"use strict";(self.webpackChunkrootSystems=self.webpackChunkrootSystems||[]).push([[179],{202:()=>{function Qt(n){return"function"==typeof n}function Ru(n){const t=n(i=>{Error.call(i),i.stack=(new Error).stack});return t.prototype=Object.create(Error.prototype),t.prototype.constructor=t,t}const Kd=Ru(n=>function(t){n(this),this.message=t?`${t.length} errors occurred during unsubscription:\n${t.map((i,r)=>`${r+1}) ${i.toString()}`).join("\n  ")}`:"",this.name="UnsubscriptionError",this.errors=t});function xc(n,e){if(n){const t=n.indexOf(e);0<=t&&n.splice(t,1)}}class Ni{constructor(e){this.initialTeardown=e,this.closed=!1,this._parentage=null,this._finalizers=null}unsubscribe(){let e;if(!this.closed){this.closed=!0;const{_parentage:t}=this;if(t)if(this._parentage=null,Array.isArray(t))for(const s of t)s.remove(this);else t.remove(this);const{initialTeardown:i}=this;if(Qt(i))try{i()}catch(s){e=s instanceof Kd?s.errors:[s]}const{_finalizers:r}=this;if(r){this._finalizers=null;for(const s of r)try{YM(s)}catch(o){e=e??[],o instanceof Kd?e=[...e,...o.errors]:e.push(o)}}if(e)throw new Kd(e)}}add(e){var t;if(e&&e!==this)if(this.closed)YM(e);else{if(e instanceof Ni){if(e.closed||e._hasParent(this))return;e._addParent(this)}(this._finalizers=null!==(t=this._finalizers)&&void 0!==t?t:[]).push(e)}}_hasParent(e){const{_parentage:t}=this;return t===e||Array.isArray(t)&&t.includes(e)}_addParent(e){const{_parentage:t}=this;this._parentage=Array.isArray(t)?(t.push(e),t):t?[t,e]:e}_removeParent(e){const{_parentage:t}=this;t===e?this._parentage=null:Array.isArray(t)&&xc(t,e)}remove(e){const{_finalizers:t}=this;t&&xc(t,e),e instanceof Ni&&e._removeParent(this)}}Ni.EMPTY=(()=>{const n=new Ni;return n.closed=!0,n})();const qM=Ni.EMPTY;function XM(n){return n instanceof Ni||n&&"closed"in n&&Qt(n.remove)&&Qt(n.add)&&Qt(n.unsubscribe)}function YM(n){Qt(n)?n():n.unsubscribe()}const sa={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1},Jd={setTimeout(n,e,...t){const{delegate:i}=Jd;return i?.setTimeout?i.setTimeout(n,e,...t):setTimeout(n,e,...t)},clearTimeout(n){const{delegate:e}=Jd;return(e?.clearTimeout||clearTimeout)(n)},delegate:void 0};function ZM(n){Jd.setTimeout(()=>{const{onUnhandledError:e}=sa;if(!e)throw n;e(n)})}function C_(){}const NF=S_("C",void 0,void 0);function S_(n,e,t){return{kind:n,value:e,error:t}}let oa=null;function Qd(n){if(sa.useDeprecatedSynchronousErrorHandling){const e=!oa;if(e&&(oa={errorThrown:!1,error:null}),n(),e){const{errorThrown:t,error:i}=oa;if(oa=null,t)throw i}}else n()}class E_ extends Ni{constructor(e){super(),this.isStopped=!1,e?(this.destination=e,XM(e)&&e.add(this)):this.destination=GF}static create(e,t,i){return new Ou(e,t,i)}next(e){this.isStopped?T_(function VF(n){return S_("N",n,void 0)}(e),this):this._next(e)}error(e){this.isStopped?T_(function FF(n){return S_("E",void 0,n)}(e),this):(this.isStopped=!0,this._error(e))}complete(){this.isStopped?T_(NF,this):(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe(),this.destination=null)}_next(e){this.destination.next(e)}_error(e){try{this.destination.error(e)}finally{this.unsubscribe()}}_complete(){try{this.destination.complete()}finally{this.unsubscribe()}}}const UF=Function.prototype.bind;function D_(n,e){return UF.call(n,e)}class zF{constructor(e){this.partialObserver=e}next(e){const{partialObserver:t}=this;if(t.next)try{t.next(e)}catch(i){ef(i)}}error(e){const{partialObserver:t}=this;if(t.error)try{t.error(e)}catch(i){ef(i)}else ef(e)}complete(){const{partialObserver:e}=this;if(e.complete)try{e.complete()}catch(t){ef(t)}}}class Ou extends E_{constructor(e,t,i){let r;if(super(),Qt(e)||!e)r={next:e??void 0,error:t??void 0,complete:i??void 0};else{let s;this&&sa.useDeprecatedNextContext?(s=Object.create(e),s.unsubscribe=()=>this.unsubscribe(),r={next:e.next&&D_(e.next,s),error:e.error&&D_(e.error,s),complete:e.complete&&D_(e.complete,s)}):r=e}this.destination=new zF(r)}}function ef(n){sa.useDeprecatedSynchronousErrorHandling?function BF(n){sa.useDeprecatedSynchronousErrorHandling&&oa&&(oa.errorThrown=!0,oa.error=n)}(n):ZM(n)}function T_(n,e){const{onStoppedNotification:t}=sa;t&&Jd.setTimeout(()=>t(n,e))}const GF={closed:!0,next:C_,error:function HF(n){throw n},complete:C_},A_="function"==typeof Symbol&&Symbol.observable||"@@observable";function aa(n){return n}function KM(n){return 0===n.length?aa:1===n.length?n[0]:function(t){return n.reduce((i,r)=>r(i),t)}}let Mn=(()=>{class n{constructor(t){t&&(this._subscribe=t)}lift(t){const i=new n;return i.source=this,i.operator=t,i}subscribe(t,i,r){const s=function $F(n){return n&&n instanceof E_||function WF(n){return n&&Qt(n.next)&&Qt(n.error)&&Qt(n.complete)}(n)&&XM(n)}(t)?t:new Ou(t,i,r);return Qd(()=>{const{operator:o,source:a}=this;s.add(o?o.call(s,a):a?this._subscribe(s):this._trySubscribe(s))}),s}_trySubscribe(t){try{return this._subscribe(t)}catch(i){t.error(i)}}forEach(t,i){return new(i=JM(i))((r,s)=>{const o=new Ou({next:a=>{try{t(a)}catch(c){s(c),o.unsubscribe()}},error:s,complete:r});this.subscribe(o)})}_subscribe(t){var i;return null===(i=this.source)||void 0===i?void 0:i.subscribe(t)}[A_](){return this}pipe(...t){return KM(t)(this)}toPromise(t){return new(t=JM(t))((i,r)=>{let s;this.subscribe(o=>s=o,o=>r(o),()=>i(s))})}}return n.create=e=>new n(e),n})();function JM(n){var e;return null!==(e=n??sa.Promise)&&void 0!==e?e:Promise}const qF=Ru(n=>function(){n(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"});let ui=(()=>{class n extends Mn{constructor(){super(),this.closed=!1,this.currentObservers=null,this.observers=[],this.isStopped=!1,this.hasError=!1,this.thrownError=null}lift(t){const i=new QM(this,this);return i.operator=t,i}_throwIfClosed(){if(this.closed)throw new qF}next(t){Qd(()=>{if(this._throwIfClosed(),!this.isStopped){this.currentObservers||(this.currentObservers=Array.from(this.observers));for(const i of this.currentObservers)i.next(t)}})}error(t){Qd(()=>{if(this._throwIfClosed(),!this.isStopped){this.hasError=this.isStopped=!0,this.thrownError=t;const{observers:i}=this;for(;i.length;)i.shift().error(t)}})}complete(){Qd(()=>{if(this._throwIfClosed(),!this.isStopped){this.isStopped=!0;const{observers:t}=this;for(;t.length;)t.shift().complete()}})}unsubscribe(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null}get observed(){var t;return(null===(t=this.observers)||void 0===t?void 0:t.length)>0}_trySubscribe(t){return this._throwIfClosed(),super._trySubscribe(t)}_subscribe(t){return this._throwIfClosed(),this._checkFinalizedStatuses(t),this._innerSubscribe(t)}_innerSubscribe(t){const{hasError:i,isStopped:r,observers:s}=this;return i||r?qM:(this.currentObservers=null,s.push(t),new Ni(()=>{this.currentObservers=null,xc(s,t)}))}_checkFinalizedStatuses(t){const{hasError:i,thrownError:r,isStopped:s}=this;i?t.error(r):s&&t.complete()}asObservable(){const t=new Mn;return t.source=this,t}}return n.create=(e,t)=>new QM(e,t),n})();class QM extends ui{constructor(e,t){super(),this.destination=e,this.source=t}next(e){var t,i;null===(i=null===(t=this.destination)||void 0===t?void 0:t.next)||void 0===i||i.call(t,e)}error(e){var t,i;null===(i=null===(t=this.destination)||void 0===t?void 0:t.error)||void 0===i||i.call(t,e)}complete(){var e,t;null===(t=null===(e=this.destination)||void 0===e?void 0:e.complete)||void 0===t||t.call(e)}_subscribe(e){var t,i;return null!==(i=null===(t=this.source)||void 0===t?void 0:t.subscribe(e))&&void 0!==i?i:qM}}function eC(n){return Qt(n?.lift)}function In(n){return e=>{if(eC(e))return e.lift(function(t){try{return n(t,this)}catch(i){this.error(i)}});throw new TypeError("Unable to lift unknown Observable type")}}function Cn(n,e,t,i,r){return new XF(n,e,t,i,r)}class XF extends E_{constructor(e,t,i,r,s,o){super(e),this.onFinalize=s,this.shouldUnsubscribe=o,this._next=t?function(a){try{t(a)}catch(c){e.error(c)}}:super._next,this._error=r?function(a){try{r(a)}catch(c){e.error(c)}finally{this.unsubscribe()}}:super._error,this._complete=i?function(){try{i()}catch(a){e.error(a)}finally{this.unsubscribe()}}:super._complete}unsubscribe(){var e;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){const{closed:t}=this;super.unsubscribe(),!t&&(null===(e=this.onFinalize)||void 0===e||e.call(this))}}}function tt(n,e){return In((t,i)=>{let r=0;t.subscribe(Cn(i,s=>{i.next(n.call(e,s,r++))}))})}function ca(n){return this instanceof ca?(this.v=n,this):new ca(n)}function KF(n,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r,i=t.apply(n,e||[]),s=[];return r={},o("next"),o("throw"),o("return"),r[Symbol.asyncIterator]=function(){return this},r;function o(d){i[d]&&(r[d]=function(f){return new Promise(function(p,m){s.push([d,f,p,m])>1||a(d,f)})})}function a(d,f){try{!function c(d){d.value instanceof ca?Promise.resolve(d.value.v).then(l,u):h(s[0][2],d)}(i[d](f))}catch(p){h(s[0][3],p)}}function l(d){a("next",d)}function u(d){a("throw",d)}function h(d,f){d(f),s.shift(),s.length&&a(s[0][0],s[0][1])}}function JF(n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,e=n[Symbol.asyncIterator];return e?e.call(n):(n=function iC(n){var e="function"==typeof Symbol&&Symbol.iterator,t=e&&n[e],i=0;if(t)return t.call(n);if(n&&"number"==typeof n.length)return{next:function(){return n&&i>=n.length&&(n=void 0),{value:n&&n[i++],done:!n}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}(n),t={},i("next"),i("throw"),i("return"),t[Symbol.asyncIterator]=function(){return this},t);function i(s){t[s]=n[s]&&function(o){return new Promise(function(a,c){!function r(s,o,a,c){Promise.resolve(c).then(function(l){s({value:l,done:a})},o)}(a,c,(o=n[s](o)).done,o.value)})}}}const rC=n=>n&&"number"==typeof n.length&&"function"!=typeof n;function sC(n){return Qt(n?.then)}function oC(n){return Qt(n[A_])}function aC(n){return Symbol.asyncIterator&&Qt(n?.[Symbol.asyncIterator])}function cC(n){return new TypeError(`You provided ${null!==n&&"object"==typeof n?"an invalid object":`'${n}'`} where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.`)}const lC=function e2(){return"function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator"}();function uC(n){return Qt(n?.[lC])}function hC(n){return KF(this,arguments,function*(){const t=n.getReader();try{for(;;){const{value:i,done:r}=yield ca(t.read());if(r)return yield ca(void 0);yield yield ca(i)}}finally{t.releaseLock()}})}function dC(n){return Qt(n?.getReader)}function pr(n){if(n instanceof Mn)return n;if(null!=n){if(oC(n))return function t2(n){return new Mn(e=>{const t=n[A_]();if(Qt(t.subscribe))return t.subscribe(e);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}(n);if(rC(n))return function n2(n){return new Mn(e=>{for(let t=0;t<n.length&&!e.closed;t++)e.next(n[t]);e.complete()})}(n);if(sC(n))return function i2(n){return new Mn(e=>{n.then(t=>{e.closed||(e.next(t),e.complete())},t=>e.error(t)).then(null,ZM)})}(n);if(aC(n))return fC(n);if(uC(n))return function r2(n){return new Mn(e=>{for(const t of n)if(e.next(t),e.closed)return;e.complete()})}(n);if(dC(n))return function s2(n){return fC(hC(n))}(n)}throw cC(n)}function fC(n){return new Mn(e=>{(function o2(n,e){var t,i,r,s;return function YF(n,e,t,i){return new(t||(t=Promise))(function(s,o){function a(u){try{l(i.next(u))}catch(h){o(h)}}function c(u){try{l(i.throw(u))}catch(h){o(h)}}function l(u){u.done?s(u.value):function r(s){return s instanceof t?s:new t(function(o){o(s)})}(u.value).then(a,c)}l((i=i.apply(n,e||[])).next())})}(this,void 0,void 0,function*(){try{for(t=JF(n);!(i=yield t.next()).done;)if(e.next(i.value),e.closed)return}catch(o){r={error:o}}finally{try{i&&!i.done&&(s=t.return)&&(yield s.call(t))}finally{if(r)throw r.error}}e.complete()})})(n,e).catch(t=>e.error(t))})}function Is(n,e,t,i=0,r=!1){const s=e.schedule(function(){t(),r?n.add(this.schedule(null,i)):this.unsubscribe()},i);if(n.add(s),!r)return s}function ni(n,e,t=1/0){return Qt(e)?ni((i,r)=>tt((s,o)=>e(i,s,r,o))(pr(n(i,r))),t):("number"==typeof e&&(t=e),In((i,r)=>function a2(n,e,t,i,r,s,o,a){const c=[];let l=0,u=0,h=!1;const d=()=>{h&&!c.length&&!l&&e.complete()},f=m=>l<i?p(m):c.push(m),p=m=>{s&&e.next(m),l++;let g=!1;pr(t(m,u++)).subscribe(Cn(e,_=>{r?.(_),s?f(_):e.next(_)},()=>{g=!0},void 0,()=>{if(g)try{for(l--;c.length&&l<i;){const _=c.shift();o?Is(e,o,()=>p(_)):p(_)}d()}catch(_){e.error(_)}}))};return n.subscribe(Cn(e,f,()=>{h=!0,d()})),()=>{a?.()}}(i,r,n,t)))}function wc(n=1/0){return ni(aa,n)}const Ps=new Mn(n=>n.complete());function P_(n){return n[n.length-1]}function pC(n){return Qt(P_(n))?n.pop():void 0}function ku(n){return function l2(n){return n&&Qt(n.schedule)}(P_(n))?n.pop():void 0}function mC(n,e=0){return In((t,i)=>{t.subscribe(Cn(i,r=>Is(i,n,()=>i.next(r),e),()=>Is(i,n,()=>i.complete(),e),r=>Is(i,n,()=>i.error(r),e)))})}function gC(n,e=0){return In((t,i)=>{i.add(n.schedule(()=>t.subscribe(i),e))})}function _C(n,e){if(!n)throw new Error("Iterable cannot be null");return new Mn(t=>{Is(t,e,()=>{const i=n[Symbol.asyncIterator]();Is(t,e,()=>{i.next().then(r=>{r.done?t.complete():t.next(r.value)})},0,!0)})})}function Pn(n,e){return e?function g2(n,e){if(null!=n){if(oC(n))return function h2(n,e){return pr(n).pipe(gC(e),mC(e))}(n,e);if(rC(n))return function f2(n,e){return new Mn(t=>{let i=0;return e.schedule(function(){i===n.length?t.complete():(t.next(n[i++]),t.closed||this.schedule())})})}(n,e);if(sC(n))return function d2(n,e){return pr(n).pipe(gC(e),mC(e))}(n,e);if(aC(n))return _C(n,e);if(uC(n))return function p2(n,e){return new Mn(t=>{let i;return Is(t,e,()=>{i=n[lC](),Is(t,e,()=>{let r,s;try{({value:r,done:s}=i.next())}catch(o){return void t.error(o)}s?t.complete():t.next(r)},0,!0)}),()=>Qt(i?.return)&&i.return()})}(n,e);if(dC(n))return function m2(n,e){return _C(hC(n),e)}(n,e)}throw cC(n)}(n,e):pr(n)}function yC(n={}){const{connector:e=(()=>new ui),resetOnError:t=!0,resetOnComplete:i=!0,resetOnRefCountZero:r=!0}=n;return s=>{let o,a,c,l=0,u=!1,h=!1;const d=()=>{a?.unsubscribe(),a=void 0},f=()=>{d(),o=c=void 0,u=h=!1},p=()=>{const m=o;f(),m?.unsubscribe()};return In((m,g)=>{l++,!h&&!u&&d();const _=c=c??e();g.add(()=>{l--,0===l&&!h&&!u&&(a=R_(p,r))}),_.subscribe(g),!o&&l>0&&(o=new Ou({next:b=>_.next(b),error:b=>{h=!0,d(),a=R_(f,t,b),_.error(b)},complete:()=>{u=!0,d(),a=R_(f,i),_.complete()}}),pr(m).subscribe(o))})(s)}}function R_(n,e,...t){if(!0===e)return void n();if(!1===e)return;const i=new Ou({next:()=>{i.unsubscribe(),n()}});return e(...t).subscribe(i)}function Zt(n){for(let e in n)if(n[e]===Zt)return e;throw Error("Could not find renamed property on target object.")}function O_(n,e){for(const t in e)e.hasOwnProperty(t)&&!n.hasOwnProperty(t)&&(n[t]=e[t])}function Kt(n){if("string"==typeof n)return n;if(Array.isArray(n))return"["+n.map(Kt).join(", ")+"]";if(null==n)return""+n;if(n.overriddenName)return`${n.overriddenName}`;if(n.name)return`${n.name}`;const e=n.toString();if(null==e)return""+e;const t=e.indexOf("\n");return-1===t?e:e.substring(0,t)}function k_(n,e){return null==n||""===n?null===e?"":e:null==e||""===e?n:n+" "+e}const y2=Zt({__forward_ref__:Zt});function $t(n){return n.__forward_ref__=$t,n.toString=function(){return Kt(this())},n}function Ye(n){return function L_(n){return"function"==typeof n&&n.hasOwnProperty(y2)&&n.__forward_ref__===$t}(n)?n():n}function N_(n){return n&&!!n.\u0275providers}class K extends Error{constructor(e,t){super(function tf(n,e){return`NG0${Math.abs(n)}${e?": "+e.trim():""}`}(e,t)),this.code=e}}function rt(n){return"string"==typeof n?n:null==n?"":String(n)}function nf(n,e){throw new K(-201,!1)}function ji(n,e){null==n&&function Ft(n,e,t,i){throw new Error(`ASSERTION ERROR: ${n}`+(null==i?"":` [Expected=> ${t} ${i} ${e} <=Actual]`))}(e,n,null,"!=")}function Te(n){return{token:n.token,providedIn:n.providedIn||null,factory:n.factory,value:void 0}}function hi(n){return{providers:n.providers||[],imports:n.imports||[]}}function rf(n){return vC(n,sf)||vC(n,xC)}function vC(n,e){return n.hasOwnProperty(e)?n[e]:null}function bC(n){return n&&(n.hasOwnProperty(F_)||n.hasOwnProperty(D2))?n[F_]:null}const sf=Zt({\u0275prov:Zt}),F_=Zt({\u0275inj:Zt}),xC=Zt({ngInjectableDef:Zt}),D2=Zt({ngInjectorDef:Zt});var Ze=(()=>((Ze=Ze||{})[Ze.Default=0]="Default",Ze[Ze.Host=1]="Host",Ze[Ze.Self=2]="Self",Ze[Ze.SkipSelf=4]="SkipSelf",Ze[Ze.Optional=8]="Optional",Ze))();let V_;function mr(n){const e=V_;return V_=n,e}function wC(n,e,t){const i=rf(n);return i&&"root"==i.providedIn?void 0===i.value?i.value=i.factory():i.value:t&Ze.Optional?null:void 0!==e?e:void nf(Kt(n))}const en=(()=>typeof globalThis<"u"&&globalThis||typeof global<"u"&&global||typeof window<"u"&&window||typeof self<"u"&&typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&self)(),Lu={},B_="__NG_DI_FLAG__",af="ngTempTokenPath",I2=/\n/gm,MC="__source";let Nu;function Mc(n){const e=Nu;return Nu=n,e}function R2(n,e=Ze.Default){if(void 0===Nu)throw new K(-203,!1);return null===Nu?wC(n,void 0,e):Nu.get(n,e&Ze.Optional?null:void 0,e)}function le(n,e=Ze.Default){return(function T2(){return V_}()||R2)(Ye(n),e)}function Ot(n,e=Ze.Default){return le(n,cf(e))}function cf(n){return typeof n>"u"||"number"==typeof n?n:0|(n.optional&&8)|(n.host&&1)|(n.self&&2)|(n.skipSelf&&4)}function U_(n){const e=[];for(let t=0;t<n.length;t++){const i=Ye(n[t]);if(Array.isArray(i)){if(0===i.length)throw new K(900,!1);let r,s=Ze.Default;for(let o=0;o<i.length;o++){const a=i[o],c=O2(a);"number"==typeof c?-1===c?r=a.token:s|=c:r=a}e.push(le(r,s))}else e.push(le(i))}return e}function Fu(n,e){return n[B_]=e,n.prototype[B_]=e,n}function O2(n){return n[B_]}function mo(n){return{toString:n}.toString()}var Lr=(()=>((Lr=Lr||{})[Lr.OnPush=0]="OnPush",Lr[Lr.Default=1]="Default",Lr))(),Nr=(()=>{return(n=Nr||(Nr={}))[n.Emulated=0]="Emulated",n[n.None=2]="None",n[n.ShadowDom=3]="ShadowDom",Nr;var n})();const Os={},kt=[],lf=Zt({\u0275cmp:Zt}),z_=Zt({\u0275dir:Zt}),H_=Zt({\u0275pipe:Zt}),SC=Zt({\u0275mod:Zt}),ks=Zt({\u0275fac:Zt}),Vu=Zt({__NG_ELEMENT_ID__:Zt});let N2=0;function ii(n){return mo(()=>{const t=!0===n.standalone,i={},r={type:n.type,providersResolver:null,decls:n.decls,vars:n.vars,factory:null,template:n.template||null,consts:n.consts||null,ngContentSelectors:n.ngContentSelectors,hostBindings:n.hostBindings||null,hostVars:n.hostVars||0,hostAttrs:n.hostAttrs||null,contentQueries:n.contentQueries||null,declaredInputs:i,inputs:null,outputs:null,exportAs:n.exportAs||null,onPush:n.changeDetection===Lr.OnPush,directiveDefs:null,pipeDefs:null,standalone:t,dependencies:t&&n.dependencies||null,getStandaloneInjector:null,selectors:n.selectors||kt,viewQuery:n.viewQuery||null,features:n.features||null,data:n.data||{},encapsulation:n.encapsulation||Nr.Emulated,id:"c"+N2++,styles:n.styles||kt,_:null,setInput:null,schemas:n.schemas||null,tView:null,findHostDirectiveDefs:null,hostDirectives:null},s=n.dependencies,o=n.features;return r.inputs=TC(n.inputs,i),r.outputs=TC(n.outputs),o&&o.forEach(a=>a(r)),r.directiveDefs=s?()=>("function"==typeof s?s():s).map(EC).filter(DC):null,r.pipeDefs=s?()=>("function"==typeof s?s():s).map(xi).filter(DC):null,r})}function EC(n){return Vt(n)||di(n)}function DC(n){return null!==n}function bi(n){return mo(()=>({type:n.type,bootstrap:n.bootstrap||kt,declarations:n.declarations||kt,imports:n.imports||kt,exports:n.exports||kt,transitiveCompileScopes:null,schemas:n.schemas||null,id:n.id||null}))}function TC(n,e){if(null==n)return Os;const t={};for(const i in n)if(n.hasOwnProperty(i)){let r=n[i],s=r;Array.isArray(r)&&(s=r[1],r=r[0]),t[r]=i,e&&(e[r]=s)}return t}const Ke=ii;function Vt(n){return n[lf]||null}function di(n){return n[z_]||null}function xi(n){return n[H_]||null}function Wi(n,e){const t=n[SC]||null;if(!t&&!0===e)throw new Error(`Type ${Kt(n)} does not have '\u0275mod' property.`);return t}function Vi(n){return Array.isArray(n)&&"object"==typeof n[1]}function Vr(n){return Array.isArray(n)&&!0===n[1]}function W_(n){return 0!=(4&n.flags)}function ff(n){return n.componentOffset>-1}function pf(n){return 1==(1&n.flags)}function Br(n){return null!==n.template}function H2(n){return 0!=(256&n[2])}function fa(n,e){return n.hasOwnProperty(ks)?n[ks]:null}class W2{constructor(e,t,i){this.previousValue=e,this.currentValue=t,this.firstChange=i}isFirstChange(){return this.firstChange}}function _r(){return PC}function PC(n){return n.type.prototype.ngOnChanges&&(n.setInput=q2),$2}function $2(){const n=OC(this),e=n?.current;if(e){const t=n.previous;if(t===Os)n.previous=e;else for(let i in e)t[i]=e[i];n.current=null,this.ngOnChanges(e)}}function q2(n,e,t,i){const r=this.declaredInputs[t],s=OC(n)||function X2(n,e){return n[RC]=e}(n,{previous:Os,current:null}),o=s.current||(s.current={}),a=s.previous,c=a[r];o[r]=new W2(c&&c.currentValue,e,a===Os),n[i]=e}_r.ngInherit=!0;const RC="__ngSimpleChanges__";function OC(n){return n[RC]||null}function Rn(n){for(;Array.isArray(n);)n=n[0];return n}function mf(n,e){return Rn(e[n])}function qi(n,e){return Rn(e[n.index])}function Z_(n,e){return n.data[e]}function Xi(n,e){const t=e[n];return Vi(t)?t:t[0]}function gf(n){return 64==(64&n[2])}function go(n,e){return null==e?null:n[e]}function kC(n){n[18]=0}function K_(n,e){n[5]+=e;let t=n,i=n[3];for(;null!==i&&(1===e&&1===t[5]||-1===e&&0===t[5]);)i[5]+=e,t=i,i=i[3]}const nt={lFrame:jC(null),bindingsEnabled:!0};function NC(){return nt.bindingsEnabled}function ae(){return nt.lFrame.lView}function Tt(){return nt.lFrame.tView}function Ur(n){return nt.lFrame.contextLView=n,n[8]}function zr(n){return nt.lFrame.contextLView=null,n}function ri(){let n=FC();for(;null!==n&&64===n.type;)n=n.parent;return n}function FC(){return nt.lFrame.currentTNode}function rs(n,e){const t=nt.lFrame;t.currentTNode=n,t.isParent=e}function J_(){return nt.lFrame.isParent}function Q_(){nt.lFrame.isParent=!1}function Ac(){return nt.lFrame.bindingIndex++}function u3(n,e){const t=nt.lFrame;t.bindingIndex=t.bindingRootIndex=n,ey(e)}function ey(n){nt.lFrame.currentDirectiveIndex=n}function zC(){return nt.lFrame.currentQueryIndex}function ny(n){nt.lFrame.currentQueryIndex=n}function d3(n){const e=n[1];return 2===e.type?e.declTNode:1===e.type?n[6]:null}function HC(n,e,t){if(t&Ze.SkipSelf){let r=e,s=n;for(;!(r=r.parent,null!==r||t&Ze.Host||(r=d3(s),null===r||(s=s[15],10&r.type))););if(null===r)return!1;e=r,n=s}const i=nt.lFrame=GC();return i.currentTNode=e,i.lView=n,!0}function iy(n){const e=GC(),t=n[1];nt.lFrame=e,e.currentTNode=t.firstChild,e.lView=n,e.tView=t,e.contextLView=n,e.bindingIndex=t.bindingStartIndex,e.inI18n=!1}function GC(){const n=nt.lFrame,e=null===n?null:n.child;return null===e?jC(n):e}function jC(n){const e={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:n,child:null,inI18n:!1};return null!==n&&(n.child=e),e}function WC(){const n=nt.lFrame;return nt.lFrame=n.parent,n.currentTNode=null,n.lView=null,n}const $C=WC;function ry(){const n=WC();n.isParent=!0,n.tView=null,n.selectedIndex=-1,n.contextLView=null,n.elementDepthCount=0,n.currentDirectiveIndex=-1,n.currentNamespace=null,n.bindingRootIndex=-1,n.bindingIndex=-1,n.currentQueryIndex=0}function Mi(){return nt.lFrame.selectedIndex}function pa(n){nt.lFrame.selectedIndex=n}function pn(){const n=nt.lFrame;return Z_(n.tView,n.selectedIndex)}function _f(n,e){for(let t=e.directiveStart,i=e.directiveEnd;t<i;t++){const s=n.data[t].type.prototype,{ngAfterContentInit:o,ngAfterContentChecked:a,ngAfterViewInit:c,ngAfterViewChecked:l,ngOnDestroy:u}=s;o&&(n.contentHooks||(n.contentHooks=[])).push(-t,o),a&&((n.contentHooks||(n.contentHooks=[])).push(t,a),(n.contentCheckHooks||(n.contentCheckHooks=[])).push(t,a)),c&&(n.viewHooks||(n.viewHooks=[])).push(-t,c),l&&((n.viewHooks||(n.viewHooks=[])).push(t,l),(n.viewCheckHooks||(n.viewCheckHooks=[])).push(t,l)),null!=u&&(n.destroyHooks||(n.destroyHooks=[])).push(t,u)}}function yf(n,e,t){YC(n,e,3,t)}function vf(n,e,t,i){(3&n[2])===t&&YC(n,e,t,i)}function sy(n,e){let t=n[2];(3&t)===e&&(t&=2047,t+=1,n[2]=t)}function YC(n,e,t,i){const s=i??-1,o=e.length-1;let a=0;for(let c=void 0!==i?65535&n[18]:0;c<o;c++)if("number"==typeof e[c+1]){if(a=e[c],null!=i&&a>=i)break}else e[c]<0&&(n[18]+=65536),(a<s||-1==s)&&(v3(n,t,e,c),n[18]=(4294901760&n[18])+c+2),c++}function v3(n,e,t,i){const r=t[i]<0,s=t[i+1],a=n[r?-t[i]:t[i]];if(r){if(n[2]>>11<n[18]>>16&&(3&n[2])===e){n[2]+=2048;try{s.call(a)}finally{}}}else try{s.call(a)}finally{}}class ju{constructor(e,t,i){this.factory=e,this.resolving=!1,this.canSeeViewProviders=t,this.injectImpl=i}}function ay(n,e,t){let i=0;for(;i<t.length;){const r=t[i];if("number"==typeof r){if(0!==r)break;i++;const s=t[i++],o=t[i++],a=t[i++];n.setAttribute(e,o,a,s)}else{const s=r,o=t[++i];KC(s)?n.setProperty(e,s,o):n.setAttribute(e,s,o),i++}}return i}function ZC(n){return 3===n||4===n||6===n}function KC(n){return 64===n.charCodeAt(0)}function $u(n,e){if(null!==e&&0!==e.length)if(null===n||0===n.length)n=e.slice();else{let t=-1;for(let i=0;i<e.length;i++){const r=e[i];"number"==typeof r?t=r:0===t||JC(n,t,r,null,-1===t||2===t?e[++i]:null)}}return n}function JC(n,e,t,i,r){let s=0,o=n.length;if(-1===e)o=-1;else for(;s<n.length;){const a=n[s++];if("number"==typeof a){if(a===e){o=-1;break}if(a>e){o=s-1;break}}}for(;s<n.length;){const a=n[s];if("number"==typeof a)break;if(a===t){if(null===i)return void(null!==r&&(n[s+1]=r));if(i===n[s+1])return void(n[s+2]=r)}s++,null!==i&&s++,null!==r&&s++}-1!==o&&(n.splice(o,0,e),s=o+1),n.splice(s++,0,t),null!==i&&n.splice(s++,0,i),null!==r&&n.splice(s++,0,r)}function QC(n){return-1!==n}function Ic(n){return 32767&n}function Pc(n,e){let t=function C3(n){return n>>16}(n),i=e;for(;t>0;)i=i[15],t--;return i}let cy=!0;function bf(n){const e=cy;return cy=n,e}let S3=0;const ss={};function xf(n,e){const t=uy(n,e);if(-1!==t)return t;const i=e[1];i.firstCreatePass&&(n.injectorIndex=e.length,ly(i.data,n),ly(e,null),ly(i.blueprint,null));const r=wf(n,e),s=n.injectorIndex;if(QC(r)){const o=Ic(r),a=Pc(r,e),c=a[1].data;for(let l=0;l<8;l++)e[s+l]=a[o+l]|c[o+l]}return e[s+8]=r,s}function ly(n,e){n.push(0,0,0,0,0,0,0,0,e)}function uy(n,e){return-1===n.injectorIndex||n.parent&&n.parent.injectorIndex===n.injectorIndex||null===e[n.injectorIndex+8]?-1:n.injectorIndex}function wf(n,e){if(n.parent&&-1!==n.parent.injectorIndex)return n.parent.injectorIndex;let t=0,i=null,r=e;for(;null!==r;){if(i=cS(r),null===i)return-1;if(t++,r=r[15],-1!==i.injectorIndex)return i.injectorIndex|t<<16}return-1}function hy(n,e,t){!function E3(n,e,t){let i;"string"==typeof t?i=t.charCodeAt(0)||0:t.hasOwnProperty(Vu)&&(i=t[Vu]),null==i&&(i=t[Vu]=S3++);const r=255&i;e.data[n+(r>>5)]|=1<<r}(n,e,t)}function nS(n,e,t){if(t&Ze.Optional||void 0!==n)return n;nf()}function iS(n,e,t,i){if(t&Ze.Optional&&void 0===i&&(i=null),0==(t&(Ze.Self|Ze.Host))){const r=n[9],s=mr(void 0);try{return r?r.get(e,i,t&Ze.Optional):wC(e,i,t&Ze.Optional)}finally{mr(s)}}return nS(i,0,t)}function rS(n,e,t,i=Ze.Default,r){if(null!==n){if(1024&e[2]){const o=function P3(n,e,t,i,r){let s=n,o=e;for(;null!==s&&null!==o&&1024&o[2]&&!(256&o[2]);){const a=sS(s,o,t,i|Ze.Self,ss);if(a!==ss)return a;let c=s.parent;if(!c){const l=o[21];if(l){const u=l.get(t,ss,i);if(u!==ss)return u}c=cS(o),o=o[15]}s=c}return r}(n,e,t,i,ss);if(o!==ss)return o}const s=sS(n,e,t,i,ss);if(s!==ss)return s}return iS(e,t,i,r)}function sS(n,e,t,i,r){const s=function A3(n){if("string"==typeof n)return n.charCodeAt(0)||0;const e=n.hasOwnProperty(Vu)?n[Vu]:void 0;return"number"==typeof e?e>=0?255&e:I3:e}(t);if("function"==typeof s){if(!HC(e,n,i))return i&Ze.Host?nS(r,0,i):iS(e,t,i,r);try{const o=s(i);if(null!=o||i&Ze.Optional)return o;nf()}finally{$C()}}else if("number"==typeof s){let o=null,a=uy(n,e),c=-1,l=i&Ze.Host?e[16][6]:null;for((-1===a||i&Ze.SkipSelf)&&(c=-1===a?wf(n,e):e[a+8],-1!==c&&aS(i,!1)?(o=e[1],a=Ic(c),e=Pc(c,e)):a=-1);-1!==a;){const u=e[1];if(oS(s,a,u.data)){const h=T3(a,e,t,o,i,l);if(h!==ss)return h}c=e[a+8],-1!==c&&aS(i,e[1].data[a+8]===l)&&oS(s,a,e)?(o=u,a=Ic(c),e=Pc(c,e)):a=-1}}return r}function T3(n,e,t,i,r,s){const o=e[1],a=o.data[n+8],u=Mf(a,o,t,null==i?ff(a)&&cy:i!=o&&0!=(3&a.type),r&Ze.Host&&s===a);return null!==u?Rc(e,o,u,a):ss}function Mf(n,e,t,i,r){const s=n.providerIndexes,o=e.data,a=1048575&s,c=n.directiveStart,u=s>>20,d=r?a+u:n.directiveEnd;for(let f=i?a:a+u;f<d;f++){const p=o[f];if(f<c&&t===p||f>=c&&p.type===t)return f}if(r){const f=o[c];if(f&&Br(f)&&f.type===t)return c}return null}function Rc(n,e,t,i){let r=n[t];const s=e.data;if(function b3(n){return n instanceof ju}(r)){const o=r;o.resolving&&function v2(n,e){const t=e?`. Dependency path: ${e.join(" > ")} > ${n}`:"";throw new K(-200,`Circular dependency in DI detected for ${n}${t}`)}(function Nt(n){return"function"==typeof n?n.name||n.toString():"object"==typeof n&&null!=n&&"function"==typeof n.type?n.type.name||n.type.toString():rt(n)}(s[t]));const a=bf(o.canSeeViewProviders);o.resolving=!0;const c=o.injectImpl?mr(o.injectImpl):null;HC(n,i,Ze.Default);try{r=n[t]=o.factory(void 0,s,n,i),e.firstCreatePass&&t>=i.directiveStart&&function y3(n,e,t){const{ngOnChanges:i,ngOnInit:r,ngDoCheck:s}=e.type.prototype;if(i){const o=PC(e);(t.preOrderHooks||(t.preOrderHooks=[])).push(n,o),(t.preOrderCheckHooks||(t.preOrderCheckHooks=[])).push(n,o)}r&&(t.preOrderHooks||(t.preOrderHooks=[])).push(0-n,r),s&&((t.preOrderHooks||(t.preOrderHooks=[])).push(n,s),(t.preOrderCheckHooks||(t.preOrderCheckHooks=[])).push(n,s))}(t,s[t],e)}finally{null!==c&&mr(c),bf(a),o.resolving=!1,$C()}}return r}function oS(n,e,t){return!!(t[e+(n>>5)]&1<<n)}function aS(n,e){return!(n&Ze.Self||n&Ze.Host&&e)}class Oc{constructor(e,t){this._tNode=e,this._lView=t}get(e,t,i){return rS(this._tNode,this._lView,e,cf(i),t)}}function I3(){return new Oc(ri(),ae())}function cS(n){const e=n[1],t=e.type;return 2===t?e.declTNode:1===t?n[6]:null}function kc(n){return function D3(n,e){if("class"===e)return n.classes;if("style"===e)return n.styles;const t=n.attrs;if(t){const i=t.length;let r=0;for(;r<i;){const s=t[r];if(ZC(s))break;if(0===s)r+=2;else if("number"==typeof s)for(r++;r<i&&"string"==typeof t[r];)r++;else{if(s===e)return t[r+1];r+=2}}}return null}(ri(),n)}const Nc="__parameters__";function Vc(n,e,t){return mo(()=>{const i=function fy(n){return function(...t){if(n){const i=n(...t);for(const r in i)this[r]=i[r]}}}(e);function r(...s){if(this instanceof r)return i.apply(this,s),this;const o=new r(...s);return a.annotation=o,a;function a(c,l,u){const h=c.hasOwnProperty(Nc)?c[Nc]:Object.defineProperty(c,Nc,{value:[]})[Nc];for(;h.length<=u;)h.push(null);return(h[u]=h[u]||[]).push(o),c}}return t&&(r.prototype=Object.create(t.prototype)),r.prototype.ngMetadataName=n,r.annotationCls=r,r})}class xe{constructor(e,t){this._desc=e,this.ngMetadataName="InjectionToken",this.\u0275prov=void 0,"number"==typeof t?this.__NG_ELEMENT_ID__=t:void 0!==t&&(this.\u0275prov=Te({token:this,providedIn:t.providedIn||"root",factory:t.factory}))}get multi(){return this}toString(){return`InjectionToken ${this._desc}`}}function Yi(n,e){void 0===e&&(e=n);for(let t=0;t<n.length;t++){let i=n[t];Array.isArray(i)?(e===n&&(e=n.slice(0,t)),Yi(i,e)):e!==n&&e.push(i)}return e}function ma(n,e){n.forEach(t=>Array.isArray(t)?ma(t,e):e(t))}function uS(n,e,t){e>=n.length?n.push(t):n.splice(e,0,t)}function Cf(n,e){return e>=n.length-1?n.pop():n.splice(e,1)[0]}function Yu(n,e){const t=[];for(let i=0;i<n;i++)t.push(e);return t}function Zi(n,e,t){let i=Bc(n,e);return i>=0?n[1|i]=t:(i=~i,function L3(n,e,t,i){let r=n.length;if(r==e)n.push(t,i);else if(1===r)n.push(i,n[0]),n[0]=t;else{for(r--,n.push(n[r-1],n[r]);r>e;)n[r]=n[r-2],r--;n[e]=t,n[e+1]=i}}(n,i,e,t)),i}function my(n,e){const t=Bc(n,e);if(t>=0)return n[1|t]}function Bc(n,e){return function fS(n,e,t){let i=0,r=n.length>>t;for(;r!==i;){const s=i+(r-i>>1),o=n[s<<t];if(e===o)return s<<t;o>e?r=s:i=s+1}return~(r<<t)}(n,e,1)}const yo=Fu(Vc("Optional"),8),Uc=Fu(Vc("SkipSelf"),4);var Bi=(()=>((Bi=Bi||{})[Bi.Important=1]="Important",Bi[Bi.DashCase=2]="DashCase",Bi))();const xy=new Map;let iV=0;const My="__ngContext__";function mi(n,e){Vi(e)?(n[My]=e[20],function sV(n){xy.set(n[20],n)}(e)):n[My]=e}function Sy(n,e){return undefined(n,e)}function Qu(n){const e=n[3];return Vr(e)?e[3]:e}function Ey(n){return kS(n[13])}function Dy(n){return kS(n[4])}function kS(n){for(;null!==n&&!Vr(n);)n=n[4];return n}function Hc(n,e,t,i,r){if(null!=i){let s,o=!1;Vr(i)?s=i:Vi(i)&&(o=!0,i=i[0]);const a=Rn(i);0===n&&null!==t?null==r?US(e,t,a):ga(e,t,a,r||null,!0):1===n&&null!==t?ga(e,t,a,r||null,!0):2===n?function ky(n,e,t){const i=Tf(n,e);i&&function EV(n,e,t,i){n.removeChild(e,t,i)}(n,i,e,t)}(e,a,o):3===n&&e.destroyNode(a),null!=s&&function AV(n,e,t,i,r){const s=t[7];s!==Rn(t)&&Hc(e,n,i,s,r);for(let a=10;a<t.length;a++){const c=t[a];eh(c[1],c,n,e,i,s)}}(e,n,s,t,r)}}function Ay(n,e,t){return n.createElement(e,t)}function NS(n,e){const t=n[9],i=t.indexOf(e),r=e[3];512&e[2]&&(e[2]&=-513,K_(r,-1)),t.splice(i,1)}function Iy(n,e){if(n.length<=10)return;const t=10+e,i=n[t];if(i){const r=i[17];null!==r&&r!==n&&NS(r,i),e>0&&(n[t-1][4]=i[4]);const s=Cf(n,10+e);!function yV(n,e){eh(n,e,e[11],2,null,null),e[0]=null,e[6]=null}(i[1],i);const o=s[19];null!==o&&o.detachView(s[1]),i[3]=null,i[4]=null,i[2]&=-65}return i}function FS(n,e){if(!(128&e[2])){const t=e[11];t.destroyNode&&eh(n,e,t,3,null,null),function xV(n){let e=n[13];if(!e)return Py(n[1],n);for(;e;){let t=null;if(Vi(e))t=e[13];else{const i=e[10];i&&(t=i)}if(!t){for(;e&&!e[4]&&e!==n;)Vi(e)&&Py(e[1],e),e=e[3];null===e&&(e=n),Vi(e)&&Py(e[1],e),t=e&&e[4]}e=t}}(e)}}function Py(n,e){if(!(128&e[2])){e[2]&=-65,e[2]|=128,function SV(n,e){let t;if(null!=n&&null!=(t=n.destroyHooks))for(let i=0;i<t.length;i+=2){const r=e[t[i]];if(!(r instanceof ju)){const s=t[i+1];if(Array.isArray(s))for(let o=0;o<s.length;o+=2){const a=r[s[o]],c=s[o+1];try{c.call(a)}finally{}}else try{s.call(r)}finally{}}}}(n,e),function CV(n,e){const t=n.cleanup,i=e[7];let r=-1;if(null!==t)for(let s=0;s<t.length-1;s+=2)if("string"==typeof t[s]){const o=t[s+1],a="function"==typeof o?o(e):Rn(e[o]),c=i[r=t[s+2]],l=t[s+3];"boolean"==typeof l?a.removeEventListener(t[s],c,l):l>=0?i[r=l]():i[r=-l].unsubscribe(),s+=2}else{const o=i[r=t[s+1]];t[s].call(o)}if(null!==i){for(let s=r+1;s<i.length;s++)(0,i[s])();e[7]=null}}(n,e),1===e[1].type&&e[11].destroy();const t=e[17];if(null!==t&&Vr(e[3])){t!==e[3]&&NS(t,e);const i=e[19];null!==i&&i.detachView(n)}!function oV(n){xy.delete(n[20])}(e)}}function VS(n,e,t){return function BS(n,e,t){let i=e;for(;null!==i&&40&i.type;)i=(e=i).parent;if(null===i)return t[0];{const{componentOffset:r}=i;if(r>-1){const{encapsulation:s}=n.data[i.directiveStart+r];if(s===Nr.None||s===Nr.Emulated)return null}return qi(i,t)}}(n,e.parent,t)}function ga(n,e,t,i,r){n.insertBefore(e,t,i,r)}function US(n,e,t){n.appendChild(e,t)}function zS(n,e,t,i,r){null!==i?ga(n,e,t,i,r):US(n,e,t)}function Tf(n,e){return n.parentNode(e)}function HS(n,e,t){return jS(n,e,t)}let Pf,Fy,jS=function GS(n,e,t){return 40&n.type?qi(n,t):null};function Af(n,e,t,i){const r=VS(n,i,e),s=e[11],a=HS(i.parent||e[6],i,e);if(null!=r)if(Array.isArray(t))for(let c=0;c<t.length;c++)zS(s,r,t[c],a,!1);else zS(s,r,t,a,!1)}function If(n,e){if(null!==e){const t=e.type;if(3&t)return qi(e,n);if(4&t)return Oy(-1,n[e.index]);if(8&t){const i=e.child;if(null!==i)return If(n,i);{const r=n[e.index];return Vr(r)?Oy(-1,r):Rn(r)}}if(32&t)return Sy(e,n)()||Rn(n[e.index]);{const i=$S(n,e);return null!==i?Array.isArray(i)?i[0]:If(Qu(n[16]),i):If(n,e.next)}}return null}function $S(n,e){return null!==e?n[16][6].projection[e.projection]:null}function Oy(n,e){const t=10+n+1;if(t<e.length){const i=e[t],r=i[1].firstChild;if(null!==r)return If(i,r)}return e[7]}function Ly(n,e,t,i,r,s,o){for(;null!=t;){const a=i[t.index],c=t.type;if(o&&0===e&&(a&&mi(Rn(a),i),t.flags|=2),32!=(32&t.flags))if(8&c)Ly(n,e,t.child,i,r,s,!1),Hc(e,n,r,a,s);else if(32&c){const l=Sy(t,i);let u;for(;u=l();)Hc(e,n,r,u,s);Hc(e,n,r,a,s)}else 16&c?qS(n,e,i,t,r,s):Hc(e,n,r,a,s);t=o?t.projectionNext:t.next}}function eh(n,e,t,i,r,s){Ly(t,i,n.firstChild,e,r,s,!1)}function qS(n,e,t,i,r,s){const o=t[16],c=o[6].projection[i.projection];if(Array.isArray(c))for(let l=0;l<c.length;l++)Hc(e,n,r,c[l],s);else Ly(n,e,c,o[3],r,s,!0)}function XS(n,e,t){""===t?n.removeAttribute(e,"class"):n.setAttribute(e,"class",t)}function YS(n,e,t){const{mergedAttrs:i,classes:r,styles:s}=t;null!==i&&ay(n,e,i),null!==r&&XS(n,e,r),null!==s&&function PV(n,e,t){n.setAttribute(e,"style",t)}(n,e,s)}function _a(n){return function Ny(){if(void 0===Pf&&(Pf=null,en.trustedTypes))try{Pf=en.trustedTypes.createPolicy("angular",{createHTML:n=>n,createScript:n=>n,createScriptURL:n=>n})}catch{}return Pf}()?.createHTML(n)||n}class ya{constructor(e){this.changingThisBreaksApplicationSecurity=e}toString(){return`SafeValue must use [property]=binding: ${this.changingThisBreaksApplicationSecurity} (see https://g.co/ng/security#xss)`}}class NV extends ya{getTypeName(){return"HTML"}}class FV extends ya{getTypeName(){return"Style"}}class VV extends ya{getTypeName(){return"Script"}}class BV extends ya{getTypeName(){return"URL"}}class UV extends ya{getTypeName(){return"ResourceURL"}}function Ki(n){return n instanceof ya?n.changingThisBreaksApplicationSecurity:n}function os(n,e){const t=function zV(n){return n instanceof ya&&n.getTypeName()||null}(n);if(null!=t&&t!==e){if("ResourceURL"===t&&"URL"===e)return!0;throw new Error(`Required a safe ${e}, got a ${t} (see https://g.co/ng/security#xss)`)}return t===e}class qV{constructor(e){this.inertDocumentHelper=e}getInertBodyElement(e){e="<body><remove></remove>"+e;try{const t=(new window.DOMParser).parseFromString(_a(e),"text/html").body;return null===t?this.inertDocumentHelper.getInertBodyElement(e):(t.removeChild(t.firstChild),t)}catch{return null}}}class XV{constructor(e){if(this.defaultDoc=e,this.inertDocument=this.defaultDoc.implementation.createHTMLDocument("sanitization-inert"),null==this.inertDocument.body){const t=this.inertDocument.createElement("html");this.inertDocument.appendChild(t);const i=this.inertDocument.createElement("body");t.appendChild(i)}}getInertBodyElement(e){const t=this.inertDocument.createElement("template");if("content"in t)return t.innerHTML=_a(e),t;const i=this.inertDocument.createElement("body");return i.innerHTML=_a(e),this.defaultDoc.documentMode&&this.stripCustomNsAttrs(i),i}stripCustomNsAttrs(e){const t=e.attributes;for(let r=t.length-1;0<r;r--){const o=t.item(r).name;("xmlns:ns1"===o||0===o.indexOf("ns1:"))&&e.removeAttribute(o)}let i=e.firstChild;for(;i;)i.nodeType===Node.ELEMENT_NODE&&this.stripCustomNsAttrs(i),i=i.nextSibling}}const ZV=/^(?:(?:https?|mailto|data|ftp|tel|file|sms):|[^&:/?#]*(?:[/?#]|$))/gi;function Of(n){return(n=String(n)).match(ZV)?n:"unsafe:"+n}function Fs(n){const e={};for(const t of n.split(","))e[t]=!0;return e}function th(...n){const e={};for(const t of n)for(const i in t)t.hasOwnProperty(i)&&(e[i]=!0);return e}const tE=Fs("area,br,col,hr,img,wbr"),nE=Fs("colgroup,dd,dt,li,p,tbody,td,tfoot,th,thead,tr"),iE=Fs("rp,rt"),By=th(tE,th(nE,Fs("address,article,aside,blockquote,caption,center,del,details,dialog,dir,div,dl,figure,figcaption,footer,h1,h2,h3,h4,h5,h6,header,hgroup,hr,ins,main,map,menu,nav,ol,pre,section,summary,table,ul")),th(iE,Fs("a,abbr,acronym,audio,b,bdi,bdo,big,br,cite,code,del,dfn,em,font,i,img,ins,kbd,label,map,mark,picture,q,ruby,rp,rt,s,samp,small,source,span,strike,strong,sub,sup,time,track,tt,u,var,video")),th(iE,nE)),Uy=Fs("background,cite,href,itemtype,longdesc,poster,src,xlink:href"),rE=th(Uy,Fs("abbr,accesskey,align,alt,autoplay,axis,bgcolor,border,cellpadding,cellspacing,class,clear,color,cols,colspan,compact,controls,coords,datetime,default,dir,download,face,headers,height,hidden,hreflang,hspace,ismap,itemscope,itemprop,kind,label,lang,language,loop,media,muted,nohref,nowrap,open,preload,rel,rev,role,rows,rowspan,rules,scope,scrolling,shape,size,sizes,span,srclang,srcset,start,summary,tabindex,target,title,translate,type,usemap,valign,value,vspace,width"),Fs("aria-activedescendant,aria-atomic,aria-autocomplete,aria-busy,aria-checked,aria-colcount,aria-colindex,aria-colspan,aria-controls,aria-current,aria-describedby,aria-details,aria-disabled,aria-dropeffect,aria-errormessage,aria-expanded,aria-flowto,aria-grabbed,aria-haspopup,aria-hidden,aria-invalid,aria-keyshortcuts,aria-label,aria-labelledby,aria-level,aria-live,aria-modal,aria-multiline,aria-multiselectable,aria-orientation,aria-owns,aria-placeholder,aria-posinset,aria-pressed,aria-readonly,aria-relevant,aria-required,aria-roledescription,aria-rowcount,aria-rowindex,aria-rowspan,aria-selected,aria-setsize,aria-sort,aria-valuemax,aria-valuemin,aria-valuenow,aria-valuetext")),KV=Fs("script,style,template");class JV{constructor(){this.sanitizedSomething=!1,this.buf=[]}sanitizeChildren(e){let t=e.firstChild,i=!0;for(;t;)if(t.nodeType===Node.ELEMENT_NODE?i=this.startElement(t):t.nodeType===Node.TEXT_NODE?this.chars(t.nodeValue):this.sanitizedSomething=!0,i&&t.firstChild)t=t.firstChild;else for(;t;){t.nodeType===Node.ELEMENT_NODE&&this.endElement(t);let r=this.checkClobberedElement(t,t.nextSibling);if(r){t=r;break}t=this.checkClobberedElement(t,t.parentNode)}return this.buf.join("")}startElement(e){const t=e.nodeName.toLowerCase();if(!By.hasOwnProperty(t))return this.sanitizedSomething=!0,!KV.hasOwnProperty(t);this.buf.push("<"),this.buf.push(t);const i=e.attributes;for(let r=0;r<i.length;r++){const s=i.item(r),o=s.name,a=o.toLowerCase();if(!rE.hasOwnProperty(a)){this.sanitizedSomething=!0;continue}let c=s.value;Uy[a]&&(c=Of(c)),this.buf.push(" ",o,'="',sE(c),'"')}return this.buf.push(">"),!0}endElement(e){const t=e.nodeName.toLowerCase();By.hasOwnProperty(t)&&!tE.hasOwnProperty(t)&&(this.buf.push("</"),this.buf.push(t),this.buf.push(">"))}chars(e){this.buf.push(sE(e))}checkClobberedElement(e,t){if(t&&(e.compareDocumentPosition(t)&Node.DOCUMENT_POSITION_CONTAINED_BY)===Node.DOCUMENT_POSITION_CONTAINED_BY)throw new Error(`Failed to sanitize html because the element is clobbered: ${e.outerHTML}`);return t}}const QV=/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,eB=/([^\#-~ |!])/g;function sE(n){return n.replace(/&/g,"&amp;").replace(QV,function(e){return"&#"+(1024*(e.charCodeAt(0)-55296)+(e.charCodeAt(1)-56320)+65536)+";"}).replace(eB,function(e){return"&#"+e.charCodeAt(0)+";"}).replace(/</g,"&lt;").replace(/>/g,"&gt;")}let kf;function oE(n,e){let t=null;try{kf=kf||function eE(n){const e=new XV(n);return function YV(){try{return!!(new window.DOMParser).parseFromString(_a(""),"text/html")}catch{return!1}}()?new qV(e):e}(n);let i=e?String(e):"";t=kf.getInertBodyElement(i);let r=5,s=i;do{if(0===r)throw new Error("Failed to sanitize html because the input is unstable");r--,i=s,s=t.innerHTML,t=kf.getInertBodyElement(i)}while(i!==s);return _a((new JV).sanitizeChildren(zy(t)||t))}finally{if(t){const i=zy(t)||t;for(;i.firstChild;)i.removeChild(i.firstChild)}}}function zy(n){return"content"in n&&function tB(n){return n.nodeType===Node.ELEMENT_NODE&&"TEMPLATE"===n.nodeName}(n)?n.content:null}var Lt=(()=>((Lt=Lt||{})[Lt.NONE=0]="NONE",Lt[Lt.HTML=1]="HTML",Lt[Lt.STYLE=2]="STYLE",Lt[Lt.SCRIPT=3]="SCRIPT",Lt[Lt.URL=4]="URL",Lt[Lt.RESOURCE_URL=5]="RESOURCE_URL",Lt))();const Lf=new xe("ENVIRONMENT_INITIALIZER"),uE=new xe("INJECTOR",-1),hE=new xe("INJECTOR_DEF_TYPES");class dE{get(e,t=Lu){if(t===Lu){const i=new Error(`NullInjectorError: No provider for ${Kt(e)}!`);throw i.name="NullInjectorError",i}return t}}function cB(...n){return{\u0275providers:fE(0,n),\u0275fromNgModule:!0}}function fE(n,...e){const t=[],i=new Set;let r;return ma(e,s=>{const o=s;Hy(o,t,[],i)&&(r||(r=[]),r.push(o))}),void 0!==r&&pE(r,t),t}function pE(n,e){for(let t=0;t<n.length;t++){const{providers:r}=n[t];Gy(r,s=>{e.push(s)})}}function Hy(n,e,t,i){if(!(n=Ye(n)))return!1;let r=null,s=bC(n);const o=!s&&Vt(n);if(s||o){if(o&&!o.standalone)return!1;r=n}else{const c=n.ngModule;if(s=bC(c),!s)return!1;r=c}const a=i.has(r);if(o){if(a)return!1;if(i.add(r),o.dependencies){const c="function"==typeof o.dependencies?o.dependencies():o.dependencies;for(const l of c)Hy(l,e,t,i)}}else{if(!s)return!1;{if(null!=s.imports&&!a){let l;i.add(r);try{ma(s.imports,u=>{Hy(u,e,t,i)&&(l||(l=[]),l.push(u))})}finally{}void 0!==l&&pE(l,e)}if(!a){const l=fa(r)||(()=>new r);e.push({provide:r,useFactory:l,deps:kt},{provide:hE,useValue:r,multi:!0},{provide:Lf,useValue:()=>le(r),multi:!0})}const c=s.providers;null==c||a||Gy(c,u=>{e.push(u)})}}return r!==n&&void 0!==n.providers}function Gy(n,e){for(let t of n)N_(t)&&(t=t.\u0275providers),Array.isArray(t)?Gy(t,e):e(t)}const lB=Zt({provide:String,useValue:Zt});function jy(n){return null!==n&&"object"==typeof n&&lB in n}function va(n){return"function"==typeof n}const Wy=new xe("Set Injector scope."),Nf={},hB={};let $y;function Ff(){return void 0===$y&&($y=new dE),$y}class vo{}class _E extends vo{constructor(e,t,i,r){super(),this.parent=t,this.source=i,this.scopes=r,this.records=new Map,this._ngOnDestroyHooks=new Set,this._onDestroyHooks=[],this._destroyed=!1,Xy(e,o=>this.processProvider(o)),this.records.set(uE,Gc(void 0,this)),r.has("environment")&&this.records.set(vo,Gc(void 0,this));const s=this.records.get(Wy);null!=s&&"string"==typeof s.value&&this.scopes.add(s.value),this.injectorDefTypes=new Set(this.get(hE.multi,kt,Ze.Self))}get destroyed(){return this._destroyed}destroy(){this.assertNotDestroyed(),this._destroyed=!0;try{for(const e of this._ngOnDestroyHooks)e.ngOnDestroy();for(const e of this._onDestroyHooks)e()}finally{this.records.clear(),this._ngOnDestroyHooks.clear(),this.injectorDefTypes.clear(),this._onDestroyHooks.length=0}}onDestroy(e){this._onDestroyHooks.push(e)}runInContext(e){this.assertNotDestroyed();const t=Mc(this),i=mr(void 0);try{return e()}finally{Mc(t),mr(i)}}get(e,t=Lu,i=Ze.Default){this.assertNotDestroyed(),i=cf(i);const r=Mc(this),s=mr(void 0);try{if(!(i&Ze.SkipSelf)){let a=this.records.get(e);if(void 0===a){const c=function gB(n){return"function"==typeof n||"object"==typeof n&&n instanceof xe}(e)&&rf(e);a=c&&this.injectableDefInScope(c)?Gc(qy(e),Nf):null,this.records.set(e,a)}if(null!=a)return this.hydrate(e,a)}return(i&Ze.Self?Ff():this.parent).get(e,t=i&Ze.Optional&&t===Lu?null:t)}catch(o){if("NullInjectorError"===o.name){if((o[af]=o[af]||[]).unshift(Kt(e)),r)throw o;return function k2(n,e,t,i){const r=n[af];throw e[MC]&&r.unshift(e[MC]),n.message=function L2(n,e,t,i=null){n=n&&"\n"===n.charAt(0)&&"\u0275"==n.charAt(1)?n.slice(2):n;let r=Kt(e);if(Array.isArray(e))r=e.map(Kt).join(" -> ");else if("object"==typeof e){let s=[];for(let o in e)if(e.hasOwnProperty(o)){let a=e[o];s.push(o+":"+("string"==typeof a?JSON.stringify(a):Kt(a)))}r=`{${s.join(", ")}}`}return`${t}${i?"("+i+")":""}[${r}]: ${n.replace(I2,"\n  ")}`}("\n"+n.message,r,t,i),n.ngTokenPath=r,n[af]=null,n}(o,e,"R3InjectorError",this.source)}throw o}finally{mr(s),Mc(r)}}resolveInjectorInitializers(){const e=Mc(this),t=mr(void 0);try{const i=this.get(Lf.multi,kt,Ze.Self);for(const r of i)r()}finally{Mc(e),mr(t)}}toString(){const e=[],t=this.records;for(const i of t.keys())e.push(Kt(i));return`R3Injector[${e.join(", ")}]`}assertNotDestroyed(){if(this._destroyed)throw new K(205,!1)}processProvider(e){let t=va(e=Ye(e))?e:Ye(e&&e.provide);const i=function fB(n){return jy(n)?Gc(void 0,n.useValue):Gc(yE(n),Nf)}(e);if(va(e)||!0!==e.multi)this.records.get(t);else{let r=this.records.get(t);r||(r=Gc(void 0,Nf,!0),r.factory=()=>U_(r.multi),this.records.set(t,r)),t=e,r.multi.push(e)}this.records.set(t,i)}hydrate(e,t){return t.value===Nf&&(t.value=hB,t.value=t.factory()),"object"==typeof t.value&&t.value&&function mB(n){return null!==n&&"object"==typeof n&&"function"==typeof n.ngOnDestroy}(t.value)&&this._ngOnDestroyHooks.add(t.value),t.value}injectableDefInScope(e){if(!e.providedIn)return!1;const t=Ye(e.providedIn);return"string"==typeof t?"any"===t||this.scopes.has(t):this.injectorDefTypes.has(t)}}function qy(n){const e=rf(n),t=null!==e?e.factory:fa(n);if(null!==t)return t;if(n instanceof xe)throw new K(204,!1);if(n instanceof Function)return function dB(n){const e=n.length;if(e>0)throw Yu(e,"?"),new K(204,!1);const t=function S2(n){const e=n&&(n[sf]||n[xC]);if(e){const t=function E2(n){if(n.hasOwnProperty("name"))return n.name;const e=(""+n).match(/^function\s*([^\s(]+)/);return null===e?"":e[1]}(n);return console.warn(`DEPRECATED: DI is instantiating a token "${t}" that inherits its @Injectable decorator but does not provide one itself.\nThis will become an error in a future version of Angular. Please add @Injectable() to the "${t}" class.`),e}return null}(n);return null!==t?()=>t.factory(n):()=>new n}(n);throw new K(204,!1)}function yE(n,e,t){let i;if(va(n)){const r=Ye(n);return fa(r)||qy(r)}if(jy(n))i=()=>Ye(n.useValue);else if(function gE(n){return!(!n||!n.useFactory)}(n))i=()=>n.useFactory(...U_(n.deps||[]));else if(function mE(n){return!(!n||!n.useExisting)}(n))i=()=>le(Ye(n.useExisting));else{const r=Ye(n&&(n.useClass||n.provide));if(!function pB(n){return!!n.deps}(n))return fa(r)||qy(r);i=()=>new r(...U_(n.deps))}return i}function Gc(n,e,t=!1){return{factory:n,value:e,multi:t?[]:void 0}}function Xy(n,e){for(const t of n)Array.isArray(t)?Xy(t,e):t&&N_(t)?Xy(t.\u0275providers,e):e(t)}class _B{}class vE{}class vB{resolveComponentFactory(e){throw function yB(n){const e=Error(`No component factory found for ${Kt(n)}. Did you add it to @NgModule.entryComponents?`);return e.ngComponent=n,e}(e)}}let ih=(()=>{class n{}return n.NULL=new vB,n})();function bB(){return jc(ri(),ae())}function jc(n,e){return new oi(qi(n,e))}let oi=(()=>{class n{constructor(t){this.nativeElement=t}}return n.__NG_ELEMENT_ID__=bB,n})();function xB(n){return n instanceof oi?n.nativeElement:n}class rh{}let Vs=(()=>{class n{}return n.__NG_ELEMENT_ID__=()=>function wB(){const n=ae(),t=Xi(ri().index,n);return(Vi(t)?t:n)[11]}(),n})(),MB=(()=>{class n{}return n.\u0275prov=Te({token:n,providedIn:"root",factory:()=>null}),n})();class ba{constructor(e){this.full=e,this.major=e.split(".")[0],this.minor=e.split(".")[1],this.patch=e.split(".").slice(2).join(".")}}const CB=new ba("15.0.0"),Yy={};function Ky(n){return n.ngOriginalError}class Bs{constructor(){this._console=console}handleError(e){const t=this._findOriginalError(e);this._console.error("ERROR",e),t&&this._console.error("ORIGINAL ERROR",t)}_findOriginalError(e){let t=e&&Ky(e);for(;t&&Ky(t);)t=Ky(t);return t||null}}function Us(n){return n instanceof Function?n():n}function wE(n,e,t){let i=n.length;for(;;){const r=n.indexOf(e,t);if(-1===r)return r;if(0===r||n.charCodeAt(r-1)<=32){const s=e.length;if(r+s===i||n.charCodeAt(r+s)<=32)return r}t=r+1}}const ME="ng-template";function LB(n,e,t){let i=0;for(;i<n.length;){let r=n[i++];if(t&&"class"===r){if(r=n[i],-1!==wE(r.toLowerCase(),e,0))return!0}else if(1===r){for(;i<n.length&&"string"==typeof(r=n[i++]);)if(r.toLowerCase()===e)return!0;return!1}}return!1}function CE(n){return 4===n.type&&n.value!==ME}function NB(n,e,t){return e===(4!==n.type||t?n.value:ME)}function FB(n,e,t){let i=4;const r=n.attrs||[],s=function UB(n){for(let e=0;e<n.length;e++)if(ZC(n[e]))return e;return n.length}(r);let o=!1;for(let a=0;a<e.length;a++){const c=e[a];if("number"!=typeof c){if(!o)if(4&i){if(i=2|1&i,""!==c&&!NB(n,c,t)||""===c&&1===e.length){if(Hr(i))return!1;o=!0}}else{const l=8&i?c:e[++a];if(8&i&&null!==n.attrs){if(!LB(n.attrs,l,t)){if(Hr(i))return!1;o=!0}continue}const h=VB(8&i?"class":c,r,CE(n),t);if(-1===h){if(Hr(i))return!1;o=!0;continue}if(""!==l){let d;d=h>s?"":r[h+1].toLowerCase();const f=8&i?d:null;if(f&&-1!==wE(f,l,0)||2&i&&l!==d){if(Hr(i))return!1;o=!0}}}}else{if(!o&&!Hr(i)&&!Hr(c))return!1;if(o&&Hr(c))continue;o=!1,i=c|1&i}}return Hr(i)||o}function Hr(n){return 0==(1&n)}function VB(n,e,t,i){if(null===e)return-1;let r=0;if(i||!t){let s=!1;for(;r<e.length;){const o=e[r];if(o===n)return r;if(3===o||6===o)s=!0;else{if(1===o||2===o){let a=e[++r];for(;"string"==typeof a;)a=e[++r];continue}if(4===o)break;if(0===o){r+=4;continue}}r+=s?1:2}return-1}return function zB(n,e){let t=n.indexOf(4);if(t>-1)for(t++;t<n.length;){const i=n[t];if("number"==typeof i)return-1;if(i===e)return t;t++}return-1}(e,n)}function SE(n,e,t=!1){for(let i=0;i<e.length;i++)if(FB(n,e[i],t))return!0;return!1}function HB(n,e){e:for(let t=0;t<e.length;t++){const i=e[t];if(n.length===i.length){for(let r=0;r<n.length;r++)if(n[r]!==i[r])continue e;return!0}}return!1}function EE(n,e){return n?":not("+e.trim()+")":e}function GB(n){let e=n[0],t=1,i=2,r="",s=!1;for(;t<n.length;){let o=n[t];if("string"==typeof o)if(2&i){const a=n[++t];r+="["+o+(a.length>0?'="'+a+'"':"")+"]"}else 8&i?r+="."+o:4&i&&(r+=" "+o);else""!==r&&!Hr(o)&&(e+=EE(s,r),r=""),i=o,s=s||!Hr(i);t++}return""!==r&&(e+=EE(s,r)),e}const st={};function ge(n){DE(Tt(),ae(),Mi()+n,!1)}function DE(n,e,t,i){if(!i)if(3==(3&e[2])){const s=n.preOrderCheckHooks;null!==s&&yf(e,s,t)}else{const s=n.preOrderHooks;null!==s&&vf(e,s,0,t)}pa(t)}function PE(n,e=null,t=null,i){const r=RE(n,e,t,i);return r.resolveInjectorInitializers(),r}function RE(n,e=null,t=null,i,r=new Set){const s=[t||kt,cB(n)];return i=i||("object"==typeof n?void 0:Kt(n)),new _E(s,e||Ff(),i||null,r)}let Ji=(()=>{class n{static create(t,i){if(Array.isArray(t))return PE({name:""},i,t,"");{const r=t.name??"";return PE({name:r},t.parent,t.providers,r)}}}return n.THROW_IF_NOT_FOUND=Lu,n.NULL=new dE,n.\u0275prov=Te({token:n,providedIn:"any",factory:()=>le(uE)}),n.__NG_ELEMENT_ID__=-1,n})();function j(n,e=Ze.Default){const t=ae();return null===t?le(n,e):rS(ri(),t,Ye(n),e)}function Bf(){throw new Error("invalid")}function Uf(n,e){return n<<17|e<<2}function Gr(n){return n>>17&32767}function nv(n){return 2|n}function zs(n){return(131068&n)>>2}function iv(n,e){return-131069&n|e<<2}function rv(n){return 1|n}function YE(n,e){const t=n.contentQueries;if(null!==t)for(let i=0;i<t.length;i+=2){const r=t[i],s=t[i+1];if(-1!==s){const o=n.data[s];ny(r),o.contentQueries(2,e[s],s)}}}function Gf(n,e,t,i,r,s,o,a,c,l,u){const h=e.blueprint.slice();return h[0]=r,h[2]=76|i,(null!==u||n&&1024&n[2])&&(h[2]|=1024),kC(h),h[3]=h[15]=n,h[8]=t,h[10]=o||n&&n[10],h[11]=a||n&&n[11],h[12]=c||n&&n[12]||null,h[9]=l||n&&n[9]||null,h[6]=s,h[20]=function rV(){return iV++}(),h[21]=u,h[16]=2==e.type?n[16]:h,h}function qc(n,e,t,i,r){let s=n.data[e];if(null===s)s=function dv(n,e,t,i,r){const s=FC(),o=J_(),c=n.data[e]=function SU(n,e,t,i,r,s){return{type:t,index:i,insertBeforeIndex:null,injectorIndex:e?e.injectorIndex:-1,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,componentOffset:-1,propertyBindings:null,flags:0,providerIndexes:0,value:r,attrs:s,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tViews:null,next:null,projectionNext:null,child:null,parent:e,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}(0,o?s:s&&s.parent,t,e,i,r);return null===n.firstChild&&(n.firstChild=c),null!==s&&(o?null==s.child&&null!==c.parent&&(s.child=c):null===s.next&&(s.next=c)),c}(n,e,t,i,r),function l3(){return nt.lFrame.inI18n}()&&(s.flags|=32);else if(64&s.type){s.type=t,s.value=i,s.attrs=r;const o=function Gu(){const n=nt.lFrame,e=n.currentTNode;return n.isParent?e:e.parent}();s.injectorIndex=null===o?-1:o.injectorIndex}return rs(s,!0),s}function sh(n,e,t,i){if(0===t)return-1;const r=e.length;for(let s=0;s<t;s++)e.push(i),n.blueprint.push(i),n.data.push(null);return r}function fv(n,e,t){iy(e);try{const i=n.viewQuery;null!==i&&Mv(1,i,t);const r=n.template;null!==r&&ZE(n,e,r,1,t),n.firstCreatePass&&(n.firstCreatePass=!1),n.staticContentQueries&&YE(n,e),n.staticViewQueries&&Mv(2,n.viewQuery,t);const s=n.components;null!==s&&function wU(n,e){for(let t=0;t<e.length;t++)jU(n,e[t])}(e,s)}catch(i){throw n.firstCreatePass&&(n.incompleteFirstPass=!0,n.firstCreatePass=!1),i}finally{e[2]&=-5,ry()}}function jf(n,e,t,i){const r=e[2];if(128!=(128&r)){iy(e);try{kC(e),function BC(n){return nt.lFrame.bindingIndex=n}(n.bindingStartIndex),null!==t&&ZE(n,e,t,2,i);const o=3==(3&r);if(o){const l=n.preOrderCheckHooks;null!==l&&yf(e,l,null)}else{const l=n.preOrderHooks;null!==l&&vf(e,l,0,null),sy(e,0)}if(function HU(n){for(let e=Ey(n);null!==e;e=Dy(e)){if(!e[2])continue;const t=e[9];for(let i=0;i<t.length;i++){const r=t[i],s=r[3];0==(512&r[2])&&K_(s,1),r[2]|=512}}}(e),function zU(n){for(let e=Ey(n);null!==e;e=Dy(e))for(let t=10;t<e.length;t++){const i=e[t],r=i[1];gf(i)&&jf(r,i,r.template,i[8])}}(e),null!==n.contentQueries&&YE(n,e),o){const l=n.contentCheckHooks;null!==l&&yf(e,l)}else{const l=n.contentHooks;null!==l&&vf(e,l,1),sy(e,1)}!function bU(n,e){const t=n.hostBindingOpCodes;if(null!==t)try{for(let i=0;i<t.length;i++){const r=t[i];if(r<0)pa(~r);else{const s=r,o=t[++i],a=t[++i];u3(o,s),a(2,e[s])}}}finally{pa(-1)}}(n,e);const a=n.components;null!==a&&function xU(n,e){for(let t=0;t<e.length;t++)GU(n,e[t])}(e,a);const c=n.viewQuery;if(null!==c&&Mv(2,c,i),o){const l=n.viewCheckHooks;null!==l&&yf(e,l)}else{const l=n.viewHooks;null!==l&&vf(e,l,2),sy(e,2)}!0===n.firstUpdatePass&&(n.firstUpdatePass=!1),e[2]&=-41,512&e[2]&&(e[2]&=-513,K_(e[3],-1))}finally{ry()}}}function ZE(n,e,t,i,r){const s=Mi(),o=2&i;try{pa(-1),o&&e.length>22&&DE(n,e,22,!1),t(i,r)}finally{pa(s)}}function pv(n,e,t){if(W_(e)){const r=e.directiveEnd;for(let s=e.directiveStart;s<r;s++){const o=n.data[s];o.contentQueries&&o.contentQueries(1,t[s],s)}}}function mv(n,e,t){!NC()||(function PU(n,e,t,i){const r=t.directiveStart,s=t.directiveEnd;n.firstCreatePass||xf(t,e),mi(i,e);const o=t.initialInputs;for(let a=r;a<s;a++){const c=n.data[a],l=Br(c);l&&VU(e,t,c);const u=Rc(e,n,a,t);mi(u,e),null!==o&&BU(0,a-r,u,c,0,o),l&&(Xi(t.index,e)[8]=u)}}(n,e,t,qi(t,e)),64==(64&t.flags)&&r1(n,e,t))}function gv(n,e,t=qi){const i=e.localNames;if(null!==i){let r=e.index+1;for(let s=0;s<i.length;s+=2){const o=i[s+1],a=-1===o?t(e,n):n[o];n[r++]=a}}}function KE(n){const e=n.tView;return null===e||e.incompleteFirstPass?n.tView=_v(1,null,n.template,n.decls,n.vars,n.directiveDefs,n.pipeDefs,n.viewQuery,n.schemas,n.consts):e}function _v(n,e,t,i,r,s,o,a,c,l){const u=22+i,h=u+r,d=function MU(n,e){const t=[];for(let i=0;i<e;i++)t.push(i<n?null:st);return t}(u,h),f="function"==typeof l?l():l;return d[1]={type:n,blueprint:d,template:t,queries:null,viewQuery:a,declTNode:e,data:d.slice().fill(null,u),bindingStartIndex:u,expandoStartIndex:h,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:"function"==typeof s?s():s,pipeRegistry:"function"==typeof o?o():o,firstChild:null,schemas:c,consts:f,incompleteFirstPass:!1}}function JE(n,e,t,i){const r=o1(e);null===t?r.push(i):(r.push(t),n.firstCreatePass&&a1(n).push(i,r.length-1))}function QE(n,e,t,i){for(let r in n)if(n.hasOwnProperty(r)){t=null===t?{}:t;const s=n[r];null===i?e1(t,e,r,s):i.hasOwnProperty(r)&&e1(t,e,i[r],s)}return t}function e1(n,e,t,i){n.hasOwnProperty(t)?n[t].push(e,i):n[t]=[e,i]}function Qi(n,e,t,i,r,s,o,a){const c=qi(e,t);let u,l=e.inputs;!a&&null!=l&&(u=l[i])?(Cv(n,t,u,i,r),ff(e)&&t1(t,e.index)):3&e.type&&(i=function DU(n){return"class"===n?"className":"for"===n?"htmlFor":"formaction"===n?"formAction":"innerHtml"===n?"innerHTML":"readonly"===n?"readOnly":"tabindex"===n?"tabIndex":n}(i),r=null!=o?o(r,e.value||"",i):r,s.setProperty(c,i,r))}function t1(n,e){const t=Xi(e,n);16&t[2]||(t[2]|=32)}function yv(n,e,t,i){let r=!1;if(NC()){const s=null===i?null:{"":-1},o=function OU(n,e){const t=n.directiveRegistry;let i=null,r=null;if(t)for(let s=0;s<t.length;s++){const o=t[s];if(SE(e,o.selectors,!1))if(i||(i=[]),Br(o))if(null!==o.findHostDirectiveDefs){const a=[];r=r||new Map,o.findHostDirectiveDefs(o,a,r),i.unshift(...a,o),vv(n,e,a.length)}else i.unshift(o),vv(n,e,0);else r=r||new Map,o.findHostDirectiveDefs?.(o,i,r),i.push(o)}return null===i?null:[i,r]}(n,t);let a,c;null===o?a=c=null:[a,c]=o,null!==a&&(r=!0,n1(n,e,t,a,s,c)),s&&function kU(n,e,t){if(e){const i=n.localNames=[];for(let r=0;r<e.length;r+=2){const s=t[e[r+1]];if(null==s)throw new K(-301,!1);i.push(e[r],s)}}}(t,i,s)}return t.mergedAttrs=$u(t.mergedAttrs,t.attrs),r}function n1(n,e,t,i,r,s){for(let l=0;l<i.length;l++)hy(xf(t,e),n,i[l].type);!function NU(n,e,t){n.flags|=1,n.directiveStart=e,n.directiveEnd=e+t,n.providerIndexes=e}(t,n.data.length,i.length);for(let l=0;l<i.length;l++){const u=i[l];u.providersResolver&&u.providersResolver(u)}let o=!1,a=!1,c=sh(n,e,i.length,null);for(let l=0;l<i.length;l++){const u=i[l];t.mergedAttrs=$u(t.mergedAttrs,u.hostAttrs),FU(n,t,e,c,u),LU(c,u,r),null!==u.contentQueries&&(t.flags|=4),(null!==u.hostBindings||null!==u.hostAttrs||0!==u.hostVars)&&(t.flags|=64);const h=u.type.prototype;!o&&(h.ngOnChanges||h.ngOnInit||h.ngDoCheck)&&((n.preOrderHooks||(n.preOrderHooks=[])).push(t.index),o=!0),!a&&(h.ngOnChanges||h.ngDoCheck)&&((n.preOrderCheckHooks||(n.preOrderCheckHooks=[])).push(t.index),a=!0),c++}!function EU(n,e,t){const r=e.directiveEnd,s=n.data,o=e.attrs,a=[];let c=null,l=null;for(let u=e.directiveStart;u<r;u++){const h=s[u],d=t?t.get(h):null,p=d?d.outputs:null;c=QE(h.inputs,u,c,d?d.inputs:null),l=QE(h.outputs,u,l,p);const m=null===c||null===o||CE(e)?null:UU(c,u,o);a.push(m)}null!==c&&(c.hasOwnProperty("class")&&(e.flags|=8),c.hasOwnProperty("style")&&(e.flags|=16)),e.initialInputs=a,e.inputs=c,e.outputs=l}(n,t,s)}function r1(n,e,t){const i=t.directiveStart,r=t.directiveEnd,s=t.index,o=function h3(){return nt.lFrame.currentDirectiveIndex}();try{pa(s);for(let a=i;a<r;a++){const c=n.data[a],l=e[a];ey(a),(null!==c.hostBindings||0!==c.hostVars||null!==c.hostAttrs)&&RU(c,l)}}finally{pa(-1),ey(o)}}function RU(n,e){null!==n.hostBindings&&n.hostBindings(1,e)}function vv(n,e,t){e.componentOffset=t,(n.components||(n.components=[])).push(e.index)}function LU(n,e,t){if(t){if(e.exportAs)for(let i=0;i<e.exportAs.length;i++)t[e.exportAs[i]]=n;Br(e)&&(t[""]=n)}}function FU(n,e,t,i,r){n.data[i]=r;const s=r.factory||(r.factory=fa(r.type)),o=new ju(s,Br(r),j);n.blueprint[i]=o,t[i]=o,function AU(n,e,t,i,r){const s=r.hostBindings;if(s){let o=n.hostBindingOpCodes;null===o&&(o=n.hostBindingOpCodes=[]);const a=~e.index;(function IU(n){let e=n.length;for(;e>0;){const t=n[--e];if("number"==typeof t&&t<0)return t}return 0})(o)!=a&&o.push(a),o.push(t,i,s)}}(n,e,i,sh(n,t,r.hostVars,st),r)}function VU(n,e,t){const i=qi(e,n),r=KE(t),s=n[10],o=Wf(n,Gf(n,r,null,t.onPush?32:16,i,e,s,s.createRenderer(i,t),null,null,null));n[e.index]=o}function as(n,e,t,i,r,s){const o=qi(n,e);!function bv(n,e,t,i,r,s,o){if(null==s)n.removeAttribute(e,r,t);else{const a=null==o?rt(s):o(s,i||"",r);n.setAttribute(e,r,a,t)}}(e[11],o,s,n.value,t,i,r)}function BU(n,e,t,i,r,s){const o=s[e];if(null!==o){const a=i.setInput;for(let c=0;c<o.length;){const l=o[c++],u=o[c++],h=o[c++];null!==a?i.setInput(t,h,l,u):t[u]=h}}}function UU(n,e,t){let i=null,r=0;for(;r<t.length;){const s=t[r];if(0!==s)if(5!==s){if("number"==typeof s)break;if(n.hasOwnProperty(s)){null===i&&(i=[]);const o=n[s];for(let a=0;a<o.length;a+=2)if(o[a]===e){i.push(s,o[a+1],t[r+1]);break}}r+=2}else r+=2;else r+=4}return i}function s1(n,e,t,i){return new Array(n,!0,!1,e,null,0,i,t,null,null)}function GU(n,e){const t=Xi(e,n);if(gf(t)){const i=t[1];48&t[2]?jf(i,t,i.template,t[8]):t[5]>0&&xv(t)}}function xv(n){for(let i=Ey(n);null!==i;i=Dy(i))for(let r=10;r<i.length;r++){const s=i[r];if(gf(s))if(512&s[2]){const o=s[1];jf(o,s,o.template,s[8])}else s[5]>0&&xv(s)}const t=n[1].components;if(null!==t)for(let i=0;i<t.length;i++){const r=Xi(t[i],n);gf(r)&&r[5]>0&&xv(r)}}function jU(n,e){const t=Xi(e,n),i=t[1];(function WU(n,e){for(let t=e.length;t<n.blueprint.length;t++)e.push(n.blueprint[t])})(i,t),fv(i,t,t[8])}function Wf(n,e){return n[13]?n[14][4]=e:n[13]=e,n[14]=e,e}function wv(n){for(;n;){n[2]|=32;const e=Qu(n);if(H2(n)&&!e)return n;n=e}return null}function $f(n,e,t,i=!0){const r=e[10];r.begin&&r.begin();try{jf(n,e,n.template,t)}catch(o){throw i&&l1(e,o),o}finally{r.end&&r.end()}}function Mv(n,e,t){ny(0),e(n,t)}function o1(n){return n[7]||(n[7]=[])}function a1(n){return n.cleanup||(n.cleanup=[])}function l1(n,e){const t=n[9],i=t?t.get(Bs,null):null;i&&i.handleError(e)}function Cv(n,e,t,i,r){for(let s=0;s<t.length;){const o=t[s++],a=t[s++],c=e[o],l=n.data[o];null!==l.setInput?l.setInput(c,r,i,a):c[a]=r}}function qf(n,e,t){let i=t?n.styles:null,r=t?n.classes:null,s=0;if(null!==e)for(let o=0;o<e.length;o++){const a=e[o];"number"==typeof a?s=a:1==s?r=k_(r,a):2==s&&(i=k_(i,a+": "+e[++o]+";"))}t?n.styles=i:n.stylesWithoutHost=i,t?n.classes=r:n.classesWithoutHost=r}function Xf(n,e,t,i,r=!1){for(;null!==t;){const s=e[t.index];if(null!==s&&i.push(Rn(s)),Vr(s))for(let a=10;a<s.length;a++){const c=s[a],l=c[1].firstChild;null!==l&&Xf(c[1],c,l,i)}const o=t.type;if(8&o)Xf(n,e,t.child,i);else if(32&o){const a=Sy(t,e);let c;for(;c=a();)i.push(c)}else if(16&o){const a=$S(e,t);if(Array.isArray(a))i.push(...a);else{const c=Qu(e[16]);Xf(c[1],c,a,i,!0)}}t=r?t.projectionNext:t.next}return i}class oh{constructor(e,t){this._lView=e,this._cdRefInjectingView=t,this._appRef=null,this._attachedToViewContainer=!1}get rootNodes(){const e=this._lView,t=e[1];return Xf(t,e,t.firstChild,[])}get context(){return this._lView[8]}set context(e){this._lView[8]=e}get destroyed(){return 128==(128&this._lView[2])}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){const e=this._lView[3];if(Vr(e)){const t=e[8],i=t?t.indexOf(this):-1;i>-1&&(Iy(e,i),Cf(t,i))}this._attachedToViewContainer=!1}FS(this._lView[1],this._lView)}onDestroy(e){JE(this._lView[1],this._lView,null,e)}markForCheck(){wv(this._cdRefInjectingView||this._lView)}detach(){this._lView[2]&=-65}reattach(){this._lView[2]|=64}detectChanges(){$f(this._lView[1],this._lView,this.context)}checkNoChanges(){}attachToViewContainerRef(){if(this._appRef)throw new K(902,!1);this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null,function bV(n,e){eh(n,e,e[11],2,null,null)}(this._lView[1],this._lView)}attachToAppRef(e){if(this._attachedToViewContainer)throw new K(902,!1);this._appRef=e}}class $U extends oh{constructor(e){super(e),this._view=e}detectChanges(){const e=this._view;$f(e[1],e,e[8],!1)}checkNoChanges(){}get context(){return null}}class Sv extends ih{constructor(e){super(),this.ngModule=e}resolveComponentFactory(e){const t=Vt(e);return new ah(t,this.ngModule)}}function u1(n){const e=[];for(let t in n)n.hasOwnProperty(t)&&e.push({propName:n[t],templateName:t});return e}class XU{constructor(e,t){this.injector=e,this.parentInjector=t}get(e,t,i){i=cf(i);const r=this.injector.get(e,Yy,i);return r!==Yy||t===Yy?r:this.parentInjector.get(e,t,i)}}class ah extends vE{constructor(e,t){super(),this.componentDef=e,this.ngModule=t,this.componentType=e.type,this.selector=function jB(n){return n.map(GB).join(",")}(e.selectors),this.ngContentSelectors=e.ngContentSelectors?e.ngContentSelectors:[],this.isBoundToModule=!!t}get inputs(){return u1(this.componentDef.inputs)}get outputs(){return u1(this.componentDef.outputs)}create(e,t,i,r){let s=(r=r||this.ngModule)instanceof vo?r:r?.injector;s&&null!==this.componentDef.getStandaloneInjector&&(s=this.componentDef.getStandaloneInjector(s)||s);const o=s?new XU(e,s):e,a=o.get(rh,null);if(null===a)throw new K(407,!1);const c=o.get(MB,null),l=a.createRenderer(null,this.componentDef),u=this.componentDef.selectors[0][0]||"div",h=i?function CU(n,e,t){return n.selectRootElement(e,t===Nr.ShadowDom)}(l,i,this.componentDef.encapsulation):Ay(l,u,function qU(n){const e=n.toLowerCase();return"svg"===e?"svg":"math"===e?"math":null}(u)),d=this.componentDef.onPush?288:272,f=_v(0,null,null,1,0,null,null,null,null,null),p=Gf(null,f,null,d,null,null,a,l,c,o,null);let m,g;iy(p);try{const _=this.componentDef;let b,y=null;_.findHostDirectiveDefs?(b=[],y=new Map,_.findHostDirectiveDefs(_,b,y),b.push(_)):b=[_];const v=function KU(n,e){const t=n[1];return n[22]=e,qc(t,22,2,"#host",null)}(p,h),w=function JU(n,e,t,i,r,s,o,a){const c=r[1];!function QU(n,e,t,i){for(const r of n)e.mergedAttrs=$u(e.mergedAttrs,r.hostAttrs);null!==e.mergedAttrs&&(qf(e,e.mergedAttrs,!0),null!==t&&YS(i,t,e))}(i,n,e,o);const l=s.createRenderer(e,t),u=Gf(r,KE(t),null,t.onPush?32:16,r[n.index],n,s,l,a||null,null,null);return c.firstCreatePass&&vv(c,n,i.length-1),Wf(r,u),r[n.index]=u}(v,h,_,b,p,a,l);g=Z_(f,22),h&&function tz(n,e,t,i){if(i)ay(n,t,["ng-version",CB.full]);else{const{attrs:r,classes:s}=function WB(n){const e=[],t=[];let i=1,r=2;for(;i<n.length;){let s=n[i];if("string"==typeof s)2===r?""!==s&&e.push(s,n[++i]):8===r&&t.push(s);else{if(!Hr(r))break;r=s}i++}return{attrs:e,classes:t}}(e.selectors[0]);r&&ay(n,t,r),s&&s.length>0&&XS(n,t,s.join(" "))}}(l,_,h,i),void 0!==t&&function nz(n,e,t){const i=n.projection=[];for(let r=0;r<e.length;r++){const s=t[r];i.push(null!=s?Array.from(s):null)}}(g,this.ngContentSelectors,t),m=function ez(n,e,t,i,r,s){const o=ri(),a=r[1],c=qi(o,r);n1(a,r,o,t,null,i);for(let u=0;u<t.length;u++)mi(Rc(r,a,o.directiveStart+u,o),r);r1(a,r,o),c&&mi(c,r);const l=Rc(r,a,o.directiveStart+o.componentOffset,o);if(n[8]=r[8]=l,null!==s)for(const u of s)u(l,e);return pv(a,o,n),l}(w,_,b,y,p,[iz]),fv(f,p,null)}finally{ry()}return new ZU(this.componentType,m,jc(g,p),p,g)}}class ZU extends _B{constructor(e,t,i,r,s){super(),this.location=i,this._rootLView=r,this._tNode=s,this.instance=t,this.hostView=this.changeDetectorRef=new $U(r),this.componentType=e}setInput(e,t){const i=this._tNode.inputs;let r;if(null!==i&&(r=i[e])){const s=this._rootLView;Cv(s[1],s,r,e,t),t1(s,this._tNode.index)}}get injector(){return new Oc(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(e){this.hostView.onDestroy(e)}}function iz(){const n=ri();_f(ae()[1],n)}function Pt(n){let e=function h1(n){return Object.getPrototypeOf(n.prototype).constructor}(n.type),t=!0;const i=[n];for(;e;){let r;if(Br(n))r=e.\u0275cmp||e.\u0275dir;else{if(e.\u0275cmp)throw new K(903,!1);r=e.\u0275dir}if(r){if(t){i.push(r);const o=n;o.inputs=Ev(n.inputs),o.declaredInputs=Ev(n.declaredInputs),o.outputs=Ev(n.outputs);const a=r.hostBindings;a&&az(n,a);const c=r.viewQuery,l=r.contentQueries;if(c&&sz(n,c),l&&oz(n,l),O_(n.inputs,r.inputs),O_(n.declaredInputs,r.declaredInputs),O_(n.outputs,r.outputs),Br(r)&&r.data.animation){const u=n.data;u.animation=(u.animation||[]).concat(r.data.animation)}}const s=r.features;if(s)for(let o=0;o<s.length;o++){const a=s[o];a&&a.ngInherit&&a(n),a===Pt&&(t=!1)}}e=Object.getPrototypeOf(e)}!function rz(n){let e=0,t=null;for(let i=n.length-1;i>=0;i--){const r=n[i];r.hostVars=e+=r.hostVars,r.hostAttrs=$u(r.hostAttrs,t=$u(t,r.hostAttrs))}}(i)}function Ev(n){return n===Os?{}:n===kt?[]:n}function sz(n,e){const t=n.viewQuery;n.viewQuery=t?(i,r)=>{e(i,r),t(i,r)}:e}function oz(n,e){const t=n.contentQueries;n.contentQueries=t?(i,r,s)=>{e(i,r,s),t(i,r,s)}:e}function az(n,e){const t=n.hostBindings;n.hostBindings=t?(i,r)=>{e(i,r),t(i,r)}:e}let Yf=null;function xa(){if(!Yf){const n=en.Symbol;if(n&&n.iterator)Yf=n.iterator;else{const e=Object.getOwnPropertyNames(Map.prototype);for(let t=0;t<e.length;++t){const i=e[t];"entries"!==i&&"size"!==i&&Map.prototype[i]===Map.prototype.entries&&(Yf=i)}}}return Yf}function ch(n){return!!Dv(n)&&(Array.isArray(n)||!(n instanceof Map)&&xa()in n)}function Dv(n){return null!==n&&("function"==typeof n||"object"==typeof n)}function gi(n,e,t){return!Object.is(n[e],t)&&(n[e]=t,!0)}function Zf(n,e,t,i,r){const s=function wa(n,e,t,i){const r=gi(n,e,t);return gi(n,e+1,i)||r}(n,e,t,i);return gi(n,e+2,r)||s}function er(n,e,t,i){const r=ae();return gi(r,Ac(),e)&&(Tt(),as(pn(),r,n,e,t,i)),er}function Si(n,e,t,i,r,s,o,a){const c=ae(),l=Tt(),u=n+22,h=l.firstCreatePass?function _z(n,e,t,i,r,s,o,a,c){const l=e.consts,u=qc(e,n,4,o||null,go(l,a));yv(e,t,u,go(l,c)),_f(e,u);const h=u.tViews=_v(2,u,i,r,s,e.directiveRegistry,e.pipeRegistry,null,e.schemas,l);return null!==e.queries&&(e.queries.template(e,u),h.queries=e.queries.embeddedTView(u)),u}(u,l,c,e,t,i,r,s,o):l.data[u];rs(h,!1);const d=c[11].createComment("");Af(l,c,d,h),mi(d,c),Wf(c,c[u]=s1(d,c,d,h)),pf(h)&&mv(l,c,h),null!=o&&gv(c,h,a)}function Ge(n,e,t){const i=ae();return gi(i,Ac(),e)&&Qi(Tt(),pn(),i,n,e,i[11],t,!1),Ge}function Tv(n,e,t,i,r){const o=r?"class":"style";Cv(n,t,e.inputs[o],o,i)}function W(n,e,t,i){const r=ae(),s=Tt(),o=22+n,a=r[11],c=r[o]=Ay(a,e,function _3(){return nt.lFrame.currentNamespace}()),l=s.firstCreatePass?function vz(n,e,t,i,r,s,o){const a=e.consts,l=qc(e,n,2,r,go(a,s));return yv(e,t,l,go(a,o)),null!==l.attrs&&qf(l,l.attrs,!1),null!==l.mergedAttrs&&qf(l,l.mergedAttrs,!0),null!==e.queries&&e.queries.elementStart(e,l),l}(o,s,r,0,e,t,i):s.data[o];return rs(l,!0),YS(a,c,l),32!=(32&l.flags)&&Af(s,r,c,l),0===function n3(){return nt.lFrame.elementDepthCount}()&&mi(c,r),function r3(){nt.lFrame.elementDepthCount++}(),pf(l)&&(mv(s,r,l),pv(s,l,r)),null!==i&&gv(r,l),W}function Y(){let n=ri();J_()?Q_():(n=n.parent,rs(n,!1));const e=n;!function s3(){nt.lFrame.elementDepthCount--}();const t=Tt();return t.firstCreatePass&&(_f(t,n),W_(n)&&t.queries.elementEnd(n)),null!=e.classesWithoutHost&&function w3(n){return 0!=(8&n.flags)}(e)&&Tv(t,e,ae(),e.classesWithoutHost,!0),null!=e.stylesWithoutHost&&function M3(n){return 0!=(16&n.flags)}(e)&&Tv(t,e,ae(),e.stylesWithoutHost,!1),Y}function it(n,e,t,i){return W(n,e,t,i),Y(),it}function Gs(){return ae()}function uh(n){return!!n&&"function"==typeof n.then}const Pv=function E1(n){return!!n&&"function"==typeof n.subscribe};function Oe(n,e,t,i){const r=ae(),s=Tt(),o=ri();return function T1(n,e,t,i,r,s,o,a){const c=pf(i),u=n.firstCreatePass&&a1(n),h=e[8],d=o1(e);let f=!0;if(3&i.type||a){const g=qi(i,e),_=a?a(g):g,b=d.length,y=a?w=>a(Rn(w[i.index])):i.index;let v=null;if(!a&&c&&(v=function xz(n,e,t,i){const r=n.cleanup;if(null!=r)for(let s=0;s<r.length-1;s+=2){const o=r[s];if(o===t&&r[s+1]===i){const a=e[7],c=r[s+2];return a.length>c?a[c]:null}"string"==typeof o&&(s+=2)}return null}(n,e,r,i.index)),null!==v)(v.__ngLastListenerFn__||v).__ngNextListenerFn__=s,v.__ngLastListenerFn__=s,f=!1;else{s=I1(i,e,h,s,!1);const w=t.listen(_,r,s);d.push(s,w),u&&u.push(r,y,b,b+1)}}else s=I1(i,e,h,s,!1);const p=i.outputs;let m;if(f&&null!==p&&(m=p[r])){const g=m.length;if(g)for(let _=0;_<g;_+=2){const M=e[m[_]][m[_+1]].subscribe(s),I=d.length;d.push(s,M),u&&u.push(r,i.index,I,-(I+1))}}}(s,r,r[11],o,n,e,0,i),Oe}function A1(n,e,t,i){try{return!1!==t(i)}catch(r){return l1(n,r),!1}}function I1(n,e,t,i,r){return function s(o){if(o===Function)return i;wv(n.componentOffset>-1?Xi(n.index,e):e);let c=A1(e,0,i,o),l=s.__ngNextListenerFn__;for(;l;)c=A1(e,0,l,o)&&c,l=l.__ngNextListenerFn__;return r&&!1===c&&(o.preventDefault(),o.returnValue=!1),c}}function Sn(n=1){return function f3(n){return(nt.lFrame.contextLView=function p3(n,e){for(;n>0;)e=e[15],n--;return e}(n,nt.lFrame.contextLView))[8]}(n)}function wz(n,e){let t=null;const i=function BB(n){const e=n.attrs;if(null!=e){const t=e.indexOf(5);if(0==(1&t))return e[t+1]}return null}(n);for(let r=0;r<e.length;r++){const s=e[r];if("*"!==s){if(null===i?SE(n,s,!0):HB(i,s))return r}else t=r}return t}function Rv(n){const e=ae()[16][6];if(!e.projection){const i=e.projection=Yu(n?n.length:1,null),r=i.slice();let s=e.child;for(;null!==s;){const o=n?wz(s,n):0;null!==o&&(r[o]?r[o].projectionNext=s:i[o]=s,r[o]=s),s=s.next}}}function Ov(n,e=0,t){const i=ae(),r=Tt(),s=qc(r,22+n,16,null,t||null);null===s.projection&&(s.projection=e),Q_(),32!=(32&s.flags)&&function TV(n,e,t){qS(e[11],0,e,t,VS(n,t,e),HS(t.parent||e[6],t,e))}(r,i,s)}function U1(n,e,t,i,r){const s=n[t+1],o=null===e;let a=i?Gr(s):zs(s),c=!1;for(;0!==a&&(!1===c||o);){const u=n[a+1];Sz(n[a],e)&&(c=!0,n[a+1]=i?rv(u):nv(u)),a=i?Gr(u):zs(u)}c&&(n[t+1]=i?nv(s):rv(s))}function Sz(n,e){return null===n||null==e||(Array.isArray(n)?n[1]:n)===e||!(!Array.isArray(n)||"string"!=typeof e)&&Bc(n,e)>=0}function ls(n,e,t){return jr(n,e,t,!1),ls}function yn(n,e){return jr(n,e,null,!0),yn}function jr(n,e,t,i){const r=ae(),s=Tt(),o=function Ns(n){const e=nt.lFrame,t=e.bindingIndex;return e.bindingIndex=e.bindingIndex+n,t}(2);s.firstUpdatePass&&function X1(n,e,t,i){const r=n.data;if(null===r[t+1]){const s=r[Mi()],o=function q1(n,e){return e>=n.expandoStartIndex}(n,t);(function J1(n,e){return 0!=(n.flags&(e?8:16))})(s,i)&&null===e&&!o&&(e=!1),e=function kz(n,e,t,i){const r=function ty(n){const e=nt.lFrame.currentDirectiveIndex;return-1===e?null:n[e]}(n);let s=i?e.residualClasses:e.residualStyles;if(null===r)0===(i?e.classBindings:e.styleBindings)&&(t=hh(t=Lv(null,n,e,t,i),e.attrs,i),s=null);else{const o=e.directiveStylingLast;if(-1===o||n[o]!==r)if(t=Lv(r,n,e,t,i),null===s){let c=function Lz(n,e,t){const i=t?e.classBindings:e.styleBindings;if(0!==zs(i))return n[Gr(i)]}(n,e,i);void 0!==c&&Array.isArray(c)&&(c=Lv(null,n,e,c[1],i),c=hh(c,e.attrs,i),function Nz(n,e,t,i){n[Gr(t?e.classBindings:e.styleBindings)]=i}(n,e,i,c))}else s=function Fz(n,e,t){let i;const r=e.directiveEnd;for(let s=1+e.directiveStylingLast;s<r;s++)i=hh(i,n[s].hostAttrs,t);return hh(i,e.attrs,t)}(n,e,i)}return void 0!==s&&(i?e.residualClasses=s:e.residualStyles=s),t}(r,s,e,i),function Mz(n,e,t,i,r,s){let o=s?e.classBindings:e.styleBindings,a=Gr(o),c=zs(o);n[i]=t;let u,l=!1;if(Array.isArray(t)){const h=t;u=h[1],(null===u||Bc(h,u)>0)&&(l=!0)}else u=t;if(r)if(0!==c){const d=Gr(n[a+1]);n[i+1]=Uf(d,a),0!==d&&(n[d+1]=iv(n[d+1],i)),n[a+1]=function uU(n,e){return 131071&n|e<<17}(n[a+1],i)}else n[i+1]=Uf(a,0),0!==a&&(n[a+1]=iv(n[a+1],i)),a=i;else n[i+1]=Uf(c,0),0===a?a=i:n[c+1]=iv(n[c+1],i),c=i;l&&(n[i+1]=nv(n[i+1])),U1(n,u,i,!0),U1(n,u,i,!1),function Cz(n,e,t,i,r){const s=r?n.residualClasses:n.residualStyles;null!=s&&"string"==typeof e&&Bc(s,e)>=0&&(t[i+1]=rv(t[i+1]))}(e,u,n,i,s),o=Uf(a,c),s?e.classBindings=o:e.styleBindings=o}(r,s,e,t,o,i)}}(s,n,o,i),e!==st&&gi(r,o,e)&&function Z1(n,e,t,i,r,s,o,a){if(!(3&e.type))return;const c=n.data,l=c[a+1];Kf(function zE(n){return 1==(1&n)}(l)?K1(c,e,t,r,zs(l),o):void 0)||(Kf(s)||function UE(n){return 2==(2&n)}(l)&&(s=K1(c,null,t,r,a,o)),function IV(n,e,t,i,r){if(e)r?n.addClass(t,i):n.removeClass(t,i);else{let s=-1===i.indexOf("-")?void 0:Bi.DashCase;null==r?n.removeStyle(t,i,s):("string"==typeof r&&r.endsWith("!important")&&(r=r.slice(0,-10),s|=Bi.Important),n.setStyle(t,i,r,s))}}(i,o,mf(Mi(),t),r,s))}(s,s.data[Mi()],r,r[11],n,r[o+1]=function Uz(n,e){return null==n||("string"==typeof e?n+=e:"object"==typeof n&&(n=Kt(Ki(n)))),n}(e,t),i,o)}function Lv(n,e,t,i,r){let s=null;const o=t.directiveEnd;let a=t.directiveStylingLast;for(-1===a?a=t.directiveStart:a++;a<o&&(s=e[a],i=hh(i,s.hostAttrs,r),s!==n);)a++;return null!==n&&(t.directiveStylingLast=a),i}function hh(n,e,t){const i=t?1:2;let r=-1;if(null!==e)for(let s=0;s<e.length;s++){const o=e[s];"number"==typeof o?r=o:r===i&&(Array.isArray(n)||(n=void 0===n?[]:["",n]),Zi(n,o,!!t||e[++s]))}return void 0===n?null:n}function K1(n,e,t,i,r,s){const o=null===e;let a;for(;r>0;){const c=n[r],l=Array.isArray(c),u=l?c[1]:c,h=null===u;let d=t[r+1];d===st&&(d=h?kt:void 0);let f=h?my(d,i):u===i?d:void 0;if(l&&!Kf(f)&&(f=my(c,i)),Kf(f)&&(a=f,o))return a;const p=n[r+1];r=o?Gr(p):zs(p)}if(null!==e){let c=s?e.residualClasses:e.residualStyles;null!=c&&(a=my(c,i))}return a}function Kf(n){return void 0!==n}function Ce(n,e=""){const t=ae(),i=Tt(),r=n+22,s=i.firstCreatePass?qc(i,r,1,e,null):i.data[r],o=t[r]=function Ty(n,e){return n.createText(e)}(t[11],e);Af(i,t,o,s),rs(s,!1)}function br(n){return dh("",n,""),br}function dh(n,e,t){const i=ae(),r=function Yc(n,e,t,i){return gi(n,Ac(),t)?e+rt(t)+i:st}(i,n,e,t);return r!==st&&function Hs(n,e,t){const i=mf(e,n);!function LS(n,e,t){n.setValue(e,t)}(n[11],i,t)}(i,Mi(),r),dh}function Nv(n,e,t){const i=ae();return gi(i,Ac(),e)&&Qi(Tt(),pn(),i,n,e,i[11],t,!0),Nv}const sl="en-US";let vD=sl;function Bv(n,e,t,i,r){if(n=Ye(n),Array.isArray(n))for(let s=0;s<n.length;s++)Bv(n[s],e,t,i,r);else{const s=Tt(),o=ae();let a=va(n)?n:Ye(n.provide),c=yE(n);const l=ri(),u=1048575&l.providerIndexes,h=l.directiveStart,d=l.providerIndexes>>20;if(va(n)||!n.multi){const f=new ju(c,r,j),p=zv(a,e,r?u:u+d,h);-1===p?(hy(xf(l,o),s,a),Uv(s,n,e.length),e.push(a),l.directiveStart++,l.directiveEnd++,r&&(l.providerIndexes+=1048576),t.push(f),o.push(f)):(t[p]=f,o[p]=f)}else{const f=zv(a,e,u+d,h),p=zv(a,e,u,u+d),m=f>=0&&t[f],g=p>=0&&t[p];if(r&&!g||!r&&!m){hy(xf(l,o),s,a);const _=function r4(n,e,t,i,r){const s=new ju(n,t,j);return s.multi=[],s.index=e,s.componentProviders=0,jD(s,r,i&&!t),s}(r?i4:n4,t.length,r,i,c);!r&&g&&(t[p].providerFactory=_),Uv(s,n,e.length,0),e.push(a),l.directiveStart++,l.directiveEnd++,r&&(l.providerIndexes+=1048576),t.push(_),o.push(_)}else Uv(s,n,f>-1?f:p,jD(t[r?p:f],c,!r&&i));!r&&i&&g&&t[p].componentProviders++}}}function Uv(n,e,t,i){const r=va(e),s=function uB(n){return!!n.useClass}(e);if(r||s){const c=(s?Ye(e.useClass):e).prototype.ngOnDestroy;if(c){const l=n.destroyHooks||(n.destroyHooks=[]);if(!r&&e.multi){const u=l.indexOf(t);-1===u?l.push(t,[i,c]):l[u+1].push(i,c)}else l.push(t,c)}}}function jD(n,e,t){return t&&n.componentProviders++,n.multi.push(e)-1}function zv(n,e,t,i){for(let r=t;r<i;r++)if(e[r]===n)return r;return-1}function n4(n,e,t,i){return Hv(this.multi,[])}function i4(n,e,t,i){const r=this.multi;let s;if(this.providerFactory){const o=this.providerFactory.componentProviders,a=Rc(t,t[1],this.providerFactory.index,i);s=a.slice(0,o),Hv(r,s);for(let c=o;c<a.length;c++)s.push(a[c])}else s=[],Hv(r,s);return s}function Hv(n,e){for(let t=0;t<n.length;t++)e.push((0,n[t])());return e}function nn(n,e=[]){return t=>{t.providersResolver=(i,r)=>function t4(n,e,t){const i=Tt();if(i.firstCreatePass){const r=Br(n);Bv(t,i.data,i.blueprint,r,!0),Bv(e,i.data,i.blueprint,r,!1)}}(i,r?r(n):n,e)}}class Ca{}class WD{}class $D extends Ca{constructor(e,t){super(),this._parent=t,this._bootstrapComponents=[],this.destroyCbs=[],this.componentFactoryResolver=new Sv(this);const i=Wi(e);this._bootstrapComponents=Us(i.bootstrap),this._r3Injector=RE(e,t,[{provide:Ca,useValue:this},{provide:ih,useValue:this.componentFactoryResolver}],Kt(e),new Set(["environment"])),this._r3Injector.resolveInjectorInitializers(),this.instance=this._r3Injector.get(e)}get injector(){return this._r3Injector}destroy(){const e=this._r3Injector;!e.destroyed&&e.destroy(),this.destroyCbs.forEach(t=>t()),this.destroyCbs=null}onDestroy(e){this.destroyCbs.push(e)}}class Gv extends WD{constructor(e){super(),this.moduleType=e}create(e){return new $D(this.moduleType,e)}}class o4 extends Ca{constructor(e,t,i){super(),this.componentFactoryResolver=new Sv(this),this.instance=null;const r=new _E([...e,{provide:Ca,useValue:this},{provide:ih,useValue:this.componentFactoryResolver}],t||Ff(),i,new Set(["environment"]));this.injector=r,r.resolveInjectorInitializers()}destroy(){this.injector.destroy()}onDestroy(e){this.injector.onDestroy(e)}}function np(n,e,t=null){return new o4(n,e,t).injector}let a4=(()=>{class n{constructor(t){this._injector=t,this.cachedInjectors=new Map}getOrCreateStandaloneInjector(t){if(!t.standalone)return null;if(!this.cachedInjectors.has(t.id)){const i=fE(0,t.type),r=i.length>0?np([i],this._injector,`Standalone[${t.type.name}]`):null;this.cachedInjectors.set(t.id,r)}return this.cachedInjectors.get(t.id)}ngOnDestroy(){try{for(const t of this.cachedInjectors.values())null!==t&&t.destroy()}finally{this.cachedInjectors.clear()}}}return n.\u0275prov=Te({token:n,providedIn:"environment",factory:()=>new n(le(vo))}),n})();function qD(n){n.getStandaloneInjector=e=>e.get(a4).getOrCreateStandaloneInjector(n)}function eT(n,e,t,i,r,s){return function iT(n,e,t,i,r,s,o,a){const c=e+t;return Zf(n,c,r,s,o)?function cs(n,e,t){return n[e]=t}(n,c+3,a?i.call(a,r,s,o):i(r,s,o)):function yh(n,e){const t=n[e];return t===st?void 0:t}(n,c+3)}(ae(),function wi(){const n=nt.lFrame;let e=n.bindingRootIndex;return-1===e&&(e=n.bindingRootIndex=n.tView.bindingStartIndex),e}(),n,e,t,i,r,s)}function Wv(n){return e=>{setTimeout(n,void 0,e)}}const sn=class R4 extends ui{constructor(e=!1){super(),this.__isAsync=e}emit(e){super.next(e)}subscribe(e,t,i){let r=e,s=t||(()=>null),o=i;if(e&&"object"==typeof e){const c=e;r=c.next?.bind(c),s=c.error?.bind(c),o=c.complete?.bind(c)}this.__isAsync&&(s=Wv(s),r&&(r=Wv(r)),o&&(o=Wv(o)));const a=super.subscribe({next:r,error:s,complete:o});return e instanceof Ni&&e.add(a),a}};function O4(){return this._results[xa()]()}class $v{constructor(e=!1){this._emitDistinctChangesOnly=e,this.dirty=!0,this._results=[],this._changesDetected=!1,this._changes=null,this.length=0,this.first=void 0,this.last=void 0;const t=xa(),i=$v.prototype;i[t]||(i[t]=O4)}get changes(){return this._changes||(this._changes=new sn)}get(e){return this._results[e]}map(e){return this._results.map(e)}filter(e){return this._results.filter(e)}find(e){return this._results.find(e)}reduce(e,t){return this._results.reduce(e,t)}forEach(e){this._results.forEach(e)}some(e){return this._results.some(e)}toArray(){return this._results.slice()}toString(){return this._results.toString()}reset(e,t){const i=this;i.dirty=!1;const r=Yi(e);(this._changesDetected=!function O3(n,e,t){if(n.length!==e.length)return!1;for(let i=0;i<n.length;i++){let r=n[i],s=e[i];if(t&&(r=t(r),s=t(s)),s!==r)return!1}return!0}(i._results,r,t))&&(i._results=r,i.length=r.length,i.last=r[this.length-1],i.first=r[0])}notifyOnChanges(){this._changes&&(this._changesDetected||!this._emitDistinctChangesOnly)&&this._changes.emit(this)}setDirty(){this.dirty=!0}destroy(){this.changes.complete(),this.changes.unsubscribe()}}let js=(()=>{class n{}return n.__NG_ELEMENT_ID__=N4,n})();const k4=js,L4=class extends k4{constructor(e,t,i){super(),this._declarationLView=e,this._declarationTContainer=t,this.elementRef=i}createEmbeddedView(e,t){const i=this._declarationTContainer.tViews,r=Gf(this._declarationLView,i,e,16,null,i.declTNode,null,null,null,null,t||null);r[17]=this._declarationLView[this._declarationTContainer.index];const o=this._declarationLView[19];return null!==o&&(r[19]=o.createEmbeddedView(i)),fv(i,r,e),new oh(r)}};function N4(){return ip(ri(),ae())}function ip(n,e){return 4&n.type?new L4(e,n,jc(n,e)):null}let $r=(()=>{class n{}return n.__NG_ELEMENT_ID__=F4,n})();function F4(){return cT(ri(),ae())}const V4=$r,oT=class extends V4{constructor(e,t,i){super(),this._lContainer=e,this._hostTNode=t,this._hostLView=i}get element(){return jc(this._hostTNode,this._hostLView)}get injector(){return new Oc(this._hostTNode,this._hostLView)}get parentInjector(){const e=wf(this._hostTNode,this._hostLView);if(QC(e)){const t=Pc(e,this._hostLView),i=Ic(e);return new Oc(t[1].data[i+8],t)}return new Oc(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(e){const t=aT(this._lContainer);return null!==t&&t[e]||null}get length(){return this._lContainer.length-10}createEmbeddedView(e,t,i){let r,s;"number"==typeof i?r=i:null!=i&&(r=i.index,s=i.injector);const o=e.createEmbeddedView(t||{},s);return this.insert(o,r),o}createComponent(e,t,i,r,s){const o=e&&!function Xu(n){return"function"==typeof n}(e);let a;if(o)a=t;else{const h=t||{};a=h.index,i=h.injector,r=h.projectableNodes,s=h.environmentInjector||h.ngModuleRef}const c=o?e:new ah(Vt(e)),l=i||this.parentInjector;if(!s&&null==c.ngModule){const d=(o?l:this.parentInjector).get(vo,null);d&&(s=d)}const u=c.create(l,r,void 0,s);return this.insert(u.hostView,a),u}insert(e,t){const i=e._lView,r=i[1];if(function t3(n){return Vr(n[3])}(i)){const u=this.indexOf(e);if(-1!==u)this.detach(u);else{const h=i[3],d=new oT(h,h[6],h[3]);d.detach(d.indexOf(e))}}const s=this._adjustIndex(t),o=this._lContainer;!function wV(n,e,t,i){const r=10+i,s=t.length;i>0&&(t[r-1][4]=e),i<s-10?(e[4]=t[r],uS(t,10+i,e)):(t.push(e),e[4]=null),e[3]=t;const o=e[17];null!==o&&t!==o&&function MV(n,e){const t=n[9];e[16]!==e[3][3][16]&&(n[2]=!0),null===t?n[9]=[e]:t.push(e)}(o,e);const a=e[19];null!==a&&a.insertView(n),e[2]|=64}(r,i,o,s);const a=Oy(s,o),c=i[11],l=Tf(c,o[7]);return null!==l&&function vV(n,e,t,i,r,s){i[0]=r,i[6]=e,eh(n,i,t,1,r,s)}(r,o[6],c,i,l,a),e.attachToViewContainerRef(),uS(qv(o),s,e),e}move(e,t){return this.insert(e,t)}indexOf(e){const t=aT(this._lContainer);return null!==t?t.indexOf(e):-1}remove(e){const t=this._adjustIndex(e,-1),i=Iy(this._lContainer,t);i&&(Cf(qv(this._lContainer),t),FS(i[1],i))}detach(e){const t=this._adjustIndex(e,-1),i=Iy(this._lContainer,t);return i&&null!=Cf(qv(this._lContainer),t)?new oh(i):null}_adjustIndex(e,t=0){return e??this.length+t}};function aT(n){return n[8]}function qv(n){return n[8]||(n[8]=[])}function cT(n,e){let t;const i=e[n.index];if(Vr(i))t=i;else{let r;if(8&n.type)r=Rn(i);else{const s=e[11];r=s.createComment("");const o=qi(n,e);ga(s,Tf(s,o),r,function DV(n,e){return n.nextSibling(e)}(s,o),!1)}e[n.index]=t=s1(i,e,r,n),Wf(e,t)}return new oT(t,n,e)}class Xv{constructor(e){this.queryList=e,this.matches=null}clone(){return new Xv(this.queryList)}setDirty(){this.queryList.setDirty()}}class Yv{constructor(e=[]){this.queries=e}createEmbeddedView(e){const t=e.queries;if(null!==t){const i=null!==e.contentQueries?e.contentQueries[0]:t.length,r=[];for(let s=0;s<i;s++){const o=t.getByIndex(s);r.push(this.queries[o.indexInDeclarationView].clone())}return new Yv(r)}return null}insertView(e){this.dirtyQueriesWithMatches(e)}detachView(e){this.dirtyQueriesWithMatches(e)}dirtyQueriesWithMatches(e){for(let t=0;t<this.queries.length;t++)null!==pT(e,t).matches&&this.queries[t].setDirty()}}class lT{constructor(e,t,i=null){this.predicate=e,this.flags=t,this.read=i}}class Zv{constructor(e=[]){this.queries=e}elementStart(e,t){for(let i=0;i<this.queries.length;i++)this.queries[i].elementStart(e,t)}elementEnd(e){for(let t=0;t<this.queries.length;t++)this.queries[t].elementEnd(e)}embeddedTView(e){let t=null;for(let i=0;i<this.length;i++){const r=null!==t?t.length:0,s=this.getByIndex(i).embeddedTView(e,r);s&&(s.indexInDeclarationView=i,null!==t?t.push(s):t=[s])}return null!==t?new Zv(t):null}template(e,t){for(let i=0;i<this.queries.length;i++)this.queries[i].template(e,t)}getByIndex(e){return this.queries[e]}get length(){return this.queries.length}track(e){this.queries.push(e)}}class Kv{constructor(e,t=-1){this.metadata=e,this.matches=null,this.indexInDeclarationView=-1,this.crossesNgTemplate=!1,this._appliesToNextNode=!0,this._declarationNodeIndex=t}elementStart(e,t){this.isApplyingToNode(t)&&this.matchTNode(e,t)}elementEnd(e){this._declarationNodeIndex===e.index&&(this._appliesToNextNode=!1)}template(e,t){this.elementStart(e,t)}embeddedTView(e,t){return this.isApplyingToNode(e)?(this.crossesNgTemplate=!0,this.addMatch(-e.index,t),new Kv(this.metadata)):null}isApplyingToNode(e){if(this._appliesToNextNode&&1!=(1&this.metadata.flags)){const t=this._declarationNodeIndex;let i=e.parent;for(;null!==i&&8&i.type&&i.index!==t;)i=i.parent;return t===(null!==i?i.index:-1)}return this._appliesToNextNode}matchTNode(e,t){const i=this.metadata.predicate;if(Array.isArray(i))for(let r=0;r<i.length;r++){const s=i[r];this.matchTNodeWithReadOption(e,t,z4(t,s)),this.matchTNodeWithReadOption(e,t,Mf(t,e,s,!1,!1))}else i===js?4&t.type&&this.matchTNodeWithReadOption(e,t,-1):this.matchTNodeWithReadOption(e,t,Mf(t,e,i,!1,!1))}matchTNodeWithReadOption(e,t,i){if(null!==i){const r=this.metadata.read;if(null!==r)if(r===oi||r===$r||r===js&&4&t.type)this.addMatch(t.index,-2);else{const s=Mf(t,e,r,!1,!1);null!==s&&this.addMatch(t.index,s)}else this.addMatch(t.index,i)}}addMatch(e,t){null===this.matches?this.matches=[e,t]:this.matches.push(e,t)}}function z4(n,e){const t=n.localNames;if(null!==t)for(let i=0;i<t.length;i+=2)if(t[i]===e)return t[i+1];return null}function G4(n,e,t,i){return-1===t?function H4(n,e){return 11&n.type?jc(n,e):4&n.type?ip(n,e):null}(e,n):-2===t?function j4(n,e,t){return t===oi?jc(e,n):t===js?ip(e,n):t===$r?cT(e,n):void 0}(n,e,i):Rc(n,n[1],t,e)}function uT(n,e,t,i){const r=e[19].queries[i];if(null===r.matches){const s=n.data,o=t.matches,a=[];for(let c=0;c<o.length;c+=2){const l=o[c];a.push(l<0?null:G4(e,s[l],o[c+1],t.metadata.read))}r.matches=a}return r.matches}function Jv(n,e,t,i){const r=n.queries.getByIndex(t),s=r.matches;if(null!==s){const o=uT(n,e,r,t);for(let a=0;a<s.length;a+=2){const c=s[a];if(c>0)i.push(o[a/2]);else{const l=s[a+1],u=e[-c];for(let h=10;h<u.length;h++){const d=u[h];d[17]===d[3]&&Jv(d[1],d,l,i)}if(null!==u[9]){const h=u[9];for(let d=0;d<h.length;d++){const f=h[d];Jv(f[1],f,l,i)}}}}}return i}function tr(n){const e=ae(),t=Tt(),i=zC();ny(i+1);const r=pT(t,i);if(n.dirty&&function e3(n){return 4==(4&n[2])}(e)===(2==(2&r.metadata.flags))){if(null===r.matches)n.reset([]);else{const s=r.crossesNgTemplate?Jv(t,e,i,[]):uT(t,e,r,i);n.reset(s,xB),n.notifyOnChanges()}return!0}return!1}function xr(n,e,t){const i=Tt();i.firstCreatePass&&(function fT(n,e,t){null===n.queries&&(n.queries=new Zv),n.queries.track(new Kv(e,t))}(i,new lT(n,e,t),-1),2==(2&e)&&(i.staticViewQueries=!0)),function dT(n,e,t){const i=new $v(4==(4&t));JE(n,e,i,i.destroy),null===e[19]&&(e[19]=new Yv),e[19].queries.push(new Xv(i))}(i,ae(),e)}function nr(){return function W4(n,e){return n[19].queries[e].queryList}(ae(),zC())}function pT(n,e){return n.queries.getByIndex(e)}function sp(...n){}const op=new xe("Application Initializer");let ap=(()=>{class n{constructor(t){this.appInits=t,this.resolve=sp,this.reject=sp,this.initialized=!1,this.done=!1,this.donePromise=new Promise((i,r)=>{this.resolve=i,this.reject=r})}runInitializers(){if(this.initialized)return;const t=[],i=()=>{this.done=!0,this.resolve()};if(this.appInits)for(let r=0;r<this.appInits.length;r++){const s=this.appInits[r]();if(uh(s))t.push(s);else if(Pv(s)){const o=new Promise((a,c)=>{s.subscribe({complete:a,error:c})});t.push(o)}}Promise.all(t).then(()=>{i()}).catch(r=>{this.reject(r)}),0===t.length&&i(),this.initialized=!0}}return n.\u0275fac=function(t){return new(t||n)(le(op,8))},n.\u0275prov=Te({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();const xh=new xe("AppId",{providedIn:"root",factory:function OT(){return`${r0()}${r0()}${r0()}`}});function r0(){return String.fromCharCode(97+Math.floor(25*Math.random()))}const kT=new xe("Platform Initializer"),s0=new xe("Platform ID",{providedIn:"platform",factory:()=>"unknown"}),LT=new xe("appBootstrapListener"),cp=new xe("AnimationModuleType");let f5=(()=>{class n{log(t){console.log(t)}warn(t){console.warn(t)}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=Te({token:n,factory:n.\u0275fac,providedIn:"platform"}),n})();const ds=new xe("LocaleId",{providedIn:"root",factory:()=>Ot(ds,Ze.Optional|Ze.SkipSelf)||function p5(){return typeof $localize<"u"&&$localize.locale||sl}()});class g5{constructor(e,t){this.ngModuleFactory=e,this.componentFactories=t}}let o0=(()=>{class n{compileModuleSync(t){return new Gv(t)}compileModuleAsync(t){return Promise.resolve(this.compileModuleSync(t))}compileModuleAndAllComponentsSync(t){const i=this.compileModuleSync(t),s=Us(Wi(t).declarations).reduce((o,a)=>{const c=Vt(a);return c&&o.push(new ah(c)),o},[]);return new g5(i,s)}compileModuleAndAllComponentsAsync(t){return Promise.resolve(this.compileModuleAndAllComponentsSync(t))}clearCache(){}clearCacheFor(t){}getModuleId(t){}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=Te({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();const v5=(()=>Promise.resolve(0))();function a0(n){typeof Zone>"u"?v5.then(()=>{n&&n.apply(null,null)}):Zone.current.scheduleMicroTask("scheduleMicrotask",n)}class on{constructor({enableLongStackTrace:e=!1,shouldCoalesceEventChangeDetection:t=!1,shouldCoalesceRunChangeDetection:i=!1}){if(this.hasPendingMacrotasks=!1,this.hasPendingMicrotasks=!1,this.isStable=!0,this.onUnstable=new sn(!1),this.onMicrotaskEmpty=new sn(!1),this.onStable=new sn(!1),this.onError=new sn(!1),typeof Zone>"u")throw new K(908,!1);Zone.assertZonePatched();const r=this;r._nesting=0,r._outer=r._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(r._inner=r._inner.fork(new Zone.TaskTrackingZoneSpec)),e&&Zone.longStackTraceZoneSpec&&(r._inner=r._inner.fork(Zone.longStackTraceZoneSpec)),r.shouldCoalesceEventChangeDetection=!i&&t,r.shouldCoalesceRunChangeDetection=i,r.lastRequestAnimationFrameId=-1,r.nativeRequestAnimationFrame=function b5(){let n=en.requestAnimationFrame,e=en.cancelAnimationFrame;if(typeof Zone<"u"&&n&&e){const t=n[Zone.__symbol__("OriginalDelegate")];t&&(n=t);const i=e[Zone.__symbol__("OriginalDelegate")];i&&(e=i)}return{nativeRequestAnimationFrame:n,nativeCancelAnimationFrame:e}}().nativeRequestAnimationFrame,function M5(n){const e=()=>{!function w5(n){n.isCheckStableRunning||-1!==n.lastRequestAnimationFrameId||(n.lastRequestAnimationFrameId=n.nativeRequestAnimationFrame.call(en,()=>{n.fakeTopEventTask||(n.fakeTopEventTask=Zone.root.scheduleEventTask("fakeTopEventTask",()=>{n.lastRequestAnimationFrameId=-1,l0(n),n.isCheckStableRunning=!0,c0(n),n.isCheckStableRunning=!1},void 0,()=>{},()=>{})),n.fakeTopEventTask.invoke()}),l0(n))}(n)};n._inner=n._inner.fork({name:"angular",properties:{isAngularZone:!0},onInvokeTask:(t,i,r,s,o,a)=>{try{return VT(n),t.invokeTask(r,s,o,a)}finally{(n.shouldCoalesceEventChangeDetection&&"eventTask"===s.type||n.shouldCoalesceRunChangeDetection)&&e(),BT(n)}},onInvoke:(t,i,r,s,o,a,c)=>{try{return VT(n),t.invoke(r,s,o,a,c)}finally{n.shouldCoalesceRunChangeDetection&&e(),BT(n)}},onHasTask:(t,i,r,s)=>{t.hasTask(r,s),i===r&&("microTask"==s.change?(n._hasPendingMicrotasks=s.microTask,l0(n),c0(n)):"macroTask"==s.change&&(n.hasPendingMacrotasks=s.macroTask))},onHandleError:(t,i,r,s)=>(t.handleError(r,s),n.runOutsideAngular(()=>n.onError.emit(s)),!1)})}(r)}static isInAngularZone(){return typeof Zone<"u"&&!0===Zone.current.get("isAngularZone")}static assertInAngularZone(){if(!on.isInAngularZone())throw new K(909,!1)}static assertNotInAngularZone(){if(on.isInAngularZone())throw new K(909,!1)}run(e,t,i){return this._inner.run(e,t,i)}runTask(e,t,i,r){const s=this._inner,o=s.scheduleEventTask("NgZoneEvent: "+r,e,x5,sp,sp);try{return s.runTask(o,t,i)}finally{s.cancelTask(o)}}runGuarded(e,t,i){return this._inner.runGuarded(e,t,i)}runOutsideAngular(e){return this._outer.run(e)}}const x5={};function c0(n){if(0==n._nesting&&!n.hasPendingMicrotasks&&!n.isStable)try{n._nesting++,n.onMicrotaskEmpty.emit(null)}finally{if(n._nesting--,!n.hasPendingMicrotasks)try{n.runOutsideAngular(()=>n.onStable.emit(null))}finally{n.isStable=!0}}}function l0(n){n.hasPendingMicrotasks=!!(n._hasPendingMicrotasks||(n.shouldCoalesceEventChangeDetection||n.shouldCoalesceRunChangeDetection)&&-1!==n.lastRequestAnimationFrameId)}function VT(n){n._nesting++,n.isStable&&(n.isStable=!1,n.onUnstable.emit(null))}function BT(n){n._nesting--,c0(n)}class C5{constructor(){this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new sn,this.onMicrotaskEmpty=new sn,this.onStable=new sn,this.onError=new sn}run(e,t,i){return e.apply(t,i)}runGuarded(e,t,i){return e.apply(t,i)}runOutsideAngular(e){return e()}runTask(e,t,i,r){return e.apply(t,i)}}const UT=new xe(""),lp=new xe("");let d0,u0=(()=>{class n{constructor(t,i,r){this._ngZone=t,this.registry=i,this._pendingCount=0,this._isZoneStable=!0,this._didWork=!1,this._callbacks=[],this.taskTrackingZone=null,d0||(function S5(n){d0=n}(r),r.addToWindow(i)),this._watchAngularEvents(),t.run(()=>{this.taskTrackingZone=typeof Zone>"u"?null:Zone.current.get("TaskTrackingZone")})}_watchAngularEvents(){this._ngZone.onUnstable.subscribe({next:()=>{this._didWork=!0,this._isZoneStable=!1}}),this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.subscribe({next:()=>{on.assertNotInAngularZone(),a0(()=>{this._isZoneStable=!0,this._runCallbacksIfReady()})}})})}increasePendingRequestCount(){return this._pendingCount+=1,this._didWork=!0,this._pendingCount}decreasePendingRequestCount(){if(this._pendingCount-=1,this._pendingCount<0)throw new Error("pending async requests below zero");return this._runCallbacksIfReady(),this._pendingCount}isStable(){return this._isZoneStable&&0===this._pendingCount&&!this._ngZone.hasPendingMacrotasks}_runCallbacksIfReady(){if(this.isStable())a0(()=>{for(;0!==this._callbacks.length;){let t=this._callbacks.pop();clearTimeout(t.timeoutId),t.doneCb(this._didWork)}this._didWork=!1});else{let t=this.getPendingTasks();this._callbacks=this._callbacks.filter(i=>!i.updateCb||!i.updateCb(t)||(clearTimeout(i.timeoutId),!1)),this._didWork=!0}}getPendingTasks(){return this.taskTrackingZone?this.taskTrackingZone.macroTasks.map(t=>({source:t.source,creationLocation:t.creationLocation,data:t.data})):[]}addCallback(t,i,r){let s=-1;i&&i>0&&(s=setTimeout(()=>{this._callbacks=this._callbacks.filter(o=>o.timeoutId!==s),t(this._didWork,this.getPendingTasks())},i)),this._callbacks.push({doneCb:t,timeoutId:s,updateCb:r})}whenStable(t,i,r){if(r&&!this.taskTrackingZone)throw new Error('Task tracking zone is required when passing an update callback to whenStable(). Is "zone.js/plugins/task-tracking" loaded?');this.addCallback(t,i,r),this._runCallbacksIfReady()}getPendingRequestCount(){return this._pendingCount}registerApplication(t){this.registry.registerApplication(t,this)}unregisterApplication(t){this.registry.unregisterApplication(t)}findProviders(t,i,r){return[]}}return n.\u0275fac=function(t){return new(t||n)(le(on),le(h0),le(lp))},n.\u0275prov=Te({token:n,factory:n.\u0275fac}),n})(),h0=(()=>{class n{constructor(){this._applications=new Map}registerApplication(t,i){this._applications.set(t,i)}unregisterApplication(t){this._applications.delete(t)}unregisterAllApplications(){this._applications.clear()}getTestability(t){return this._applications.get(t)||null}getAllTestabilities(){return Array.from(this._applications.values())}getAllRootElements(){return Array.from(this._applications.keys())}findTestabilityInTree(t,i=!0){return d0?.findTestabilityInTree(this,t,i)??null}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=Te({token:n,factory:n.\u0275fac,providedIn:"platform"}),n})(),wo=null;const zT=new xe("AllowMultipleToken"),f0=new xe("PlatformDestroyListeners");class HT{constructor(e,t){this.name=e,this.token=t}}function jT(n,e,t=[]){const i=`Platform: ${e}`,r=new xe(i);return(s=[])=>{let o=p0();if(!o||o.injector.get(zT,!1)){const a=[...t,...s,{provide:r,useValue:!0}];n?n(a):function T5(n){if(wo&&!wo.get(zT,!1))throw new K(400,!1);wo=n;const e=n.get($T);(function GT(n){const e=n.get(kT,null);e&&e.forEach(t=>t())})(n)}(function WT(n=[],e){return Ji.create({name:e,providers:[{provide:Wy,useValue:"platform"},{provide:f0,useValue:new Set([()=>wo=null])},...n]})}(a,i))}return function I5(n){const e=p0();if(!e)throw new K(401,!1);return e}()}}function p0(){return wo?.get($T)??null}let $T=(()=>{class n{constructor(t){this._injector=t,this._modules=[],this._destroyListeners=[],this._destroyed=!1}bootstrapModuleFactory(t,i){const r=function XT(n,e){let t;return t="noop"===n?new C5:("zone.js"===n?void 0:n)||new on(e),t}(i?.ngZone,function qT(n){return{enableLongStackTrace:!1,shouldCoalesceEventChangeDetection:!(!n||!n.ngZoneEventCoalescing)||!1,shouldCoalesceRunChangeDetection:!(!n||!n.ngZoneRunCoalescing)||!1}}(i)),s=[{provide:on,useValue:r}];return r.run(()=>{const o=Ji.create({providers:s,parent:this.injector,name:t.moduleType.name}),a=t.create(o),c=a.injector.get(Bs,null);if(!c)throw new K(402,!1);return r.runOutsideAngular(()=>{const l=r.onError.subscribe({next:u=>{c.handleError(u)}});a.onDestroy(()=>{up(this._modules,a),l.unsubscribe()})}),function YT(n,e,t){try{const i=t();return uh(i)?i.catch(r=>{throw e.runOutsideAngular(()=>n.handleError(r)),r}):i}catch(i){throw e.runOutsideAngular(()=>n.handleError(i)),i}}(c,r,()=>{const l=a.injector.get(ap);return l.runInitializers(),l.donePromise.then(()=>(function bD(n){ji(n,"Expected localeId to be defined"),"string"==typeof n&&(vD=n.toLowerCase().replace(/_/g,"-"))}(a.injector.get(ds,sl)||sl),this._moduleDoBootstrap(a),a))})})}bootstrapModule(t,i=[]){const r=ZT({},i);return function E5(n,e,t){const i=new Gv(t);return Promise.resolve(i)}(0,0,t).then(s=>this.bootstrapModuleFactory(s,r))}_moduleDoBootstrap(t){const i=t.injector.get(wh);if(t._bootstrapComponents.length>0)t._bootstrapComponents.forEach(r=>i.bootstrap(r));else{if(!t.instance.ngDoBootstrap)throw new K(403,!1);t.instance.ngDoBootstrap(i)}this._modules.push(t)}onDestroy(t){this._destroyListeners.push(t)}get injector(){return this._injector}destroy(){if(this._destroyed)throw new K(404,!1);this._modules.slice().forEach(i=>i.destroy()),this._destroyListeners.forEach(i=>i());const t=this._injector.get(f0,null);t&&(t.forEach(i=>i()),t.clear()),this._destroyed=!0}get destroyed(){return this._destroyed}}return n.\u0275fac=function(t){return new(t||n)(le(Ji))},n.\u0275prov=Te({token:n,factory:n.\u0275fac,providedIn:"platform"}),n})();function ZT(n,e){return Array.isArray(e)?e.reduce(ZT,n):{...n,...e}}let wh=(()=>{class n{constructor(t,i,r){this._zone=t,this._injector=i,this._exceptionHandler=r,this._bootstrapListeners=[],this._views=[],this._runningTick=!1,this._stable=!0,this._destroyed=!1,this._destroyListeners=[],this.componentTypes=[],this.components=[],this._onMicrotaskEmptySubscription=this._zone.onMicrotaskEmpty.subscribe({next:()=>{this._zone.run(()=>{this.tick()})}});const s=new Mn(a=>{this._stable=this._zone.isStable&&!this._zone.hasPendingMacrotasks&&!this._zone.hasPendingMicrotasks,this._zone.runOutsideAngular(()=>{a.next(this._stable),a.complete()})}),o=new Mn(a=>{let c;this._zone.runOutsideAngular(()=>{c=this._zone.onStable.subscribe(()=>{on.assertNotInAngularZone(),a0(()=>{!this._stable&&!this._zone.hasPendingMacrotasks&&!this._zone.hasPendingMicrotasks&&(this._stable=!0,a.next(!0))})})});const l=this._zone.onUnstable.subscribe(()=>{on.assertInAngularZone(),this._stable&&(this._stable=!1,this._zone.runOutsideAngular(()=>{a.next(!1)}))});return()=>{c.unsubscribe(),l.unsubscribe()}});this.isStable=function _2(...n){const e=ku(n),t=function u2(n,e){return"number"==typeof P_(n)?n.pop():e}(n,1/0),i=n;return i.length?1===i.length?pr(i[0]):wc(t)(Pn(i,e)):Ps}(s,o.pipe(yC()))}get destroyed(){return this._destroyed}get injector(){return this._injector}bootstrap(t,i){const r=t instanceof vE;if(!this._injector.get(ap).done)throw!r&&function Cc(n){const e=Vt(n)||di(n)||xi(n);return null!==e&&e.standalone}(t),new K(405,false);let o;o=r?t:this._injector.get(ih).resolveComponentFactory(t),this.componentTypes.push(o.componentType);const a=function D5(n){return n.isBoundToModule}(o)?void 0:this._injector.get(Ca),l=o.create(Ji.NULL,[],i||o.selector,a),u=l.location.nativeElement,h=l.injector.get(UT,null);return h?.registerApplication(u),l.onDestroy(()=>{this.detachView(l.hostView),up(this.components,l),h?.unregisterApplication(u)}),this._loadComponent(l),l}tick(){if(this._runningTick)throw new K(101,!1);try{this._runningTick=!0;for(let t of this._views)t.detectChanges()}catch(t){this._zone.runOutsideAngular(()=>this._exceptionHandler.handleError(t))}finally{this._runningTick=!1}}attachView(t){const i=t;this._views.push(i),i.attachToAppRef(this)}detachView(t){const i=t;up(this._views,i),i.detachFromAppRef()}_loadComponent(t){this.attachView(t.hostView),this.tick(),this.components.push(t),this._injector.get(LT,[]).concat(this._bootstrapListeners).forEach(r=>r(t))}ngOnDestroy(){if(!this._destroyed)try{this._destroyListeners.forEach(t=>t()),this._views.slice().forEach(t=>t.destroy()),this._onMicrotaskEmptySubscription.unsubscribe()}finally{this._destroyed=!0,this._views=[],this._bootstrapListeners=[],this._destroyListeners=[]}}onDestroy(t){return this._destroyListeners.push(t),()=>up(this._destroyListeners,t)}destroy(){if(this._destroyed)throw new K(406,!1);const t=this._injector;t.destroy&&!t.destroyed&&t.destroy()}get viewCount(){return this._views.length}warnIfDestroyed(){}}return n.\u0275fac=function(t){return new(t||n)(le(on),le(vo),le(Bs))},n.\u0275prov=Te({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();function up(n,e){const t=n.indexOf(e);t>-1&&n.splice(t,1)}let Mo=(()=>{class n{}return n.__NG_ELEMENT_ID__=R5,n})();function R5(n){return function O5(n,e,t){if(ff(n)&&!t){const i=Xi(n.index,e);return new oh(i,i)}return 47&n.type?new oh(e[16],e):null}(ri(),ae(),16==(16&n))}class tA{constructor(){}supports(e){return ch(e)}create(e){return new B5(e)}}const V5=(n,e)=>e;class B5{constructor(e){this.length=0,this._linkedRecords=null,this._unlinkedRecords=null,this._previousItHead=null,this._itHead=null,this._itTail=null,this._additionsHead=null,this._additionsTail=null,this._movesHead=null,this._movesTail=null,this._removalsHead=null,this._removalsTail=null,this._identityChangesHead=null,this._identityChangesTail=null,this._trackByFn=e||V5}forEachItem(e){let t;for(t=this._itHead;null!==t;t=t._next)e(t)}forEachOperation(e){let t=this._itHead,i=this._removalsHead,r=0,s=null;for(;t||i;){const o=!i||t&&t.currentIndex<iA(i,r,s)?t:i,a=iA(o,r,s),c=o.currentIndex;if(o===i)r--,i=i._nextRemoved;else if(t=t._next,null==o.previousIndex)r++;else{s||(s=[]);const l=a-r,u=c-r;if(l!=u){for(let d=0;d<l;d++){const f=d<s.length?s[d]:s[d]=0,p=f+d;u<=p&&p<l&&(s[d]=f+1)}s[o.previousIndex]=u-l}}a!==c&&e(o,a,c)}}forEachPreviousItem(e){let t;for(t=this._previousItHead;null!==t;t=t._nextPrevious)e(t)}forEachAddedItem(e){let t;for(t=this._additionsHead;null!==t;t=t._nextAdded)e(t)}forEachMovedItem(e){let t;for(t=this._movesHead;null!==t;t=t._nextMoved)e(t)}forEachRemovedItem(e){let t;for(t=this._removalsHead;null!==t;t=t._nextRemoved)e(t)}forEachIdentityChange(e){let t;for(t=this._identityChangesHead;null!==t;t=t._nextIdentityChange)e(t)}diff(e){if(null==e&&(e=[]),!ch(e))throw new K(900,!1);return this.check(e)?this:null}onDestroy(){}check(e){this._reset();let r,s,o,t=this._itHead,i=!1;if(Array.isArray(e)){this.length=e.length;for(let a=0;a<this.length;a++)s=e[a],o=this._trackByFn(a,s),null!==t&&Object.is(t.trackById,o)?(i&&(t=this._verifyReinsertion(t,s,o,a)),Object.is(t.item,s)||this._addIdentityChange(t,s)):(t=this._mismatch(t,s,o,a),i=!0),t=t._next}else r=0,function pz(n,e){if(Array.isArray(n))for(let t=0;t<n.length;t++)e(n[t]);else{const t=n[xa()]();let i;for(;!(i=t.next()).done;)e(i.value)}}(e,a=>{o=this._trackByFn(r,a),null!==t&&Object.is(t.trackById,o)?(i&&(t=this._verifyReinsertion(t,a,o,r)),Object.is(t.item,a)||this._addIdentityChange(t,a)):(t=this._mismatch(t,a,o,r),i=!0),t=t._next,r++}),this.length=r;return this._truncate(t),this.collection=e,this.isDirty}get isDirty(){return null!==this._additionsHead||null!==this._movesHead||null!==this._removalsHead||null!==this._identityChangesHead}_reset(){if(this.isDirty){let e;for(e=this._previousItHead=this._itHead;null!==e;e=e._next)e._nextPrevious=e._next;for(e=this._additionsHead;null!==e;e=e._nextAdded)e.previousIndex=e.currentIndex;for(this._additionsHead=this._additionsTail=null,e=this._movesHead;null!==e;e=e._nextMoved)e.previousIndex=e.currentIndex;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}_mismatch(e,t,i,r){let s;return null===e?s=this._itTail:(s=e._prev,this._remove(e)),null!==(e=null===this._unlinkedRecords?null:this._unlinkedRecords.get(i,null))?(Object.is(e.item,t)||this._addIdentityChange(e,t),this._reinsertAfter(e,s,r)):null!==(e=null===this._linkedRecords?null:this._linkedRecords.get(i,r))?(Object.is(e.item,t)||this._addIdentityChange(e,t),this._moveAfter(e,s,r)):e=this._addAfter(new U5(t,i),s,r),e}_verifyReinsertion(e,t,i,r){let s=null===this._unlinkedRecords?null:this._unlinkedRecords.get(i,null);return null!==s?e=this._reinsertAfter(s,e._prev,r):e.currentIndex!=r&&(e.currentIndex=r,this._addToMoves(e,r)),e}_truncate(e){for(;null!==e;){const t=e._next;this._addToRemovals(this._unlink(e)),e=t}null!==this._unlinkedRecords&&this._unlinkedRecords.clear(),null!==this._additionsTail&&(this._additionsTail._nextAdded=null),null!==this._movesTail&&(this._movesTail._nextMoved=null),null!==this._itTail&&(this._itTail._next=null),null!==this._removalsTail&&(this._removalsTail._nextRemoved=null),null!==this._identityChangesTail&&(this._identityChangesTail._nextIdentityChange=null)}_reinsertAfter(e,t,i){null!==this._unlinkedRecords&&this._unlinkedRecords.remove(e);const r=e._prevRemoved,s=e._nextRemoved;return null===r?this._removalsHead=s:r._nextRemoved=s,null===s?this._removalsTail=r:s._prevRemoved=r,this._insertAfter(e,t,i),this._addToMoves(e,i),e}_moveAfter(e,t,i){return this._unlink(e),this._insertAfter(e,t,i),this._addToMoves(e,i),e}_addAfter(e,t,i){return this._insertAfter(e,t,i),this._additionsTail=null===this._additionsTail?this._additionsHead=e:this._additionsTail._nextAdded=e,e}_insertAfter(e,t,i){const r=null===t?this._itHead:t._next;return e._next=r,e._prev=t,null===r?this._itTail=e:r._prev=e,null===t?this._itHead=e:t._next=e,null===this._linkedRecords&&(this._linkedRecords=new nA),this._linkedRecords.put(e),e.currentIndex=i,e}_remove(e){return this._addToRemovals(this._unlink(e))}_unlink(e){null!==this._linkedRecords&&this._linkedRecords.remove(e);const t=e._prev,i=e._next;return null===t?this._itHead=i:t._next=i,null===i?this._itTail=t:i._prev=t,e}_addToMoves(e,t){return e.previousIndex===t||(this._movesTail=null===this._movesTail?this._movesHead=e:this._movesTail._nextMoved=e),e}_addToRemovals(e){return null===this._unlinkedRecords&&(this._unlinkedRecords=new nA),this._unlinkedRecords.put(e),e.currentIndex=null,e._nextRemoved=null,null===this._removalsTail?(this._removalsTail=this._removalsHead=e,e._prevRemoved=null):(e._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=e),e}_addIdentityChange(e,t){return e.item=t,this._identityChangesTail=null===this._identityChangesTail?this._identityChangesHead=e:this._identityChangesTail._nextIdentityChange=e,e}}class U5{constructor(e,t){this.item=e,this.trackById=t,this.currentIndex=null,this.previousIndex=null,this._nextPrevious=null,this._prev=null,this._next=null,this._prevDup=null,this._nextDup=null,this._prevRemoved=null,this._nextRemoved=null,this._nextAdded=null,this._nextMoved=null,this._nextIdentityChange=null}}class z5{constructor(){this._head=null,this._tail=null}add(e){null===this._head?(this._head=this._tail=e,e._nextDup=null,e._prevDup=null):(this._tail._nextDup=e,e._prevDup=this._tail,e._nextDup=null,this._tail=e)}get(e,t){let i;for(i=this._head;null!==i;i=i._nextDup)if((null===t||t<=i.currentIndex)&&Object.is(i.trackById,e))return i;return null}remove(e){const t=e._prevDup,i=e._nextDup;return null===t?this._head=i:t._nextDup=i,null===i?this._tail=t:i._prevDup=t,null===this._head}}class nA{constructor(){this.map=new Map}put(e){const t=e.trackById;let i=this.map.get(t);i||(i=new z5,this.map.set(t,i)),i.add(e)}get(e,t){const r=this.map.get(e);return r?r.get(e,t):null}remove(e){const t=e.trackById;return this.map.get(t).remove(e)&&this.map.delete(t),e}get isEmpty(){return 0===this.map.size}clear(){this.map.clear()}}function iA(n,e,t){const i=n.previousIndex;if(null===i)return i;let r=0;return t&&i<t.length&&(r=t[i]),i+e+r}class rA{constructor(){}supports(e){return e instanceof Map||Dv(e)}create(){return new H5}}class H5{constructor(){this._records=new Map,this._mapHead=null,this._appendAfter=null,this._previousMapHead=null,this._changesHead=null,this._changesTail=null,this._additionsHead=null,this._additionsTail=null,this._removalsHead=null,this._removalsTail=null}get isDirty(){return null!==this._additionsHead||null!==this._changesHead||null!==this._removalsHead}forEachItem(e){let t;for(t=this._mapHead;null!==t;t=t._next)e(t)}forEachPreviousItem(e){let t;for(t=this._previousMapHead;null!==t;t=t._nextPrevious)e(t)}forEachChangedItem(e){let t;for(t=this._changesHead;null!==t;t=t._nextChanged)e(t)}forEachAddedItem(e){let t;for(t=this._additionsHead;null!==t;t=t._nextAdded)e(t)}forEachRemovedItem(e){let t;for(t=this._removalsHead;null!==t;t=t._nextRemoved)e(t)}diff(e){if(e){if(!(e instanceof Map||Dv(e)))throw new K(900,!1)}else e=new Map;return this.check(e)?this:null}onDestroy(){}check(e){this._reset();let t=this._mapHead;if(this._appendAfter=null,this._forEach(e,(i,r)=>{if(t&&t.key===r)this._maybeAddToChanges(t,i),this._appendAfter=t,t=t._next;else{const s=this._getOrCreateRecordForKey(r,i);t=this._insertBeforeOrAppend(t,s)}}),t){t._prev&&(t._prev._next=null),this._removalsHead=t;for(let i=t;null!==i;i=i._nextRemoved)i===this._mapHead&&(this._mapHead=null),this._records.delete(i.key),i._nextRemoved=i._next,i.previousValue=i.currentValue,i.currentValue=null,i._prev=null,i._next=null}return this._changesTail&&(this._changesTail._nextChanged=null),this._additionsTail&&(this._additionsTail._nextAdded=null),this.isDirty}_insertBeforeOrAppend(e,t){if(e){const i=e._prev;return t._next=e,t._prev=i,e._prev=t,i&&(i._next=t),e===this._mapHead&&(this._mapHead=t),this._appendAfter=e,e}return this._appendAfter?(this._appendAfter._next=t,t._prev=this._appendAfter):this._mapHead=t,this._appendAfter=t,null}_getOrCreateRecordForKey(e,t){if(this._records.has(e)){const r=this._records.get(e);this._maybeAddToChanges(r,t);const s=r._prev,o=r._next;return s&&(s._next=o),o&&(o._prev=s),r._next=null,r._prev=null,r}const i=new G5(e);return this._records.set(e,i),i.currentValue=t,this._addToAdditions(i),i}_reset(){if(this.isDirty){let e;for(this._previousMapHead=this._mapHead,e=this._previousMapHead;null!==e;e=e._next)e._nextPrevious=e._next;for(e=this._changesHead;null!==e;e=e._nextChanged)e.previousValue=e.currentValue;for(e=this._additionsHead;null!=e;e=e._nextAdded)e.previousValue=e.currentValue;this._changesHead=this._changesTail=null,this._additionsHead=this._additionsTail=null,this._removalsHead=null}}_maybeAddToChanges(e,t){Object.is(t,e.currentValue)||(e.previousValue=e.currentValue,e.currentValue=t,this._addToChanges(e))}_addToAdditions(e){null===this._additionsHead?this._additionsHead=this._additionsTail=e:(this._additionsTail._nextAdded=e,this._additionsTail=e)}_addToChanges(e){null===this._changesHead?this._changesHead=this._changesTail=e:(this._changesTail._nextChanged=e,this._changesTail=e)}_forEach(e,t){e instanceof Map?e.forEach(t):Object.keys(e).forEach(i=>t(e[i],i))}}class G5{constructor(e){this.key=e,this.previousValue=null,this.currentValue=null,this._nextPrevious=null,this._next=null,this._prev=null,this._nextAdded=null,this._nextRemoved=null,this._nextChanged=null}}function sA(){return new fp([new tA])}let fp=(()=>{class n{constructor(t){this.factories=t}static create(t,i){if(null!=i){const r=i.factories.slice();t=t.concat(r)}return new n(t)}static extend(t){return{provide:n,useFactory:i=>n.create(t,i||sA()),deps:[[n,new Uc,new yo]]}}find(t){const i=this.factories.find(r=>r.supports(t));if(null!=i)return i;throw new K(901,!1)}}return n.\u0275prov=Te({token:n,providedIn:"root",factory:sA}),n})();function oA(){return new Mh([new rA])}let Mh=(()=>{class n{constructor(t){this.factories=t}static create(t,i){if(i){const r=i.factories.slice();t=t.concat(r)}return new n(t)}static extend(t){return{provide:n,useFactory:i=>n.create(t,i||oA()),deps:[[n,new Uc,new yo]]}}find(t){const i=this.factories.find(r=>r.supports(t));if(i)return i;throw new K(901,!1)}}return n.\u0275prov=Te({token:n,providedIn:"root",factory:oA}),n})();const $5=jT(null,"core",[]);let q5=(()=>{class n{constructor(t){}}return n.\u0275fac=function(t){return new(t||n)(le(wh))},n.\u0275mod=bi({type:n}),n.\u0275inj=hi({}),n})(),pp=null;function fs(){return pp}class Z5{}const hn=new xe("DocumentToken");let v0=(()=>{class n{historyGo(t){throw new Error("Not implemented")}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=Te({token:n,factory:function(){return function K5(){return le(aA)}()},providedIn:"platform"}),n})();const J5=new xe("Location Initialized");let aA=(()=>{class n extends v0{constructor(t){super(),this._doc=t,this._init()}_init(){this.location=window.location,this._history=window.history}getBaseHrefFromDOM(){return fs().getBaseHref(this._doc)}onPopState(t){const i=fs().getGlobalEventTarget(this._doc,"window");return i.addEventListener("popstate",t,!1),()=>i.removeEventListener("popstate",t)}onHashChange(t){const i=fs().getGlobalEventTarget(this._doc,"window");return i.addEventListener("hashchange",t,!1),()=>i.removeEventListener("hashchange",t)}get href(){return this.location.href}get protocol(){return this.location.protocol}get hostname(){return this.location.hostname}get port(){return this.location.port}get pathname(){return this.location.pathname}get search(){return this.location.search}get hash(){return this.location.hash}set pathname(t){this.location.pathname=t}pushState(t,i,r){cA()?this._history.pushState(t,i,r):this.location.hash=r}replaceState(t,i,r){cA()?this._history.replaceState(t,i,r):this.location.hash=r}forward(){this._history.forward()}back(){this._history.back()}historyGo(t=0){this._history.go(t)}getState(){return this._history.state}}return n.\u0275fac=function(t){return new(t||n)(le(hn))},n.\u0275prov=Te({token:n,factory:function(){return function Q5(){return new aA(le(hn))}()},providedIn:"platform"}),n})();function cA(){return!!window.history.pushState}function b0(n,e){if(0==n.length)return e;if(0==e.length)return n;let t=0;return n.endsWith("/")&&t++,e.startsWith("/")&&t++,2==t?n+e.substring(1):1==t?n+e:n+"/"+e}function lA(n){const e=n.match(/#|\?|$/),t=e&&e.index||n.length;return n.slice(0,t-("/"===n[t-1]?1:0))+n.slice(t)}function $s(n){return n&&"?"!==n[0]?"?"+n:n}let Ea=(()=>{class n{historyGo(t){throw new Error("Not implemented")}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=Te({token:n,factory:function(){return Ot(hA)},providedIn:"root"}),n})();const uA=new xe("appBaseHref");let hA=(()=>{class n extends Ea{constructor(t,i){super(),this._platformLocation=t,this._removeListenerFns=[],this._baseHref=i??this._platformLocation.getBaseHrefFromDOM()??Ot(hn).location?.origin??""}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(t){this._removeListenerFns.push(this._platformLocation.onPopState(t),this._platformLocation.onHashChange(t))}getBaseHref(){return this._baseHref}prepareExternalUrl(t){return b0(this._baseHref,t)}path(t=!1){const i=this._platformLocation.pathname+$s(this._platformLocation.search),r=this._platformLocation.hash;return r&&t?`${i}${r}`:i}pushState(t,i,r,s){const o=this.prepareExternalUrl(r+$s(s));this._platformLocation.pushState(t,i,o)}replaceState(t,i,r,s){const o=this.prepareExternalUrl(r+$s(s));this._platformLocation.replaceState(t,i,o)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(t=0){this._platformLocation.historyGo?.(t)}}return n.\u0275fac=function(t){return new(t||n)(le(v0),le(uA,8))},n.\u0275prov=Te({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),e8=(()=>{class n extends Ea{constructor(t,i){super(),this._platformLocation=t,this._baseHref="",this._removeListenerFns=[],null!=i&&(this._baseHref=i)}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(t){this._removeListenerFns.push(this._platformLocation.onPopState(t),this._platformLocation.onHashChange(t))}getBaseHref(){return this._baseHref}path(t=!1){let i=this._platformLocation.hash;return null==i&&(i="#"),i.length>0?i.substring(1):i}prepareExternalUrl(t){const i=b0(this._baseHref,t);return i.length>0?"#"+i:i}pushState(t,i,r,s){let o=this.prepareExternalUrl(r+$s(s));0==o.length&&(o=this._platformLocation.pathname),this._platformLocation.pushState(t,i,o)}replaceState(t,i,r,s){let o=this.prepareExternalUrl(r+$s(s));0==o.length&&(o=this._platformLocation.pathname),this._platformLocation.replaceState(t,i,o)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(t=0){this._platformLocation.historyGo?.(t)}}return n.\u0275fac=function(t){return new(t||n)(le(v0),le(uA,8))},n.\u0275prov=Te({token:n,factory:n.\u0275fac}),n})(),x0=(()=>{class n{constructor(t){this._subject=new sn,this._urlChangeListeners=[],this._urlChangeSubscription=null,this._locationStrategy=t;const i=this._locationStrategy.getBaseHref();this._baseHref=lA(dA(i)),this._locationStrategy.onPopState(r=>{this._subject.emit({url:this.path(!0),pop:!0,state:r.state,type:r.type})})}ngOnDestroy(){this._urlChangeSubscription?.unsubscribe(),this._urlChangeListeners=[]}path(t=!1){return this.normalize(this._locationStrategy.path(t))}getState(){return this._locationStrategy.getState()}isCurrentPathEqualTo(t,i=""){return this.path()==this.normalize(t+$s(i))}normalize(t){return n.stripTrailingSlash(function n8(n,e){return n&&e.startsWith(n)?e.substring(n.length):e}(this._baseHref,dA(t)))}prepareExternalUrl(t){return t&&"/"!==t[0]&&(t="/"+t),this._locationStrategy.prepareExternalUrl(t)}go(t,i="",r=null){this._locationStrategy.pushState(r,"",t,i),this._notifyUrlChangeListeners(this.prepareExternalUrl(t+$s(i)),r)}replaceState(t,i="",r=null){this._locationStrategy.replaceState(r,"",t,i),this._notifyUrlChangeListeners(this.prepareExternalUrl(t+$s(i)),r)}forward(){this._locationStrategy.forward()}back(){this._locationStrategy.back()}historyGo(t=0){this._locationStrategy.historyGo?.(t)}onUrlChange(t){return this._urlChangeListeners.push(t),this._urlChangeSubscription||(this._urlChangeSubscription=this.subscribe(i=>{this._notifyUrlChangeListeners(i.url,i.state)})),()=>{const i=this._urlChangeListeners.indexOf(t);this._urlChangeListeners.splice(i,1),0===this._urlChangeListeners.length&&(this._urlChangeSubscription?.unsubscribe(),this._urlChangeSubscription=null)}}_notifyUrlChangeListeners(t="",i){this._urlChangeListeners.forEach(r=>r(t,i))}subscribe(t,i,r){return this._subject.subscribe({next:t,error:i,complete:r})}}return n.normalizeQueryParams=$s,n.joinWithSlash=b0,n.stripTrailingSlash=lA,n.\u0275fac=function(t){return new(t||n)(le(Ea))},n.\u0275prov=Te({token:n,factory:function(){return function t8(){return new x0(le(Ea))}()},providedIn:"root"}),n})();function dA(n){return n.replace(/\/index.html$/,"")}let xA=(()=>{class n{constructor(t,i,r,s){this._iterableDiffers=t,this._keyValueDiffers=i,this._ngEl=r,this._renderer=s,this._iterableDiffer=null,this._keyValueDiffer=null,this._initialClasses=[],this._rawClass=null}set klass(t){this._removeClasses(this._initialClasses),this._initialClasses="string"==typeof t?t.split(/\s+/):[],this._applyClasses(this._initialClasses),this._applyClasses(this._rawClass)}set ngClass(t){this._removeClasses(this._rawClass),this._applyClasses(this._initialClasses),this._iterableDiffer=null,this._keyValueDiffer=null,this._rawClass="string"==typeof t?t.split(/\s+/):t,this._rawClass&&(ch(this._rawClass)?this._iterableDiffer=this._iterableDiffers.find(this._rawClass).create():this._keyValueDiffer=this._keyValueDiffers.find(this._rawClass).create())}ngDoCheck(){if(this._iterableDiffer){const t=this._iterableDiffer.diff(this._rawClass);t&&this._applyIterableChanges(t)}else if(this._keyValueDiffer){const t=this._keyValueDiffer.diff(this._rawClass);t&&this._applyKeyValueChanges(t)}}_applyKeyValueChanges(t){t.forEachAddedItem(i=>this._toggleClass(i.key,i.currentValue)),t.forEachChangedItem(i=>this._toggleClass(i.key,i.currentValue)),t.forEachRemovedItem(i=>{i.previousValue&&this._toggleClass(i.key,!1)})}_applyIterableChanges(t){t.forEachAddedItem(i=>{if("string"!=typeof i.item)throw new Error(`NgClass can only toggle CSS classes expressed as strings, got ${Kt(i.item)}`);this._toggleClass(i.item,!0)}),t.forEachRemovedItem(i=>this._toggleClass(i.item,!1))}_applyClasses(t){t&&(Array.isArray(t)||t instanceof Set?t.forEach(i=>this._toggleClass(i,!0)):Object.keys(t).forEach(i=>this._toggleClass(i,!!t[i])))}_removeClasses(t){t&&(Array.isArray(t)||t instanceof Set?t.forEach(i=>this._toggleClass(i,!1)):Object.keys(t).forEach(i=>this._toggleClass(i,!1)))}_toggleClass(t,i){(t=t.trim())&&t.split(/\s+/g).forEach(r=>{i?this._renderer.addClass(this._ngEl.nativeElement,r):this._renderer.removeClass(this._ngEl.nativeElement,r)})}}return n.\u0275fac=function(t){return new(t||n)(j(fp),j(Mh),j(oi),j(Vs))},n.\u0275dir=Ke({type:n,selectors:[["","ngClass",""]],inputs:{klass:["class","klass"],ngClass:"ngClass"},standalone:!0}),n})();class z8{constructor(e,t,i,r){this.$implicit=e,this.ngForOf=t,this.index=i,this.count=r}get first(){return 0===this.index}get last(){return this.index===this.count-1}get even(){return this.index%2==0}get odd(){return!this.even}}let Eh=(()=>{class n{constructor(t,i,r){this._viewContainer=t,this._template=i,this._differs=r,this._ngForOf=null,this._ngForOfDirty=!0,this._differ=null}set ngForOf(t){this._ngForOf=t,this._ngForOfDirty=!0}set ngForTrackBy(t){this._trackByFn=t}get ngForTrackBy(){return this._trackByFn}set ngForTemplate(t){t&&(this._template=t)}ngDoCheck(){if(this._ngForOfDirty){this._ngForOfDirty=!1;const t=this._ngForOf;!this._differ&&t&&(this._differ=this._differs.find(t).create(this.ngForTrackBy))}if(this._differ){const t=this._differ.diff(this._ngForOf);t&&this._applyChanges(t)}}_applyChanges(t){const i=this._viewContainer;t.forEachOperation((r,s,o)=>{if(null==r.previousIndex)i.createEmbeddedView(this._template,new z8(r.item,this._ngForOf,-1,-1),null===o?void 0:o);else if(null==o)i.remove(null===s?void 0:s);else if(null!==s){const a=i.get(s);i.move(a,o),CA(a,r)}});for(let r=0,s=i.length;r<s;r++){const a=i.get(r).context;a.index=r,a.count=s,a.ngForOf=this._ngForOf}t.forEachIdentityChange(r=>{CA(i.get(r.currentIndex),r)})}static ngTemplateContextGuard(t,i){return!0}}return n.\u0275fac=function(t){return new(t||n)(j($r),j(js),j(fp))},n.\u0275dir=Ke({type:n,selectors:[["","ngFor","","ngForOf",""]],inputs:{ngForOf:"ngForOf",ngForTrackBy:"ngForTrackBy",ngForTemplate:"ngForTemplate"},standalone:!0}),n})();function CA(n,e){n.context.$implicit=e.item}let P0=(()=>{class n{constructor(t,i){this._viewContainer=t,this._context=new G8,this._thenTemplateRef=null,this._elseTemplateRef=null,this._thenViewRef=null,this._elseViewRef=null,this._thenTemplateRef=i}set ngIf(t){this._context.$implicit=this._context.ngIf=t,this._updateView()}set ngIfThen(t){SA("ngIfThen",t),this._thenTemplateRef=t,this._thenViewRef=null,this._updateView()}set ngIfElse(t){SA("ngIfElse",t),this._elseTemplateRef=t,this._elseViewRef=null,this._updateView()}_updateView(){this._context.$implicit?this._thenViewRef||(this._viewContainer.clear(),this._elseViewRef=null,this._thenTemplateRef&&(this._thenViewRef=this._viewContainer.createEmbeddedView(this._thenTemplateRef,this._context))):this._elseViewRef||(this._viewContainer.clear(),this._thenViewRef=null,this._elseTemplateRef&&(this._elseViewRef=this._viewContainer.createEmbeddedView(this._elseTemplateRef,this._context)))}static ngTemplateContextGuard(t,i){return!0}}return n.\u0275fac=function(t){return new(t||n)(j($r),j(js))},n.\u0275dir=Ke({type:n,selectors:[["","ngIf",""]],inputs:{ngIf:"ngIf",ngIfThen:"ngIfThen",ngIfElse:"ngIfElse"},standalone:!0}),n})();class G8{constructor(){this.$implicit=null,this.ngIf=null}}function SA(n,e){if(e&&!e.createEmbeddedView)throw new Error(`${n} must be a TemplateRef, but received '${Kt(e)}'.`)}let yG=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=bi({type:n}),n.\u0275inj=hi({}),n})();const TA="browser";let MG=(()=>{class n{}return n.\u0275prov=Te({token:n,providedIn:"root",factory:()=>new CG(le(hn),window)}),n})();class CG{constructor(e,t){this.document=e,this.window=t,this.offset=()=>[0,0]}setOffset(e){this.offset=Array.isArray(e)?()=>e:e}getScrollPosition(){return this.supportsScrolling()?[this.window.pageXOffset,this.window.pageYOffset]:[0,0]}scrollToPosition(e){this.supportsScrolling()&&this.window.scrollTo(e[0],e[1])}scrollToAnchor(e){if(!this.supportsScrolling())return;const t=function SG(n,e){const t=n.getElementById(e)||n.getElementsByName(e)[0];if(t)return t;if("function"==typeof n.createTreeWalker&&n.body&&(n.body.createShadowRoot||n.body.attachShadow)){const i=n.createTreeWalker(n.body,NodeFilter.SHOW_ELEMENT);let r=i.currentNode;for(;r;){const s=r.shadowRoot;if(s){const o=s.getElementById(e)||s.querySelector(`[name="${e}"]`);if(o)return o}r=i.nextNode()}}return null}(this.document,e);t&&(this.scrollToElement(t),t.focus())}setHistoryScrollRestoration(e){if(this.supportScrollRestoration()){const t=this.window.history;t&&t.scrollRestoration&&(t.scrollRestoration=e)}}scrollToElement(e){const t=e.getBoundingClientRect(),i=t.left+this.window.pageXOffset,r=t.top+this.window.pageYOffset,s=this.offset();this.window.scrollTo(i-s[0],r-s[1])}supportScrollRestoration(){try{if(!this.supportsScrolling())return!1;const e=AA(this.window.history)||AA(Object.getPrototypeOf(this.window.history));return!(!e||!e.writable&&!e.set)}catch{return!1}}supportsScrolling(){try{return!!this.window&&!!this.window.scrollTo&&"pageXOffset"in this.window}catch{return!1}}}function AA(n){return Object.getOwnPropertyDescriptor(n,"scrollRestoration")}class QG extends Z5{constructor(){super(...arguments),this.supportsDOMEvents=!0}}class V0 extends QG{static makeCurrent(){!function Y5(n){pp||(pp=n)}(new V0)}onAndCancel(e,t,i){return e.addEventListener(t,i,!1),()=>{e.removeEventListener(t,i,!1)}}dispatchEvent(e,t){e.dispatchEvent(t)}remove(e){e.parentNode&&e.parentNode.removeChild(e)}createElement(e,t){return(t=t||this.getDefaultDocument()).createElement(e)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(e){return e.nodeType===Node.ELEMENT_NODE}isShadowRoot(e){return e instanceof DocumentFragment}getGlobalEventTarget(e,t){return"window"===t?window:"document"===t?e:"body"===t?e.body:null}getBaseHref(e){const t=function e6(){return Th=Th||document.querySelector("base"),Th?Th.getAttribute("href"):null}();return null==t?null:function t6(n){Sp=Sp||document.createElement("a"),Sp.setAttribute("href",n);const e=Sp.pathname;return"/"===e.charAt(0)?e:`/${e}`}(t)}resetBaseElement(){Th=null}getUserAgent(){return window.navigator.userAgent}getCookie(e){return function B8(n,e){e=encodeURIComponent(e);for(const t of n.split(";")){const i=t.indexOf("="),[r,s]=-1==i?[t,""]:[t.slice(0,i),t.slice(i+1)];if(r.trim()===e)return decodeURIComponent(s)}return null}(document.cookie,e)}}let Sp,Th=null;const LA=new xe("TRANSITION_ID"),i6=[{provide:op,useFactory:function n6(n,e,t){return()=>{t.get(ap).donePromise.then(()=>{const i=fs(),r=e.querySelectorAll(`style[ng-transition="${n}"]`);for(let s=0;s<r.length;s++)i.remove(r[s])})}},deps:[LA,hn,Ji],multi:!0}];let s6=(()=>{class n{build(){return new XMLHttpRequest}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=Te({token:n,factory:n.\u0275fac}),n})();const Ep=new xe("EventManagerPlugins");let Dp=(()=>{class n{constructor(t,i){this._zone=i,this._eventNameToPlugin=new Map,t.forEach(r=>r.manager=this),this._plugins=t.slice().reverse()}addEventListener(t,i,r){return this._findPluginFor(i).addEventListener(t,i,r)}addGlobalEventListener(t,i,r){return this._findPluginFor(i).addGlobalEventListener(t,i,r)}getZone(){return this._zone}_findPluginFor(t){const i=this._eventNameToPlugin.get(t);if(i)return i;const r=this._plugins;for(let s=0;s<r.length;s++){const o=r[s];if(o.supports(t))return this._eventNameToPlugin.set(t,o),o}throw new Error(`No event manager plugin found for event ${t}`)}}return n.\u0275fac=function(t){return new(t||n)(le(Ep),le(on))},n.\u0275prov=Te({token:n,factory:n.\u0275fac}),n})();class NA{constructor(e){this._doc=e}addGlobalEventListener(e,t,i){const r=fs().getGlobalEventTarget(this._doc,e);if(!r)throw new Error(`Unsupported event target ${r} for event ${t}`);return this.addEventListener(r,t,i)}}let FA=(()=>{class n{constructor(){this._stylesSet=new Set}addStyles(t){const i=new Set;t.forEach(r=>{this._stylesSet.has(r)||(this._stylesSet.add(r),i.add(r))}),this.onStylesAdded(i)}onStylesAdded(t){}getAllStyles(){return Array.from(this._stylesSet)}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=Te({token:n,factory:n.\u0275fac}),n})(),Ah=(()=>{class n extends FA{constructor(t){super(),this._doc=t,this._hostNodes=new Map,this._hostNodes.set(t.head,[])}_addStylesToHost(t,i,r){t.forEach(s=>{const o=this._doc.createElement("style");o.textContent=s,r.push(i.appendChild(o))})}addHost(t){const i=[];this._addStylesToHost(this._stylesSet,t,i),this._hostNodes.set(t,i)}removeHost(t){const i=this._hostNodes.get(t);i&&i.forEach(VA),this._hostNodes.delete(t)}onStylesAdded(t){this._hostNodes.forEach((i,r)=>{this._addStylesToHost(t,r,i)})}ngOnDestroy(){this._hostNodes.forEach(t=>t.forEach(VA))}}return n.\u0275fac=function(t){return new(t||n)(le(hn))},n.\u0275prov=Te({token:n,factory:n.\u0275fac}),n})();function VA(n){fs().remove(n)}const B0={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/MathML/"},U0=/%COMP%/g;function Tp(n,e,t){for(let i=0;i<e.length;i++){let r=e[i];Array.isArray(r)?Tp(n,r,t):(r=r.replace(U0,n),t.push(r))}return t}function zA(n){return e=>{if("__ngUnwrap__"===e)return n;!1===n(e)&&(e.preventDefault(),e.returnValue=!1)}}let Ap=(()=>{class n{constructor(t,i,r){this.eventManager=t,this.sharedStylesHost=i,this.appId=r,this.rendererByCompId=new Map,this.defaultRenderer=new z0(t)}createRenderer(t,i){if(!t||!i)return this.defaultRenderer;switch(i.encapsulation){case Nr.Emulated:{let r=this.rendererByCompId.get(i.id);return r||(r=new h6(this.eventManager,this.sharedStylesHost,i,this.appId),this.rendererByCompId.set(i.id,r)),r.applyToHost(t),r}case 1:case Nr.ShadowDom:return new d6(this.eventManager,this.sharedStylesHost,t,i);default:if(!this.rendererByCompId.has(i.id)){const r=Tp(i.id,i.styles,[]);this.sharedStylesHost.addStyles(r),this.rendererByCompId.set(i.id,this.defaultRenderer)}return this.defaultRenderer}}begin(){}end(){}}return n.\u0275fac=function(t){return new(t||n)(le(Dp),le(Ah),le(xh))},n.\u0275prov=Te({token:n,factory:n.\u0275fac}),n})();class z0{constructor(e){this.eventManager=e,this.data=Object.create(null),this.destroyNode=null}destroy(){}createElement(e,t){return t?document.createElementNS(B0[t]||t,e):document.createElement(e)}createComment(e){return document.createComment(e)}createText(e){return document.createTextNode(e)}appendChild(e,t){(GA(e)?e.content:e).appendChild(t)}insertBefore(e,t,i){e&&(GA(e)?e.content:e).insertBefore(t,i)}removeChild(e,t){e&&e.removeChild(t)}selectRootElement(e,t){let i="string"==typeof e?document.querySelector(e):e;if(!i)throw new Error(`The selector "${e}" did not match any elements`);return t||(i.textContent=""),i}parentNode(e){return e.parentNode}nextSibling(e){return e.nextSibling}setAttribute(e,t,i,r){if(r){t=r+":"+t;const s=B0[r];s?e.setAttributeNS(s,t,i):e.setAttribute(t,i)}else e.setAttribute(t,i)}removeAttribute(e,t,i){if(i){const r=B0[i];r?e.removeAttributeNS(r,t):e.removeAttribute(`${i}:${t}`)}else e.removeAttribute(t)}addClass(e,t){e.classList.add(t)}removeClass(e,t){e.classList.remove(t)}setStyle(e,t,i,r){r&(Bi.DashCase|Bi.Important)?e.style.setProperty(t,i,r&Bi.Important?"important":""):e.style[t]=i}removeStyle(e,t,i){i&Bi.DashCase?e.style.removeProperty(t):e.style[t]=""}setProperty(e,t,i){e[t]=i}setValue(e,t){e.nodeValue=t}listen(e,t,i){return"string"==typeof e?this.eventManager.addGlobalEventListener(e,t,zA(i)):this.eventManager.addEventListener(e,t,zA(i))}}function GA(n){return"TEMPLATE"===n.tagName&&void 0!==n.content}class h6 extends z0{constructor(e,t,i,r){super(e),this.component=i;const s=Tp(r+"-"+i.id,i.styles,[]);t.addStyles(s),this.contentAttr=function c6(n){return"_ngcontent-%COMP%".replace(U0,n)}(r+"-"+i.id),this.hostAttr=function l6(n){return"_nghost-%COMP%".replace(U0,n)}(r+"-"+i.id)}applyToHost(e){super.setAttribute(e,this.hostAttr,"")}createElement(e,t){const i=super.createElement(e,t);return super.setAttribute(i,this.contentAttr,""),i}}class d6 extends z0{constructor(e,t,i,r){super(e),this.sharedStylesHost=t,this.hostEl=i,this.shadowRoot=i.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);const s=Tp(r.id,r.styles,[]);for(let o=0;o<s.length;o++){const a=document.createElement("style");a.textContent=s[o],this.shadowRoot.appendChild(a)}}nodeOrShadowRoot(e){return e===this.hostEl?this.shadowRoot:e}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}appendChild(e,t){return super.appendChild(this.nodeOrShadowRoot(e),t)}insertBefore(e,t,i){return super.insertBefore(this.nodeOrShadowRoot(e),t,i)}removeChild(e,t){return super.removeChild(this.nodeOrShadowRoot(e),t)}parentNode(e){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(e)))}}let f6=(()=>{class n extends NA{constructor(t){super(t)}supports(t){return!0}addEventListener(t,i,r){return t.addEventListener(i,r,!1),()=>this.removeEventListener(t,i,r)}removeEventListener(t,i,r){return t.removeEventListener(i,r)}}return n.\u0275fac=function(t){return new(t||n)(le(hn))},n.\u0275prov=Te({token:n,factory:n.\u0275fac}),n})();const jA=["alt","control","meta","shift"],p6={"\b":"Backspace","\t":"Tab","\x7f":"Delete","\x1b":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},m6={alt:n=>n.altKey,control:n=>n.ctrlKey,meta:n=>n.metaKey,shift:n=>n.shiftKey};let g6=(()=>{class n extends NA{constructor(t){super(t)}supports(t){return null!=n.parseEventName(t)}addEventListener(t,i,r){const s=n.parseEventName(i),o=n.eventCallback(s.fullKey,r,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>fs().onAndCancel(t,s.domEventName,o))}static parseEventName(t){const i=t.toLowerCase().split("."),r=i.shift();if(0===i.length||"keydown"!==r&&"keyup"!==r)return null;const s=n._normalizeKey(i.pop());let o="",a=i.indexOf("code");if(a>-1&&(i.splice(a,1),o="code."),jA.forEach(l=>{const u=i.indexOf(l);u>-1&&(i.splice(u,1),o+=l+".")}),o+=s,0!=i.length||0===s.length)return null;const c={};return c.domEventName=r,c.fullKey=o,c}static matchEventFullKeyCode(t,i){let r=p6[t.key]||t.key,s="";return i.indexOf("code.")>-1&&(r=t.code,s="code."),!(null==r||!r)&&(r=r.toLowerCase()," "===r?r="space":"."===r&&(r="dot"),jA.forEach(o=>{o!==r&&(0,m6[o])(t)&&(s+=o+".")}),s+=r,s===i)}static eventCallback(t,i,r){return s=>{n.matchEventFullKeyCode(s,t)&&r.runGuarded(()=>i(s))}}static _normalizeKey(t){return"esc"===t?"escape":t}}return n.\u0275fac=function(t){return new(t||n)(le(hn))},n.\u0275prov=Te({token:n,factory:n.\u0275fac}),n})();const b6=jT($5,"browser",[{provide:s0,useValue:TA},{provide:kT,useValue:function _6(){V0.makeCurrent()},multi:!0},{provide:hn,useFactory:function v6(){return function LV(n){Fy=n}(document),document},deps:[]}]),qA=new xe(""),XA=[{provide:lp,useClass:class r6{addToWindow(e){en.getAngularTestability=(i,r=!0)=>{const s=e.findTestabilityInTree(i,r);if(null==s)throw new Error("Could not find testability for element.");return s},en.getAllAngularTestabilities=()=>e.getAllTestabilities(),en.getAllAngularRootElements=()=>e.getAllRootElements(),en.frameworkStabilizers||(en.frameworkStabilizers=[]),en.frameworkStabilizers.push(i=>{const r=en.getAllAngularTestabilities();let s=r.length,o=!1;const a=function(c){o=o||c,s--,0==s&&i(o)};r.forEach(function(c){c.whenStable(a)})})}findTestabilityInTree(e,t,i){return null==t?null:e.getTestability(t)??(i?fs().isShadowRoot(t)?this.findTestabilityInTree(e,t.host,!0):this.findTestabilityInTree(e,t.parentElement,!0):null)}},deps:[]},{provide:UT,useClass:u0,deps:[on,h0,lp]},{provide:u0,useClass:u0,deps:[on,h0,lp]}],YA=[{provide:Wy,useValue:"root"},{provide:Bs,useFactory:function y6(){return new Bs},deps:[]},{provide:Ep,useClass:f6,multi:!0,deps:[hn,on,s0]},{provide:Ep,useClass:g6,multi:!0,deps:[hn]},{provide:Ap,useClass:Ap,deps:[Dp,Ah,xh]},{provide:rh,useExisting:Ap},{provide:FA,useExisting:Ah},{provide:Ah,useClass:Ah,deps:[hn]},{provide:Dp,useClass:Dp,deps:[Ep,on]},{provide:class EG{},useClass:s6,deps:[]},[]];let ZA=(()=>{class n{constructor(t){}static withServerTransition(t){return{ngModule:n,providers:[{provide:xh,useValue:t.appId},{provide:LA,useExisting:xh},i6]}}}return n.\u0275fac=function(t){return new(t||n)(le(qA,12))},n.\u0275mod=bi({type:n}),n.\u0275inj=hi({providers:[...YA,...XA],imports:[yG,q5]}),n})(),KA=(()=>{class n{constructor(t){this._doc=t}getTitle(){return this._doc.title}setTitle(t){this._doc.title=t||""}}return n.\u0275fac=function(t){return new(t||n)(le(hn))},n.\u0275prov=Te({token:n,factory:function(t){let i=null;return i=t?new t:function w6(){return new KA(le(hn))}(),i},providedIn:"root"}),n})();typeof window<"u"&&window;let j0=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=Te({token:n,factory:function(t){let i=null;return i=t?new(t||n):le(eI),i},providedIn:"root"}),n})(),eI=(()=>{class n extends j0{constructor(t){super(),this._doc=t}sanitize(t,i){if(null==i)return null;switch(t){case Lt.NONE:return i;case Lt.HTML:return os(i,"HTML")?Ki(i):oE(this._doc,String(i)).toString();case Lt.STYLE:return os(i,"Style")?Ki(i):i;case Lt.SCRIPT:if(os(i,"Script"))return Ki(i);throw new Error("unsafe value used in a script context");case Lt.URL:return os(i,"URL")?Ki(i):Of(String(i));case Lt.RESOURCE_URL:if(os(i,"ResourceURL"))return Ki(i);throw new Error("unsafe value used in a resource URL context (see https://g.co/ng/security#xss)");default:throw new Error(`Unexpected SecurityContext ${t} (see https://g.co/ng/security#xss)`)}}bypassSecurityTrustHtml(t){return function HV(n){return new NV(n)}(t)}bypassSecurityTrustStyle(t){return function GV(n){return new FV(n)}(t)}bypassSecurityTrustScript(t){return function jV(n){return new VV(n)}(t)}bypassSecurityTrustUrl(t){return function WV(n){return new BV(n)}(t)}bypassSecurityTrustResourceUrl(t){return function $V(n){return new UV(n)}(t)}}return n.\u0275fac=function(t){return new(t||n)(le(hn))},n.\u0275prov=Te({token:n,factory:function(t){let i=null;return i=t?new t:function A6(n){return new eI(n.get(hn))}(le(Ji)),i},providedIn:"root"}),n})();function Ve(...n){return Pn(n,ku(n))}class Zr extends ui{constructor(e){super(),this._value=e}get value(){return this.getValue()}_subscribe(e){const t=super._subscribe(e);return!t.closed&&e.next(this._value),t}getValue(){const{hasError:e,thrownError:t,_value:i}=this;if(e)throw t;return this._throwIfClosed(),i}next(e){super.next(this._value=e)}}const Ip=Ru(n=>function(){n(this),this.name="EmptyError",this.message="no elements in sequence"}),{isArray:I6}=Array,{getPrototypeOf:P6,prototype:R6,keys:O6}=Object;function tI(n){if(1===n.length){const e=n[0];if(I6(e))return{args:e,keys:null};if(function k6(n){return n&&"object"==typeof n&&P6(n)===R6}(e)){const t=O6(e);return{args:t.map(i=>e[i]),keys:t}}}return{args:n,keys:null}}const{isArray:L6}=Array;function nI(n){return tt(e=>function N6(n,e){return L6(e)?n(...e):n(e)}(n,e))}function iI(n,e){return n.reduce((t,i,r)=>(t[i]=e[r],t),{})}function W0(...n){const e=ku(n),t=pC(n),{args:i,keys:r}=tI(n);if(0===i.length)return Pn([],e);const s=new Mn(function F6(n,e,t=aa){return i=>{rI(e,()=>{const{length:r}=n,s=new Array(r);let o=r,a=r;for(let c=0;c<r;c++)rI(e,()=>{const l=Pn(n[c],e);let u=!1;l.subscribe(Cn(i,h=>{s[c]=h,u||(u=!0,a--),a||i.next(t(s.slice()))},()=>{--o||i.complete()}))},i)},i)}}(i,e,r?o=>iI(r,o):aa));return t?s.pipe(nI(t)):s}function rI(n,e,t){n?Is(t,n,e):e()}function Pp(...n){return function V6(){return wc(1)}()(Pn(n,ku(n)))}function sI(n){return new Mn(e=>{pr(n()).subscribe(e)})}function ll(n,e){const t=Qt(n)?n:()=>n,i=r=>r.error(t());return new Mn(e?r=>e.schedule(i,0,r):i)}function $0(){return In((n,e)=>{let t=null;n._refCount++;const i=Cn(e,void 0,void 0,void 0,()=>{if(!n||n._refCount<=0||0<--n._refCount)return void(t=null);const r=n._connection,s=t;t=null,r&&(!s||r===s)&&r.unsubscribe(),e.unsubscribe()});n.subscribe(i),i.closed||(t=n.connect())})}class oI extends Mn{constructor(e,t){super(),this.source=e,this.subjectFactory=t,this._subject=null,this._refCount=0,this._connection=null,eC(e)&&(this.lift=e.lift)}_subscribe(e){return this.getSubject().subscribe(e)}getSubject(){const e=this._subject;return(!e||e.isStopped)&&(this._subject=this.subjectFactory()),this._subject}_teardown(){this._refCount=0;const{_connection:e}=this;this._subject=this._connection=null,e?.unsubscribe()}connect(){let e=this._connection;if(!e){e=this._connection=new Ni;const t=this.getSubject();e.add(this.source.subscribe(Cn(t,void 0,()=>{this._teardown(),t.complete()},i=>{this._teardown(),t.error(i)},()=>this._teardown()))),e.closed&&(this._connection=null,e=Ni.EMPTY)}return e}refCount(){return $0()(this)}}function ps(n,e){return In((t,i)=>{let r=null,s=0,o=!1;const a=()=>o&&!r&&i.complete();t.subscribe(Cn(i,c=>{r?.unsubscribe();let l=0;const u=s++;pr(n(c,u)).subscribe(r=Cn(i,h=>i.next(e?e(c,h,u,l++):h),()=>{r=null,a()}))},()=>{o=!0,a()}))})}function Da(n){return n<=0?()=>Ps:In((e,t)=>{let i=0;e.subscribe(Cn(t,r=>{++i<=n&&(t.next(r),n<=i&&t.complete())}))})}function aI(...n){const e=ku(n);return In((t,i)=>{(e?Pp(n,t,e):Pp(n,t)).subscribe(i)})}function ms(n,e){return In((t,i)=>{let r=0;t.subscribe(Cn(i,s=>n.call(e,s,r++)&&i.next(s)))})}function Rp(n){return In((e,t)=>{let i=!1;e.subscribe(Cn(t,r=>{i=!0,t.next(r)},()=>{i||t.next(n),t.complete()}))})}function cI(n=B6){return In((e,t)=>{let i=!1;e.subscribe(Cn(t,r=>{i=!0,t.next(r)},()=>i?t.complete():t.error(n())))})}function B6(){return new Ip}function So(n,e){const t=arguments.length>=2;return i=>i.pipe(n?ms((r,s)=>n(r,s,i)):aa,Da(1),t?Rp(e):cI(()=>new Ip))}function Eo(n,e){return Qt(e)?ni(n,e,1):ni(n,1)}function Gn(n,e,t){const i=Qt(n)||e||t?{next:n,error:e,complete:t}:n;return i?In((r,s)=>{var o;null===(o=i.subscribe)||void 0===o||o.call(i);let a=!0;r.subscribe(Cn(s,c=>{var l;null===(l=i.next)||void 0===l||l.call(i,c),s.next(c)},()=>{var c;a=!1,null===(c=i.complete)||void 0===c||c.call(i),s.complete()},c=>{var l;a=!1,null===(l=i.error)||void 0===l||l.call(i,c),s.error(c)},()=>{var c,l;a&&(null===(c=i.unsubscribe)||void 0===c||c.call(i)),null===(l=i.finalize)||void 0===l||l.call(i)}))}):aa}function Xs(n){return In((e,t)=>{let s,i=null,r=!1;i=e.subscribe(Cn(t,void 0,void 0,o=>{s=pr(n(o,Xs(n)(e))),i?(i.unsubscribe(),i=null,s.subscribe(t)):r=!0})),r&&(i.unsubscribe(),i=null,s.subscribe(t))})}function U6(n,e,t,i,r){return(s,o)=>{let a=t,c=e,l=0;s.subscribe(Cn(o,u=>{const h=l++;c=a?n(c,u,h):(a=!0,u),i&&o.next(c)},r&&(()=>{a&&o.next(c),o.complete()})))}}function lI(n,e){return In(U6(n,e,arguments.length>=2,!0))}function q0(n){return n<=0?()=>Ps:In((e,t)=>{let i=[];e.subscribe(Cn(t,r=>{i.push(r),n<i.length&&i.shift()},()=>{for(const r of i)t.next(r);t.complete()},void 0,()=>{i=null}))})}function uI(n,e){const t=arguments.length>=2;return i=>i.pipe(n?ms((r,s)=>n(r,s,i)):aa,q0(1),t?Rp(e):cI(()=>new Ip))}function Op(n){return In((e,t)=>{try{e.subscribe(t)}finally{t.add(n)}})}const _t="primary",Ih=Symbol("RouteTitle");class G6{constructor(e){this.params=e||{}}has(e){return Object.prototype.hasOwnProperty.call(this.params,e)}get(e){if(this.has(e)){const t=this.params[e];return Array.isArray(t)?t[0]:t}return null}getAll(e){if(this.has(e)){const t=this.params[e];return Array.isArray(t)?t:[t]}return[]}get keys(){return Object.keys(this.params)}}function ul(n){return new G6(n)}function j6(n,e,t){const i=t.path.split("/");if(i.length>n.length||"full"===t.pathMatch&&(e.hasChildren()||i.length<n.length))return null;const r={};for(let s=0;s<i.length;s++){const o=i[s],a=n[s];if(o.startsWith(":"))r[o.substring(1)]=a;else if(o!==a.path)return null}return{consumed:n.slice(0,i.length),posParams:r}}function gs(n,e){const t=n?Object.keys(n):void 0,i=e?Object.keys(e):void 0;if(!t||!i||t.length!=i.length)return!1;let r;for(let s=0;s<t.length;s++)if(r=t[s],!hI(n[r],e[r]))return!1;return!0}function hI(n,e){if(Array.isArray(n)&&Array.isArray(e)){if(n.length!==e.length)return!1;const t=[...n].sort(),i=[...e].sort();return t.every((r,s)=>i[s]===r)}return n===e}function dI(n){return Array.prototype.concat.apply([],n)}function fI(n){return n.length>0?n[n.length-1]:null}function ai(n,e){for(const t in n)n.hasOwnProperty(t)&&e(n[t],t)}function Do(n){return Pv(n)?n:uh(n)?Pn(Promise.resolve(n)):Ve(n)}const kp=!1,$6={exact:function gI(n,e,t){if(!Aa(n.segments,e.segments)||!Lp(n.segments,e.segments,t)||n.numberOfChildren!==e.numberOfChildren)return!1;for(const i in e.children)if(!n.children[i]||!gI(n.children[i],e.children[i],t))return!1;return!0},subset:_I},pI={exact:function q6(n,e){return gs(n,e)},subset:function X6(n,e){return Object.keys(e).length<=Object.keys(n).length&&Object.keys(e).every(t=>hI(n[t],e[t]))},ignored:()=>!0};function mI(n,e,t){return $6[t.paths](n.root,e.root,t.matrixParams)&&pI[t.queryParams](n.queryParams,e.queryParams)&&!("exact"===t.fragment&&n.fragment!==e.fragment)}function _I(n,e,t){return yI(n,e,e.segments,t)}function yI(n,e,t,i){if(n.segments.length>t.length){const r=n.segments.slice(0,t.length);return!(!Aa(r,t)||e.hasChildren()||!Lp(r,t,i))}if(n.segments.length===t.length){if(!Aa(n.segments,t)||!Lp(n.segments,t,i))return!1;for(const r in e.children)if(!n.children[r]||!_I(n.children[r],e.children[r],i))return!1;return!0}{const r=t.slice(0,n.segments.length),s=t.slice(n.segments.length);return!!(Aa(n.segments,r)&&Lp(n.segments,r,i)&&n.children[_t])&&yI(n.children[_t],e,s,i)}}function Lp(n,e,t){return e.every((i,r)=>pI[t](n[r].parameters,i.parameters))}class Ta{constructor(e=new xt([],{}),t={},i=null){this.root=e,this.queryParams=t,this.fragment=i}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=ul(this.queryParams)),this._queryParamMap}toString(){return K6.serialize(this)}}class xt{constructor(e,t){this.segments=e,this.children=t,this.parent=null,ai(t,(i,r)=>i.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return Np(this)}}class Ph{constructor(e,t){this.path=e,this.parameters=t}get parameterMap(){return this._parameterMap||(this._parameterMap=ul(this.parameters)),this._parameterMap}toString(){return wI(this)}}function Aa(n,e){return n.length===e.length&&n.every((t,i)=>t.path===e[i].path)}let vI=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=Te({token:n,factory:function(){return new X0},providedIn:"root"}),n})();class X0{parse(e){const t=new oj(e);return new Ta(t.parseRootSegment(),t.parseQueryParams(),t.parseFragment())}serialize(e){const t=`/${Rh(e.root,!0)}`,i=function ej(n){const e=Object.keys(n).map(t=>{const i=n[t];return Array.isArray(i)?i.map(r=>`${Fp(t)}=${Fp(r)}`).join("&"):`${Fp(t)}=${Fp(i)}`}).filter(t=>!!t);return e.length?`?${e.join("&")}`:""}(e.queryParams);return`${t}${i}${"string"==typeof e.fragment?`#${function J6(n){return encodeURI(n)}(e.fragment)}`:""}`}}const K6=new X0;function Np(n){return n.segments.map(e=>wI(e)).join("/")}function Rh(n,e){if(!n.hasChildren())return Np(n);if(e){const t=n.children[_t]?Rh(n.children[_t],!1):"",i=[];return ai(n.children,(r,s)=>{s!==_t&&i.push(`${s}:${Rh(r,!1)}`)}),i.length>0?`${t}(${i.join("//")})`:t}{const t=function Z6(n,e){let t=[];return ai(n.children,(i,r)=>{r===_t&&(t=t.concat(e(i,r)))}),ai(n.children,(i,r)=>{r!==_t&&(t=t.concat(e(i,r)))}),t}(n,(i,r)=>r===_t?[Rh(n.children[_t],!1)]:[`${r}:${Rh(i,!1)}`]);return 1===Object.keys(n.children).length&&null!=n.children[_t]?`${Np(n)}/${t[0]}`:`${Np(n)}/(${t.join("//")})`}}function bI(n){return encodeURIComponent(n).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function Fp(n){return bI(n).replace(/%3B/gi,";")}function Y0(n){return bI(n).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function Vp(n){return decodeURIComponent(n)}function xI(n){return Vp(n.replace(/\+/g,"%20"))}function wI(n){return`${Y0(n.path)}${function Q6(n){return Object.keys(n).map(e=>`;${Y0(e)}=${Y0(n[e])}`).join("")}(n.parameters)}`}const tj=/^[^\/()?;=#]+/;function Bp(n){const e=n.match(tj);return e?e[0]:""}const nj=/^[^=?&#]+/,rj=/^[^&#]+/;class oj{constructor(e){this.url=e,this.remaining=e}parseRootSegment(){return this.consumeOptional("/"),""===this.remaining||this.peekStartsWith("?")||this.peekStartsWith("#")?new xt([],{}):new xt([],this.parseChildren())}parseQueryParams(){const e={};if(this.consumeOptional("?"))do{this.parseQueryParam(e)}while(this.consumeOptional("&"));return e}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(""===this.remaining)return{};this.consumeOptional("/");const e=[];for(this.peekStartsWith("(")||e.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),e.push(this.parseSegment());let t={};this.peekStartsWith("/(")&&(this.capture("/"),t=this.parseParens(!0));let i={};return this.peekStartsWith("(")&&(i=this.parseParens(!1)),(e.length>0||Object.keys(t).length>0)&&(i[_t]=new xt(e,t)),i}parseSegment(){const e=Bp(this.remaining);if(""===e&&this.peekStartsWith(";"))throw new K(4009,kp);return this.capture(e),new Ph(Vp(e),this.parseMatrixParams())}parseMatrixParams(){const e={};for(;this.consumeOptional(";");)this.parseParam(e);return e}parseParam(e){const t=Bp(this.remaining);if(!t)return;this.capture(t);let i="";if(this.consumeOptional("=")){const r=Bp(this.remaining);r&&(i=r,this.capture(i))}e[Vp(t)]=Vp(i)}parseQueryParam(e){const t=function ij(n){const e=n.match(nj);return e?e[0]:""}(this.remaining);if(!t)return;this.capture(t);let i="";if(this.consumeOptional("=")){const o=function sj(n){const e=n.match(rj);return e?e[0]:""}(this.remaining);o&&(i=o,this.capture(i))}const r=xI(t),s=xI(i);if(e.hasOwnProperty(r)){let o=e[r];Array.isArray(o)||(o=[o],e[r]=o),o.push(s)}else e[r]=s}parseParens(e){const t={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){const i=Bp(this.remaining),r=this.remaining[i.length];if("/"!==r&&")"!==r&&";"!==r)throw new K(4010,kp);let s;i.indexOf(":")>-1?(s=i.slice(0,i.indexOf(":")),this.capture(s),this.capture(":")):e&&(s=_t);const o=this.parseChildren();t[s]=1===Object.keys(o).length?o[_t]:new xt([],o),this.consumeOptional("//")}return t}peekStartsWith(e){return this.remaining.startsWith(e)}consumeOptional(e){return!!this.peekStartsWith(e)&&(this.remaining=this.remaining.substring(e.length),!0)}capture(e){if(!this.consumeOptional(e))throw new K(4011,kp)}}function Z0(n){return n.segments.length>0?new xt([],{[_t]:n}):n}function Up(n){const e={};for(const i of Object.keys(n.children)){const s=Up(n.children[i]);(s.segments.length>0||s.hasChildren())&&(e[i]=s)}return function aj(n){if(1===n.numberOfChildren&&n.children[_t]){const e=n.children[_t];return new xt(n.segments.concat(e.segments),e.children)}return n}(new xt(n.segments,e))}function Ia(n){return n instanceof Ta}function uj(n,e,t,i,r){if(0===t.length)return hl(e.root,e.root,e.root,i,r);const s=function SI(n){if("string"==typeof n[0]&&1===n.length&&"/"===n[0])return new CI(!0,0,n);let e=0,t=!1;const i=n.reduce((r,s,o)=>{if("object"==typeof s&&null!=s){if(s.outlets){const a={};return ai(s.outlets,(c,l)=>{a[l]="string"==typeof c?c.split("/"):c}),[...r,{outlets:a}]}if(s.segmentPath)return[...r,s.segmentPath]}return"string"!=typeof s?[...r,s]:0===o?(s.split("/").forEach((a,c)=>{0==c&&"."===a||(0==c&&""===a?t=!0:".."===a?e++:""!=a&&r.push(a))}),r):[...r,s]},[]);return new CI(t,e,i)}(t);return s.toRoot()?hl(e.root,e.root,new xt([],{}),i,r):function o(c){const l=function dj(n,e,t,i){if(n.isAbsolute)return new dl(e.root,!0,0);if(-1===i)return new dl(t,t===e.root,0);return function EI(n,e,t){let i=n,r=e,s=t;for(;s>r;){if(s-=r,i=i.parent,!i)throw new K(4005,!1);r=i.segments.length}return new dl(i,!1,r-s)}(t,i+(Oh(n.commands[0])?0:1),n.numberOfDoubleDots)}(s,e,n.snapshot?._urlSegment,c),u=l.processChildren?Lh(l.segmentGroup,l.index,s.commands):J0(l.segmentGroup,l.index,s.commands);return hl(e.root,l.segmentGroup,u,i,r)}(n.snapshot?._lastPathIndex)}function Oh(n){return"object"==typeof n&&null!=n&&!n.outlets&&!n.segmentPath}function kh(n){return"object"==typeof n&&null!=n&&n.outlets}function hl(n,e,t,i,r){let o,s={};i&&ai(i,(c,l)=>{s[l]=Array.isArray(c)?c.map(u=>`${u}`):`${c}`}),o=n===e?t:MI(n,e,t);const a=Z0(Up(o));return new Ta(a,s,r)}function MI(n,e,t){const i={};return ai(n.children,(r,s)=>{i[s]=r===e?t:MI(r,e,t)}),new xt(n.segments,i)}class CI{constructor(e,t,i){if(this.isAbsolute=e,this.numberOfDoubleDots=t,this.commands=i,e&&i.length>0&&Oh(i[0]))throw new K(4003,!1);const r=i.find(kh);if(r&&r!==fI(i))throw new K(4004,!1)}toRoot(){return this.isAbsolute&&1===this.commands.length&&"/"==this.commands[0]}}class dl{constructor(e,t,i){this.segmentGroup=e,this.processChildren=t,this.index=i}}function J0(n,e,t){if(n||(n=new xt([],{})),0===n.segments.length&&n.hasChildren())return Lh(n,e,t);const i=function pj(n,e,t){let i=0,r=e;const s={match:!1,pathIndex:0,commandIndex:0};for(;r<n.segments.length;){if(i>=t.length)return s;const o=n.segments[r],a=t[i];if(kh(a))break;const c=`${a}`,l=i<t.length-1?t[i+1]:null;if(r>0&&void 0===c)break;if(c&&l&&"object"==typeof l&&void 0===l.outlets){if(!TI(c,l,o))return s;i+=2}else{if(!TI(c,{},o))return s;i++}r++}return{match:!0,pathIndex:r,commandIndex:i}}(n,e,t),r=t.slice(i.commandIndex);if(i.match&&i.pathIndex<n.segments.length){const s=new xt(n.segments.slice(0,i.pathIndex),{});return s.children[_t]=new xt(n.segments.slice(i.pathIndex),n.children),Lh(s,0,r)}return i.match&&0===r.length?new xt(n.segments,{}):i.match&&!n.hasChildren()?Q0(n,e,t):i.match?Lh(n,0,r):Q0(n,e,t)}function Lh(n,e,t){if(0===t.length)return new xt(n.segments,{});{const i=function fj(n){return kh(n[0])?n[0].outlets:{[_t]:n}}(t),r={};return ai(i,(s,o)=>{"string"==typeof s&&(s=[s]),null!==s&&(r[o]=J0(n.children[o],e,s))}),ai(n.children,(s,o)=>{void 0===i[o]&&(r[o]=s)}),new xt(n.segments,r)}}function Q0(n,e,t){const i=n.segments.slice(0,e);let r=0;for(;r<t.length;){const s=t[r];if(kh(s)){const c=mj(s.outlets);return new xt(i,c)}if(0===r&&Oh(t[0])){i.push(new Ph(n.segments[e].path,DI(t[0]))),r++;continue}const o=kh(s)?s.outlets[_t]:`${s}`,a=r<t.length-1?t[r+1]:null;o&&a&&Oh(a)?(i.push(new Ph(o,DI(a))),r+=2):(i.push(new Ph(o,{})),r++)}return new xt(i,{})}function mj(n){const e={};return ai(n,(t,i)=>{"string"==typeof t&&(t=[t]),null!==t&&(e[i]=Q0(new xt([],{}),0,t))}),e}function DI(n){const e={};return ai(n,(t,i)=>e[i]=`${t}`),e}function TI(n,e,t){return n==t.path&&gs(e,t.parameters)}class Ys{constructor(e,t){this.id=e,this.url=t}}class eb extends Ys{constructor(e,t,i="imperative",r=null){super(e,t),this.type=0,this.navigationTrigger=i,this.restoredState=r}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}}class To extends Ys{constructor(e,t,i){super(e,t),this.urlAfterRedirects=i,this.type=1}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}}class zp extends Ys{constructor(e,t,i,r){super(e,t),this.reason=i,this.code=r,this.type=2}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}}class AI extends Ys{constructor(e,t,i,r){super(e,t),this.error=i,this.target=r,this.type=3}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}}class gj extends Ys{constructor(e,t,i,r){super(e,t),this.urlAfterRedirects=i,this.state=r,this.type=4}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class _j extends Ys{constructor(e,t,i,r){super(e,t),this.urlAfterRedirects=i,this.state=r,this.type=7}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class yj extends Ys{constructor(e,t,i,r,s){super(e,t),this.urlAfterRedirects=i,this.state=r,this.shouldActivate=s,this.type=8}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}}class vj extends Ys{constructor(e,t,i,r){super(e,t),this.urlAfterRedirects=i,this.state=r,this.type=5}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class bj extends Ys{constructor(e,t,i,r){super(e,t),this.urlAfterRedirects=i,this.state=r,this.type=6}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class xj{constructor(e){this.route=e,this.type=9}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}}class wj{constructor(e){this.route=e,this.type=10}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}}class Mj{constructor(e){this.snapshot=e,this.type=11}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class Cj{constructor(e){this.snapshot=e,this.type=12}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class Sj{constructor(e){this.snapshot=e,this.type=13}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class Ej{constructor(e){this.snapshot=e,this.type=14}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class II{constructor(e,t,i){this.routerEvent=e,this.position=t,this.anchor=i,this.type=15}toString(){return`Scroll(anchor: '${this.anchor}', position: '${this.position?`${this.position[0]}, ${this.position[1]}`:null}')`}}class PI{constructor(e){this._root=e}get root(){return this._root.value}parent(e){const t=this.pathFromRoot(e);return t.length>1?t[t.length-2]:null}children(e){const t=tb(e,this._root);return t?t.children.map(i=>i.value):[]}firstChild(e){const t=tb(e,this._root);return t&&t.children.length>0?t.children[0].value:null}siblings(e){const t=nb(e,this._root);return t.length<2?[]:t[t.length-2].children.map(r=>r.value).filter(r=>r!==e)}pathFromRoot(e){return nb(e,this._root).map(t=>t.value)}}function tb(n,e){if(n===e.value)return e;for(const t of e.children){const i=tb(n,t);if(i)return i}return null}function nb(n,e){if(n===e.value)return[e];for(const t of e.children){const i=nb(n,t);if(i.length)return i.unshift(e),i}return[]}class Zs{constructor(e,t){this.value=e,this.children=t}toString(){return`TreeNode(${this.value})`}}function fl(n){const e={};return n&&n.children.forEach(t=>e[t.value.outlet]=t),e}class RI extends PI{constructor(e,t){super(e),this.snapshot=t,ib(this,e)}toString(){return this.snapshot.toString()}}function OI(n,e){const t=function Tj(n,e){const o=new Hp([],{},{},"",{},_t,e,null,n.root,-1,{});return new LI("",new Zs(o,[]))}(n,e),i=new Zr([new Ph("",{})]),r=new Zr({}),s=new Zr({}),o=new Zr({}),a=new Zr(""),c=new _s(i,r,o,a,s,_t,e,t.root);return c.snapshot=t.root,new RI(new Zs(c,[]),t)}class _s{constructor(e,t,i,r,s,o,a,c){this.url=e,this.params=t,this.queryParams=i,this.fragment=r,this.data=s,this.outlet=o,this.component=a,this.title=this.data?.pipe(tt(l=>l[Ih]))??Ve(void 0),this._futureSnapshot=c}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=this.params.pipe(tt(e=>ul(e)))),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=this.queryParams.pipe(tt(e=>ul(e)))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}}function kI(n,e="emptyOnly"){const t=n.pathFromRoot;let i=0;if("always"!==e)for(i=t.length-1;i>=1;){const r=t[i],s=t[i-1];if(r.routeConfig&&""===r.routeConfig.path)i--;else{if(s.component)break;i--}}return function Aj(n){return n.reduce((e,t)=>({params:{...e.params,...t.params},data:{...e.data,...t.data},resolve:{...t.data,...e.resolve,...t.routeConfig?.data,...t._resolvedData}}),{params:{},data:{},resolve:{}})}(t.slice(i))}class Hp{constructor(e,t,i,r,s,o,a,c,l,u,h){this.url=e,this.params=t,this.queryParams=i,this.fragment=r,this.data=s,this.outlet=o,this.component=a,this.routeConfig=c,this._urlSegment=l,this._lastPathIndex=u,this._resolve=h}get title(){return this.data?.[Ih]}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=ul(this.params)),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=ul(this.queryParams)),this._queryParamMap}toString(){return`Route(url:'${this.url.map(i=>i.toString()).join("/")}', path:'${this.routeConfig?this.routeConfig.path:""}')`}}class LI extends PI{constructor(e,t){super(t),this.url=e,ib(this,t)}toString(){return NI(this._root)}}function ib(n,e){e.value._routerState=n,e.children.forEach(t=>ib(n,t))}function NI(n){const e=n.children.length>0?` { ${n.children.map(NI).join(", ")} } `:"";return`${n.value}${e}`}function rb(n){if(n.snapshot){const e=n.snapshot,t=n._futureSnapshot;n.snapshot=t,gs(e.queryParams,t.queryParams)||n.queryParams.next(t.queryParams),e.fragment!==t.fragment&&n.fragment.next(t.fragment),gs(e.params,t.params)||n.params.next(t.params),function W6(n,e){if(n.length!==e.length)return!1;for(let t=0;t<n.length;++t)if(!gs(n[t],e[t]))return!1;return!0}(e.url,t.url)||n.url.next(t.url),gs(e.data,t.data)||n.data.next(t.data)}else n.snapshot=n._futureSnapshot,n.data.next(n._futureSnapshot.data)}function sb(n,e){const t=gs(n.params,e.params)&&function Y6(n,e){return Aa(n,e)&&n.every((t,i)=>gs(t.parameters,e[i].parameters))}(n.url,e.url);return t&&!(!n.parent!=!e.parent)&&(!n.parent||sb(n.parent,e.parent))}function Nh(n,e,t){if(t&&n.shouldReuseRoute(e.value,t.value.snapshot)){const i=t.value;i._futureSnapshot=e.value;const r=function Pj(n,e,t){return e.children.map(i=>{for(const r of t.children)if(n.shouldReuseRoute(i.value,r.value.snapshot))return Nh(n,i,r);return Nh(n,i)})}(n,e,t);return new Zs(i,r)}{if(n.shouldAttach(e.value)){const s=n.retrieve(e.value);if(null!==s){const o=s.route;return o.value._futureSnapshot=e.value,o.children=e.children.map(a=>Nh(n,a)),o}}const i=function Rj(n){return new _s(new Zr(n.url),new Zr(n.params),new Zr(n.queryParams),new Zr(n.fragment),new Zr(n.data),n.outlet,n.component,n)}(e.value),r=e.children.map(s=>Nh(n,s));return new Zs(i,r)}}const ob="ngNavigationCancelingError";function FI(n,e){const{redirectTo:t,navigationBehaviorOptions:i}=Ia(e)?{redirectTo:e,navigationBehaviorOptions:void 0}:e,r=VI(!1,0,e);return r.url=t,r.navigationBehaviorOptions=i,r}function VI(n,e,t){const i=new Error("NavigationCancelingError: "+(n||""));return i[ob]=!0,i.cancellationCode=e,t&&(i.url=t),i}function BI(n){return UI(n)&&Ia(n.url)}function UI(n){return n&&n[ob]}class Oj{constructor(){this.outlet=null,this.route=null,this.resolver=null,this.injector=null,this.children=new Fh,this.attachRef=null}}let Fh=(()=>{class n{constructor(){this.contexts=new Map}onChildOutletCreated(t,i){const r=this.getOrCreateContext(t);r.outlet=i,this.contexts.set(t,r)}onChildOutletDestroyed(t){const i=this.getContext(t);i&&(i.outlet=null,i.attachRef=null)}onOutletDeactivated(){const t=this.contexts;return this.contexts=new Map,t}onOutletReAttached(t){this.contexts=t}getOrCreateContext(t){let i=this.getContext(t);return i||(i=new Oj,this.contexts.set(t,i)),i}getContext(t){return this.contexts.get(t)||null}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=Te({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();const Gp=!1;let ab=(()=>{class n{constructor(){this.activated=null,this._activatedRoute=null,this.name=_t,this.activateEvents=new sn,this.deactivateEvents=new sn,this.attachEvents=new sn,this.detachEvents=new sn,this.parentContexts=Ot(Fh),this.location=Ot($r),this.changeDetector=Ot(Mo),this.environmentInjector=Ot(vo)}ngOnChanges(t){if(t.name){const{firstChange:i,previousValue:r}=t.name;if(i)return;this.isTrackedInParentContexts(r)&&(this.deactivate(),this.parentContexts.onChildOutletDestroyed(r)),this.initializeOutletWithName()}}ngOnDestroy(){this.isTrackedInParentContexts(this.name)&&this.parentContexts.onChildOutletDestroyed(this.name)}isTrackedInParentContexts(t){return this.parentContexts.getContext(t)?.outlet===this}ngOnInit(){this.initializeOutletWithName()}initializeOutletWithName(){if(this.parentContexts.onChildOutletCreated(this.name,this),this.activated)return;const t=this.parentContexts.getContext(this.name);t?.route&&(t.attachRef?this.attach(t.attachRef,t.route):this.activateWith(t.route,t.injector))}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new K(4012,Gp);return this.activated.instance}get activatedRoute(){if(!this.activated)throw new K(4012,Gp);return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new K(4012,Gp);this.location.detach();const t=this.activated;return this.activated=null,this._activatedRoute=null,this.detachEvents.emit(t.instance),t}attach(t,i){this.activated=t,this._activatedRoute=i,this.location.insert(t.hostView),this.attachEvents.emit(t.instance)}deactivate(){if(this.activated){const t=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(t)}}activateWith(t,i){if(this.isActivated)throw new K(4013,Gp);this._activatedRoute=t;const r=this.location,o=t._futureSnapshot.component,a=this.parentContexts.getOrCreateContext(this.name).children,c=new kj(t,a,r.injector);if(i&&function Lj(n){return!!n.resolveComponentFactory}(i)){const l=i.resolveComponentFactory(o);this.activated=r.createComponent(l,r.length,c)}else this.activated=r.createComponent(o,{index:r.length,injector:c,environmentInjector:i??this.environmentInjector});this.changeDetector.markForCheck(),this.activateEvents.emit(this.activated.instance)}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275dir=Ke({type:n,selectors:[["router-outlet"]],inputs:{name:"name"},outputs:{activateEvents:"activate",deactivateEvents:"deactivate",attachEvents:"attach",detachEvents:"detach"},exportAs:["outlet"],standalone:!0,features:[_r]}),n})();class kj{constructor(e,t,i){this.route=e,this.childContexts=t,this.parent=i}get(e,t){return e===_s?this.route:e===Fh?this.childContexts:this.parent.get(e,t)}}let cb=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=ii({type:n,selectors:[["ng-component"]],standalone:!0,features:[qD],decls:1,vars:0,template:function(t,i){1&t&&it(0,"router-outlet")},dependencies:[ab],encapsulation:2}),n})();function zI(n,e){return n.providers&&!n._injector&&(n._injector=np(n.providers,e,`Route: ${n.path}`)),n._injector??e}function ub(n){const e=n.children&&n.children.map(ub),t=e?{...n,children:e}:{...n};return!t.component&&!t.loadComponent&&(e||t.loadChildren)&&t.outlet&&t.outlet!==_t&&(t.component=cb),t}function Cr(n){return n.outlet||_t}function HI(n,e){const t=n.filter(i=>Cr(i)===e);return t.push(...n.filter(i=>Cr(i)!==e)),t}function Vh(n){if(!n)return null;if(n.routeConfig?._injector)return n.routeConfig._injector;for(let e=n.parent;e;e=e.parent){const t=e.routeConfig;if(t?._loadedInjector)return t._loadedInjector;if(t?._injector)return t._injector}return null}class Uj{constructor(e,t,i,r){this.routeReuseStrategy=e,this.futureState=t,this.currState=i,this.forwardEvent=r}activate(e){const t=this.futureState._root,i=this.currState?this.currState._root:null;this.deactivateChildRoutes(t,i,e),rb(this.futureState.root),this.activateChildRoutes(t,i,e)}deactivateChildRoutes(e,t,i){const r=fl(t);e.children.forEach(s=>{const o=s.value.outlet;this.deactivateRoutes(s,r[o],i),delete r[o]}),ai(r,(s,o)=>{this.deactivateRouteAndItsChildren(s,i)})}deactivateRoutes(e,t,i){const r=e.value,s=t?t.value:null;if(r===s)if(r.component){const o=i.getContext(r.outlet);o&&this.deactivateChildRoutes(e,t,o.children)}else this.deactivateChildRoutes(e,t,i);else s&&this.deactivateRouteAndItsChildren(t,i)}deactivateRouteAndItsChildren(e,t){e.value.component&&this.routeReuseStrategy.shouldDetach(e.value.snapshot)?this.detachAndStoreRouteSubtree(e,t):this.deactivateRouteAndOutlet(e,t)}detachAndStoreRouteSubtree(e,t){const i=t.getContext(e.value.outlet),r=i&&e.value.component?i.children:t,s=fl(e);for(const o of Object.keys(s))this.deactivateRouteAndItsChildren(s[o],r);if(i&&i.outlet){const o=i.outlet.detach(),a=i.children.onOutletDeactivated();this.routeReuseStrategy.store(e.value.snapshot,{componentRef:o,route:e,contexts:a})}}deactivateRouteAndOutlet(e,t){const i=t.getContext(e.value.outlet),r=i&&e.value.component?i.children:t,s=fl(e);for(const o of Object.keys(s))this.deactivateRouteAndItsChildren(s[o],r);i&&i.outlet&&(i.outlet.deactivate(),i.children.onOutletDeactivated(),i.attachRef=null,i.resolver=null,i.route=null)}activateChildRoutes(e,t,i){const r=fl(t);e.children.forEach(s=>{this.activateRoutes(s,r[s.value.outlet],i),this.forwardEvent(new Ej(s.value.snapshot))}),e.children.length&&this.forwardEvent(new Cj(e.value.snapshot))}activateRoutes(e,t,i){const r=e.value,s=t?t.value:null;if(rb(r),r===s)if(r.component){const o=i.getOrCreateContext(r.outlet);this.activateChildRoutes(e,t,o.children)}else this.activateChildRoutes(e,t,i);else if(r.component){const o=i.getOrCreateContext(r.outlet);if(this.routeReuseStrategy.shouldAttach(r.snapshot)){const a=this.routeReuseStrategy.retrieve(r.snapshot);this.routeReuseStrategy.store(r.snapshot,null),o.children.onOutletReAttached(a.contexts),o.attachRef=a.componentRef,o.route=a.route.value,o.outlet&&o.outlet.attach(a.componentRef,a.route.value),rb(a.route.value),this.activateChildRoutes(e,null,o.children)}else{const a=Vh(r.snapshot),c=a?.get(ih)??null;o.attachRef=null,o.route=r,o.resolver=c,o.injector=a,o.outlet&&o.outlet.activateWith(r,o.injector),this.activateChildRoutes(e,null,o.children)}}else this.activateChildRoutes(e,null,i)}}class GI{constructor(e){this.path=e,this.route=this.path[this.path.length-1]}}class jp{constructor(e,t){this.component=e,this.route=t}}function zj(n,e,t){const i=n._root;return Bh(i,e?e._root:null,t,[i.value])}function pl(n,e){const t=Symbol(),i=e.get(n,t);return i===t?"function"!=typeof n||function C2(n){return null!==rf(n)}(n)?e.get(n):n:i}function Bh(n,e,t,i,r={canDeactivateChecks:[],canActivateChecks:[]}){const s=fl(e);return n.children.forEach(o=>{(function Gj(n,e,t,i,r={canDeactivateChecks:[],canActivateChecks:[]}){const s=n.value,o=e?e.value:null,a=t?t.getContext(n.value.outlet):null;if(o&&s.routeConfig===o.routeConfig){const c=function jj(n,e,t){if("function"==typeof t)return t(n,e);switch(t){case"pathParamsChange":return!Aa(n.url,e.url);case"pathParamsOrQueryParamsChange":return!Aa(n.url,e.url)||!gs(n.queryParams,e.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!sb(n,e)||!gs(n.queryParams,e.queryParams);default:return!sb(n,e)}}(o,s,s.routeConfig.runGuardsAndResolvers);c?r.canActivateChecks.push(new GI(i)):(s.data=o.data,s._resolvedData=o._resolvedData),Bh(n,e,s.component?a?a.children:null:t,i,r),c&&a&&a.outlet&&a.outlet.isActivated&&r.canDeactivateChecks.push(new jp(a.outlet.component,o))}else o&&Uh(e,a,r),r.canActivateChecks.push(new GI(i)),Bh(n,null,s.component?a?a.children:null:t,i,r)})(o,s[o.value.outlet],t,i.concat([o.value]),r),delete s[o.value.outlet]}),ai(s,(o,a)=>Uh(o,t.getContext(a),r)),r}function Uh(n,e,t){const i=fl(n),r=n.value;ai(i,(s,o)=>{Uh(s,r.component?e?e.children.getContext(o):null:e,t)}),t.canDeactivateChecks.push(new jp(r.component&&e&&e.outlet&&e.outlet.isActivated?e.outlet.component:null,r))}function zh(n){return"function"==typeof n}function hb(n){return n instanceof Ip||"EmptyError"===n?.name}const Wp=Symbol("INITIAL_VALUE");function ml(){return ps(n=>W0(n.map(e=>e.pipe(Da(1),aI(Wp)))).pipe(tt(e=>{for(const t of e)if(!0!==t){if(t===Wp)return Wp;if(!1===t||t instanceof Ta)return t}return!0}),ms(e=>e!==Wp),Da(1)))}function jI(n){return function jF(...n){return KM(n)}(Gn(e=>{if(Ia(e))throw FI(0,e)}),tt(e=>!0===e))}const db={matched:!1,consumedSegments:[],remainingSegments:[],parameters:{},positionalParamSegments:{}};function WI(n,e,t,i,r){const s=fb(n,e,t);return s.matched?function aW(n,e,t,i){const r=e.canMatch;return r&&0!==r.length?Ve(r.map(o=>{const a=pl(o,n);return Do(function Zj(n){return n&&zh(n.canMatch)}(a)?a.canMatch(e,t):n.runInContext(()=>a(e,t)))})).pipe(ml(),jI()):Ve(!0)}(i=zI(e,i),e,t).pipe(tt(o=>!0===o?s:{...db})):Ve(s)}function fb(n,e,t){if(""===e.path)return"full"===e.pathMatch&&(n.hasChildren()||t.length>0)?{...db}:{matched:!0,consumedSegments:[],remainingSegments:t,parameters:{},positionalParamSegments:{}};const r=(e.matcher||j6)(t,n,e);if(!r)return{...db};const s={};ai(r.posParams,(a,c)=>{s[c]=a.path});const o=r.consumed.length>0?{...s,...r.consumed[r.consumed.length-1].parameters}:s;return{matched:!0,consumedSegments:r.consumed,remainingSegments:t.slice(r.consumed.length),parameters:o,positionalParamSegments:r.posParams??{}}}function $p(n,e,t,i){if(t.length>0&&function uW(n,e,t){return t.some(i=>qp(n,e,i)&&Cr(i)!==_t)}(n,t,i)){const s=new xt(e,function lW(n,e,t,i){const r={};r[_t]=i,i._sourceSegment=n,i._segmentIndexShift=e.length;for(const s of t)if(""===s.path&&Cr(s)!==_t){const o=new xt([],{});o._sourceSegment=n,o._segmentIndexShift=e.length,r[Cr(s)]=o}return r}(n,e,i,new xt(t,n.children)));return s._sourceSegment=n,s._segmentIndexShift=e.length,{segmentGroup:s,slicedSegments:[]}}if(0===t.length&&function hW(n,e,t){return t.some(i=>qp(n,e,i))}(n,t,i)){const s=new xt(n.segments,function cW(n,e,t,i,r){const s={};for(const o of i)if(qp(n,t,o)&&!r[Cr(o)]){const a=new xt([],{});a._sourceSegment=n,a._segmentIndexShift=e.length,s[Cr(o)]=a}return{...r,...s}}(n,e,t,i,n.children));return s._sourceSegment=n,s._segmentIndexShift=e.length,{segmentGroup:s,slicedSegments:t}}const r=new xt(n.segments,n.children);return r._sourceSegment=n,r._segmentIndexShift=e.length,{segmentGroup:r,slicedSegments:t}}function qp(n,e,t){return(!(n.hasChildren()||e.length>0)||"full"!==t.pathMatch)&&""===t.path}function $I(n,e,t,i){return!!(Cr(n)===i||i!==_t&&qp(e,t,n))&&("**"===n.path||fb(e,n,t).matched)}function qI(n,e,t){return 0===e.length&&!n.children[t]}const Xp=!1;class Yp{constructor(e){this.segmentGroup=e||null}}class XI{constructor(e){this.urlTree=e}}function Hh(n){return ll(new Yp(n))}function YI(n){return ll(new XI(n))}class mW{constructor(e,t,i,r,s){this.injector=e,this.configLoader=t,this.urlSerializer=i,this.urlTree=r,this.config=s,this.allowRedirects=!0}apply(){const e=$p(this.urlTree.root,[],[],this.config).segmentGroup,t=new xt(e.segments,e.children);return this.expandSegmentGroup(this.injector,this.config,t,_t).pipe(tt(s=>this.createUrlTree(Up(s),this.urlTree.queryParams,this.urlTree.fragment))).pipe(Xs(s=>{if(s instanceof XI)return this.allowRedirects=!1,this.match(s.urlTree);throw s instanceof Yp?this.noMatchError(s):s}))}match(e){return this.expandSegmentGroup(this.injector,this.config,e.root,_t).pipe(tt(r=>this.createUrlTree(Up(r),e.queryParams,e.fragment))).pipe(Xs(r=>{throw r instanceof Yp?this.noMatchError(r):r}))}noMatchError(e){return new K(4002,Xp)}createUrlTree(e,t,i){const r=Z0(e);return new Ta(r,t,i)}expandSegmentGroup(e,t,i,r){return 0===i.segments.length&&i.hasChildren()?this.expandChildren(e,t,i).pipe(tt(s=>new xt([],s))):this.expandSegment(e,i,t,i.segments,r,!0)}expandChildren(e,t,i){const r=[];for(const s of Object.keys(i.children))"primary"===s?r.unshift(s):r.push(s);return Pn(r).pipe(Eo(s=>{const o=i.children[s],a=HI(t,s);return this.expandSegmentGroup(e,a,o,s).pipe(tt(c=>({segment:c,outlet:s})))}),lI((s,o)=>(s[o.outlet]=o.segment,s),{}),uI())}expandSegment(e,t,i,r,s,o){return Pn(i).pipe(Eo(a=>this.expandSegmentAgainstRoute(e,t,i,a,r,s,o).pipe(Xs(l=>{if(l instanceof Yp)return Ve(null);throw l}))),So(a=>!!a),Xs((a,c)=>{if(hb(a))return qI(t,r,s)?Ve(new xt([],{})):Hh(t);throw a}))}expandSegmentAgainstRoute(e,t,i,r,s,o,a){return $I(r,t,s,o)?void 0===r.redirectTo?this.matchSegmentAgainstRoute(e,t,r,s,o):a&&this.allowRedirects?this.expandSegmentAgainstRouteUsingRedirect(e,t,i,r,s,o):Hh(t):Hh(t)}expandSegmentAgainstRouteUsingRedirect(e,t,i,r,s,o){return"**"===r.path?this.expandWildCardWithParamsAgainstRouteUsingRedirect(e,i,r,o):this.expandRegularSegmentAgainstRouteUsingRedirect(e,t,i,r,s,o)}expandWildCardWithParamsAgainstRouteUsingRedirect(e,t,i,r){const s=this.applyRedirectCommands([],i.redirectTo,{});return i.redirectTo.startsWith("/")?YI(s):this.lineralizeSegments(i,s).pipe(ni(o=>{const a=new xt(o,{});return this.expandSegment(e,a,t,o,r,!1)}))}expandRegularSegmentAgainstRouteUsingRedirect(e,t,i,r,s,o){const{matched:a,consumedSegments:c,remainingSegments:l,positionalParamSegments:u}=fb(t,r,s);if(!a)return Hh(t);const h=this.applyRedirectCommands(c,r.redirectTo,u);return r.redirectTo.startsWith("/")?YI(h):this.lineralizeSegments(r,h).pipe(ni(d=>this.expandSegment(e,t,i,d.concat(l),o,!1)))}matchSegmentAgainstRoute(e,t,i,r,s){return"**"===i.path?(e=zI(i,e),i.loadChildren?(i._loadedRoutes?Ve({routes:i._loadedRoutes,injector:i._loadedInjector}):this.configLoader.loadChildren(e,i)).pipe(tt(a=>(i._loadedRoutes=a.routes,i._loadedInjector=a.injector,new xt(r,{})))):Ve(new xt(r,{}))):WI(t,i,r,e).pipe(ps(({matched:o,consumedSegments:a,remainingSegments:c})=>o?this.getChildConfig(e=i._injector??e,i,r).pipe(ni(u=>{const h=u.injector??e,d=u.routes,{segmentGroup:f,slicedSegments:p}=$p(t,a,c,d),m=new xt(f.segments,f.children);if(0===p.length&&m.hasChildren())return this.expandChildren(h,d,m).pipe(tt(y=>new xt(a,y)));if(0===d.length&&0===p.length)return Ve(new xt(a,{}));const g=Cr(i)===s;return this.expandSegment(h,m,d,p,g?_t:s,!0).pipe(tt(b=>new xt(a.concat(b.segments),b.children)))})):Hh(t)))}getChildConfig(e,t,i){return t.children?Ve({routes:t.children,injector:e}):t.loadChildren?void 0!==t._loadedRoutes?Ve({routes:t._loadedRoutes,injector:t._loadedInjector}):function oW(n,e,t,i){const r=e.canLoad;return void 0===r||0===r.length?Ve(!0):Ve(r.map(o=>{const a=pl(o,n);return Do(function $j(n){return n&&zh(n.canLoad)}(a)?a.canLoad(e,t):n.runInContext(()=>a(e,t)))})).pipe(ml(),jI())}(e,t,i).pipe(ni(r=>r?this.configLoader.loadChildren(e,t).pipe(Gn(s=>{t._loadedRoutes=s.routes,t._loadedInjector=s.injector})):function fW(n){return ll(VI(Xp,3))}())):Ve({routes:[],injector:e})}lineralizeSegments(e,t){let i=[],r=t.root;for(;;){if(i=i.concat(r.segments),0===r.numberOfChildren)return Ve(i);if(r.numberOfChildren>1||!r.children[_t])return ll(new K(4e3,Xp));r=r.children[_t]}}applyRedirectCommands(e,t,i){return this.applyRedirectCreateUrlTree(t,this.urlSerializer.parse(t),e,i)}applyRedirectCreateUrlTree(e,t,i,r){const s=this.createSegmentGroup(e,t.root,i,r);return new Ta(s,this.createQueryParams(t.queryParams,this.urlTree.queryParams),t.fragment)}createQueryParams(e,t){const i={};return ai(e,(r,s)=>{if("string"==typeof r&&r.startsWith(":")){const a=r.substring(1);i[s]=t[a]}else i[s]=r}),i}createSegmentGroup(e,t,i,r){const s=this.createSegments(e,t.segments,i,r);let o={};return ai(t.children,(a,c)=>{o[c]=this.createSegmentGroup(e,a,i,r)}),new xt(s,o)}createSegments(e,t,i,r){return t.map(s=>s.path.startsWith(":")?this.findPosParam(e,s,r):this.findOrReturn(s,i))}findPosParam(e,t,i){const r=i[t.path.substring(1)];if(!r)throw new K(4001,Xp);return r}findOrReturn(e,t){let i=0;for(const r of t){if(r.path===e.path)return t.splice(i),r;i++}return e}}class _W{}class bW{constructor(e,t,i,r,s,o,a){this.injector=e,this.rootComponentType=t,this.config=i,this.urlTree=r,this.url=s,this.paramsInheritanceStrategy=o,this.urlSerializer=a}recognize(){const e=$p(this.urlTree.root,[],[],this.config.filter(t=>void 0===t.redirectTo)).segmentGroup;return this.processSegmentGroup(this.injector,this.config,e,_t).pipe(tt(t=>{if(null===t)return null;const i=new Hp([],Object.freeze({}),Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,{},_t,this.rootComponentType,null,this.urlTree.root,-1,{}),r=new Zs(i,t),s=new LI(this.url,r);return this.inheritParamsAndData(s._root),s}))}inheritParamsAndData(e){const t=e.value,i=kI(t,this.paramsInheritanceStrategy);t.params=Object.freeze(i.params),t.data=Object.freeze(i.data),e.children.forEach(r=>this.inheritParamsAndData(r))}processSegmentGroup(e,t,i,r){return 0===i.segments.length&&i.hasChildren()?this.processChildren(e,t,i):this.processSegment(e,t,i,i.segments,r)}processChildren(e,t,i){return Pn(Object.keys(i.children)).pipe(Eo(r=>{const s=i.children[r],o=HI(t,r);return this.processSegmentGroup(e,o,s,r)}),lI((r,s)=>r&&s?(r.push(...s),r):null),function z6(n,e=!1){return In((t,i)=>{let r=0;t.subscribe(Cn(i,s=>{const o=n(s,r++);(o||e)&&i.next(s),!o&&i.complete()}))})}(r=>null!==r),Rp(null),uI(),tt(r=>{if(null===r)return null;const s=KI(r);return function xW(n){n.sort((e,t)=>e.value.outlet===_t?-1:t.value.outlet===_t?1:e.value.outlet.localeCompare(t.value.outlet))}(s),s}))}processSegment(e,t,i,r,s){return Pn(t).pipe(Eo(o=>this.processSegmentAgainstRoute(o._injector??e,o,i,r,s)),So(o=>!!o),Xs(o=>{if(hb(o))return qI(i,r,s)?Ve([]):Ve(null);throw o}))}processSegmentAgainstRoute(e,t,i,r,s){if(t.redirectTo||!$I(t,i,r,s))return Ve(null);let o;if("**"===t.path){const a=r.length>0?fI(r).parameters:{},c=QI(i)+r.length;o=Ve({snapshot:new Hp(r,a,Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,eP(t),Cr(t),t.component??t._loadedComponent??null,t,JI(i),c,tP(t)),consumedSegments:[],remainingSegments:[]})}else o=WI(i,t,r,e).pipe(tt(({matched:a,consumedSegments:c,remainingSegments:l,parameters:u})=>{if(!a)return null;const h=QI(i)+c.length;return{snapshot:new Hp(c,u,Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,eP(t),Cr(t),t.component??t._loadedComponent??null,t,JI(i),h,tP(t)),consumedSegments:c,remainingSegments:l}}));return o.pipe(ps(a=>{if(null===a)return Ve(null);const{snapshot:c,consumedSegments:l,remainingSegments:u}=a;e=t._injector??e;const h=t._loadedInjector??e,d=function wW(n){return n.children?n.children:n.loadChildren?n._loadedRoutes:[]}(t),{segmentGroup:f,slicedSegments:p}=$p(i,l,u,d.filter(g=>void 0===g.redirectTo));if(0===p.length&&f.hasChildren())return this.processChildren(h,d,f).pipe(tt(g=>null===g?null:[new Zs(c,g)]));if(0===d.length&&0===p.length)return Ve([new Zs(c,[])]);const m=Cr(t)===s;return this.processSegment(h,d,f,p,m?_t:s).pipe(tt(g=>null===g?null:[new Zs(c,g)]))}))}}function MW(n){const e=n.value.routeConfig;return e&&""===e.path&&void 0===e.redirectTo}function KI(n){const e=[],t=new Set;for(const i of n){if(!MW(i)){e.push(i);continue}const r=e.find(s=>i.value.routeConfig===s.value.routeConfig);void 0!==r?(r.children.push(...i.children),t.add(r)):e.push(i)}for(const i of t){const r=KI(i.children);e.push(new Zs(i.value,r))}return e.filter(i=>!t.has(i))}function JI(n){let e=n;for(;e._sourceSegment;)e=e._sourceSegment;return e}function QI(n){let e=n,t=e._segmentIndexShift??0;for(;e._sourceSegment;)e=e._sourceSegment,t+=e._segmentIndexShift??0;return t-1}function eP(n){return n.data||{}}function tP(n){return n.resolve||{}}function nP(n){return"string"==typeof n.title||null===n.title}function pb(n){return ps(e=>{const t=n(e);return t?Pn(t).pipe(tt(()=>e)):Ve(e)})}let iP=(()=>{class n{buildTitle(t){let i,r=t.root;for(;void 0!==r;)i=this.getResolvedTitleForRoute(r)??i,r=r.children.find(s=>s.outlet===_t);return i}getResolvedTitleForRoute(t){return t.data[Ih]}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=Te({token:n,factory:function(){return Ot(rP)},providedIn:"root"}),n})(),rP=(()=>{class n extends iP{constructor(t){super(),this.title=t}updateTitle(t){const i=this.buildTitle(t);void 0!==i&&this.title.setTitle(i)}}return n.\u0275fac=function(t){return new(t||n)(le(KA))},n.\u0275prov=Te({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();class PW{}class RW{shouldDetach(e){return!1}store(e,t){}shouldAttach(e){return!1}retrieve(e){return null}shouldReuseRoute(e,t){return e.routeConfig===t.routeConfig}}class OW extends RW{}const Zp=new xe("",{providedIn:"root",factory:()=>({})}),gl=new xe("ROUTES");let mb=(()=>{class n{constructor(t,i){this.injector=t,this.compiler=i,this.componentLoaders=new WeakMap,this.childrenLoaders=new WeakMap}loadComponent(t){if(this.componentLoaders.get(t))return this.componentLoaders.get(t);if(t._loadedComponent)return Ve(t._loadedComponent);this.onLoadStartListener&&this.onLoadStartListener(t);const i=Do(t.loadComponent()).pipe(tt(oP),Gn(s=>{this.onLoadEndListener&&this.onLoadEndListener(t),t._loadedComponent=s}),Op(()=>{this.componentLoaders.delete(t)})),r=new oI(i,()=>new ui).pipe($0());return this.componentLoaders.set(t,r),r}loadChildren(t,i){if(this.childrenLoaders.get(i))return this.childrenLoaders.get(i);if(i._loadedRoutes)return Ve({routes:i._loadedRoutes,injector:i._loadedInjector});this.onLoadStartListener&&this.onLoadStartListener(i);const s=this.loadModuleFactoryOrRoutes(i.loadChildren).pipe(tt(a=>{this.onLoadEndListener&&this.onLoadEndListener(i);let c,l,u=!1;Array.isArray(a)?l=a:(c=a.create(t).injector,l=dI(c.get(gl,[],Ze.Self|Ze.Optional)));return{routes:l.map(ub),injector:c}}),Op(()=>{this.childrenLoaders.delete(i)})),o=new oI(s,()=>new ui).pipe($0());return this.childrenLoaders.set(i,o),o}loadModuleFactoryOrRoutes(t){return Do(t()).pipe(tt(oP),ni(r=>r instanceof WD||Array.isArray(r)?Ve(r):Pn(this.compiler.compileModuleAsync(r))))}}return n.\u0275fac=function(t){return new(t||n)(le(Ji),le(o0))},n.\u0275prov=Te({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();function oP(n){return function NW(n){return n&&"object"==typeof n&&"default"in n}(n)?n.default:n}class FW{}class VW{shouldProcessUrl(e){return!0}extract(e){return e}merge(e,t){return e}}function BW(n){throw n}function UW(n,e,t){return e.parse("/")}const zW={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},HW={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"};function aP(){const n=Ot(vI),e=Ot(Fh),t=Ot(x0),i=Ot(Ji),r=Ot(o0),s=Ot(gl,{optional:!0})??[],o=Ot(Zp,{optional:!0})??{},a=Ot(rP),c=Ot(iP,{optional:!0}),l=Ot(FW,{optional:!0}),u=Ot(PW,{optional:!0}),h=new Ln(null,n,e,t,i,r,dI(s));return l&&(h.urlHandlingStrategy=l),u&&(h.routeReuseStrategy=u),h.titleStrategy=c??a,function GW(n,e){n.errorHandler&&(e.errorHandler=n.errorHandler),n.malformedUriErrorHandler&&(e.malformedUriErrorHandler=n.malformedUriErrorHandler),n.onSameUrlNavigation&&(e.onSameUrlNavigation=n.onSameUrlNavigation),n.paramsInheritanceStrategy&&(e.paramsInheritanceStrategy=n.paramsInheritanceStrategy),n.urlUpdateStrategy&&(e.urlUpdateStrategy=n.urlUpdateStrategy),n.canceledNavigationResolution&&(e.canceledNavigationResolution=n.canceledNavigationResolution)}(o,h),h}let Ln=(()=>{class n{constructor(t,i,r,s,o,a,c){this.rootComponentType=t,this.urlSerializer=i,this.rootContexts=r,this.location=s,this.config=c,this.lastSuccessfulNavigation=null,this.currentNavigation=null,this.disposed=!1,this.navigationId=0,this.currentPageId=0,this.isNgZoneEnabled=!1,this.events=new ui,this.errorHandler=BW,this.malformedUriErrorHandler=UW,this.navigated=!1,this.lastSuccessfulId=-1,this.afterPreactivation=()=>Ve(void 0),this.urlHandlingStrategy=new VW,this.routeReuseStrategy=new OW,this.onSameUrlNavigation="ignore",this.paramsInheritanceStrategy="emptyOnly",this.urlUpdateStrategy="deferred",this.canceledNavigationResolution="replace",this.configLoader=o.get(mb),this.configLoader.onLoadEndListener=d=>this.triggerEvent(new wj(d)),this.configLoader.onLoadStartListener=d=>this.triggerEvent(new xj(d)),this.ngModule=o.get(Ca),this.console=o.get(f5);const h=o.get(on);this.isNgZoneEnabled=h instanceof on&&on.isInAngularZone(),this.resetConfig(c),this.currentUrlTree=new Ta,this.rawUrlTree=this.currentUrlTree,this.browserUrlTree=this.currentUrlTree,this.routerState=OI(this.currentUrlTree,this.rootComponentType),this.transitions=new Zr({id:0,targetPageId:0,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,extractedUrl:this.urlHandlingStrategy.extract(this.currentUrlTree),urlAfterRedirects:this.urlHandlingStrategy.extract(this.currentUrlTree),rawUrl:this.currentUrlTree,extras:{},resolve:null,reject:null,promise:Promise.resolve(!0),source:"imperative",restoredState:null,currentSnapshot:this.routerState.snapshot,targetSnapshot:null,currentRouterState:this.routerState,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null}),this.navigations=this.setupNavigations(this.transitions),this.processNavigations()}get browserPageId(){return this.location.getState()?.\u0275routerPageId}setupNavigations(t){const i=this.events;return t.pipe(ms(r=>0!==r.id),tt(r=>({...r,extractedUrl:this.urlHandlingStrategy.extract(r.rawUrl)})),ps(r=>{let s=!1,o=!1;return Ve(r).pipe(Gn(a=>{this.currentNavigation={id:a.id,initialUrl:a.rawUrl,extractedUrl:a.extractedUrl,trigger:a.source,extras:a.extras,previousNavigation:this.lastSuccessfulNavigation?{...this.lastSuccessfulNavigation,previousNavigation:null}:null}}),ps(a=>{const c=this.browserUrlTree.toString(),l=!this.navigated||a.extractedUrl.toString()!==c||c!==this.currentUrlTree.toString();if(("reload"===this.onSameUrlNavigation||l)&&this.urlHandlingStrategy.shouldProcessUrl(a.rawUrl))return cP(a.source)&&(this.browserUrlTree=a.extractedUrl),Ve(a).pipe(ps(h=>{const d=this.transitions.getValue();return i.next(new eb(h.id,this.serializeUrl(h.extractedUrl),h.source,h.restoredState)),d!==this.transitions.getValue()?Ps:Promise.resolve(h)}),function gW(n,e,t,i){return ps(r=>function pW(n,e,t,i,r){return new mW(n,e,t,i,r).apply()}(n,e,t,r.extractedUrl,i).pipe(tt(s=>({...r,urlAfterRedirects:s}))))}(this.ngModule.injector,this.configLoader,this.urlSerializer,this.config),Gn(h=>{this.currentNavigation={...this.currentNavigation,finalUrl:h.urlAfterRedirects},r.urlAfterRedirects=h.urlAfterRedirects}),function SW(n,e,t,i,r){return ni(s=>function vW(n,e,t,i,r,s,o="emptyOnly"){return new bW(n,e,t,i,r,o,s).recognize().pipe(ps(a=>null===a?function yW(n){return new Mn(e=>e.error(n))}(new _W):Ve(a)))}(n,e,t,s.urlAfterRedirects,i.serialize(s.urlAfterRedirects),i,r).pipe(tt(o=>({...s,targetSnapshot:o}))))}(this.ngModule.injector,this.rootComponentType,this.config,this.urlSerializer,this.paramsInheritanceStrategy),Gn(h=>{if(r.targetSnapshot=h.targetSnapshot,"eager"===this.urlUpdateStrategy){if(!h.extras.skipLocationChange){const f=this.urlHandlingStrategy.merge(h.urlAfterRedirects,h.rawUrl);this.setBrowserUrl(f,h)}this.browserUrlTree=h.urlAfterRedirects}const d=new gj(h.id,this.serializeUrl(h.extractedUrl),this.serializeUrl(h.urlAfterRedirects),h.targetSnapshot);i.next(d)}));if(l&&this.rawUrlTree&&this.urlHandlingStrategy.shouldProcessUrl(this.rawUrlTree)){const{id:d,extractedUrl:f,source:p,restoredState:m,extras:g}=a,_=new eb(d,this.serializeUrl(f),p,m);i.next(_);const b=OI(f,this.rootComponentType).snapshot;return Ve(r={...a,targetSnapshot:b,urlAfterRedirects:f,extras:{...g,skipLocationChange:!1,replaceUrl:!1}})}return this.rawUrlTree=a.rawUrl,a.resolve(null),Ps}),Gn(a=>{const c=new _j(a.id,this.serializeUrl(a.extractedUrl),this.serializeUrl(a.urlAfterRedirects),a.targetSnapshot);this.triggerEvent(c)}),tt(a=>r={...a,guards:zj(a.targetSnapshot,a.currentSnapshot,this.rootContexts)}),function Jj(n,e){return ni(t=>{const{targetSnapshot:i,currentSnapshot:r,guards:{canActivateChecks:s,canDeactivateChecks:o}}=t;return 0===o.length&&0===s.length?Ve({...t,guardsResult:!0}):function Qj(n,e,t,i){return Pn(n).pipe(ni(r=>function sW(n,e,t,i,r){const s=e&&e.routeConfig?e.routeConfig.canDeactivate:null;return s&&0!==s.length?Ve(s.map(a=>{const c=Vh(e)??r,l=pl(a,c);return Do(function Yj(n){return n&&zh(n.canDeactivate)}(l)?l.canDeactivate(n,e,t,i):c.runInContext(()=>l(n,e,t,i))).pipe(So())})).pipe(ml()):Ve(!0)}(r.component,r.route,t,e,i)),So(r=>!0!==r,!0))}(o,i,r,n).pipe(ni(a=>a&&function Wj(n){return"boolean"==typeof n}(a)?function eW(n,e,t,i){return Pn(e).pipe(Eo(r=>Pp(function nW(n,e){return null!==n&&e&&e(new Mj(n)),Ve(!0)}(r.route.parent,i),function tW(n,e){return null!==n&&e&&e(new Sj(n)),Ve(!0)}(r.route,i),function rW(n,e,t){const i=e[e.length-1],s=e.slice(0,e.length-1).reverse().map(o=>function Hj(n){const e=n.routeConfig?n.routeConfig.canActivateChild:null;return e&&0!==e.length?{node:n,guards:e}:null}(o)).filter(o=>null!==o).map(o=>sI(()=>Ve(o.guards.map(c=>{const l=Vh(o.node)??t,u=pl(c,l);return Do(function Xj(n){return n&&zh(n.canActivateChild)}(u)?u.canActivateChild(i,n):l.runInContext(()=>u(i,n))).pipe(So())})).pipe(ml())));return Ve(s).pipe(ml())}(n,r.path,t),function iW(n,e,t){const i=e.routeConfig?e.routeConfig.canActivate:null;if(!i||0===i.length)return Ve(!0);const r=i.map(s=>sI(()=>{const o=Vh(e)??t,a=pl(s,o);return Do(function qj(n){return n&&zh(n.canActivate)}(a)?a.canActivate(e,n):o.runInContext(()=>a(e,n))).pipe(So())}));return Ve(r).pipe(ml())}(n,r.route,t))),So(r=>!0!==r,!0))}(i,s,n,e):Ve(a)),tt(a=>({...t,guardsResult:a})))})}(this.ngModule.injector,a=>this.triggerEvent(a)),Gn(a=>{if(r.guardsResult=a.guardsResult,Ia(a.guardsResult))throw FI(0,a.guardsResult);const c=new yj(a.id,this.serializeUrl(a.extractedUrl),this.serializeUrl(a.urlAfterRedirects),a.targetSnapshot,!!a.guardsResult);this.triggerEvent(c)}),ms(a=>!!a.guardsResult||(this.restoreHistory(a),this.cancelNavigationTransition(a,"",3),!1)),pb(a=>{if(a.guards.canActivateChecks.length)return Ve(a).pipe(Gn(c=>{const l=new vj(c.id,this.serializeUrl(c.extractedUrl),this.serializeUrl(c.urlAfterRedirects),c.targetSnapshot);this.triggerEvent(l)}),ps(c=>{let l=!1;return Ve(c).pipe(function EW(n,e){return ni(t=>{const{targetSnapshot:i,guards:{canActivateChecks:r}}=t;if(!r.length)return Ve(t);let s=0;return Pn(r).pipe(Eo(o=>function DW(n,e,t,i){const r=n.routeConfig,s=n._resolve;return void 0!==r?.title&&!nP(r)&&(s[Ih]=r.title),function TW(n,e,t,i){const r=function AW(n){return[...Object.keys(n),...Object.getOwnPropertySymbols(n)]}(n);if(0===r.length)return Ve({});const s={};return Pn(r).pipe(ni(o=>function IW(n,e,t,i){const r=Vh(e)??i,s=pl(n,r);return Do(s.resolve?s.resolve(e,t):r.runInContext(()=>s(e,t)))}(n[o],e,t,i).pipe(So(),Gn(a=>{s[o]=a}))),q0(1),function H6(n){return tt(()=>n)}(s),Xs(o=>hb(o)?Ps:ll(o)))}(s,n,e,i).pipe(tt(o=>(n._resolvedData=o,n.data=kI(n,t).resolve,r&&nP(r)&&(n.data[Ih]=r.title),null)))}(o.route,i,n,e)),Gn(()=>s++),q0(1),ni(o=>s===r.length?Ve(t):Ps))})}(this.paramsInheritanceStrategy,this.ngModule.injector),Gn({next:()=>l=!0,complete:()=>{l||(this.restoreHistory(c),this.cancelNavigationTransition(c,"",2))}}))}),Gn(c=>{const l=new bj(c.id,this.serializeUrl(c.extractedUrl),this.serializeUrl(c.urlAfterRedirects),c.targetSnapshot);this.triggerEvent(l)}))}),pb(a=>{const c=l=>{const u=[];l.routeConfig?.loadComponent&&!l.routeConfig._loadedComponent&&u.push(this.configLoader.loadComponent(l.routeConfig).pipe(Gn(h=>{l.component=h}),tt(()=>{})));for(const h of l.children)u.push(...c(h));return u};return W0(c(a.targetSnapshot.root)).pipe(Rp(),Da(1))}),pb(()=>this.afterPreactivation()),tt(a=>{const c=function Ij(n,e,t){const i=Nh(n,e._root,t?t._root:void 0);return new RI(i,e)}(this.routeReuseStrategy,a.targetSnapshot,a.currentRouterState);return r={...a,targetRouterState:c}}),Gn(a=>{this.currentUrlTree=a.urlAfterRedirects,this.rawUrlTree=this.urlHandlingStrategy.merge(a.urlAfterRedirects,a.rawUrl),this.routerState=a.targetRouterState,"deferred"===this.urlUpdateStrategy&&(a.extras.skipLocationChange||this.setBrowserUrl(this.rawUrlTree,a),this.browserUrlTree=a.urlAfterRedirects)}),((n,e,t)=>tt(i=>(new Uj(e,i.targetRouterState,i.currentRouterState,t).activate(n),i)))(this.rootContexts,this.routeReuseStrategy,a=>this.triggerEvent(a)),Gn({next(){s=!0},complete(){s=!0}}),Op(()=>{s||o||this.cancelNavigationTransition(r,"",1),this.currentNavigation?.id===r.id&&(this.currentNavigation=null)}),Xs(a=>{if(o=!0,UI(a)){BI(a)||(this.navigated=!0,this.restoreHistory(r,!0));const c=new zp(r.id,this.serializeUrl(r.extractedUrl),a.message,a.cancellationCode);if(i.next(c),BI(a)){const l=this.urlHandlingStrategy.merge(a.url,this.rawUrlTree),u={skipLocationChange:r.extras.skipLocationChange,replaceUrl:"eager"===this.urlUpdateStrategy||cP(r.source)};this.scheduleNavigation(l,"imperative",null,u,{resolve:r.resolve,reject:r.reject,promise:r.promise})}else r.resolve(!1)}else{this.restoreHistory(r,!0);const c=new AI(r.id,this.serializeUrl(r.extractedUrl),a,r.targetSnapshot??void 0);i.next(c);try{r.resolve(this.errorHandler(a))}catch(l){r.reject(l)}}return Ps}))}))}resetRootComponentType(t){this.rootComponentType=t,this.routerState.root.component=this.rootComponentType}setTransition(t){this.transitions.next({...this.transitions.value,...t})}initialNavigation(){this.setUpLocationChangeListener(),0===this.navigationId&&this.navigateByUrl(this.location.path(!0),{replaceUrl:!0})}setUpLocationChangeListener(){this.locationSubscription||(this.locationSubscription=this.location.subscribe(t=>{const i="popstate"===t.type?"popstate":"hashchange";"popstate"===i&&setTimeout(()=>{const r={replaceUrl:!0},s=t.state?.navigationId?t.state:null;if(s){const a={...s};delete a.navigationId,delete a.\u0275routerPageId,0!==Object.keys(a).length&&(r.state=a)}const o=this.parseUrl(t.url);this.scheduleNavigation(o,i,s,r)},0)}))}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return this.currentNavigation}triggerEvent(t){this.events.next(t)}resetConfig(t){this.config=t.map(ub),this.navigated=!1,this.lastSuccessfulId=-1}ngOnDestroy(){this.dispose()}dispose(){this.transitions.complete(),this.locationSubscription&&(this.locationSubscription.unsubscribe(),this.locationSubscription=void 0),this.disposed=!0}createUrlTree(t,i={}){const{relativeTo:r,queryParams:s,fragment:o,queryParamsHandling:a,preserveFragment:c}=i,l=r||this.routerState.root,u=c?this.currentUrlTree.fragment:o;let h=null;switch(a){case"merge":h={...this.currentUrlTree.queryParams,...s};break;case"preserve":h=this.currentUrlTree.queryParams;break;default:h=s||null}return null!==h&&(h=this.removeEmptyProps(h)),uj(l,this.currentUrlTree,t,h,u??null)}navigateByUrl(t,i={skipLocationChange:!1}){const r=Ia(t)?t:this.parseUrl(t),s=this.urlHandlingStrategy.merge(r,this.rawUrlTree);return this.scheduleNavigation(s,"imperative",null,i)}navigate(t,i={skipLocationChange:!1}){return function jW(n){for(let e=0;e<n.length;e++){if(null==n[e])throw new K(4008,false)}}(t),this.navigateByUrl(this.createUrlTree(t,i),i)}serializeUrl(t){return this.urlSerializer.serialize(t)}parseUrl(t){let i;try{i=this.urlSerializer.parse(t)}catch(r){i=this.malformedUriErrorHandler(r,this.urlSerializer,t)}return i}isActive(t,i){let r;if(r=!0===i?{...zW}:!1===i?{...HW}:i,Ia(t))return mI(this.currentUrlTree,t,r);const s=this.parseUrl(t);return mI(this.currentUrlTree,s,r)}removeEmptyProps(t){return Object.keys(t).reduce((i,r)=>{const s=t[r];return null!=s&&(i[r]=s),i},{})}processNavigations(){this.navigations.subscribe(t=>{this.navigated=!0,this.lastSuccessfulId=t.id,this.currentPageId=t.targetPageId,this.events.next(new To(t.id,this.serializeUrl(t.extractedUrl),this.serializeUrl(this.currentUrlTree))),this.lastSuccessfulNavigation=this.currentNavigation,this.titleStrategy?.updateTitle(this.routerState.snapshot),t.resolve(!0)},t=>{this.console.warn(`Unhandled Navigation Error: ${t}`)})}scheduleNavigation(t,i,r,s,o){if(this.disposed)return Promise.resolve(!1);let a,c,l;o?(a=o.resolve,c=o.reject,l=o.promise):l=new Promise((d,f)=>{a=d,c=f});const u=++this.navigationId;let h;return"computed"===this.canceledNavigationResolution?(0===this.currentPageId&&(r=this.location.getState()),h=r&&r.\u0275routerPageId?r.\u0275routerPageId:s.replaceUrl||s.skipLocationChange?this.browserPageId??0:(this.browserPageId??0)+1):h=0,this.setTransition({id:u,targetPageId:h,source:i,restoredState:r,currentUrlTree:this.currentUrlTree,currentRawUrl:this.rawUrlTree,rawUrl:t,extras:s,resolve:a,reject:c,promise:l,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),l.catch(d=>Promise.reject(d))}setBrowserUrl(t,i){const r=this.urlSerializer.serialize(t),s={...i.extras.state,...this.generateNgRouterState(i.id,i.targetPageId)};this.location.isCurrentPathEqualTo(r)||i.extras.replaceUrl?this.location.replaceState(r,"",s):this.location.go(r,"",s)}restoreHistory(t,i=!1){if("computed"===this.canceledNavigationResolution){const r=this.currentPageId-t.targetPageId;"popstate"!==t.source&&"eager"!==this.urlUpdateStrategy&&this.currentUrlTree!==this.currentNavigation?.finalUrl||0===r?this.currentUrlTree===this.currentNavigation?.finalUrl&&0===r&&(this.resetState(t),this.browserUrlTree=t.currentUrlTree,this.resetUrlToCurrentUrlTree()):this.location.historyGo(r)}else"replace"===this.canceledNavigationResolution&&(i&&this.resetState(t),this.resetUrlToCurrentUrlTree())}resetState(t){this.routerState=t.currentRouterState,this.currentUrlTree=t.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,t.rawUrl)}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.rawUrlTree),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}cancelNavigationTransition(t,i,r){const s=new zp(t.id,this.serializeUrl(t.extractedUrl),i,r);this.triggerEvent(s),t.resolve(!1)}generateNgRouterState(t,i){return"computed"===this.canceledNavigationResolution?{navigationId:t,\u0275routerPageId:i}:{navigationId:t}}}return n.\u0275fac=function(t){Bf()},n.\u0275prov=Te({token:n,factory:function(){return aP()},providedIn:"root"}),n})();function cP(n){return"imperative"!==n}class lP{}let qW=(()=>{class n{constructor(t,i,r,s,o){this.router=t,this.injector=r,this.preloadingStrategy=s,this.loader=o}setUpPreloading(){this.subscription=this.router.events.pipe(ms(t=>t instanceof To),Eo(()=>this.preload())).subscribe(()=>{})}preload(){return this.processRoutes(this.injector,this.router.config)}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}processRoutes(t,i){const r=[];for(const s of i){s.providers&&!s._injector&&(s._injector=np(s.providers,t,`Route: ${s.path}`));const o=s._injector??t,a=s._loadedInjector??o;s.loadChildren&&!s._loadedRoutes&&void 0===s.canLoad||s.loadComponent&&!s._loadedComponent?r.push(this.preloadConfig(o,s)):(s.children||s._loadedRoutes)&&r.push(this.processRoutes(a,s.children??s._loadedRoutes))}return Pn(r).pipe(wc())}preloadConfig(t,i){return this.preloadingStrategy.preload(i,()=>{let r;r=i.loadChildren&&void 0===i.canLoad?this.loader.loadChildren(t,i):Ve(null);const s=r.pipe(ni(o=>null===o?Ve(void 0):(i._loadedRoutes=o.routes,i._loadedInjector=o.injector,this.processRoutes(o.injector??t,o.routes))));return i.loadComponent&&!i._loadedComponent?Pn([s,this.loader.loadComponent(i)]).pipe(wc()):s})}}return n.\u0275fac=function(t){return new(t||n)(le(Ln),le(o0),le(vo),le(lP),le(mb))},n.\u0275prov=Te({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();const _b=new xe("");let uP=(()=>{class n{constructor(t,i,r,s={}){this.router=t,this.viewportScroller=i,this.zone=r,this.options=s,this.lastId=0,this.lastSource="imperative",this.restoredId=0,this.store={},s.scrollPositionRestoration=s.scrollPositionRestoration||"disabled",s.anchorScrolling=s.anchorScrolling||"disabled"}init(){"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.setHistoryScrollRestoration("manual"),this.routerEventsSubscription=this.createScrollEvents(),this.scrollEventsSubscription=this.consumeScrollEvents()}createScrollEvents(){return this.router.events.subscribe(t=>{t instanceof eb?(this.store[this.lastId]=this.viewportScroller.getScrollPosition(),this.lastSource=t.navigationTrigger,this.restoredId=t.restoredState?t.restoredState.navigationId:0):t instanceof To&&(this.lastId=t.id,this.scheduleScrollEvent(t,this.router.parseUrl(t.urlAfterRedirects).fragment))})}consumeScrollEvents(){return this.router.events.subscribe(t=>{t instanceof II&&(t.position?"top"===this.options.scrollPositionRestoration?this.viewportScroller.scrollToPosition([0,0]):"enabled"===this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition(t.position):t.anchor&&"enabled"===this.options.anchorScrolling?this.viewportScroller.scrollToAnchor(t.anchor):"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition([0,0]))})}scheduleScrollEvent(t,i){this.zone.runOutsideAngular(()=>{setTimeout(()=>{this.zone.run(()=>{this.router.triggerEvent(new II(t,"popstate"===this.lastSource?this.store[this.restoredId]:null,i))})},0)})}ngOnDestroy(){this.routerEventsSubscription&&this.routerEventsSubscription.unsubscribe(),this.scrollEventsSubscription&&this.scrollEventsSubscription.unsubscribe()}}return n.\u0275fac=function(t){Bf()},n.\u0275prov=Te({token:n,factory:n.\u0275fac}),n})();function yl(n,e){return{\u0275kind:n,\u0275providers:e}}function dP(){const n=Ot(Ji);return e=>{const t=n.get(wh);if(e!==t.components[0])return;const i=n.get(Ln),r=n.get(fP);1===n.get(vb)&&i.initialNavigation(),n.get(pP,null,Ze.Optional)?.setUpPreloading(),n.get(_b,null,Ze.Optional)?.init(),i.resetRootComponentType(t.componentTypes[0]),r.next(),r.complete()}}const fP=new xe("",{factory:()=>new ui}),vb=new xe("",{providedIn:"root",factory:()=>1});const pP=new xe("");function JW(n){return yl(0,[{provide:pP,useExisting:qW},{provide:lP,useExisting:n}])}const mP=new xe("ROUTER_FORROOT_GUARD"),QW=[x0,{provide:vI,useClass:X0},{provide:Ln,useFactory:aP},Fh,{provide:_s,useFactory:function hP(n){return n.routerState.root},deps:[Ln]},mb,[]];function e$(){return new HT("Router",Ln)}let gP=(()=>{class n{constructor(t){}static forRoot(t,i){return{ngModule:n,providers:[QW,[],{provide:gl,multi:!0,useValue:t},{provide:mP,useFactory:r$,deps:[[Ln,new yo,new Uc]]},{provide:Zp,useValue:i||{}},i?.useHash?{provide:Ea,useClass:e8}:{provide:Ea,useClass:hA},{provide:_b,useFactory:()=>{const n=Ot(Ln),e=Ot(MG),t=Ot(on),i=Ot(Zp);return i.scrollOffset&&e.setOffset(i.scrollOffset),new uP(n,e,t,i)}},i?.preloadingStrategy?JW(i.preloadingStrategy).\u0275providers:[],{provide:HT,multi:!0,useFactory:e$},i?.initialNavigation?s$(i):[],[{provide:_P,useFactory:dP},{provide:LT,multi:!0,useExisting:_P}]]}}static forChild(t){return{ngModule:n,providers:[{provide:gl,multi:!0,useValue:t}]}}}return n.\u0275fac=function(t){return new(t||n)(le(mP,8))},n.\u0275mod=bi({type:n}),n.\u0275inj=hi({imports:[cb]}),n})();function r$(n){return"guarded"}function s$(n){return["disabled"===n.initialNavigation?yl(3,[{provide:op,multi:!0,useFactory:()=>{const e=Ot(Ln);return()=>{e.setUpLocationChangeListener()}}},{provide:vb,useValue:2}]).\u0275providers:[],"enabledBlocking"===n.initialNavigation?yl(2,[{provide:vb,useValue:0},{provide:op,multi:!0,deps:[Ji],useFactory:e=>{const t=e.get(J5,Promise.resolve());let i=!1;return()=>t.then(()=>new Promise(s=>{const o=e.get(Ln),a=e.get(fP);(function r(s){e.get(Ln).events.pipe(ms(a=>a instanceof To||a instanceof zp||a instanceof AI),tt(a=>a instanceof To||a instanceof zp&&(0===a.code||1===a.code)&&null),ms(a=>null!==a),Da(1)).subscribe(()=>{s()})})(()=>{s(!0),i=!0}),o.afterPreactivation=()=>(s(!0),i||a.closed?Ve(void 0):a),o.initialNavigation()}))}}]).\u0275providers:[]]}const _P=new xe(""),bb={},yP=[];function mt(n,e){if(Array.isArray(n))for(const t of n)mt(t,e);else if("object"!=typeof n)vP(Object.getOwnPropertyNames(e)),bb[n]=Object.assign(bb[n]||{},e);else for(const t in n)mt(t,n[t])}function zi(n){return bb[n]||{}}function vP(n){yP.push(...n)}function Jp(n,e){let t;const i=n.length,r=[];for(t=0;t<i;t++)r.push(e(n[t]));return r}function bP(n,e){let t;const i=n.length,r=[];for(t=0;t<i;t++)e(n[t])&&r.push(n[t]);return r}function Qp(n){return n%360*Math.PI/180}function jh(n){return n.toLowerCase().replace(/-(.)/g,function(e,t){return t.toUpperCase()})}function xP(n){return n.replace(/([A-Z])/g,function(e,t){return"-"+t.toLowerCase()})}function xb(n){return n.charAt(0).toUpperCase()+n.slice(1)}function Pa(n,e,t,i){return(null==e||null==t)&&(i=i||n.bbox(),null==e?e=i.width/i.height*t:null==t&&(t=i.height/i.width*e)),{width:e,height:t}}function em(n,e){const t=n.origin;let i=null!=n.ox?n.ox:null!=n.originX?n.originX:"center",r=null!=n.oy?n.oy:null!=n.originY?n.originY:"center";null!=t&&([i,r]=Array.isArray(t)?t:"object"==typeof t?[t.x,t.y]:[t,t]);const s="string"==typeof i,o="string"==typeof r;if(s||o){const{height:a,width:c,x:l,y:u}=e.bbox();s&&(i=i.includes("left")?l:i.includes("right")?l+c:l+c/2),o&&(r=r.includes("top")?u:r.includes("bottom")?u+a:u+a/2)}return[i,r]}const tm="http://www.w3.org/2000/svg",Wh="http://www.w3.org/2000/xmlns/",vl="http://www.w3.org/1999/xlink",yt={window:typeof window>"u"?null:window,document:typeof document>"u"?null:document};class wb{}const Ra={},Mb="___SYMBOL___ROOT___";function $h(n,e=tm){return yt.document.createElementNS(e,n)}function Ti(n,e=!1){if(n instanceof wb)return n;if("object"==typeof n)return im(n);if(null==n)return new Ra[Mb];if("string"==typeof n&&"<"!==n.charAt(0))return im(yt.document.querySelector(n));const t=e?yt.document.createElement("div"):$h("svg");return t.innerHTML=n,n=im(t.firstChild),t.removeChild(t.firstChild),n}function an(n,e){return e&&e.ownerDocument&&e instanceof e.ownerDocument.defaultView.Node?e:$h(n)}function ir(n){if(!n)return null;if(n.instance instanceof wb)return n.instance;if("#document-fragment"===n.nodeName)return new Ra.Fragment(n);let e=xb(n.nodeName||"Dom");return"LinearGradient"===e||"RadialGradient"===e?e="Gradient":Ra[e]||(e="Dom"),new Ra[e](n)}let im=ir;function At(n,e=n.name,t=!1){return Ra[e]=n,t&&(Ra[Mb]=n),vP(Object.getOwnPropertyNames(n.prototype)),n}let f$=1e3;function CP(n){return"Svgjs"+xb(n)+f$++}function SP(n){for(let e=n.children.length-1;e>=0;e--)SP(n.children[e]);return n.id&&(n.id=CP(n.nodeName)),n}function Ct(n,e){let t,i;for(i=(n=Array.isArray(n)?n:[n]).length-1;i>=0;i--)for(t in e)n[i].prototype[t]=e[t]}function cn(n){return function(...e){const t=e[e.length-1];return!t||t.constructor!==Object||t instanceof Array?n.apply(this,e):n.apply(this,e.slice(0,-1)).attr(t)}}mt("Dom",{siblings:function p$(){return this.parent().children()},position:function m$(){return this.parent().index(this)},next:function g$(){return this.siblings()[this.position()+1]},prev:function _$(){return this.siblings()[this.position()-1]},forward:function y$(){const n=this.position();return this.parent().add(this.remove(),n+1),this},backward:function v$(){const n=this.position();return this.parent().add(this.remove(),n?n-1:0),this},front:function b$(){return this.parent().add(this.remove()),this},back:function x$(){return this.parent().add(this.remove(),0),this},before:function w$(n){(n=Ti(n)).remove();const e=this.position();return this.parent().add(n,e),this},after:function M$(n){(n=Ti(n)).remove();const e=this.position();return this.parent().add(n,e+1),this},insertBefore:function C$(n){return(n=Ti(n)).before(this),this},insertAfter:function S$(n){return(n=Ti(n)).after(this),this}});const Cb=/^([+-]?(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?)([a-z%]*)$/i,EP=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i,DP=/rgb\((\d+),(\d+),(\d+)\)/,TP=/(#[a-z_][a-z0-9\-_]*)/i,AP=/\)\s*,?\s*/,IP=/\s/g,Sb=/^#[a-f0-9]{3}$|^#[a-f0-9]{6}$/i,Eb=/^rgb\(/,Db=/^(\s+)?$/,Tb=/^[+-]?(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,PP=/\.(jpg|jpeg|png|gif|svg)(\?[^=]+.*)?/i,ys=/[\s,]+/,rm=/[MLHVCSQTAZ]/i;function U$(n){const e=Math.round(n),i=Math.max(0,Math.min(255,e)).toString(16);return 1===i.length?"0"+i:i}function bl(n,e){for(let t=e.length;t--;)if(null==n[e[t]])return!1;return!0}function Ab(n,e,t){return t<0&&(t+=1),t>1&&(t-=1),t<1/6?n+6*(e-n)*t:t<.5?e:t<2/3?n+(e-n)*(2/3-t)*6:n}mt("Dom",{classes:function E$(){const n=this.attr("class");return null==n?[]:n.trim().split(ys)},hasClass:function D$(n){return-1!==this.classes().indexOf(n)},addClass:function T$(n){if(!this.hasClass(n)){const e=this.classes();e.push(n),this.attr("class",e.join(" "))}return this},removeClass:function A$(n){return this.hasClass(n)&&this.attr("class",this.classes().filter(function(e){return e!==n}).join(" ")),this},toggleClass:function I$(n){return this.hasClass(n)?this.removeClass(n):this.addClass(n)}}),mt("Dom",{css:function P$(n,e){const t={};if(0===arguments.length)return this.node.style.cssText.split(/\s*;\s*/).filter(function(i){return!!i.length}).forEach(function(i){const r=i.split(/\s*:\s*/);t[r[0]]=r[1]}),t;if(arguments.length<2){if(Array.isArray(n)){for(const i of n){const r=jh(i);t[i]=this.node.style[r]}return t}if("string"==typeof n)return this.node.style[jh(n)];if("object"==typeof n)for(const i in n)this.node.style[jh(i)]=null==n[i]||Db.test(n[i])?"":n[i]}return 2===arguments.length&&(this.node.style[jh(n)]=null==e||Db.test(e)?"":e),this},show:function R$(){return this.css("display","")},hide:function O$(){return this.css("display","none")},visible:function k$(){return"none"!==this.css("display")}}),mt("Dom",{data:function L$(n,e,t){if(null==n)return this.data(Jp(bP(this.node.attributes,i=>0===i.nodeName.indexOf("data-")),i=>i.nodeName.slice(5)));if(n instanceof Array){const i={};for(const r of n)i[r]=this.data(r);return i}if("object"==typeof n)for(e in n)this.data(e,n[e]);else if(arguments.length<2)try{return JSON.parse(this.attr("data-"+n))}catch{return this.attr("data-"+n)}else this.attr("data-"+n,null===e?null:!0===t||"string"==typeof e||"number"==typeof e?e:JSON.stringify(e));return this}}),mt("Dom",{remember:function N$(n,e){if("object"==typeof arguments[0])for(const t in n)this.remember(t,n[t]);else{if(1===arguments.length)return this.memory()[n];this.memory()[n]=e}return this},forget:function F$(){if(0===arguments.length)this._memory={};else for(let n=arguments.length-1;n>=0;n--)delete this.memory()[arguments[n]];return this},memory:function V$(){return this._memory=this._memory||{}}});class Wt{constructor(...e){this.init(...e)}static isColor(e){return e&&(e instanceof Wt||this.isRgb(e)||this.test(e))}static isRgb(e){return e&&"number"==typeof e.r&&"number"==typeof e.g&&"number"==typeof e.b}static random(e="vibrant",t,i){const{random:r,round:s,sin:o,PI:a}=Math;if("vibrant"===e){const c=24*r()+57,l=38*r()+45,u=360*r();return new Wt(c,l,u,"lch")}if("sine"===e){const c=s(80*o(2*a*(t=t??r())/.5+.01)+150),l=s(50*o(2*a*t/.5+4.6)+200),u=s(100*o(2*a*t/.5+2.3)+150);return new Wt(c,l,u)}if("pastel"===e){const c=8*r()+86,l=17*r()+9,u=360*r();return new Wt(c,l,u,"lch")}if("dark"===e){const c=10+10*r(),l=50*r()+86,u=360*r();return new Wt(c,l,u,"lch")}if("rgb"===e){const c=255*r(),l=255*r(),u=255*r();return new Wt(c,l,u)}if("lab"===e){const c=100*r(),l=256*r()-128,u=256*r()-128;return new Wt(c,l,u,"lab")}if("grey"===e){const c=255*r();return new Wt(c,c,c)}throw new Error("Unsupported random color mode")}static test(e){return"string"==typeof e&&(Sb.test(e)||Eb.test(e))}cmyk(){const{_a:e,_b:t,_c:i}=this.rgb(),[r,s,o]=[e,t,i].map(d=>d/255),a=Math.min(1-r,1-s,1-o);return 1===a?new Wt(0,0,0,1,"cmyk"):new Wt((1-r-a)/(1-a),(1-s-a)/(1-a),(1-o-a)/(1-a),a,"cmyk")}hsl(){const{_a:e,_b:t,_c:i}=this.rgb(),[r,s,o]=[e,t,i].map(m=>m/255),a=Math.max(r,s,o),c=Math.min(r,s,o),l=(a+c)/2,u=a===c,h=a-c;return new Wt(360*(u?0:a===r?((s-o)/h+(s<o?6:0))/6:a===s?((o-r)/h+2)/6:a===o?((r-s)/h+4)/6:0),100*(u?0:l>.5?h/(2-a-c):h/(a+c)),100*l,"hsl")}init(e=0,t=0,i=0,r=0,s="rgb"){if(e=e||0,this.space)for(const h in this.space)delete this[this.space[h]];if("number"==typeof e)s="string"==typeof r?r:s,r="string"==typeof r?0:r,Object.assign(this,{_a:e,_b:t,_c:i,_d:r,space:s});else if(e instanceof Array)this.space=t||("string"==typeof e[3]?e[3]:e[4])||"rgb",Object.assign(this,{_a:e[0],_b:e[1],_c:e[2],_d:e[3]||0});else if(e instanceof Object){const h=function z$(n,e){const t=bl(n,"rgb")?{_a:n.r,_b:n.g,_c:n.b,_d:0,space:"rgb"}:bl(n,"xyz")?{_a:n.x,_b:n.y,_c:n.z,_d:0,space:"xyz"}:bl(n,"hsl")?{_a:n.h,_b:n.s,_c:n.l,_d:0,space:"hsl"}:bl(n,"lab")?{_a:n.l,_b:n.a,_c:n.b,_d:0,space:"lab"}:bl(n,"lch")?{_a:n.l,_b:n.c,_c:n.h,_d:0,space:"lch"}:bl(n,"cmyk")?{_a:n.c,_b:n.m,_c:n.y,_d:n.k,space:"cmyk"}:{_a:0,_b:0,_c:0,space:"rgb"};return t.space=e||t.space,t}(e,t);Object.assign(this,h)}else if("string"==typeof e)if(Eb.test(e)){const h=e.replace(IP,""),[d,f,p]=DP.exec(h).slice(1,4).map(m=>parseInt(m));Object.assign(this,{_a:d,_b:f,_c:p,_d:0,space:"rgb"})}else{if(!Sb.test(e))throw Error("Unsupported string format, can't construct Color");{const h=m=>parseInt(m,16),[,d,f,p]=EP.exec(function B$(n){return 4===n.length?["#",n.substring(1,2),n.substring(1,2),n.substring(2,3),n.substring(2,3),n.substring(3,4),n.substring(3,4)].join(""):n}(e)).map(h);Object.assign(this,{_a:d,_b:f,_c:p,_d:0,space:"rgb"})}}const{_a:o,_b:a,_c:c,_d:l}=this;Object.assign(this,"rgb"===this.space?{r:o,g:a,b:c}:"xyz"===this.space?{x:o,y:a,z:c}:"hsl"===this.space?{h:o,s:a,l:c}:"lab"===this.space?{l:o,a,b:c}:"lch"===this.space?{l:o,c:a,h:c}:"cmyk"===this.space?{c:o,m:a,y:c,k:l}:{})}lab(){const{x:e,y:t,z:i}=this.xyz();return new Wt(116*t-16,500*(e-t),200*(t-i),"lab")}lch(){const{l:e,a:t,b:i}=this.lab(),r=Math.sqrt(t**2+i**2);let s=180*Math.atan2(i,t)/Math.PI;return s<0&&(s*=-1,s=360-s),new Wt(e,r,s,"lch")}rgb(){if("rgb"===this.space)return this;if(function H$(n){return"lab"===n||"xyz"===n||"lch"===n}(this.space)){let{x:e,y:t,z:i}=this;if("lab"===this.space||"lch"===this.space){let{l:f,a:p,b:m}=this;if("lch"===this.space){const{c:M,h:I}=this,x=Math.PI/180;p=M*Math.cos(x*I),m=M*Math.sin(x*I)}const g=(f+16)/116,_=p/500+g,b=g-m/200,y=16/116,v=.008856,w=7.787;e=.95047*(_**3>v?_**3:(_-y)/w),t=1*(g**3>v?g**3:(g-y)/w),i=1.08883*(b**3>v?b**3:(b-y)/w)}const r=3.2406*e+-1.5372*t+-.4986*i,s=-.9689*e+1.8758*t+.0415*i,o=.0557*e+-.204*t+1.057*i,a=Math.pow,c=.0031308,l=r>c?1.055*a(r,1/2.4)-.055:12.92*r,u=s>c?1.055*a(s,1/2.4)-.055:12.92*s,h=o>c?1.055*a(o,1/2.4)-.055:12.92*o;return new Wt(255*l,255*u,255*h)}if("hsl"===this.space){let{h:e,s:t,l:i}=this;if(e/=360,t/=100,i/=100,0===t)return i*=255,new Wt(i,i,i);const r=i<.5?i*(1+t):i+t-i*t,s=2*i-r,o=255*Ab(s,r,e+1/3),a=255*Ab(s,r,e),c=255*Ab(s,r,e-1/3);return new Wt(o,a,c)}if("cmyk"===this.space){const{c:e,m:t,y:i,k:r}=this,s=255*(1-Math.min(1,e*(1-r)+r)),o=255*(1-Math.min(1,t*(1-r)+r)),a=255*(1-Math.min(1,i*(1-r)+r));return new Wt(s,o,a)}return this}toArray(){const{_a:e,_b:t,_c:i,_d:r,space:s}=this;return[e,t,i,r,s]}toHex(){const[e,t,i]=this._clamped().map(U$);return`#${e}${t}${i}`}toRgb(){const[e,t,i]=this._clamped();return`rgb(${e},${t},${i})`}toString(){return this.toHex()}xyz(){const{_a:e,_b:t,_c:i}=this.rgb(),[r,s,o]=[e,t,i].map(_=>_/255),a=r>.04045?Math.pow((r+.055)/1.055,2.4):r/12.92,c=s>.04045?Math.pow((s+.055)/1.055,2.4):s/12.92,l=o>.04045?Math.pow((o+.055)/1.055,2.4):o/12.92,u=(.4124*a+.3576*c+.1805*l)/.95047,h=(.2126*a+.7152*c+.0722*l)/1,d=(.0193*a+.1192*c+.9505*l)/1.08883,f=u>.008856?Math.pow(u,1/3):7.787*u+16/116,p=h>.008856?Math.pow(h,1/3):7.787*h+16/116,m=d>.008856?Math.pow(d,1/3):7.787*d+16/116;return new Wt(f,p,m,"xyz")}_clamped(){const{_a:e,_b:t,_c:i}=this.rgb(),{max:r,min:s,round:o}=Math;return[e,t,i].map(c=>r(0,s(o(c),255)))}}class Dn{constructor(...e){this.init(...e)}clone(){return new Dn(this)}init(e,t){const r=Array.isArray(e)?{x:e[0],y:e[1]}:"object"==typeof e?{x:e.x,y:e.y}:{x:e,y:t};return this.x=r.x??0,this.y=r.y??0,this}toArray(){return[this.x,this.y]}transform(e){return this.clone().transformO(e)}transformO(e){je.isMatrixLike(e)||(e=new je(e));const{x:t,y:i}=this;return this.x=e.a*t+e.c*i+e.e,this.y=e.b*t+e.d*i+e.f,this}}function xl(n,e,t){return Math.abs(e-n)<(t||1e-6)}class je{constructor(...e){this.init(...e)}static formatTransforms(e){const t="both"===e.flip||!0===e.flip,i=e.flip&&(t||"x"===e.flip)?-1:1,r=e.flip&&(t||"y"===e.flip)?-1:1,s=e.skew&&e.skew.length?e.skew[0]:isFinite(e.skew)?e.skew:isFinite(e.skewX)?e.skewX:0,o=e.skew&&e.skew.length?e.skew[1]:isFinite(e.skew)?e.skew:isFinite(e.skewY)?e.skewY:0,a=e.scale&&e.scale.length?e.scale[0]*i:isFinite(e.scale)?e.scale*i:isFinite(e.scaleX)?e.scaleX*i:i,c=e.scale&&e.scale.length?e.scale[1]*r:isFinite(e.scale)?e.scale*r:isFinite(e.scaleY)?e.scaleY*r:r,l=e.shear||0,u=e.rotate||e.theta||0,h=new Dn(e.origin||e.around||e.ox||e.originX,e.oy||e.originY),d=h.x,f=h.y,p=new Dn(e.position||e.px||e.positionX||NaN,e.py||e.positionY||NaN),m=p.x,g=p.y,_=new Dn(e.translate||e.tx||e.translateX,e.ty||e.translateY),b=_.x,y=_.y,v=new Dn(e.relative||e.rx||e.relativeX,e.ry||e.relativeY);return{scaleX:a,scaleY:c,skewX:s,skewY:o,shear:l,theta:u,rx:v.x,ry:v.y,tx:b,ty:y,ox:d,oy:f,px:m,py:g}}static fromArray(e){return{a:e[0],b:e[1],c:e[2],d:e[3],e:e[4],f:e[5]}}static isMatrixLike(e){return null!=e.a||null!=e.b||null!=e.c||null!=e.d||null!=e.e||null!=e.f}static matrixMultiply(e,t,i){const s=e.b*t.a+e.d*t.b,o=e.a*t.c+e.c*t.d,a=e.b*t.c+e.d*t.d,c=e.e+e.a*t.e+e.c*t.f,l=e.f+e.b*t.e+e.d*t.f;return i.a=e.a*t.a+e.c*t.b,i.b=s,i.c=o,i.d=a,i.e=c,i.f=l,i}around(e,t,i){return this.clone().aroundO(e,t,i)}aroundO(e,t,i){const r=e||0,s=t||0;return this.translateO(-r,-s).lmultiplyO(i).translateO(r,s)}clone(){return new je(this)}decompose(e=0,t=0){const i=this.a,r=this.b,s=this.c,o=this.d,a=this.e,c=this.f,l=i*o-r*s,u=l>0?1:-1,h=u*Math.sqrt(i*i+r*r),d=Math.atan2(u*r,u*i),f=180/Math.PI*d,p=Math.cos(d),m=Math.sin(d),g=(i*s+r*o)/l,_=s*h/(g*i-r)||o*h/(g*r+i);return{scaleX:h,scaleY:_,shear:g,rotate:f,translateX:a-e+e*p*h+t*(g*p*h-m*_),translateY:c-t+e*m*h+t*(g*m*h+p*_),originX:e,originY:t,a:this.a,b:this.b,c:this.c,d:this.d,e:this.e,f:this.f}}equals(e){if(e===this)return!0;const t=new je(e);return xl(this.a,t.a)&&xl(this.b,t.b)&&xl(this.c,t.c)&&xl(this.d,t.d)&&xl(this.e,t.e)&&xl(this.f,t.f)}flip(e,t){return this.clone().flipO(e,t)}flipO(e,t){return"x"===e?this.scaleO(-1,1,t,0):"y"===e?this.scaleO(1,-1,0,t):this.scaleO(-1,-1,e,t||e)}init(e){const t=je.fromArray([1,0,0,1,0,0]);return e=e instanceof vs?e.matrixify():"string"==typeof e?je.fromArray(e.split(ys).map(parseFloat)):Array.isArray(e)?je.fromArray(e):"object"==typeof e&&je.isMatrixLike(e)?e:"object"==typeof e?(new je).transform(e):6===arguments.length?je.fromArray([].slice.call(arguments)):t,this.a=null!=e.a?e.a:t.a,this.b=null!=e.b?e.b:t.b,this.c=null!=e.c?e.c:t.c,this.d=null!=e.d?e.d:t.d,this.e=null!=e.e?e.e:t.e,this.f=null!=e.f?e.f:t.f,this}inverse(){return this.clone().inverseO()}inverseO(){const e=this.a,t=this.b,i=this.c,r=this.d,s=this.e,o=this.f,a=e*r-t*i;if(!a)throw new Error("Cannot invert "+this);const c=r/a,l=-t/a,u=-i/a,h=e/a,d=-(c*s+u*o),f=-(l*s+h*o);return this.a=c,this.b=l,this.c=u,this.d=h,this.e=d,this.f=f,this}lmultiply(e){return this.clone().lmultiplyO(e)}lmultiplyO(e){const i=e instanceof je?e:new je(e);return je.matrixMultiply(i,this,this)}multiply(e){return this.clone().multiplyO(e)}multiplyO(e){const i=e instanceof je?e:new je(e);return je.matrixMultiply(this,i,this)}rotate(e,t,i){return this.clone().rotateO(e,t,i)}rotateO(e,t=0,i=0){e=Qp(e);const r=Math.cos(e),s=Math.sin(e),{a:o,b:a,c,d:l,e:u,f:h}=this;return this.a=o*r-a*s,this.b=a*r+o*s,this.c=c*r-l*s,this.d=l*r+c*s,this.e=u*r-h*s+i*s-t*r+t,this.f=h*r+u*s-t*s-i*r+i,this}scale(e,t,i,r){return this.clone().scaleO(...arguments)}scaleO(e,t=e,i=0,r=0){3===arguments.length&&(r=i,i=t,t=e);const{a:s,b:o,c:a,d:c,e:l,f:u}=this;return this.a=s*e,this.b=o*t,this.c=a*e,this.d=c*t,this.e=l*e-i*e+i,this.f=u*t-r*t+r,this}shear(e,t,i){return this.clone().shearO(e,t,i)}shearO(e,t=0,i=0){const{a:r,b:s,c:o,d:a,e:c,f:l}=this;return this.a=r+s*e,this.c=o+a*e,this.e=c+l*e-i*e,this}skew(e,t,i,r){return this.clone().skewO(...arguments)}skewO(e,t=e,i=0,r=0){3===arguments.length&&(r=i,i=t,t=e),e=Qp(e),t=Qp(t);const s=Math.tan(e),o=Math.tan(t),{a,b:c,c:l,d:u,e:h,f:d}=this;return this.a=a+c*s,this.b=c+a*o,this.c=l+u*s,this.d=u+l*o,this.e=h+d*s-r*s,this.f=d+h*o-i*o,this}skewX(e,t,i){return this.skew(e,0,t,i)}skewY(e,t,i){return this.skew(0,e,t,i)}toArray(){return[this.a,this.b,this.c,this.d,this.e,this.f]}toString(){return"matrix("+this.a+","+this.b+","+this.c+","+this.d+","+this.e+","+this.f+")"}transform(e){if(je.isMatrixLike(e))return new je(e).multiplyO(this);const t=je.formatTransforms(e),{x:r,y:s}=new Dn(t.ox,t.oy).transform(this),o=(new je).translateO(t.rx,t.ry).lmultiplyO(this).translateO(-r,-s).scaleO(t.scaleX,t.scaleY).skewO(t.skewX,t.skewY).shearO(t.shear).rotateO(t.theta).translateO(r,s);if(isFinite(t.px)||isFinite(t.py)){const a=new Dn(r,s).transform(o),c=isFinite(t.px)?t.px-a.x:0,l=isFinite(t.py)?t.py-a.y:0;o.translateO(c,l)}return o.translateO(t.tx,t.ty),o}translate(e,t){return this.clone().translateO(e,t)}translateO(e,t){return this.e+=e||0,this.f+=t||0,this}valueOf(){return{a:this.a,b:this.b,c:this.c,d:this.d,e:this.e,f:this.f}}}function Ao(){if(!Ao.nodes){const n=Ti().size(2,0);n.node.style.cssText=["opacity: 0","position: absolute","left: -100%","top: -100%","overflow: hidden"].join(";"),n.attr("focusable","false"),n.attr("aria-hidden","true");const e=n.path().node;Ao.nodes={svg:n,path:e}}return Ao.nodes.svg.node.parentNode||Ao.nodes.svg.addTo(yt.document.body||yt.document.documentElement),Ao.nodes}function RP(n){return!(n.width||n.height||n.x||n.y)}At(je,"Matrix");class _i{constructor(...e){this.init(...e)}addOffset(){return this.x+=yt.window.pageXOffset,this.y+=yt.window.pageYOffset,new _i(this)}init(e){return e="string"==typeof e?e.split(ys).map(parseFloat):Array.isArray(e)?e:"object"==typeof e?[null!=e.left?e.left:e.x,null!=e.top?e.top:e.y,e.width,e.height]:4===arguments.length?[].slice.call(arguments):[0,0,0,0],this.x=e[0]||0,this.y=e[1]||0,this.width=this.w=e[2]||0,this.height=this.h=e[3]||0,this.x2=this.x+this.w,this.y2=this.y+this.h,this.cx=this.x+this.w/2,this.cy=this.y+this.h/2,this}isNulled(){return RP(this)}merge(e){const t=Math.min(this.x,e.x),i=Math.min(this.y,e.y),r=Math.max(this.x+this.width,e.x+e.width)-t,s=Math.max(this.y+this.height,e.y+e.height)-i;return new _i(t,i,r,s)}toArray(){return[this.x,this.y,this.width,this.height]}toString(){return this.x+" "+this.y+" "+this.width+" "+this.height}transform(e){e instanceof je||(e=new je(e));let t=1/0,i=-1/0,r=1/0,s=-1/0;return[new Dn(this.x,this.y),new Dn(this.x2,this.y),new Dn(this.x,this.y2),new Dn(this.x2,this.y2)].forEach(function(a){a=a.transform(e),t=Math.min(t,a.x),i=Math.max(i,a.x),r=Math.min(r,a.y),s=Math.max(s,a.y)}),new _i(t,r,i-t,s-r)}}function OP(n,e,t){let i;try{if(i=e(n.node),RP(i)&&!function $$(n){return n===yt.document||(yt.document.documentElement.contains||function(e){for(;e.parentNode;)e=e.parentNode;return e===yt.document}).call(yt.document.documentElement,n)}(n.node))throw new Error("Element not in the dom")}catch{i=t(n)}return i}mt({viewbox:{viewbox(n,e,t,i){return null==n?new _i(this.attr("viewBox")):this.attr("viewBox",new _i(n,e,t,i))},zoom(n,e){let{width:t,height:i}=this.attr(["width","height"]);if((!t&&!i||"string"==typeof t||"string"==typeof i)&&(t=this.node.clientWidth,i=this.node.clientHeight),!t||!i)throw new Error("Impossible to get absolute width and height. Please provide an absolute width and height attribute on the zooming element");const r=this.viewbox(),s=t/r.width,o=i/r.height,a=Math.min(s,o);if(null==n)return a;let c=a/n;c===1/0&&(c=Number.MAX_SAFE_INTEGER/100),e=e||new Dn(t/2/s+r.x,i/2/o+r.y);const l=new _i(r).transform(new je({scale:c,origin:e}));return this.viewbox(l)}}}),At(_i,"Box");class Oa extends Array{constructor(e=[],...t){if(super(e,...t),"number"==typeof e)return this;this.length=0,this.push(...e)}}Ct([Oa],{each(n,...e){return this.map("function"==typeof n?(t,i,r)=>n.call(t,t,i,r):t=>t[n](...e))},toArray(){return Array.prototype.concat.apply([],this)}});const Z$=["toArray","constructor","each"];function wl(n,e){return new Oa(Jp((e||yt.document).querySelectorAll(n),function(t){return ir(t)}))}Oa.extend=function(n){n=n.reduce((e,t)=>(Z$.includes(t)||"_"===t[0]||(e[t]=function(...i){return this.each(t,...i)}),e),{}),Ct([Oa],n)};let Q$=0;const kP={};function LP(n){let e=n.getEventHolder();return e===yt.window&&(e=kP),e.events||(e.events={}),e.events}function Ib(n){return n.getEventTarget()}function Pb(n,e,t,i,r){const s=t.bind(i||n),o=Ti(n),a=LP(o),c=Ib(o);e=Array.isArray(e)?e:e.split(ys),t._svgjsListenerId||(t._svgjsListenerId=++Q$),e.forEach(function(l){const u=l.split(".")[0],h=l.split(".")[1]||"*";a[u]=a[u]||{},a[u][h]=a[u][h]||{},a[u][h][t._svgjsListenerId]=s,c.addEventListener(u,s,r||!1)})}function Ml(n,e,t,i){const r=Ti(n),s=LP(r),o=Ib(r);"function"==typeof t&&!(t=t._svgjsListenerId)||(e=Array.isArray(e)?e:(e||"").split(ys)).forEach(function(a){const c=a&&a.split(".")[0],l=a&&a.split(".")[1];let u,h;if(t)s[c]&&s[c][l||"*"]&&(o.removeEventListener(c,s[c][l||"*"][t],i||!1),delete s[c][l||"*"][t]);else if(c&&l){if(s[c]&&s[c][l]){for(h in s[c][l])Ml(o,[c,l].join("."),h);delete s[c][l]}}else if(l)for(a in s)for(u in s[a])l===u&&Ml(o,[a,l].join("."));else if(c){if(s[c]){for(u in s[c])Ml(o,[c,u].join("."));delete s[c]}}else{for(a in s)Ml(o,a);!function e9(n){let e=n.getEventHolder();e===yt.window&&(e=kP),e.events&&(e.events={})}(r)}})}class qh extends wb{addEventListener(){}dispatch(e,t,i){return function t9(n,e,t,i){const r=Ib(n);return e instanceof yt.window.Event||(e=new yt.window.CustomEvent(e,{detail:t,cancelable:!0,...i})),r.dispatchEvent(e),e}(this,e,t,i)}dispatchEvent(e){const t=this.getEventHolder().events;if(!t)return!0;const i=t[e.type];for(const r in i)for(const s in i[r])i[r][s](e);return!e.defaultPrevented}fire(e,t,i){return this.dispatch(e,t,i),this}getEventHolder(){return this}getEventTarget(){return this}off(e,t,i){return Ml(this,e,t,i),this}on(e,t,i,r){return Pb(this,e,t,i,r),this}removeEventListener(){}}function Rb(){}At(qh,"EventTarget");const Cl_duration=400,Cl_ease=">",Cl_delay=0,NP={"fill-opacity":1,"stroke-opacity":1,"stroke-width":0,"stroke-linejoin":"miter","stroke-linecap":"butt",fill:"#000000",stroke:"#000000",opacity:1,x:0,y:0,cx:0,cy:0,width:0,height:0,r:0,rx:0,ry:0,offset:0,"stop-opacity":1,"stop-color":"#000000","text-anchor":"start"};class Sl extends Array{constructor(...e){super(...e),this.init(...e)}clone(){return new this.constructor(this)}init(e){return"number"==typeof e||(this.length=0,this.push(...this.parse(e))),this}parse(e=[]){return e instanceof Array?e:e.trim().split(ys).map(parseFloat)}toArray(){return Array.prototype.concat.apply([],this)}toSet(){return new Set(this)}toString(){return this.join(" ")}valueOf(){const e=[];return e.push(...this),e}}class ot{constructor(...e){this.init(...e)}convert(e){return new ot(this.value,e)}divide(e){return e=new ot(e),new ot(this/e,this.unit||e.unit)}init(e,t){return t=Array.isArray(e)?e[1]:t,e=Array.isArray(e)?e[0]:e,this.value=0,this.unit=t||"","number"==typeof e?this.value=isNaN(e)?0:isFinite(e)?e:e<0?-34e37:34e37:"string"==typeof e?(t=e.match(Cb))&&(this.value=parseFloat(t[1]),"%"===t[5]?this.value/=100:"s"===t[5]&&(this.value*=1e3),this.unit=t[5]):e instanceof ot&&(this.value=e.valueOf(),this.unit=e.unit),this}minus(e){return e=new ot(e),new ot(this-e,this.unit||e.unit)}plus(e){return e=new ot(e),new ot(this+e,this.unit||e.unit)}times(e){return e=new ot(e),new ot(this*e,this.unit||e.unit)}toArray(){return[this.value,this.unit]}toJSON(){return this.toString()}toString(){return("%"===this.unit?~~(1e8*this.value)/1e6:"s"===this.unit?this.value/1e3:this.value)+this.unit}valueOf(){return this.value}}const FP=[];class Io extends qh{constructor(e,t){super(),this.node=e,this.type=e.nodeName,t&&e!==t&&this.attr(t)}add(e,t){return(e=Ti(e)).removeNamespace&&this.node instanceof yt.window.SVGElement&&e.removeNamespace(),null==t?this.node.appendChild(e.node):e.node!==this.node.childNodes[t]&&this.node.insertBefore(e.node,this.node.childNodes[t]),this}addTo(e,t){return Ti(e).put(this,t)}children(){return new Oa(Jp(this.node.children,function(e){return ir(e)}))}clear(){for(;this.node.hasChildNodes();)this.node.removeChild(this.node.lastChild);return this}clone(e=!0){return this.writeDataToDom(),new this.constructor(SP(this.node.cloneNode(e)))}each(e,t){const i=this.children();let r,s;for(r=0,s=i.length;r<s;r++)e.apply(i[r],[r,i]),t&&i[r].each(e,t);return this}element(e,t){return this.put(new Io($h(e),t))}first(){return ir(this.node.firstChild)}get(e){return ir(this.node.childNodes[e])}getEventHolder(){return this.node}getEventTarget(){return this.node}has(e){return this.index(e)>=0}html(e,t){return this.xml(e,t,"http://www.w3.org/1999/xhtml")}id(e){return typeof e>"u"&&!this.node.id&&(this.node.id=CP(this.type)),this.attr("id",e)}index(e){return[].slice.call(this.node.childNodes).indexOf(e.node)}last(){return ir(this.node.lastChild)}matches(e){const t=this.node,i=t.matches||t.matchesSelector||t.msMatchesSelector||t.mozMatchesSelector||t.webkitMatchesSelector||t.oMatchesSelector||null;return i&&i.call(t,e)}parent(e){let t=this;if(!t.node.parentNode)return null;if(t=ir(t.node.parentNode),!e)return t;do{if("string"==typeof e?t.matches(e):t instanceof e)return t}while(t=ir(t.node.parentNode));return t}put(e,t){return e=Ti(e),this.add(e,t),e}putIn(e,t){return Ti(e).add(this,t)}remove(){return this.parent()&&this.parent().removeElement(this),this}removeElement(e){return this.node.removeChild(e.node),this}replace(e){return e=Ti(e),this.node.parentNode&&this.node.parentNode.replaceChild(e.node,this.node),e}round(e=2,t=null){const i=10**e,r=this.attr(t);for(const s in r)"number"==typeof r[s]&&(r[s]=Math.round(r[s]*i)/i);return this.attr(r),this}svg(e,t){return this.xml(e,t,tm)}toString(){return this.id()}words(e){return this.node.textContent=e,this}wrap(e){const t=this.parent();if(!t)return this.addTo(e);const i=t.index(this);return t.put(e,i).put(this)}writeDataToDom(){return this.each(function(){this.writeDataToDom()}),this}xml(e,t,i){if("boolean"==typeof e&&(i=t,t=e,e=null),null==e||"function"==typeof e){t=t??!0,this.writeDataToDom();let a=this;if(null!=e){if(a=ir(a.node.cloneNode(!0)),t){const c=e(a);if(a=c||a,!1===c)return""}a.each(function(){const c=e(this),l=c||this;!1===c?this.remove():c&&this!==l&&this.replace(l)},!0)}return t?a.node.outerHTML:a.node.innerHTML}t=t??!1;const r=$h("wrapper",i),s=yt.document.createDocumentFragment();r.innerHTML=e;for(let a=r.children.length;a--;)s.appendChild(r.firstElementChild);const o=this.parent();return t?this.replace(s)&&o:this.add(s)}}Ct(Io,{attr:function i9(n,e,t){if(null==n){n={},e=this.node.attributes;for(const i of e)n[i.nodeName]=Tb.test(i.nodeValue)?parseFloat(i.nodeValue):i.nodeValue;return n}if(n instanceof Array)return n.reduce((i,r)=>(i[r]=this.attr(r),i),{});if("object"==typeof n&&n.constructor===Object)for(e in n)this.attr(e,n[e]);else if(null===e)this.node.removeAttribute(n);else{if(null==e)return null==(e=this.node.getAttribute(n))?NP[n]:Tb.test(e)?parseFloat(e):e;"number"==typeof(e=FP.reduce((i,r)=>r(n,i,this),e))?e=new ot(e):Wt.isColor(e)?e=new Wt(e):e.constructor===Array&&(e=new Sl(e)),"leading"===n?this.leading&&this.leading(e):"string"==typeof t?this.node.setAttributeNS(t,n,e.toString()):this.node.setAttribute(n,e.toString()),this.rebuild&&("font-size"===n||"x"===n)&&this.rebuild()}return this},find:function K$(n){return wl(n,this.node)},findOne:function J$(n){return ir(this.node.querySelector(n))}}),At(Io,"Dom");class vs extends Io{constructor(e,t){super(e,t),this.dom={},this.node.instance=this,e.hasAttribute("svgjs:data")&&this.setData(JSON.parse(e.getAttribute("svgjs:data"))||{})}center(e,t){return this.cx(e).cy(t)}cx(e){return null==e?this.x()+this.width()/2:this.x(e-this.width()/2)}cy(e){return null==e?this.y()+this.height()/2:this.y(e-this.height()/2)}defs(){const e=this.root();return e&&e.defs()}dmove(e,t){return this.dx(e).dy(t)}dx(e=0){return this.x(new ot(e).plus(this.x()))}dy(e=0){return this.y(new ot(e).plus(this.y()))}getEventHolder(){return this}height(e){return this.attr("height",e)}move(e,t){return this.x(e).y(t)}parents(e=this.root()){const t="string"==typeof e;t||(e=Ti(e));const i=new Oa;let r=this;for(;(r=r.parent())&&r.node!==yt.document&&"#document-fragment"!==r.nodeName&&(i.push(r),!(!t&&r.node===e.node||t&&r.matches(e)));)if(r.node===this.root().node)return null;return i}reference(e){if(!(e=this.attr(e)))return null;const t=(e+"").match(TP);return t?Ti(t[1]):null}root(){const e=this.parent(function d$(n){return Ra[n]}(Mb));return e&&e.root()}setData(e){return this.dom=e,this}size(e,t){const i=Pa(this,e,t);return this.width(new ot(i.width)).height(new ot(i.height))}width(e){return this.attr("width",e)}writeDataToDom(){return this.node.removeAttribute("svgjs:data"),Object.keys(this.dom).length&&this.node.setAttribute("svgjs:data",JSON.stringify(this.dom)),super.writeDataToDom()}x(e){return this.attr("x",e)}y(e){return this.attr("y",e)}}Ct(vs,{bbox:function q$(){const t=OP(this,r=>r.getBBox(),r=>{try{const s=r.clone().addTo(Ao().svg).show(),o=s.node.getBBox();return s.remove(),o}catch(s){throw new Error(`Getting bbox of element "${r.node.nodeName}" is not possible: ${s.toString()}`)}});return new _i(t)},rbox:function X$(n){const i=OP(this,s=>s.getBoundingClientRect(),s=>{throw new Error(`Getting rbox of element "${s.node.nodeName}" is not possible`)}),r=new _i(i);return n?r.transform(n.screenCTM().inverseO()):r.addOffset()},inside:function Y$(n,e){const t=this.bbox();return n>t.x&&e>t.y&&n<t.x+t.width&&e<t.y+t.height},point:function G$(n,e){return new Dn(n,e).transform(this.screenCTM().inverse())},ctm:function j$(){return new je(this.node.getCTM())},screenCTM:function W$(){if("function"==typeof this.isRoot&&!this.isRoot()){const n=this.rect(1,1),e=n.node.getScreenCTM();return n.remove(),new je(e)}return new je(this.node.getScreenCTM())}}),At(vs,"Element");const Xh={stroke:["color","width","opacity","linecap","linejoin","miterlimit","dasharray","dashoffset"],fill:["color","opacity","rule"],prefix:function(n,e){return"color"===e?n:n+"-"+e}};["fill","stroke"].forEach(function(n){const e={};let t;e[n]=function(i){if(typeof i>"u")return this.attr(n);if("string"==typeof i||i instanceof Wt||Wt.isRgb(i)||i instanceof vs)this.attr(n,i);else for(t=Xh[n].length-1;t>=0;t--)null!=i[Xh[n][t]]&&this.attr(Xh.prefix(n,Xh[n][t]),i[Xh[n][t]]);return this},mt(["Element","Runner"],e)}),mt(["Element","Runner"],{matrix:function(n,e,t,i,r,s){return null==n?new je(this):this.attr("transform",new je(n,e,t,i,r,s))},rotate:function(n,e,t){return this.transform({rotate:n,ox:e,oy:t},!0)},skew:function(n,e,t,i){return this.transform(1===arguments.length||3===arguments.length?{skew:n,ox:e,oy:t}:{skew:[n,e],ox:t,oy:i},!0)},shear:function(n,e,t){return this.transform({shear:n,ox:e,oy:t},!0)},scale:function(n,e,t,i){return this.transform(1===arguments.length||3===arguments.length?{scale:n,ox:e,oy:t}:{scale:[n,e],ox:t,oy:i},!0)},translate:function(n,e){return this.transform({translate:[n,e]},!0)},relative:function(n,e){return this.transform({relative:[n,e]},!0)},flip:function(n="both",e="center"){return-1==="xybothtrue".indexOf(n)&&(e=n,n="both"),this.transform({flip:n,origin:e},!0)},opacity:function(n){return this.attr("opacity",n)}}),mt("radius",{radius:function(n,e=n){return"radialGradient"===(this._element||this).type?this.attr("r",new ot(n)):this.rx(n).ry(e)}}),mt("Path",{length:function(){return this.node.getTotalLength()},pointAt:function(n){return new Dn(this.node.getPointAtLength(n))}}),mt(["Element","Runner"],{font:function(n,e){if("object"==typeof n){for(e in n)this.font(e,n[e]);return this}return"leading"===n?this.leading(e):this.attr("anchor"===n?"text-anchor":"size"===n||"family"===n||"weight"===n||"stretch"===n||"variant"===n||"style"===n?"font-"+n:n,e)}}),mt("Element",["click","dblclick","mousedown","mouseup","mouseover","mouseout","mousemove","mouseenter","mouseleave","touchstart","touchmove","touchleave","touchend","touchcancel"].reduce(function(n,e){return n[e]=function(i){return null===i?this.off(e):this.on(e,i),this},n},{})),mt("Element",{untransform:function s9(){return this.attr("transform",null)},matrixify:function o9(){return(this.attr("transform")||"").split(AP).slice(0,-1).map(function(e){const t=e.trim().split("(");return[t[0],t[1].split(ys).map(function(i){return parseFloat(i)})]}).reverse().reduce(function(e,t){return"matrix"===t[0]?e.lmultiply(je.fromArray(t[1])):e[t[0]].apply(e,t[1])},new je)},toParent:function a9(n,e){if(this===n)return this;const t=this.screenCTM(),i=n.screenCTM().inverse();return this.addTo(n,e).untransform().transform(i.multiply(t)),this},toRoot:function c9(n){return this.toParent(this.root(),n)},transform:function l9(n,e){if(null==n||"string"==typeof n){const r=new je(this).decompose();return null==n?r:r[n]}je.isMatrixLike(n)||(n={...n,origin:em(n,this)});const i=new je(!0===e?this:e||!1).transform(n);return this.attr("transform",i)}});class Hi extends vs{flatten(e=this,t){return this.each(function(){if(this instanceof Hi)return this.flatten().ungroup()}),this}ungroup(e=this.parent(),t=e.index(this)){return t=-1===t?e.children().length:t,this.each(function(i,r){return r[r.length-i-1].toParent(e,t)}),this.remove()}}At(Hi,"Container");class Ob extends Hi{constructor(e,t=e){super(an("defs",e),t)}flatten(){return this}ungroup(){return this}}At(Ob,"Defs");class rr extends vs{}function kb(n){return this.attr("rx",n)}function Lb(n){return this.attr("ry",n)}function VP(n){return null==n?this.cx()-this.rx():this.cx(n+this.rx())}function BP(n){return null==n?this.cy()-this.ry():this.cy(n+this.ry())}function UP(n){return this.attr("cx",n)}function zP(n){return this.attr("cy",n)}function HP(n){return null==n?2*this.rx():this.rx(new ot(n).divide(2))}function GP(n){return null==n?2*this.ry():this.ry(new ot(n).divide(2))}At(rr,"Shape");var u9={__proto__:null,rx:kb,ry:Lb,x:VP,y:BP,cx:UP,cy:zP,width:HP,height:GP};class sm extends rr{constructor(e,t=e){super(an("ellipse",e),t)}size(e,t){const i=Pa(this,e,t);return this.rx(new ot(i.width).divide(2)).ry(new ot(i.height).divide(2))}}Ct(sm,u9),mt("Container",{ellipse:cn(function(n=0,e=n){return this.put(new sm).size(n,e).move(0,0)})}),At(sm,"Ellipse");class jP extends Io{constructor(e=yt.document.createDocumentFragment()){super(e)}xml(e,t,i){if("boolean"==typeof e&&(i=t,t=e,e=null),null==e||"function"==typeof e){const r=new Io($h("wrapper",i));return r.add(this.node.cloneNode(!0)),r.xml(!1,i)}return super.xml(e,!1,i)}}function WP(n,e){return this.attr("radialGradient"===(this._element||this).type?{fx:new ot(n),fy:new ot(e)}:{x1:new ot(n),y1:new ot(e)})}function $P(n,e){return this.attr("radialGradient"===(this._element||this).type?{cx:new ot(n),cy:new ot(e)}:{x2:new ot(n),y2:new ot(e)})}At(jP,"Fragment");var h9={__proto__:null,from:WP,to:$P};class Yh extends Hi{constructor(e,t){super(an(e+"Gradient","string"==typeof e?null:e),t)}attr(e,t,i){return"transform"===e&&(e="gradientTransform"),super.attr(e,t,i)}bbox(){return new _i}targets(){return wl('svg [fill*="'+this.id()+'"]')}toString(){return this.url()}update(e){return this.clear(),"function"==typeof e&&e.call(this,this),this}url(){return'url("#'+this.id()+'")'}}Ct(Yh,h9),mt({Container:{gradient(...n){return this.defs().gradient(...n)}},Defs:{gradient:cn(function(n,e){return this.put(new Yh(n)).update(e)})}}),At(Yh,"Gradient");class Zh extends Hi{constructor(e,t=e){super(an("pattern",e),t)}attr(e,t,i){return"transform"===e&&(e="patternTransform"),super.attr(e,t,i)}bbox(){return new _i}targets(){return wl('svg [fill*="'+this.id()+'"]')}toString(){return this.url()}update(e){return this.clear(),"function"==typeof e&&e.call(this,this),this}url(){return'url("#'+this.id()+'")'}}mt({Container:{pattern(...n){return this.defs().pattern(...n)}},Defs:{pattern:cn(function(n,e,t){return this.put(new Zh).update(t).attr({x:0,y:0,width:n,height:e,patternUnits:"userSpaceOnUse"})})}}),At(Zh,"Pattern");class om extends rr{constructor(e,t=e){super(an("image",e),t)}load(e,t){if(!e)return this;const i=new yt.window.Image;return Pb(i,"load",function(r){const s=this.parent(Zh);0===this.width()&&0===this.height()&&this.size(i.width,i.height),s instanceof Zh&&0===s.width()&&0===s.height()&&s.size(this.width(),this.height()),"function"==typeof t&&t.call(this,r)},this),Pb(i,"load error",function(){Ml(i)}),this.attr("href",i.src=e,vl)}}(function n9(n){FP.push(n)})(function(n,e,t){return("fill"===n||"stroke"===n)&&PP.test(e)&&(e=t.root().defs().image(e)),e instanceof om&&(e=t.root().defs().pattern(0,0,i=>{i.add(e)})),e}),mt({Container:{image:cn(function(n,e){return this.put(new om).size(0,0).load(n,e)})}}),At(om,"Image");class Po extends Sl{bbox(){let e=-1/0,t=-1/0,i=1/0,r=1/0;return this.forEach(function(s){e=Math.max(s[0],e),t=Math.max(s[1],t),i=Math.min(s[0],i),r=Math.min(s[1],r)}),new _i(i,r,e-i,t-r)}move(e,t){const i=this.bbox();if(e-=i.x,t-=i.y,!isNaN(e)&&!isNaN(t))for(let r=this.length-1;r>=0;r--)this[r]=[this[r][0]+e,this[r][1]+t];return this}parse(e=[0,0]){const t=[];(e=e instanceof Array?Array.prototype.concat.apply([],e):e.trim().split(ys).map(parseFloat)).length%2!=0&&e.pop();for(let i=0,r=e.length;i<r;i+=2)t.push([e[i],e[i+1]]);return t}size(e,t){let i;const r=this.bbox();for(i=this.length-1;i>=0;i--)r.width&&(this[i][0]=(this[i][0]-r.x)*e/r.width+r.x),r.height&&(this[i][1]=(this[i][1]-r.y)*t/r.height+r.y);return this}toLine(){return{x1:this[0][0],y1:this[0][1],x2:this[1][0],y2:this[1][1]}}toString(){const e=[];for(let t=0,i=this.length;t<i;t++)e.push(this[t].join(","));return e.join(" ")}transform(e){return this.clone().transformO(e)}transformO(e){je.isMatrixLike(e)||(e=new je(e));for(let t=this.length;t--;){const[i,r]=this[t];this[t][0]=e.a*i+e.c*r+e.e,this[t][1]=e.b*i+e.d*r+e.f}return this}}var Nb={__proto__:null,MorphArray:Po,x:function f9(n){return null==n?this.bbox().x:this.move(n,this.bbox().y)},y:function p9(n){return null==n?this.bbox().y:this.move(this.bbox().x,n)},width:function m9(n){const e=this.bbox();return null==n?e.width:this.size(n,e.height)},height:function g9(n){const e=this.bbox();return null==n?e.height:this.size(e.width,n)}};class Kh extends rr{constructor(e,t=e){super(an("line",e),t)}array(){return new Po([[this.attr("x1"),this.attr("y1")],[this.attr("x2"),this.attr("y2")]])}move(e,t){return this.attr(this.array().move(e,t).toLine())}plot(e,t,i,r){return null==e?this.array():(e=typeof t<"u"?{x1:e,y1:t,x2:i,y2:r}:new Po(e).toLine(),this.attr(e))}size(e,t){const i=Pa(this,e,t);return this.attr(this.array().size(i.width,i.height).toLine())}}Ct(Kh,Nb),mt({Container:{line:cn(function(...n){return Kh.prototype.plot.apply(this.put(new Kh),null!=n[0]?n:[0,0,0,0])})}}),At(Kh,"Line");class am extends Hi{constructor(e,t=e){super(an("marker",e),t)}height(e){return this.attr("markerHeight",e)}orient(e){return this.attr("orient",e)}ref(e,t){return this.attr("refX",e).attr("refY",t)}toString(){return"url(#"+this.id()+")"}update(e){return this.clear(),"function"==typeof e&&e.call(this,this),this}width(e){return this.attr("markerWidth",e)}}function El(n,e){return function(t){return null==t?this[n]:(this[n]=t,e&&e.call(this),this)}}mt({Container:{marker(...n){return this.defs().marker(...n)}},Defs:{marker:cn(function(n,e,t){return this.put(new am).size(n,e).ref(n/2,e/2).viewbox(0,0,n,e).attr("orient","auto").update(t)})},marker:{marker(n,e,t,i){let r=["marker"];return"all"!==n&&r.push(n),r=r.join("-"),n=arguments[1]instanceof am?arguments[1]:this.defs().marker(e,t,i),this.attr(r,n)}}}),At(am,"Marker");const _9={"-":function(n){return n},"<>":function(n){return-Math.cos(n*Math.PI)/2+.5},">":function(n){return Math.sin(n*Math.PI/2)},"<":function(n){return 1-Math.cos(n*Math.PI/2)},bezier:function(n,e,t,i){return function(r){return r<0?n>0?e/n*r:t>0?i/t*r:0:r>1?t<1?(1-i)/(1-t)*r+(i-t)/(1-t):n<1?(1-e)/(1-n)*r+(e-n)/(1-n):1:3*r*(1-r)**2*e+3*r**2*(1-r)*i+r**3}},steps:function(n,e="end"){e=e.split("-").reverse()[0];let t=n;return"none"===e?--t:"both"===e&&++t,(i,r=!1)=>{let s=Math.floor(i*n);const o=i*s%1==0;return("start"===e||"both"===e)&&++s,r&&o&&--s,i>=0&&s<0&&(s=0),i<=1&&s>t&&(s=t),s/t}}};class Fb{done(){return!1}}class Vb extends Fb{constructor(e=Cl_ease){super(),this.ease=_9[e]||e}step(e,t,i){return"number"!=typeof e?i<1?e:t:e+(t-e)*this.ease(i)}}class cm extends Fb{constructor(e){super(),this.stepper=e}done(e){return e.done}step(e,t,i,r){return this.stepper(e,t,i,r)}}function qP(){const n=(this._duration||500)/1e3,i=Math.PI,r=Math.log((this._overshoot||0)/100+1e-10),s=-r/Math.sqrt(i*i+r*r),o=3.9/(s*n);this.d=2*s*o,this.k=o*o}Ct(class y9 extends cm{constructor(e=500,t=0){super(),this.duration(e).overshoot(t)}step(e,t,i,r){if("string"==typeof e)return e;if(r.done=i===1/0,i===1/0)return t;if(0===i)return e;i>100&&(i=16);const s=r.velocity||0,o=-this.d*s-this.k*(e-t),a=e+s*(i/=1e3)+o*i*i/2;return r.velocity=s+o*i,r.done=Math.abs(t-a)+Math.abs(s)<.002,r.done?t:a}},{duration:El("_duration",qP),overshoot:El("_overshoot",qP)}),Ct(class v9 extends cm{constructor(e=.1,t=.01,i=0,r=1e3){super(),this.p(e).i(t).d(i).windup(r)}step(e,t,i,r){if("string"==typeof e)return e;if(r.done=i===1/0,i===1/0)return t;if(0===i)return e;const s=t-e;let o=(r.integral||0)+s*i;const a=(s-(r.error||0))/i,c=this._windup;return!1!==c&&(o=Math.max(-c,Math.min(o,c))),r.error=s,r.integral=o,r.done=Math.abs(s)<.001,r.done?t:e+(this.P*s+this.I*o+this.D*a)}},{windup:El("_windup"),p:El("P"),i:El("I"),d:El("D")});const b9={M:2,L:2,H:1,V:1,C:6,S:4,Q:4,T:2,A:7,Z:0},Bb={M:function(n,e,t){return e.x=t.x=n[0],e.y=t.y=n[1],["M",e.x,e.y]},L:function(n,e){return e.x=n[0],e.y=n[1],["L",n[0],n[1]]},H:function(n,e){return e.x=n[0],["H",n[0]]},V:function(n,e){return e.y=n[0],["V",n[0]]},C:function(n,e){return e.x=n[4],e.y=n[5],["C",n[0],n[1],n[2],n[3],n[4],n[5]]},S:function(n,e){return e.x=n[2],e.y=n[3],["S",n[0],n[1],n[2],n[3]]},Q:function(n,e){return e.x=n[2],e.y=n[3],["Q",n[0],n[1],n[2],n[3]]},T:function(n,e){return e.x=n[0],e.y=n[1],["T",n[0],n[1]]},Z:function(n,e,t){return e.x=t.x,e.y=t.y,["Z"]},A:function(n,e){return e.x=n[5],e.y=n[6],["A",n[0],n[1],n[2],n[3],n[4],n[5],n[6]]}},Ub="mlhvqtcsaz".split("");for(let n=0,e=Ub.length;n<e;++n)Bb[Ub[n]]=function(t){return function(i,r,s){if("H"===t)i[0]=i[0]+r.x;else if("V"===t)i[0]=i[0]+r.y;else if("A"===t)i[5]=i[5]+r.x,i[6]=i[6]+r.y;else for(let o=0,a=i.length;o<a;++o)i[o]=i[o]+(o%2?r.y:r.x);return Bb[t](i,r,s)}}(Ub[n].toUpperCase());function zb(n){return n.segment.length&&n.segment.length-1===b9[n.segment[0].toUpperCase()]}function w9(n,e){n.inNumber&&ka(n,!1);const t=rm.test(e);if(t)n.segment=[e];else{const i=n.lastCommand,r=i.toLowerCase(),s=i===r;n.segment=["m"===r?s?"l":"L":i]}return n.inSegment=!0,n.lastCommand=n.segment[0],t}function ka(n,e){if(!n.inNumber)throw new Error("Parser Error");n.number&&n.segment.push(parseFloat(n.number)),n.inNumber=e,n.number="",n.pointSeen=!1,n.hasExponent=!1,zb(n)&&Hb(n)}function Hb(n){n.inSegment=!1,n.absolute&&(n.segment=function x9(n){return Bb[n.segment[0]](n.segment.slice(1),n.p,n.p0)}(n)),n.segments.push(n.segment)}function M9(n){if(!n.segment.length)return!1;const e="A"===n.segment[0].toUpperCase(),t=n.segment.length;return e&&(4===t||5===t)}function C9(n){return"E"===n.lastToken.toUpperCase()}class La extends Sl{bbox(){return Ao().path.setAttribute("d",this.toString()),new _i(Ao.nodes.path.getBBox())}move(e,t){const i=this.bbox();if(e-=i.x,t-=i.y,!isNaN(e)&&!isNaN(t))for(let r,s=this.length-1;s>=0;s--)r=this[s][0],"M"===r||"L"===r||"T"===r?(this[s][1]+=e,this[s][2]+=t):"H"===r?this[s][1]+=e:"V"===r?this[s][1]+=t:"C"===r||"S"===r||"Q"===r?(this[s][1]+=e,this[s][2]+=t,this[s][3]+=e,this[s][4]+=t,"C"===r&&(this[s][5]+=e,this[s][6]+=t)):"A"===r&&(this[s][6]+=e,this[s][7]+=t);return this}parse(e="M0 0"){return Array.isArray(e)&&(e=Array.prototype.concat.apply([],e).toString()),function S9(n,e=!0){let t=0,i="";const r={segment:[],inNumber:!1,number:"",lastToken:"",inSegment:!1,segments:[],pointSeen:!1,hasExponent:!1,absolute:e,p0:new Dn,p:new Dn};for(;r.lastToken=i,i=n.charAt(t++);)if(r.inSegment||!w9(r,i)){if("."===i){if(r.pointSeen||r.hasExponent){ka(r,!1),--t;continue}r.inNumber=!0,r.pointSeen=!0,r.number+=i;continue}if(!isNaN(parseInt(i))){if("0"===r.number||M9(r)){r.inNumber=!0,r.number=i,ka(r,!0);continue}r.inNumber=!0,r.number+=i;continue}if(" "===i||","===i){r.inNumber&&ka(r,!1);continue}if("-"===i){if(r.inNumber&&!C9(r)){ka(r,!1),--t;continue}r.number+=i,r.inNumber=!0;continue}if("E"===i.toUpperCase()){r.number+=i,r.hasExponent=!0;continue}if(rm.test(i)){if(r.inNumber)ka(r,!1);else{if(!zb(r))throw new Error("parser Error");Hb(r)}--t}}return r.inNumber&&ka(r,!1),r.inSegment&&zb(r)&&Hb(r),r.segments}(e)}size(e,t){const i=this.bbox();let r,s;for(i.width=0===i.width?1:i.width,i.height=0===i.height?1:i.height,r=this.length-1;r>=0;r--)s=this[r][0],"M"===s||"L"===s||"T"===s?(this[r][1]=(this[r][1]-i.x)*e/i.width+i.x,this[r][2]=(this[r][2]-i.y)*t/i.height+i.y):"H"===s?this[r][1]=(this[r][1]-i.x)*e/i.width+i.x:"V"===s?this[r][1]=(this[r][1]-i.y)*t/i.height+i.y:"C"===s||"S"===s||"Q"===s?(this[r][1]=(this[r][1]-i.x)*e/i.width+i.x,this[r][2]=(this[r][2]-i.y)*t/i.height+i.y,this[r][3]=(this[r][3]-i.x)*e/i.width+i.x,this[r][4]=(this[r][4]-i.y)*t/i.height+i.y,"C"===s&&(this[r][5]=(this[r][5]-i.x)*e/i.width+i.x,this[r][6]=(this[r][6]-i.y)*t/i.height+i.y)):"A"===s&&(this[r][1]=this[r][1]*e/i.width,this[r][2]=this[r][2]*t/i.height,this[r][6]=(this[r][6]-i.x)*e/i.width+i.x,this[r][7]=(this[r][7]-i.y)*t/i.height+i.y);return this}toString(){return function E9(n){let e="";for(let t=0,i=n.length;t<i;t++)e+=n[t][0],null!=n[t][1]&&(e+=n[t][1],null!=n[t][2]&&(e+=" ",e+=n[t][2],null!=n[t][3]&&(e+=" ",e+=n[t][3],e+=" ",e+=n[t][4],null!=n[t][5]&&(e+=" ",e+=n[t][5],e+=" ",e+=n[t][6],null!=n[t][7]&&(e+=" ",e+=n[t][7])))));return e+" "}(this)}}const XP=n=>{const e=typeof n;return"number"===e?ot:"string"===e?Wt.isColor(n)?Wt:ys.test(n)?rm.test(n)?La:Sl:Cb.test(n)?ot:Gb:jb.indexOf(n.constructor)>-1?n.constructor:Array.isArray(n)?Sl:"object"===e?Jh:Gb};class Na{constructor(e){this._stepper=e||new Vb("-"),this._from=null,this._to=null,this._type=null,this._context=null,this._morphObj=null}at(e){return this._morphObj.morph(this._from,this._to,e,this._stepper,this._context)}done(){return this._context.map(this._stepper.done).reduce(function(t,i){return t&&i},!0)}from(e){return null==e?this._from:(this._from=this._set(e),this)}stepper(e){return null==e?this._stepper:(this._stepper=e,this)}to(e){return null==e?this._to:(this._to=this._set(e),this)}type(e){return null==e?this._type:(this._type=e,this)}_set(e){this._type||this.type(XP(e));let t=new this._type(e);return this._type===Wt&&(t=this._to?t[this._to[4]]():this._from?t[this._from[4]]():t),this._type===Jh&&(t=this._to?t.align(this._to):this._from?t.align(this._from):t),t=t.toConsumable(),this._morphObj=this._morphObj||new this._type,this._context=this._context||Array.apply(null,Array(t.length)).map(Object).map(function(i){return i.done=!0,i}),t}}class Gb{constructor(...e){this.init(...e)}init(e){return e=Array.isArray(e)?e[0]:e,this.value=e,this}toArray(){return[this.value]}valueOf(){return this.value}}let YP=(()=>{class n{constructor(...t){this.init(...t)}init(t){return Array.isArray(t)&&(t={scaleX:t[0],scaleY:t[1],shear:t[2],rotate:t[3],translateX:t[4],translateY:t[5],originX:t[6],originY:t[7]}),Object.assign(this,n.defaults,t),this}toArray(){const t=this;return[t.scaleX,t.scaleY,t.shear,t.rotate,t.translateX,t.translateY,t.originX,t.originY]}}return n.defaults={scaleX:1,scaleY:1,shear:0,rotate:0,translateX:0,translateY:0,originX:0,originY:0},n})();const D9=(n,e)=>n[0]<e[0]?-1:n[0]>e[0]?1:0;class Jh{constructor(...e){this.init(...e)}align(e){const t=this.values;for(let i=0,r=t.length;i<r;++i){if(t[i+1]===e[i+1]){if(t[i+1]===Wt&&e[i+7]!==t[i+7]){const a=e[i+7],c=new Wt(this.values.splice(i+3,5))[a]().toArray();this.values.splice(i+3,0,...c)}i+=t[i+2]+2;continue}if(!e[i+1])return this;const s=(new e[i+1]).toArray();t.splice(i,t[i+2]+3,e[i],e[i+1],e[i+2],...s),i+=t[i+2]+2}return this}init(e){if(this.values=[],Array.isArray(e))return void(this.values=e.slice());e=e||{};const t=[];for(const i in e){const r=XP(e[i]),s=new r(e[i]).toArray();t.push([i,r,s.length,...s])}return t.sort(D9),this.values=t.reduce((i,r)=>i.concat(r),[]),this}toArray(){return this.values}valueOf(){const e={},t=this.values;for(;t.length;){const i=t.shift(),r=t.shift(),s=t.shift(),o=t.splice(0,s);e[i]=new r(o)}return e}}const jb=[Gb,YP,Jh];class Dl extends rr{constructor(e,t=e){super(an("path",e),t)}array(){return this._array||(this._array=new La(this.attr("d")))}clear(){return delete this._array,this}height(e){return null==e?this.bbox().height:this.size(this.bbox().width,e)}move(e,t){return this.attr("d",this.array().move(e,t))}plot(e){return null==e?this.array():this.clear().attr("d","string"==typeof e?e:this._array=new La(e))}size(e,t){const i=Pa(this,e,t);return this.attr("d",this.array().size(i.width,i.height))}width(e){return null==e?this.bbox().width:this.size(e,this.bbox().height)}x(e){return null==e?this.bbox().x:this.move(e,this.bbox().y)}y(e){return null==e?this.bbox().y:this.move(this.bbox().x,e)}}Dl.prototype.MorphArray=La,mt({Container:{path:cn(function(n){return this.put(new Dl).plot(n||new La)})}}),At(Dl,"Path");var ZP={__proto__:null,array:function I9(){return this._array||(this._array=new Po(this.attr("points")))},clear:function P9(){return delete this._array,this},move:function R9(n,e){return this.attr("points",this.array().move(n,e))},plot:function O9(n){return null==n?this.array():this.clear().attr("points","string"==typeof n?n:this._array=new Po(n))},size:function k9(n,e){const t=Pa(this,n,e);return this.attr("points",this.array().size(t.width,t.height))}};class Qh extends rr{constructor(e,t=e){super(an("polygon",e),t)}}mt({Container:{polygon:cn(function(n){return this.put(new Qh).plot(n||new Po)})}}),Ct(Qh,Nb),Ct(Qh,ZP),At(Qh,"Polygon");class ed extends rr{constructor(e,t=e){super(an("polyline",e),t)}}mt({Container:{polyline:cn(function(n){return this.put(new ed).plot(n||new Po)})}}),Ct(ed,Nb),Ct(ed,ZP),At(ed,"Polyline");class lm extends rr{constructor(e,t=e){super(an("rect",e),t)}}Ct(lm,{rx:kb,ry:Lb}),mt({Container:{rect:cn(function(n,e){return this.put(new lm).size(n,e)})}}),At(lm,"Rect");class Wb{constructor(){this._first=null,this._last=null}first(){return this._first&&this._first.value}last(){return this._last&&this._last.value}push(e){const t=typeof e.next<"u"?e:{value:e,next:null,prev:null};return this._last?(t.prev=this._last,this._last.next=t,this._last=t):(this._last=t,this._first=t),t}remove(e){e.prev&&(e.prev.next=e.next),e.next&&(e.next.prev=e.prev),e===this._last&&(this._last=e.prev),e===this._first&&(this._first=e.next),e.prev=null,e.next=null}shift(){const e=this._first;return e?(this._first=e.next,this._first&&(this._first.prev=null),this._last=this._first?this._last:null,e.value):null}}const Bt={nextDraw:null,frames:new Wb,timeouts:new Wb,immediates:new Wb,timer:()=>yt.window.performance||yt.window.Date,transforms:[],frame(n){const e=Bt.frames.push({run:n});return null===Bt.nextDraw&&(Bt.nextDraw=yt.window.requestAnimationFrame(Bt._draw)),e},timeout(n,e){e=e||0;const t=Bt.timer().now()+e,i=Bt.timeouts.push({run:n,time:t});return null===Bt.nextDraw&&(Bt.nextDraw=yt.window.requestAnimationFrame(Bt._draw)),i},immediate(n){const e=Bt.immediates.push(n);return null===Bt.nextDraw&&(Bt.nextDraw=yt.window.requestAnimationFrame(Bt._draw)),e},cancelFrame(n){null!=n&&Bt.frames.remove(n)},clearTimeout(n){null!=n&&Bt.timeouts.remove(n)},cancelImmediate(n){null!=n&&Bt.immediates.remove(n)},_draw(n){let e=null;const t=Bt.timeouts.last();for(;(e=Bt.timeouts.shift())&&(n>=e.time?e.run():Bt.timeouts.push(e),e!==t););let i=null;const r=Bt.frames.last();for(;i!==r&&(i=Bt.frames.shift());)i.run(n);let s=null;for(;s=Bt.immediates.shift();)s();Bt.nextDraw=Bt.timeouts.first()||Bt.frames.first()?yt.window.requestAnimationFrame(Bt._draw):null}},L9=function(n){const e=n.start,t=n.runner.duration();return{start:e,duration:t,end:e+t,runner:n.runner}},N9=function(){const n=yt.window;return(n.performance||n.Date).now()};class KP extends qh{constructor(e=N9){super(),this._timeSource=e,this._startTime=0,this._speed=1,this._persist=0,this._nextFrame=null,this._paused=!0,this._runners=[],this._runnerIds=[],this._lastRunnerId=-1,this._time=0,this._lastSourceTime=0,this._lastStepTime=0,this._step=this._stepFn.bind(this,!1),this._stepImmediate=this._stepFn.bind(this,!0)}active(){return!!this._nextFrame}finish(){return this.time(this.getEndTimeOfTimeline()+1),this.pause()}getEndTime(){const e=this.getLastRunnerInfo(),t=e?e.runner.duration():0;return(e?e.start:this._time)+t}getEndTimeOfTimeline(){const e=this._runners.map(t=>t.start+t.runner.duration());return Math.max(0,...e)}getLastRunnerInfo(){return this.getRunnerInfoById(this._lastRunnerId)}getRunnerInfoById(e){return this._runners[this._runnerIds.indexOf(e)]||null}pause(){return this._paused=!0,this._continue()}persist(e){return null==e?this._persist:(this._persist=e,this)}play(){return this._paused=!1,this.updateTime()._continue()}reverse(e){const t=this.speed();if(null==e)return this.speed(-t);const i=Math.abs(t);return this.speed(e?-i:i)}schedule(e,t,i){if(null==e)return this._runners.map(L9);let r=0;const s=this.getEndTime();if(t=t||0,null==i||"last"===i||"after"===i)r=s;else if("absolute"===i||"start"===i)r=t,t=0;else if("now"===i)r=this._time;else if("relative"===i){const c=this.getRunnerInfoById(e.id);c&&(r=c.start+t,t=0)}else{if("with-last"!==i)throw new Error('Invalid value for the "when" parameter');{const c=this.getLastRunnerInfo();r=c?c.start:this._time}}e.unschedule(),e.timeline(this);const o=e.persist(),a={persist:null===o?this._persist:o,start:r+t,runner:e};return this._lastRunnerId=e.id,this._runners.push(a),this._runners.sort((c,l)=>c.start-l.start),this._runnerIds=this._runners.map(c=>c.runner.id),this.updateTime()._continue(),this}seek(e){return this.time(this._time+e)}source(e){return null==e?this._timeSource:(this._timeSource=e,this)}speed(e){return null==e?this._speed:(this._speed=e,this)}stop(){return this.time(0),this.pause()}time(e){return null==e?this._time:(this._time=e,this._continue(!0))}unschedule(e){const t=this._runnerIds.indexOf(e.id);return t<0||(this._runners.splice(t,1),this._runnerIds.splice(t,1),e.timeline(null)),this}updateTime(){return this.active()||(this._lastSourceTime=this._timeSource()),this}_continue(e=!1){return Bt.cancelFrame(this._nextFrame),this._nextFrame=null,e?this._stepImmediate():(this._paused||(this._nextFrame=Bt.frame(this._step)),this)}_stepFn(e=!1){const t=this._timeSource();let i=t-this._lastSourceTime;e&&(i=0);const r=this._speed*i+(this._time-this._lastStepTime);this._lastSourceTime=t,e||(this._time+=r,this._time=this._time<0?0:this._time),this._lastStepTime=this._time,this.fire("time",this._time);for(let o=this._runners.length;o--;){const a=this._runners[o],c=a.runner;this._time-a.start<=0&&c.reset()}let s=!1;for(let o=0,a=this._runners.length;o<a;o++){const c=this._runners[o],l=c.runner;let u=r;const h=this._time-c.start;h<=0?s=!0:(h<u&&(u=h),l.active()&&(l.step(u).done?!0!==c.persist&&l.duration()-l.time()+this._time+c.persist<this._time&&(l.unschedule(),--o,--a):s=!0))}return s&&!(this._speed<0&&0===this._time)||this._runnerIds.length&&this._speed<0&&this._time>0?this._continue():(this.pause(),this.fire("finished")),this}}mt({Element:{timeline:function(n){return null==n?(this._timeline=this._timeline||new KP,this._timeline):(this._timeline=n,this)}}});let Ro=(()=>{class n extends qh{constructor(t){super(),this.id=n.id++,t="function"==typeof(t=t??Cl_duration)?new cm(t):t,this._element=null,this._timeline=null,this.done=!1,this._queue=[],this._duration="number"==typeof t&&t,this._isDeclarative=t instanceof cm,this._stepper=this._isDeclarative?t:new Vb,this._history={},this.enabled=!0,this._time=0,this._lastTime=0,this._reseted=!0,this.transforms=new je,this.transformId=1,this._haveReversed=!1,this._reverse=!1,this._loopsDone=0,this._swing=!1,this._wait=0,this._times=1,this._frameId=null,this._persist=!!this._isDeclarative||null}static sanitise(t,i,r){let s=1,o=!1,a=0;return i=i||Cl_delay,r=r||"last","object"==typeof(t=t||Cl_duration)&&!(t instanceof Fb)&&(i=t.delay||i,r=t.when||r,o=t.swing||o,s=t.times||s,a=t.wait||a,t=t.duration||Cl_duration),{duration:t,delay:i,swing:o,times:s,wait:a,when:r}}active(t){return null==t?this.enabled:(this.enabled=t,this)}addTransform(t,i){return this.transforms.lmultiplyO(t),this}after(t){return this.on("finished",t)}animate(t,i,r){const s=n.sanitise(t,i,r),o=new n(s.duration);return this._timeline&&o.timeline(this._timeline),this._element&&o.element(this._element),o.loop(s).schedule(s.delay,s.when)}clearTransform(){return this.transforms=new je,this}clearTransformsFromQueue(){(!this.done||!this._timeline||!this._timeline._runnerIds.includes(this.id))&&(this._queue=this._queue.filter(t=>!t.isTransform))}delay(t){return this.animate(0,t)}duration(){return this._times*(this._wait+this._duration)-this._wait}during(t){return this.queue(null,t)}ease(t){return this._stepper=new Vb(t),this}element(t){return null==t?this._element:(this._element=t,t._prepareRunner(),this)}finish(){return this.step(1/0)}loop(t,i,r){return"object"==typeof t&&(i=t.swing,r=t.wait,t=t.times),this._times=t||1/0,this._swing=i||!1,this._wait=r||0,!0===this._times&&(this._times=1/0),this}loops(t){const i=this._duration+this._wait;if(null==t){const a=Math.floor(this._time/i);return Math.min(a+(this._time-a*i)/this._duration,this._times)}const r=Math.floor(t);return this.time(i*r+this._duration*(t%1))}persist(t){return null==t?this._persist:(this._persist=t,this)}position(t){const i=this._time,r=this._duration,s=this._wait,a=this._swing,c=this._reverse;let l;if(null==t){const f=function(m){const g=a*Math.floor(m%(2*(s+r))/(s+r)),_=g&&!c||!g&&c,b=Math.pow(-1,_)*(m%(s+r))/r+_;return Math.max(Math.min(b,1),0)},p=this._times*(s+r)-s;return l=i<=0?Math.round(f(1e-5)):i<p?f(i):Math.round(f(p-1e-5)),l}const u=Math.floor(this.loops()),h=a&&u%2==0;return l=u+(h&&!c||c&&h?t:1-t),this.loops(l)}progress(t){return null==t?Math.min(1,this._time/this.duration()):this.time(t*this.duration())}queue(t,i,r,s){return this._queue.push({initialiser:t||Rb,runner:i||Rb,retarget:r,isTransform:s,initialised:!1,finished:!1}),this.timeline()&&this.timeline()._continue(),this}reset(){return this._reseted||(this.time(0),this._reseted=!0),this}reverse(t){return this._reverse=t??!this._reverse,this}schedule(t,i,r){if(t instanceof KP||(r=i,i=t,t=this.timeline()),!t)throw Error("Runner cannot be scheduled without timeline");return t.schedule(this,i,r),this}step(t){if(!this.enabled)return this;this._time+=t=t??16;const i=this.position(),r=this._lastPosition!==i&&this._time>=0;this._lastPosition=i;const s=this.duration(),o=this._lastTime<=0&&this._time>0,a=this._lastTime<s&&this._time>=s;this._lastTime=this._time,o&&this.fire("start",this);const c=this._isDeclarative;this.done=!c&&!a&&this._time>=s,this._reseted=!1;let l=!1;return(r||c)&&(this._initialise(r),this.transforms=new je,l=this._run(c?t:i),this.fire("step",this)),this.done=this.done||l&&c,a&&this.fire("finished",this),this}time(t){return null==t?this._time:(this.step(t-this._time),this)}timeline(t){return typeof t>"u"?this._timeline:(this._timeline=t,this)}unschedule(){const t=this.timeline();return t&&t.unschedule(this),this}_initialise(t){if(t||this._isDeclarative)for(let i=0,r=this._queue.length;i<r;++i){const s=this._queue[i],o=this._isDeclarative||!s.initialised&&t;t=!s.finished,o&&t&&(s.initialiser.call(this),s.initialised=!0)}}_rememberMorpher(t,i){if(this._history[t]={morpher:i,caller:this._queue[this._queue.length-1]},this._isDeclarative){const r=this.timeline();r&&r.play()}}_run(t){let i=!0;for(let r=0,s=this._queue.length;r<s;++r){const o=this._queue[r],a=o.runner.call(this,t);o.finished=o.finished||!0===a,i=i&&o.finished}return i}_tryRetarget(t,i,r){if(this._history[t]){if(!this._history[t].caller.initialised){const o=this._queue.indexOf(this._history[t].caller);return this._queue.splice(o,1),!1}this._history[t].caller.retarget?this._history[t].caller.retarget.call(this,i,r):this._history[t].morpher.to(i),this._history[t].caller.finished=!1;const s=this.timeline();return s&&s.play(),!0}return!1}}return n.id=0,n})();class um{constructor(e=new je,t=-1,i=!0){this.transforms=e,this.id=t,this.done=i}clearTransformsFromQueue(){}}Ct([Ro,um],{mergeWith(n){return new um(n.transforms.lmultiply(this.transforms),n.id)}});const JP=(n,e)=>n.lmultiplyO(e),QP=n=>n.transforms;function F9(){const e=this._transformationRunners.runners.map(QP).reduce(JP,new je);this.transform(e),this._transformationRunners.merge(),1===this._transformationRunners.length()&&(this._frameId=null)}class V9{constructor(){this.runners=[],this.ids=[]}add(e){if(this.runners.includes(e))return;const t=e.id+1;return this.runners.push(e),this.ids.push(t),this}clearBefore(e){const t=this.ids.indexOf(e+1)||1;return this.ids.splice(0,t,0),this.runners.splice(0,t,new um).forEach(i=>i.clearTransformsFromQueue()),this}edit(e,t){const i=this.ids.indexOf(e+1);return this.ids.splice(i,1,e+1),this.runners.splice(i,1,t),this}getByID(e){return this.runners[this.ids.indexOf(e+1)]}length(){return this.ids.length}merge(){let e=null;for(let t=0;t<this.runners.length;++t){const i=this.runners[t];if(!(e&&i.done&&e.done)||i._timeline&&i._timeline._runnerIds.includes(i.id)||e._timeline&&e._timeline._runnerIds.includes(e.id))e=i;else{this.remove(i.id);const s=i.mergeWith(e);this.edit(e.id,s),e=s,--t}}return this}remove(e){const t=this.ids.indexOf(e+1);return this.ids.splice(t,1),this.runners.splice(t,1),this}}mt({Element:{animate(n,e,t){const i=Ro.sanitise(n,e,t),r=this.timeline();return new Ro(i.duration).loop(i).element(this).timeline(r.play()).schedule(i.delay,i.when)},delay(n,e){return this.animate(0,n,e)},_clearTransformRunnersBefore(n){this._transformationRunners.clearBefore(n.id)},_currentTransform(n){return this._transformationRunners.runners.filter(e=>e.id<=n.id).map(QP).reduce(JP,new je)},_addRunner(n){this._transformationRunners.add(n),Bt.cancelImmediate(this._frameId),this._frameId=Bt.immediate(F9.bind(this))},_prepareRunner(){null==this._frameId&&(this._transformationRunners=(new V9).add(new um(new je(this))))}}}),Ct(Ro,{attr(n,e){return this.styleAttr("attr",n,e)},css(n,e){return this.styleAttr("css",n,e)},styleAttr(n,e,t){if("string"==typeof e)return this.styleAttr(n,{[e]:t});let i=e;if(this._tryRetarget(n,i))return this;let r=new Na(this._stepper).to(i),s=Object.keys(i);return this.queue(function(){r=r.from(this.element()[n](s))},function(o){return this.element()[n](r.at(o).valueOf()),r.done()},function(o){const a=Object.keys(o),c=((n,e)=>n.filter(t=>!e.includes(t)))(a,s);if(c.length){const u=this.element()[n](c),h=new Jh(r.from()).valueOf();Object.assign(h,u),r.from(h)}const l=new Jh(r.to()).valueOf();Object.assign(l,o),r.to(l),s=a,i=o}),this._rememberMorpher(n,r),this},zoom(n,e){if(this._tryRetarget("zoom",n,e))return this;let t=new Na(this._stepper).to(new ot(n));return this.queue(function(){t=t.from(this.element().zoom())},function(i){return this.element().zoom(t.at(i),e),t.done()},function(i,r){e=r,t.to(i)}),this._rememberMorpher("zoom",t),this},transform(n,e,t){if(e=n.relative||e,this._isDeclarative&&!e&&this._tryRetarget("transform",n))return this;const i=je.isMatrixLike(n);t=null!=n.affine?n.affine:t??!i;const r=new Na(this._stepper).type(t?YP:je);let s,o,a,c,l;return this.queue(function u(){o=o||this.element(),s=s||em(n,o),l=new je(e?void 0:o),o._addRunner(this),e||o._clearTransformRunnersBefore(this)},function h(f){e||this.clearTransform();const{x:p,y:m}=new Dn(s).transform(o._currentTransform(this));let g=new je({...n,origin:[p,m]}),_=this._isDeclarative&&a?a:l;if(t){g=g.decompose(p,m),_=_.decompose(p,m);const y=g.rotate,v=_.rotate,w=[y-360,y,y+360],M=w.map(E=>Math.abs(E-v)),I=Math.min(...M),x=M.indexOf(I);g.rotate=w[x]}e&&(i||(g.rotate=n.rotate||0),this._isDeclarative&&c&&(_.rotate=c)),r.from(_),r.to(g);const b=r.at(f);return c=b.rotate,a=new je(b),this.addTransform(a),o._addRunner(this),r.done()},function d(f){(f.origin||"center").toString()!==(n.origin||"center").toString()&&(s=em(f,o)),n={...f,origin:s}},!0),this._isDeclarative&&this._rememberMorpher("transform",r),this},x(n,e){return this._queueNumber("x",n)},y(n){return this._queueNumber("y",n)},dx(n=0){return this._queueNumberDelta("x",n)},dy(n=0){return this._queueNumberDelta("y",n)},dmove(n,e){return this.dx(n).dy(e)},_queueNumberDelta(n,e){if(e=new ot(e),this._tryRetarget(n,e))return this;const t=new Na(this._stepper).to(e);let i=null;return this.queue(function(){i=this.element()[n](),t.from(i),t.to(i+e)},function(r){return this.element()[n](t.at(r)),t.done()},function(r){t.to(i+new ot(r))}),this._rememberMorpher(n,t),this},_queueObject(n,e){if(this._tryRetarget(n,e))return this;const t=new Na(this._stepper).to(e);return this.queue(function(){t.from(this.element()[n]())},function(i){return this.element()[n](t.at(i)),t.done()}),this._rememberMorpher(n,t),this},_queueNumber(n,e){return this._queueObject(n,new ot(e))},cx(n){return this._queueNumber("cx",n)},cy(n){return this._queueNumber("cy",n)},move(n,e){return this.x(n).y(e)},center(n,e){return this.cx(n).cy(e)},size(n,e){let t;return(!n||!e)&&(t=this._element.bbox()),n||(n=t.width/t.height*e),e||(e=t.height/t.width*n),this.width(n).height(e)},width(n){return this._queueNumber("width",n)},height(n){return this._queueNumber("height",n)},plot(n,e,t,i){if(4===arguments.length)return this.plot([n,e,t,i]);if(this._tryRetarget("plot",n))return this;const r=new Na(this._stepper).type(this._element.MorphArray).to(n);return this.queue(function(){r.from(this._element.array())},function(s){return this._element.plot(r.at(s)),r.done()}),this._rememberMorpher("plot",r),this},leading(n){return this._queueNumber("leading",n)},viewbox(n,e,t,i){return this._queueObject("viewbox",new _i(n,e,t,i))},update(n){return"object"!=typeof n?this.update({offset:arguments[0],color:arguments[1],opacity:arguments[2]}):(null!=n.opacity&&this.attr("stop-opacity",n.opacity),null!=n.color&&this.attr("stop-color",n.color),null!=n.offset&&this.attr("offset",n.offset),this)}}),Ct(Ro,{rx:kb,ry:Lb,from:WP,to:$P}),At(Ro,"Runner");class $b extends Hi{constructor(e,t=e){super(an("svg",e),t),this.namespace()}defs(){return this.isRoot()?ir(this.node.querySelector("defs"))||this.put(new Ob):this.root().defs()}isRoot(){return!this.node.parentNode||!(this.node.parentNode instanceof yt.window.SVGElement)&&"#document-fragment"!==this.node.parentNode.nodeName}namespace(){return this.isRoot()?this.attr({xmlns:tm,version:"1.1"}).attr("xmlns:xlink",vl,Wh).attr("xmlns:svgjs","http://svgjs.dev/svgjs",Wh):this.root().namespace()}removeNamespace(){return this.attr({xmlns:null,version:null}).attr("xmlns:xlink",null,Wh).attr("xmlns:svgjs",null,Wh)}root(){return this.isRoot()?this:super.root()}}mt({Container:{nested:cn(function(){return this.put(new $b)})}}),At($b,"Svg",!0);class qb extends Hi{constructor(e,t=e){super(an("symbol",e),t)}}mt({Container:{symbol:cn(function(){return this.put(new qb)})}}),At(qb,"Symbol");var eR={__proto__:null,plain:function U9(n){return!1===this._build&&this.clear(),this.node.appendChild(yt.document.createTextNode(n)),this},length:function z9(){return this.node.getComputedTextLength()},x:function H9(n,e=this.bbox()){return null==n?e.x:this.attr("x",this.attr("x")+n-e.x)},y:function G9(n,e=this.bbox()){return null==n?e.y:this.attr("y",this.attr("y")+n-e.y)},move:function j9(n,e,t=this.bbox()){return this.x(n,t).y(e,t)},cx:function W9(n,e=this.bbox()){return null==n?e.cx:this.attr("x",this.attr("x")+n-e.cx)},cy:function $9(n,e=this.bbox()){return null==n?e.cy:this.attr("y",this.attr("y")+n-e.cy)},center:function q9(n,e,t=this.bbox()){return this.cx(n,t).cy(e,t)},ax:function X9(n){return this.attr("x",n)},ay:function Y9(n){return this.attr("y",n)},amove:function Z9(n,e){return this.ax(n).ay(e)},build:function K9(n){return this._build=!!n,this}};class Kr extends rr{constructor(e,t=e){super(an("text",e),t),this.dom.leading=new ot(1.3),this._rebuild=!0,this._build=!1}leading(e){return null==e?this.dom.leading:(this.dom.leading=new ot(e),this.rebuild())}rebuild(e){if("boolean"==typeof e&&(this._rebuild=e),this._rebuild){const t=this;let i=0;const r=this.dom.leading;this.each(function(s){const o=yt.window.getComputedStyle(this.node).getPropertyValue("font-size"),a=r*new ot(o);this.dom.newLined&&(this.attr("x",t.attr("x")),"\n"===this.text()?i+=a:(this.attr("dy",s?a+i:0),i=0))}),this.fire("rebuild")}return this}setData(e){return this.dom=e,this.dom.leading=new ot(e.leading||1.3),this}text(e){if(void 0===e){const t=this.node.childNodes;let i=0;e="";for(let r=0,s=t.length;r<s;++r)"textPath"!==t[r].nodeName?(r!==i&&3!==t[r].nodeType&&!0===ir(t[r]).dom.newLined&&(e+="\n"),e+=t[r].textContent):0===r&&(i=1);return e}if(this.clear().build(!0),"function"==typeof e)e.call(this,this);else for(let t=0,i=(e=(e+"").split("\n")).length;t<i;t++)this.newLine(e[t]);return this.build(!1).rebuild()}}Ct(Kr,eR),mt({Container:{text:cn(function(n=""){return this.put(new Kr).text(n)}),plain:cn(function(n=""){return this.put(new Kr).plain(n)})}}),At(Kr,"Text");class hm extends rr{constructor(e,t=e){super(an("tspan",e),t),this._build=!1}dx(e){return this.attr("dx",e)}dy(e){return this.attr("dy",e)}newLine(){this.dom.newLined=!0;const e=this.parent();if(!(e instanceof Kr))return this;const t=e.index(this),i=yt.window.getComputedStyle(this.node).getPropertyValue("font-size"),r=e.dom.leading*new ot(i);return this.dy(t?r:0).attr("x",e.x())}text(e){return null==e?this.node.textContent+(this.dom.newLined?"\n":""):("function"==typeof e?(this.clear().build(!0),e.call(this,this),this.build(!1)):this.plain(e),this)}}Ct(hm,eR),mt({Tspan:{tspan:cn(function(n=""){const e=new hm;return this._build||this.clear(),this.put(e).text(n)})},Text:{newLine:function(n=""){return this.tspan(n).newLine()}}}),At(hm,"Tspan");class Xb extends rr{constructor(e,t=e){super(an("circle",e),t)}radius(e){return this.attr("r",e)}rx(e){return this.attr("r",e)}ry(e){return this.rx(e)}size(e){return this.radius(new ot(e).divide(2))}}Ct(Xb,{x:VP,y:BP,cx:UP,cy:zP,width:HP,height:GP}),mt({Container:{circle:cn(function(n=0){return this.put(new Xb).size(n).move(0,0)})}}),At(Xb,"Circle");class Yb extends Hi{constructor(e,t=e){super(an("clipPath",e),t)}remove(){return this.targets().forEach(function(e){e.unclip()}),super.remove()}targets(){return wl('svg [clip-path*="'+this.id()+'"]')}}mt({Container:{clip:cn(function(){return this.defs().put(new Yb)})},Element:{clipper(){return this.reference("clip-path")},clipWith(n){const e=n instanceof Yb?n:this.parent().clip().add(n);return this.attr("clip-path",'url("#'+e.id()+'")')},unclip(){return this.attr("clip-path",null)}}}),At(Yb,"ClipPath");class tR extends vs{constructor(e,t=e){super(an("foreignObject",e),t)}}mt({Container:{foreignObject:cn(function(n,e){return this.put(new tR).size(n,e)})}}),At(tR,"ForeignObject");var nR={__proto__:null,dmove:function J9(n,e){return this.children().forEach((t,i)=>{let r;try{r=t.bbox()}catch{return}const s=new je(t),o=s.translate(n,e).transform(s.inverse()),a=new Dn(r.x,r.y).transform(o);t.move(a.x,a.y)}),this},dx:function Q9(n){return this.dmove(n,0)},dy:function e7(n){return this.dmove(0,n)},height:function t7(n,e=this.bbox()){return null==n?e.height:this.size(e.width,n,e)},move:function n7(n=0,e=0,t=this.bbox()){return this.dmove(n-t.x,e-t.y)},size:function i7(n,e,t=this.bbox()){const i=Pa(this,n,e,t),r=i.width/t.width,s=i.height/t.height;return this.children().forEach((o,a)=>{const c=new Dn(t).transform(new je(o).inverse());o.scale(r,s,c.x,c.y)}),this},width:function r7(n,e=this.bbox()){return null==n?e.width:this.size(n,e.height,e)},x:function s7(n,e=this.bbox()){return null==n?e.x:this.move(n,e.y,e)},y:function o7(n,e=this.bbox()){return null==n?e.y:this.move(e.x,n,e)}};class Zb extends Hi{constructor(e,t=e){super(an("g",e),t)}}Ct(Zb,nR),mt({Container:{group:cn(function(){return this.put(new Zb)})}}),At(Zb,"G");class dm extends Hi{constructor(e,t=e){super(an("a",e),t)}target(e){return this.attr("target",e)}to(e){return this.attr("href",e,vl)}}Ct(dm,nR),mt({Container:{link:cn(function(n){return this.put(new dm).to(n)})},Element:{unlink(){const n=this.linker();if(!n)return this;const e=n.parent();if(!e)return this.remove();const t=e.index(n);return e.add(this,t),n.remove(),this},linkTo(n){let e=this.linker();return e||(e=new dm,this.wrap(e)),"function"==typeof n?n.call(e,e):e.to(n),this},linker(){const n=this.parent();return n&&"a"===n.node.nodeName.toLowerCase()?n:null}}}),At(dm,"A");class Kb extends Hi{constructor(e,t=e){super(an("mask",e),t)}remove(){return this.targets().forEach(function(e){e.unmask()}),super.remove()}targets(){return wl('svg [mask*="'+this.id()+'"]')}}mt({Container:{mask:cn(function(){return this.defs().put(new Kb)})},Element:{masker(){return this.reference("mask")},maskWith(n){const e=n instanceof Kb?n:this.parent().mask().add(n);return this.attr("mask",'url("#'+e.id()+'")')},unmask(){return this.attr("mask",null)}}}),At(Kb,"Mask");class iR extends vs{constructor(e,t=e){super(an("stop",e),t)}update(e){return("number"==typeof e||e instanceof ot)&&(e={offset:arguments[0],color:arguments[1],opacity:arguments[2]}),null!=e.opacity&&this.attr("stop-opacity",e.opacity),null!=e.color&&this.attr("stop-color",e.color),null!=e.offset&&this.attr("offset",new ot(e.offset)),this}}mt({Gradient:{stop:function(n,e,t){return this.put(new iR).update(n,e,t)}}}),At(iR,"Stop");class Jb extends vs{constructor(e,t=e){super(an("style",e),t)}addText(e=""){return this.node.textContent+=e,this}font(e,t,i={}){return this.rule("@font-face",{fontFamily:e,src:t,...i})}rule(e,t){return this.addText(function a7(n,e){if(!n)return"";if(!e)return n;let t=n+"{";for(const i in e)t+=xP(i)+":"+e[i]+";";return t+="}",t}(e,t))}}mt("Dom",{style(n,e){return this.put(new Jb).rule(n,e)},fontface(n,e,t){return this.put(new Jb).font(n,e,t)}}),At(Jb,"Style");class Qb extends Kr{constructor(e,t=e){super(an("textPath",e),t)}array(){const e=this.track();return e?e.array():null}plot(e){const t=this.track();let i=null;return t&&(i=t.plot(e)),null==e?i:this}track(){return this.reference("href")}}mt({Container:{textPath:cn(function(n,e){return n instanceof Kr||(n=this.text(n)),n.path(e)})},Text:{path:cn(function(n,e=!0){const t=new Qb;let i;if(n instanceof Dl||(n=this.defs().path(n)),t.attr("href","#"+n,vl),e)for(;i=this.node.firstChild;)t.node.appendChild(i);return this.put(t)}),textPath(){return this.findOne("textPath")}},Path:{text:cn(function(n){return n instanceof Kr||(n=(new Kr).addTo(this.parent()).text(n)),n.path(this)}),targets(){return wl("svg textPath").filter(n=>(n.attr("href")||"").includes(this.id()))}}}),Qb.prototype.MorphArray=La,At(Qb,"TextPath");class rR extends rr{constructor(e,t=e){super(an("use",e),t)}use(e,t){return this.attr("href",(t||"")+"#"+e,vl)}}mt({Container:{use:cn(function(n,e){return this.put(new rR).use(n,e)})}}),At(rR,"Use");const c7=Ti;Ct([$b,qb,om,Zh,am],zi("viewbox")),Ct([Kh,ed,Qh,Dl],zi("marker")),Ct(Kr,zi("Text")),Ct(Dl,zi("Path")),Ct(Ob,zi("Defs")),Ct([Kr,hm],zi("Tspan")),Ct([lm,sm,Yh,Ro],zi("radius")),Ct(qh,zi("EventTarget")),Ct(Io,zi("Dom")),Ct(vs,zi("Element")),Ct(rr,zi("Shape")),Ct([Hi,jP],zi("Container")),Ct(Yh,zi("Gradient")),Ct(Ro,zi("Runner")),Oa.extend(function a$(){return[...new Set(yP)]}()),function T9(n=[]){jb.push(...[].concat(n))}([ot,Wt,_i,je,Sl,Po,La,Dn]),function A9(){Ct(jb,{to(n){return(new Na).type(this.constructor).from(this.toArray()).to(n)},fromArray(n){return this.init(n),this},toConsumable(){return this.toArray()},morph(n,e,t,i,r){return this.fromArray(n.map(function(o,a){return i.step(o,e[a],t,r[a],r)}))}})}();class Tl{constructor(e){this.dashed=!1,this.dashString="",this.start=e.start,this.end=e.end,this.color=e.color,this.width=e.width,this.dashed=null!=e.dashed&&e.dashed,this.dashString=null!=e.dashString?e.dashString:""}}class at{constructor(e,t){this.x=e,this.y=t}equal(e){return Math.abs(e.x-this.x)<.01&&Math.abs(e.y-this.y)<.01}normalized(){const e=Math.sqrt(this.x*this.x+this.y*this.y);return new at(this.x/e,this.y/e)}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}dot(e){return this.x*e.x+this.y*e.y}}class l7{constructor(e){this.height=e.height,this.width=e.width,this.pixelsInOneUnit=e.pixelsInOneUnit}}class Ks{constructor(){this.paintLayers=[],this.miniViewPaintLayers=[]}initializeCanvas(e){this.canvas=e}initializeMiniView(e){this.miniViewCanvas=e}initializeMiniViewPaintLayers(e){this.miniViewPaintLayers=e}initializePaintLayers(e){this.paintLayers=e}get height(){return this.canvas.height}get width(){return this.canvas.width}get pixelsInOneUnit(){return this.canvas.pixelsInOneUnit}getPaintLayer(e){switch(e){case Ut.layer0:return this.paintLayers[0];case Ut.layer1:return this.paintLayers[1];case Ut.layer2:return this.paintLayers[2];case Ut.layer3:return this.paintLayers[3];case Ut.layer4:return this.paintLayers[4]}return this.paintLayers[2]}getMiniViewPaintLayer(e){switch(e){case Ut.layer0:return this.miniViewPaintLayers[0];case Ut.layer1:return this.miniViewPaintLayers[1];case Ut.layer2:return this.miniViewPaintLayers[2];case Ut.layer3:return this.miniViewPaintLayers[3];case Ut.layer4:return this.miniViewPaintLayers[4]}return this.miniViewPaintLayers[2]}static#e=this.\u0275fac=function(t){return new(t||Ks)};static#t=this.\u0275prov=Te({token:Ks,factory:Ks.\u0275fac,providedIn:"root"})}class Oo{constructor(e){this.c=e}getCenterPoint(){return new at(this.c.width/2,this.c.height/2)}getCoordinateSystemDimensions(){const e={left:-this.convertToMathsCoordinates(new at(0,this.c.height/2)).x,right:this.convertToMathsCoordinates(new at(this.c.width,this.c.height/2)).x,top:-this.convertToMathsCoordinates(new at(this.c.width/2,0)).y,bottom:this.convertToMathsCoordinates(new at(this.c.width/2,this.c.height)).y};return{left:e.left,right:e.right,top:e.top,bottom:e.bottom,height:e.top+e.bottom,width:e.left+e.right}}getCrossLength(){const e=this.getCoordinateSystemDimensions();return Math.sqrt(Math.pow(e.width,2)+Math.pow(e.height,2))}convertToPaintCoordinates(e){let t=this.getCenterPoint();return new at(e.x*this.c.pixelsInOneUnit+t.x,t.y-e.y*this.c.pixelsInOneUnit)}convertToMathsCoordinates(e){let t=this.getCenterPoint();return new at((e.x-t.x)/this.c.pixelsInOneUnit,(e.y-t.y)/this.c.pixelsInOneUnit)}static#e=this.\u0275fac=function(t){return new(t||Oo)(le(Ks))};static#t=this.\u0275prov=Te({token:Oo,factory:Oo.\u0275fac,providedIn:"root"})}var Ut=(()=>{return(n=Ut||(Ut={}))[n.default=0]="default",n[n.layer0=1]="layer0",n[n.layer1=2]="layer1",n[n.layer2=3]="layer2",n[n.layer3=4]="layer3",n[n.layer4=5]="layer4",Ut;var n})();class Fa{constructor(e,t){this.canvas=e,this.coord=t}paintLine(e,t=Ut.layer2){const i=this.coord.convertToPaintCoordinates(e.start),r=this.coord.convertToPaintCoordinates(e.end);return this.canvas.getPaintLayer(t).line(i.x,i.y,r.x,r.y).stroke({width:e.width,color:e.color,dasharray:e.dashed?e.dashString:""})}paintCircle(e,t=Ut.layer2){const i=this.coord.convertToPaintCoordinates(e.center);return this.canvas.getPaintLayer(t).circle(2*e.radius).move(i.x-e.radius,i.y-e.radius).attr({fill:e.color})}paintPolygon(e,t=Ut.layer2){const i=[];for(let s of e.points)i.push(this.coord.convertToPaintCoordinates(s));let r="";return i.forEach(s=>{r+=`${s.x},${s.y} `}),this.canvas.getPaintLayer(t).polygon(r).fill({color:e.color})}static#e=this.\u0275fac=function(t){return new(t||Fa)(le(Ks),le(Oo))};static#t=this.\u0275prov=Te({token:Fa,factory:Fa.\u0275fac,providedIn:"root"})}var de=(()=>{return(n=de||(de={})).white="#ffffff",n.purple800="#2c2c54",n.purple500="#343466",n.purple400="#40407a",n.purple300="#706fd3",n.brightRed="#ff0066",n.brightGreen="#33d9b2",n.red="#fc5c65",n.orange="#fd9644",n.yellow="#f7b731",n.green="#26de81",n.blue="#4b7bec",n.turqouis="#2bcbba",n.pink="#ff92c9",n.redDark="#eb3b5a",n.orangeDark="#fa8231",n.yellowLight="#fed330",n.greenDark="#20bf6b",n.turqouisDark="#0fb9b1",n.blueDark="#2d98da",n.azul="#4b7bec",n.azulDark="#3867d6",n.purple="#a55eea",n.purpleDark="#8854d0",n.gray="#d1d8e0",n.grayDark="#a5b1c2",de;var n})();class sR{constructor(e){this.center=e.center,this.radius=e.radius,this.color=e.color}}class td{constructor(e,t,i){this.c=e,this.p=t,this.coord=i,this.linesBetweenUnit=4,this.paintLayer=Ut.default}paint(e){this.paintHorizontalLines(),this.paintVerticalLines(),this.paintCoordinateSystem(),this.paintNullPoint(),e&&(this.paintLayer=e)}paintNullPoint(){this.p.paintCircle(new sR({center:new at(0,0),radius:16,color:"#ffffff"}),Ut.layer4)}paintHorizontalLines(){const e=this.coord.getCoordinateSystemDimensions(),t=e.height*this.linesBetweenUnit,i=1/this.linesBetweenUnit;for(let r=0;r<=t/2;r++){let s=-i*r;r%this.linesBetweenUnit==0?this.paintFullUnitGridLine(-e.left,s,e.right,s):this.paintBetweenGridLine(-e.left,s,e.right,s)}for(let r=0;r<=t/2;r++){let s=i*r;r%this.linesBetweenUnit==0?this.paintFullUnitGridLine(-e.left,s,e.right,s):this.paintBetweenGridLine(-e.left,s,e.right,s)}}paintVerticalLines(){const e=this.coord.getCoordinateSystemDimensions(),t=e.width*this.linesBetweenUnit,i=1/this.linesBetweenUnit;for(let r=0;r<=t/2;r++){let s=-i*r;r%this.linesBetweenUnit==0?this.paintFullUnitGridLine(s,e.top,s,-e.bottom):this.paintBetweenGridLine(s,e.top,s,-e.bottom)}for(let r=0;r<=t/2;r++){let s=i*r;r%this.linesBetweenUnit==0?this.paintFullUnitGridLine(s,e.top,s,-e.bottom):this.paintBetweenGridLine(s,e.top,s,-e.bottom)}}paintCoordinateSystem(){const e=this.coord.getCoordinateSystemDimensions();this.paintLine(new Tl({start:new at(-e.left,0),end:new at(e.right,0),color:de.purple300,width:7})),this.paintLine(new Tl({start:new at(0,e.top),end:new at(0,-e.bottom),color:de.purple300,width:7}))}paintFullUnitGridLine(e,t,i,r){const s=new Tl({start:new at(e,t),end:new at(i,r),color:de.purple400,width:5});this.paintLine(s)}paintBetweenGridLine(e,t,i,r){const s=new Tl({start:new at(e,t),end:new at(i,r),color:de.purple500,width:2,dashed:!0,dashString:"12 12"});this.paintLine(s)}paintLine(e){this.p.paintLine(e,this.paintLayer)}static#e=this.\u0275fac=function(t){return new(t||td)(le(Ks),le(Fa),le(Oo))};static#t=this.\u0275prov=Te({token:td,factory:td.\u0275fac,providedIn:"root"})}function oR(n,e,t,i,r,s,o){try{var a=n[s](o),c=a.value}catch(l){return void t(l)}a.done?e(c):Promise.resolve(c).then(i,r)}const Ai=1001,jn=1003,Nn=1006,Ua=1009,za=1014,Lo=1015,rd=1016,Ll=1020,Er=1023,Ha=1026,Nl=1027,Ga=3e3,bn=3001,Qs="srgb",Wa="srgb-linear";class $a{addEventListener(e,t){void 0===this._listeners&&(this._listeners={});const i=this._listeners;void 0===i[e]&&(i[e]=[]),-1===i[e].indexOf(t)&&i[e].push(t)}hasEventListener(e,t){if(void 0===this._listeners)return!1;const i=this._listeners;return void 0!==i[e]&&-1!==i[e].indexOf(t)}removeEventListener(e,t){if(void 0===this._listeners)return;const r=this._listeners[e];if(void 0!==r){const s=r.indexOf(t);-1!==s&&r.splice(s,1)}}dispatchEvent(e){if(void 0===this._listeners)return;const i=this._listeners[e.type];if(void 0!==i){e.target=this;const r=i.slice(0);for(let s=0,o=r.length;s<o;s++)r[s].call(this,e);e.target=null}}}const yi=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"],qa=Math.PI/180,sd=180/Math.PI;function sr(){const n=4294967295*Math.random()|0,e=4294967295*Math.random()|0,t=4294967295*Math.random()|0,i=4294967295*Math.random()|0;return(yi[255&n]+yi[n>>8&255]+yi[n>>16&255]+yi[n>>24&255]+"-"+yi[255&e]+yi[e>>8&255]+"-"+yi[e>>16&15|64]+yi[e>>24&255]+"-"+yi[63&t|128]+yi[t>>8&255]+"-"+yi[t>>16&255]+yi[t>>24&255]+yi[255&i]+yi[i>>8&255]+yi[i>>16&255]+yi[i>>24&255]).toLowerCase()}function Tn(n,e,t){return Math.max(e,Math.min(t,n))}function od(n,e,t){return(1-t)*n+t*e}function px(n){return 0==(n&n-1)&&0!==n}function wm(n){return Math.pow(2,Math.floor(Math.log(n)/Math.LN2))}function eo(n,e){switch(e.constructor){case Float32Array:return n;case Uint16Array:return n/65535;case Uint8Array:return n/255;case Int16Array:return Math.max(n/32767,-1);case Int8Array:return Math.max(n/127,-1);default:throw new Error("Invalid component type.")}}function Jt(n,e){switch(e.constructor){case Float32Array:return n;case Uint16Array:return Math.round(65535*n);case Uint8Array:return Math.round(255*n);case Int16Array:return Math.round(32767*n);case Int8Array:return Math.round(127*n);default:throw new Error("Invalid component type.")}}class ee{constructor(e=0,t=0){ee.prototype.isVector2=!0,this.x=e,this.y=t}get width(){return this.x}set width(e){this.x=e}get height(){return this.y}set height(e){this.y=e}set(e,t){return this.x=e,this.y=t,this}setScalar(e){return this.x=e,this.y=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y)}copy(e){return this.x=e.x,this.y=e.y,this}add(e){return this.x+=e.x,this.y+=e.y,this}addScalar(e){return this.x+=e,this.y+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this}subScalar(e){return this.x-=e,this.y-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this}multiply(e){return this.x*=e.x,this.y*=e.y,this}multiplyScalar(e){return this.x*=e,this.y*=e,this}divide(e){return this.x/=e.x,this.y/=e.y,this}divideScalar(e){return this.multiplyScalar(1/e)}applyMatrix3(e){const t=this.x,i=this.y,r=e.elements;return this.x=r[0]*t+r[3]*i+r[6],this.y=r[1]*t+r[4]*i+r[7],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this}clampLength(e,t){const i=this.length();return this.divideScalar(i||1).multiplyScalar(Math.max(e,Math.min(t,i)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(e){return this.x*e.x+this.y*e.y}cross(e){return this.x*e.y-this.y*e.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,i=this.y-e.y;return t*t+i*i}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this}lerpVectors(e,t,i){return this.x=e.x+(t.x-e.x)*i,this.y=e.y+(t.y-e.y)*i,this}equals(e){return e.x===this.x&&e.y===this.y}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this}rotateAround(e,t){const i=Math.cos(t),r=Math.sin(t),s=this.x-e.x,o=this.y-e.y;return this.x=s*i-o*r+e.x,this.y=s*r+o*i+e.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}}class Wn{constructor(){Wn.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1]}set(e,t,i,r,s,o,a,c,l){const u=this.elements;return u[0]=e,u[1]=r,u[2]=a,u[3]=t,u[4]=s,u[5]=c,u[6]=i,u[7]=o,u[8]=l,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(e){const t=this.elements,i=e.elements;return t[0]=i[0],t[1]=i[1],t[2]=i[2],t[3]=i[3],t[4]=i[4],t[5]=i[5],t[6]=i[6],t[7]=i[7],t[8]=i[8],this}extractBasis(e,t,i){return e.setFromMatrix3Column(this,0),t.setFromMatrix3Column(this,1),i.setFromMatrix3Column(this,2),this}setFromMatrix4(e){const t=e.elements;return this.set(t[0],t[4],t[8],t[1],t[5],t[9],t[2],t[6],t[10]),this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const i=e.elements,r=t.elements,s=this.elements,o=i[0],a=i[3],c=i[6],l=i[1],u=i[4],h=i[7],d=i[2],f=i[5],p=i[8],m=r[0],g=r[3],_=r[6],b=r[1],y=r[4],v=r[7],w=r[2],M=r[5],I=r[8];return s[0]=o*m+a*b+c*w,s[3]=o*g+a*y+c*M,s[6]=o*_+a*v+c*I,s[1]=l*m+u*b+h*w,s[4]=l*g+u*y+h*M,s[7]=l*_+u*v+h*I,s[2]=d*m+f*b+p*w,s[5]=d*g+f*y+p*M,s[8]=d*_+f*v+p*I,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[3]*=e,t[6]*=e,t[1]*=e,t[4]*=e,t[7]*=e,t[2]*=e,t[5]*=e,t[8]*=e,this}determinant(){const e=this.elements,t=e[0],i=e[1],r=e[2],s=e[3],o=e[4],a=e[5],c=e[6],l=e[7],u=e[8];return t*o*u-t*a*l-i*s*u+i*a*c+r*s*l-r*o*c}invert(){const e=this.elements,t=e[0],i=e[1],r=e[2],s=e[3],o=e[4],a=e[5],c=e[6],l=e[7],u=e[8],h=u*o-a*l,d=a*c-u*s,f=l*s-o*c,p=t*h+i*d+r*f;if(0===p)return this.set(0,0,0,0,0,0,0,0,0);const m=1/p;return e[0]=h*m,e[1]=(r*l-u*i)*m,e[2]=(a*i-r*o)*m,e[3]=d*m,e[4]=(u*t-r*c)*m,e[5]=(r*s-a*t)*m,e[6]=f*m,e[7]=(i*c-l*t)*m,e[8]=(o*t-i*s)*m,this}transpose(){let e;const t=this.elements;return e=t[1],t[1]=t[3],t[3]=e,e=t[2],t[2]=t[6],t[6]=e,e=t[5],t[5]=t[7],t[7]=e,this}getNormalMatrix(e){return this.setFromMatrix4(e).invert().transpose()}transposeIntoArray(e){const t=this.elements;return e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8],this}setUvTransform(e,t,i,r,s,o,a){const c=Math.cos(s),l=Math.sin(s);return this.set(i*c,i*l,-i*(c*o+l*a)+o+e,-r*l,r*c,-r*(-l*o+c*a)+a+t,0,0,1),this}scale(e,t){const i=this.elements;return i[0]*=e,i[3]*=e,i[6]*=e,i[1]*=t,i[4]*=t,i[7]*=t,this}rotate(e){const t=Math.cos(e),i=Math.sin(e),r=this.elements,s=r[0],o=r[3],a=r[6],c=r[1],l=r[4],u=r[7];return r[0]=t*s+i*c,r[3]=t*o+i*l,r[6]=t*a+i*u,r[1]=-i*s+t*c,r[4]=-i*o+t*l,r[7]=-i*a+t*u,this}translate(e,t){const i=this.elements;return i[0]+=e*i[2],i[3]+=e*i[5],i[6]+=e*i[8],i[1]+=t*i[2],i[4]+=t*i[5],i[7]+=t*i[8],this}equals(e){const t=this.elements,i=e.elements;for(let r=0;r<9;r++)if(t[r]!==i[r])return!1;return!0}fromArray(e,t=0){for(let i=0;i<9;i++)this.elements[i]=e[i+t];return this}toArray(e=[],t=0){const i=this.elements;return e[t]=i[0],e[t+1]=i[1],e[t+2]=i[2],e[t+3]=i[3],e[t+4]=i[4],e[t+5]=i[5],e[t+6]=i[6],e[t+7]=i[7],e[t+8]=i[8],e}clone(){return(new this.constructor).fromArray(this.elements)}}function GR(n){for(let e=n.length-1;e>=0;--e)if(n[e]>=65535)return!0;return!1}function ad(n){return document.createElementNS("http://www.w3.org/1999/xhtml",n)}function Xa(n){return n<.04045?.0773993808*n:Math.pow(.9478672986*n+.0521327014,2.4)}function Mm(n){return n<.0031308?12.92*n:1.055*Math.pow(n,.41666)-.055}Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array;const mx={[Qs]:{[Wa]:Xa},[Wa]:{[Qs]:Mm}},Jr={legacyMode:!0,get workingColorSpace(){return Wa},set workingColorSpace(n){console.warn("THREE.ColorManagement: .workingColorSpace is readonly.")},convert:function(n,e,t){if(this.legacyMode||e===t||!e||!t)return n;if(mx[e]&&void 0!==mx[e][t]){const i=mx[e][t];return n.r=i(n.r),n.g=i(n.g),n.b=i(n.b),n}throw new Error("Unsupported color space conversion.")},fromWorkingColorSpace:function(n,e){return this.convert(n,this.workingColorSpace,e)},toWorkingColorSpace:function(n,e){return this.convert(n,e,this.workingColorSpace)}},jR={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},$n={r:0,g:0,b:0},Qr={h:0,s:0,l:0},Cm={h:0,s:0,l:0};function gx(n,e,t){return t<0&&(t+=1),t>1&&(t-=1),t<1/6?n+6*(e-n)*t:t<.5?e:t<2/3?n+6*(e-n)*(2/3-t):n}function Sm(n,e){return e.r=n.r,e.g=n.g,e.b=n.b,e}let Ul,Ie=(()=>{class n{constructor(t,i,r){return this.isColor=!0,this.r=1,this.g=1,this.b=1,void 0===i&&void 0===r?this.set(t):this.setRGB(t,i,r)}set(t){return t&&t.isColor?this.copy(t):"number"==typeof t?this.setHex(t):"string"==typeof t&&this.setStyle(t),this}setScalar(t){return this.r=t,this.g=t,this.b=t,this}setHex(t,i=Qs){return t=Math.floor(t),this.r=(t>>16&255)/255,this.g=(t>>8&255)/255,this.b=(255&t)/255,Jr.toWorkingColorSpace(this,i),this}setRGB(t,i,r,s=Wa){return this.r=t,this.g=i,this.b=r,Jr.toWorkingColorSpace(this,s),this}setHSL(t,i,r,s=Wa){if(t=function fx(n,e){return(n%e+e)%e}(t,1),i=Tn(i,0,1),r=Tn(r,0,1),0===i)this.r=this.g=this.b=r;else{const o=r<=.5?r*(1+i):r+i-r*i,a=2*r-o;this.r=gx(a,o,t+1/3),this.g=gx(a,o,t),this.b=gx(a,o,t-1/3)}return Jr.toWorkingColorSpace(this,s),this}setStyle(t,i=Qs){function r(o){void 0!==o&&parseFloat(o)<1&&console.warn("THREE.Color: Alpha component of "+t+" will be ignored.")}let s;if(s=/^((?:rgb|hsl)a?)\(([^\)]*)\)/.exec(t)){let o;const c=s[2];switch(s[1]){case"rgb":case"rgba":if(o=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(c))return this.r=Math.min(255,parseInt(o[1],10))/255,this.g=Math.min(255,parseInt(o[2],10))/255,this.b=Math.min(255,parseInt(o[3],10))/255,Jr.toWorkingColorSpace(this,i),r(o[4]),this;if(o=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(c))return this.r=Math.min(100,parseInt(o[1],10))/100,this.g=Math.min(100,parseInt(o[2],10))/100,this.b=Math.min(100,parseInt(o[3],10))/100,Jr.toWorkingColorSpace(this,i),r(o[4]),this;break;case"hsl":case"hsla":if(o=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\%\s*,\s*(\d*\.?\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(c)){const l=parseFloat(o[1])/360,u=parseFloat(o[2])/100,h=parseFloat(o[3])/100;return r(o[4]),this.setHSL(l,u,h,i)}}}else if(s=/^\#([A-Fa-f\d]+)$/.exec(t)){const o=s[1],a=o.length;if(3===a)return this.r=parseInt(o.charAt(0)+o.charAt(0),16)/255,this.g=parseInt(o.charAt(1)+o.charAt(1),16)/255,this.b=parseInt(o.charAt(2)+o.charAt(2),16)/255,Jr.toWorkingColorSpace(this,i),this;if(6===a)return this.r=parseInt(o.charAt(0)+o.charAt(1),16)/255,this.g=parseInt(o.charAt(2)+o.charAt(3),16)/255,this.b=parseInt(o.charAt(4)+o.charAt(5),16)/255,Jr.toWorkingColorSpace(this,i),this}return t&&t.length>0?this.setColorName(t,i):this}setColorName(t,i=Qs){const r=jR[t.toLowerCase()];return void 0!==r?this.setHex(r,i):console.warn("THREE.Color: Unknown color "+t),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(t){return this.r=t.r,this.g=t.g,this.b=t.b,this}copySRGBToLinear(t){return this.r=Xa(t.r),this.g=Xa(t.g),this.b=Xa(t.b),this}copyLinearToSRGB(t){return this.r=Mm(t.r),this.g=Mm(t.g),this.b=Mm(t.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(t=Qs){return Jr.fromWorkingColorSpace(Sm(this,$n),t),Tn(255*$n.r,0,255)<<16^Tn(255*$n.g,0,255)<<8^Tn(255*$n.b,0,255)<<0}getHexString(t=Qs){return("000000"+this.getHex(t).toString(16)).slice(-6)}getHSL(t,i=Wa){Jr.fromWorkingColorSpace(Sm(this,$n),i);const r=$n.r,s=$n.g,o=$n.b,a=Math.max(r,s,o),c=Math.min(r,s,o);let l,u;const h=(c+a)/2;if(c===a)l=0,u=0;else{const d=a-c;switch(u=h<=.5?d/(a+c):d/(2-a-c),a){case r:l=(s-o)/d+(s<o?6:0);break;case s:l=(o-r)/d+2;break;case o:l=(r-s)/d+4}l/=6}return t.h=l,t.s=u,t.l=h,t}getRGB(t,i=Wa){return Jr.fromWorkingColorSpace(Sm(this,$n),i),t.r=$n.r,t.g=$n.g,t.b=$n.b,t}getStyle(t=Qs){return Jr.fromWorkingColorSpace(Sm(this,$n),t),t!==Qs?`color(${t} ${$n.r} ${$n.g} ${$n.b})`:`rgb(${255*$n.r|0},${255*$n.g|0},${255*$n.b|0})`}offsetHSL(t,i,r){return this.getHSL(Qr),Qr.h+=t,Qr.s+=i,Qr.l+=r,this.setHSL(Qr.h,Qr.s,Qr.l),this}add(t){return this.r+=t.r,this.g+=t.g,this.b+=t.b,this}addColors(t,i){return this.r=t.r+i.r,this.g=t.g+i.g,this.b=t.b+i.b,this}addScalar(t){return this.r+=t,this.g+=t,this.b+=t,this}sub(t){return this.r=Math.max(0,this.r-t.r),this.g=Math.max(0,this.g-t.g),this.b=Math.max(0,this.b-t.b),this}multiply(t){return this.r*=t.r,this.g*=t.g,this.b*=t.b,this}multiplyScalar(t){return this.r*=t,this.g*=t,this.b*=t,this}lerp(t,i){return this.r+=(t.r-this.r)*i,this.g+=(t.g-this.g)*i,this.b+=(t.b-this.b)*i,this}lerpColors(t,i,r){return this.r=t.r+(i.r-t.r)*r,this.g=t.g+(i.g-t.g)*r,this.b=t.b+(i.b-t.b)*r,this}lerpHSL(t,i){this.getHSL(Qr),t.getHSL(Cm);const r=od(Qr.h,Cm.h,i),s=od(Qr.s,Cm.s,i),o=od(Qr.l,Cm.l,i);return this.setHSL(r,s,o),this}equals(t){return t.r===this.r&&t.g===this.g&&t.b===this.b}fromArray(t,i=0){return this.r=t[i],this.g=t[i+1],this.b=t[i+2],this}toArray(t=[],i=0){return t[i]=this.r,t[i+1]=this.g,t[i+2]=this.b,t}fromBufferAttribute(t,i){return this.r=t.getX(i),this.g=t.getY(i),this.b=t.getZ(i),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}}return n.NAMES=jR,n})();class WR{static getDataURL(e){if(/^data:/i.test(e.src)||typeof HTMLCanvasElement>"u")return e.src;let t;if(e instanceof HTMLCanvasElement)t=e;else{void 0===Ul&&(Ul=ad("canvas")),Ul.width=e.width,Ul.height=e.height;const i=Ul.getContext("2d");e instanceof ImageData?i.putImageData(e,0,0):i.drawImage(e,0,0,e.width,e.height),t=Ul}return t.width>2048||t.height>2048?(console.warn("THREE.ImageUtils.getDataURL: Image converted to jpg for performance reasons",e),t.toDataURL("image/jpeg",.6)):t.toDataURL("image/png")}static sRGBToLinear(e){if(typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&e instanceof ImageBitmap){const t=ad("canvas");t.width=e.width,t.height=e.height;const i=t.getContext("2d");i.drawImage(e,0,0,e.width,e.height);const r=i.getImageData(0,0,e.width,e.height),s=r.data;for(let o=0;o<s.length;o++)s[o]=255*Xa(s[o]/255);return i.putImageData(r,0,0),t}if(e.data){const t=e.data.slice(0);for(let i=0;i<t.length;i++)t[i]=t instanceof Uint8Array||t instanceof Uint8ClampedArray?Math.floor(255*Xa(t[i]/255)):Xa(t[i]);return{data:t,width:e.width,height:e.height}}return console.warn("THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),e}}class zl{constructor(e=null){this.isSource=!0,this.uuid=sr(),this.data=e,this.version=0}set needsUpdate(e){!0===e&&this.version++}toJSON(e){const t=void 0===e||"string"==typeof e;if(!t&&void 0!==e.images[this.uuid])return e.images[this.uuid];const i={uuid:this.uuid,url:""},r=this.data;if(null!==r){let s;if(Array.isArray(r)){s=[];for(let o=0,a=r.length;o<a;o++)s.push(_x(r[o].isDataTexture?r[o].image:r[o]))}else s=_x(r);i.url=s}return t||(e.images[this.uuid]=i),i}}function _x(n){return typeof HTMLImageElement<"u"&&n instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&n instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&n instanceof ImageBitmap?WR.getDataURL(n):n.data?{data:Array.from(n.data),width:n.width,height:n.height,type:n.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}let Mq=0,No=(()=>{class n extends $a{constructor(t=n.DEFAULT_IMAGE,i=n.DEFAULT_MAPPING,r=Ai,s=Ai,o=Nn,a=1008,c=Er,l=Ua,u=1,h=Ga){super(),this.isTexture=!0,Object.defineProperty(this,"id",{value:Mq++}),this.uuid=sr(),this.name="",this.source=new zl(t),this.mipmaps=[],this.mapping=i,this.wrapS=r,this.wrapT=s,this.magFilter=o,this.minFilter=a,this.anisotropy=u,this.format=c,this.internalFormat=null,this.type=l,this.offset=new ee(0,0),this.repeat=new ee(1,1),this.center=new ee(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new Wn,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.encoding=h,this.userData={},this.version=0,this.onUpdate=null,this.isRenderTargetTexture=!1,this.needsPMREMUpdate=!1}get image(){return this.source.data}set image(t){this.source.data=t}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return(new this.constructor).copy(this)}copy(t){return this.name=t.name,this.source=t.source,this.mipmaps=t.mipmaps.slice(0),this.mapping=t.mapping,this.wrapS=t.wrapS,this.wrapT=t.wrapT,this.magFilter=t.magFilter,this.minFilter=t.minFilter,this.anisotropy=t.anisotropy,this.format=t.format,this.internalFormat=t.internalFormat,this.type=t.type,this.offset.copy(t.offset),this.repeat.copy(t.repeat),this.center.copy(t.center),this.rotation=t.rotation,this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrix.copy(t.matrix),this.generateMipmaps=t.generateMipmaps,this.premultiplyAlpha=t.premultiplyAlpha,this.flipY=t.flipY,this.unpackAlignment=t.unpackAlignment,this.encoding=t.encoding,this.userData=JSON.parse(JSON.stringify(t.userData)),this.needsUpdate=!0,this}toJSON(t){const i=void 0===t||"string"==typeof t;if(!i&&void 0!==t.textures[this.uuid])return t.textures[this.uuid];const r={metadata:{version:4.5,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(t).uuid,mapping:this.mapping,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,type:this.type,encoding:this.encoding,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return"{}"!==JSON.stringify(this.userData)&&(r.userData=this.userData),i||(t.textures[this.uuid]=r),r}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(t){if(300!==this.mapping)return t;if(t.applyMatrix3(this.matrix),t.x<0||t.x>1)switch(this.wrapS){case 1e3:t.x=t.x-Math.floor(t.x);break;case Ai:t.x=t.x<0?0:1;break;case 1002:t.x=1===Math.abs(Math.floor(t.x)%2)?Math.ceil(t.x)-t.x:t.x-Math.floor(t.x)}if(t.y<0||t.y>1)switch(this.wrapT){case 1e3:t.y=t.y-Math.floor(t.y);break;case Ai:t.y=t.y<0?0:1;break;case 1002:t.y=1===Math.abs(Math.floor(t.y)%2)?Math.ceil(t.y)-t.y:t.y-Math.floor(t.y)}return this.flipY&&(t.y=1-t.y),t}set needsUpdate(t){!0===t&&(this.version++,this.source.needsUpdate=!0)}}return n.DEFAULT_IMAGE=null,n.DEFAULT_MAPPING=300,n})();class qt{constructor(e=0,t=0,i=0,r=1){qt.prototype.isVector4=!0,this.x=e,this.y=t,this.z=i,this.w=r}get width(){return this.z}set width(e){this.z=e}get height(){return this.w}set height(e){this.w=e}set(e,t,i,r){return this.x=e,this.y=t,this.z=i,this.w=r,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this.w=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setW(e){return this.w=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;case 3:this.w=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=void 0!==e.w?e.w:1,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this.w=e.w+t.w,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this.w+=e.w*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this.w=e.w-t.w,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this.w*=e.w,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this}applyMatrix4(e){const t=this.x,i=this.y,r=this.z,s=this.w,o=e.elements;return this.x=o[0]*t+o[4]*i+o[8]*r+o[12]*s,this.y=o[1]*t+o[5]*i+o[9]*r+o[13]*s,this.z=o[2]*t+o[6]*i+o[10]*r+o[14]*s,this.w=o[3]*t+o[7]*i+o[11]*r+o[15]*s,this}divideScalar(e){return this.multiplyScalar(1/e)}setAxisAngleFromQuaternion(e){this.w=2*Math.acos(e.w);const t=Math.sqrt(1-e.w*e.w);return t<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/t,this.y=e.y/t,this.z=e.z/t),this}setAxisAngleFromRotationMatrix(e){let t,i,r,s;const c=e.elements,l=c[0],u=c[4],h=c[8],d=c[1],f=c[5],p=c[9],m=c[2],g=c[6],_=c[10];if(Math.abs(u-d)<.01&&Math.abs(h-m)<.01&&Math.abs(p-g)<.01){if(Math.abs(u+d)<.1&&Math.abs(h+m)<.1&&Math.abs(p+g)<.1&&Math.abs(l+f+_-3)<.1)return this.set(1,0,0,0),this;t=Math.PI;const y=(l+1)/2,v=(f+1)/2,w=(_+1)/2,M=(u+d)/4,I=(h+m)/4,x=(p+g)/4;return y>v&&y>w?y<.01?(i=0,r=.707106781,s=.707106781):(i=Math.sqrt(y),r=M/i,s=I/i):v>w?v<.01?(i=.707106781,r=0,s=.707106781):(r=Math.sqrt(v),i=M/r,s=x/r):w<.01?(i=.707106781,r=.707106781,s=0):(s=Math.sqrt(w),i=I/s,r=x/s),this.set(i,r,s,t),this}let b=Math.sqrt((g-p)*(g-p)+(h-m)*(h-m)+(d-u)*(d-u));return Math.abs(b)<.001&&(b=1),this.x=(g-p)/b,this.y=(h-m)/b,this.z=(d-u)/b,this.w=Math.acos((l+f+_-1)/2),this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this.w=Math.max(e.w,Math.min(t.w,this.w)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this.w=Math.max(e,Math.min(t,this.w)),this}clampLength(e,t){const i=this.length();return this.divideScalar(i||1).multiplyScalar(Math.max(e,Math.min(t,i)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this.w+=(e.w-this.w)*t,this}lerpVectors(e,t,i){return this.x=e.x+(t.x-e.x)*i,this.y=e.y+(t.y-e.y)*i,this.z=e.z+(t.z-e.z)*i,this.w=e.w+(t.w-e.w)*i,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this.w=e[t+3],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e[t+3]=this.w,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this.w=e.getW(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}}class Fo extends $a{constructor(e=1,t=1,i={}){super(),this.isWebGLRenderTarget=!0,this.width=e,this.height=t,this.depth=1,this.scissor=new qt(0,0,e,t),this.scissorTest=!1,this.viewport=new qt(0,0,e,t),this.texture=new No({width:e,height:t,depth:1},i.mapping,i.wrapS,i.wrapT,i.magFilter,i.minFilter,i.format,i.type,i.anisotropy,i.encoding),this.texture.isRenderTargetTexture=!0,this.texture.flipY=!1,this.texture.generateMipmaps=void 0!==i.generateMipmaps&&i.generateMipmaps,this.texture.internalFormat=void 0!==i.internalFormat?i.internalFormat:null,this.texture.minFilter=void 0!==i.minFilter?i.minFilter:Nn,this.depthBuffer=void 0===i.depthBuffer||i.depthBuffer,this.stencilBuffer=void 0!==i.stencilBuffer&&i.stencilBuffer,this.depthTexture=void 0!==i.depthTexture?i.depthTexture:null,this.samples=void 0!==i.samples?i.samples:0}setSize(e,t,i=1){(this.width!==e||this.height!==t||this.depth!==i)&&(this.width=e,this.height=t,this.depth=i,this.texture.image.width=e,this.texture.image.height=t,this.texture.image.depth=i,this.dispose()),this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t)}clone(){return(new this.constructor).copy(this)}copy(e){this.width=e.width,this.height=e.height,this.depth=e.depth,this.viewport.copy(e.viewport),this.texture=e.texture.clone(),this.texture.isRenderTargetTexture=!0;const t=Object.assign({},e.texture.image);return this.texture.source=new zl(t),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,null!==e.depthTexture&&(this.depthTexture=e.depthTexture.clone()),this.samples=e.samples,this}dispose(){this.dispatchEvent({type:"dispose"})}}class yx extends No{constructor(e=null,t=1,i=1,r=1){super(null),this.isDataArrayTexture=!0,this.image={data:e,width:t,height:i,depth:r},this.magFilter=jn,this.minFilter=jn,this.wrapR=Ai,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class $R extends No{constructor(e=null,t=1,i=1,r=1){super(null),this.isData3DTexture=!0,this.image={data:e,width:t,height:i,depth:r},this.magFilter=jn,this.minFilter=jn,this.wrapR=Ai,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class Ii{constructor(e=0,t=0,i=0,r=1){this.isQuaternion=!0,this._x=e,this._y=t,this._z=i,this._w=r}static slerpFlat(e,t,i,r,s,o,a){let c=i[r+0],l=i[r+1],u=i[r+2],h=i[r+3];const d=s[o+0],f=s[o+1],p=s[o+2],m=s[o+3];if(0===a)return e[t+0]=c,e[t+1]=l,e[t+2]=u,void(e[t+3]=h);if(1===a)return e[t+0]=d,e[t+1]=f,e[t+2]=p,void(e[t+3]=m);if(h!==m||c!==d||l!==f||u!==p){let g=1-a;const _=c*d+l*f+u*p+h*m,b=_>=0?1:-1,y=1-_*_;if(y>Number.EPSILON){const w=Math.sqrt(y),M=Math.atan2(w,_*b);g=Math.sin(g*M)/w,a=Math.sin(a*M)/w}const v=a*b;if(c=c*g+d*v,l=l*g+f*v,u=u*g+p*v,h=h*g+m*v,g===1-a){const w=1/Math.sqrt(c*c+l*l+u*u+h*h);c*=w,l*=w,u*=w,h*=w}}e[t]=c,e[t+1]=l,e[t+2]=u,e[t+3]=h}static multiplyQuaternionsFlat(e,t,i,r,s,o){const a=i[r],c=i[r+1],l=i[r+2],u=i[r+3],h=s[o],d=s[o+1],f=s[o+2],p=s[o+3];return e[t]=a*p+u*h+c*f-l*d,e[t+1]=c*p+u*d+l*h-a*f,e[t+2]=l*p+u*f+a*d-c*h,e[t+3]=u*p-a*h-c*d-l*f,e}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get w(){return this._w}set w(e){this._w=e,this._onChangeCallback()}set(e,t,i,r){return this._x=e,this._y=t,this._z=i,this._w=r,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this}setFromEuler(e,t){const i=e._x,r=e._y,s=e._z,o=e._order,a=Math.cos,c=Math.sin,l=a(i/2),u=a(r/2),h=a(s/2),d=c(i/2),f=c(r/2),p=c(s/2);switch(o){case"XYZ":this._x=d*u*h+l*f*p,this._y=l*f*h-d*u*p,this._z=l*u*p+d*f*h,this._w=l*u*h-d*f*p;break;case"YXZ":this._x=d*u*h+l*f*p,this._y=l*f*h-d*u*p,this._z=l*u*p-d*f*h,this._w=l*u*h+d*f*p;break;case"ZXY":this._x=d*u*h-l*f*p,this._y=l*f*h+d*u*p,this._z=l*u*p+d*f*h,this._w=l*u*h-d*f*p;break;case"ZYX":this._x=d*u*h-l*f*p,this._y=l*f*h+d*u*p,this._z=l*u*p-d*f*h,this._w=l*u*h+d*f*p;break;case"YZX":this._x=d*u*h+l*f*p,this._y=l*f*h+d*u*p,this._z=l*u*p-d*f*h,this._w=l*u*h-d*f*p;break;case"XZY":this._x=d*u*h-l*f*p,this._y=l*f*h-d*u*p,this._z=l*u*p+d*f*h,this._w=l*u*h+d*f*p;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+o)}return!1!==t&&this._onChangeCallback(),this}setFromAxisAngle(e,t){const i=t/2,r=Math.sin(i);return this._x=e.x*r,this._y=e.y*r,this._z=e.z*r,this._w=Math.cos(i),this._onChangeCallback(),this}setFromRotationMatrix(e){const t=e.elements,i=t[0],r=t[4],s=t[8],o=t[1],a=t[5],c=t[9],l=t[2],u=t[6],h=t[10],d=i+a+h;if(d>0){const f=.5/Math.sqrt(d+1);this._w=.25/f,this._x=(u-c)*f,this._y=(s-l)*f,this._z=(o-r)*f}else if(i>a&&i>h){const f=2*Math.sqrt(1+i-a-h);this._w=(u-c)/f,this._x=.25*f,this._y=(r+o)/f,this._z=(s+l)/f}else if(a>h){const f=2*Math.sqrt(1+a-i-h);this._w=(s-l)/f,this._x=(r+o)/f,this._y=.25*f,this._z=(c+u)/f}else{const f=2*Math.sqrt(1+h-i-a);this._w=(o-r)/f,this._x=(s+l)/f,this._y=(c+u)/f,this._z=.25*f}return this._onChangeCallback(),this}setFromUnitVectors(e,t){let i=e.dot(t)+1;return i<Number.EPSILON?(i=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0,this._w=i):(this._x=0,this._y=-e.z,this._z=e.y,this._w=i)):(this._x=e.y*t.z-e.z*t.y,this._y=e.z*t.x-e.x*t.z,this._z=e.x*t.y-e.y*t.x,this._w=i),this.normalize()}angleTo(e){return 2*Math.acos(Math.abs(Tn(this.dot(e),-1,1)))}rotateTowards(e,t){const i=this.angleTo(e);if(0===i)return this;const r=Math.min(1,t/i);return this.slerp(e,r),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let e=this.length();return 0===e?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this._onChangeCallback(),this}multiply(e){return this.multiplyQuaternions(this,e)}premultiply(e){return this.multiplyQuaternions(e,this)}multiplyQuaternions(e,t){const i=e._x,r=e._y,s=e._z,o=e._w,a=t._x,c=t._y,l=t._z,u=t._w;return this._x=i*u+o*a+r*l-s*c,this._y=r*u+o*c+s*a-i*l,this._z=s*u+o*l+i*c-r*a,this._w=o*u-i*a-r*c-s*l,this._onChangeCallback(),this}slerp(e,t){if(0===t)return this;if(1===t)return this.copy(e);const i=this._x,r=this._y,s=this._z,o=this._w;let a=o*e._w+i*e._x+r*e._y+s*e._z;if(a<0?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,a=-a):this.copy(e),a>=1)return this._w=o,this._x=i,this._y=r,this._z=s,this;const c=1-a*a;if(c<=Number.EPSILON){const f=1-t;return this._w=f*o+t*this._w,this._x=f*i+t*this._x,this._y=f*r+t*this._y,this._z=f*s+t*this._z,this.normalize(),this._onChangeCallback(),this}const l=Math.sqrt(c),u=Math.atan2(l,a),h=Math.sin((1-t)*u)/l,d=Math.sin(t*u)/l;return this._w=o*h+this._w*d,this._x=i*h+this._x*d,this._y=r*h+this._y*d,this._z=s*h+this._z*d,this._onChangeCallback(),this}slerpQuaternions(e,t,i){return this.copy(e).slerp(t,i)}random(){const e=Math.random(),t=Math.sqrt(1-e),i=Math.sqrt(e),r=2*Math.PI*Math.random(),s=2*Math.PI*Math.random();return this.set(t*Math.cos(r),i*Math.sin(s),i*Math.cos(s),t*Math.sin(r))}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w}fromArray(e,t=0){return this._x=e[t],this._y=e[t+1],this._z=e[t+2],this._w=e[t+3],this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._w,e}fromBufferAttribute(e,t){return this._x=e.getX(t),this._y=e.getY(t),this._z=e.getZ(t),this._w=e.getW(t),this}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}}class S{constructor(e=0,t=0,i=0){S.prototype.isVector3=!0,this.x=e,this.y=t,this.z=i}set(e,t,i){return void 0===i&&(i=this.z),this.x=e,this.y=t,this.z=i,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this}multiplyVectors(e,t){return this.x=e.x*t.x,this.y=e.y*t.y,this.z=e.z*t.z,this}applyEuler(e){return this.applyQuaternion(qR.setFromEuler(e))}applyAxisAngle(e,t){return this.applyQuaternion(qR.setFromAxisAngle(e,t))}applyMatrix3(e){const t=this.x,i=this.y,r=this.z,s=e.elements;return this.x=s[0]*t+s[3]*i+s[6]*r,this.y=s[1]*t+s[4]*i+s[7]*r,this.z=s[2]*t+s[5]*i+s[8]*r,this}applyNormalMatrix(e){return this.applyMatrix3(e).normalize()}applyMatrix4(e){const t=this.x,i=this.y,r=this.z,s=e.elements,o=1/(s[3]*t+s[7]*i+s[11]*r+s[15]);return this.x=(s[0]*t+s[4]*i+s[8]*r+s[12])*o,this.y=(s[1]*t+s[5]*i+s[9]*r+s[13])*o,this.z=(s[2]*t+s[6]*i+s[10]*r+s[14])*o,this}applyQuaternion(e){const t=this.x,i=this.y,r=this.z,s=e.x,o=e.y,a=e.z,c=e.w,l=c*t+o*r-a*i,u=c*i+a*t-s*r,h=c*r+s*i-o*t,d=-s*t-o*i-a*r;return this.x=l*c+d*-s+u*-a-h*-o,this.y=u*c+d*-o+h*-s-l*-a,this.z=h*c+d*-a+l*-o-u*-s,this}project(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)}unproject(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)}transformDirection(e){const t=this.x,i=this.y,r=this.z,s=e.elements;return this.x=s[0]*t+s[4]*i+s[8]*r,this.y=s[1]*t+s[5]*i+s[9]*r,this.z=s[2]*t+s[6]*i+s[10]*r,this.normalize()}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this}divideScalar(e){return this.multiplyScalar(1/e)}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this}clampLength(e,t){const i=this.length();return this.divideScalar(i||1).multiplyScalar(Math.max(e,Math.min(t,i)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this}lerpVectors(e,t,i){return this.x=e.x+(t.x-e.x)*i,this.y=e.y+(t.y-e.y)*i,this.z=e.z+(t.z-e.z)*i,this}cross(e){return this.crossVectors(this,e)}crossVectors(e,t){const i=e.x,r=e.y,s=e.z,o=t.x,a=t.y,c=t.z;return this.x=r*c-s*a,this.y=s*o-i*c,this.z=i*a-r*o,this}projectOnVector(e){const t=e.lengthSq();if(0===t)return this.set(0,0,0);const i=e.dot(this)/t;return this.copy(e).multiplyScalar(i)}projectOnPlane(e){return vx.copy(this).projectOnVector(e),this.sub(vx)}reflect(e){return this.sub(vx.copy(e).multiplyScalar(2*this.dot(e)))}angleTo(e){const t=Math.sqrt(this.lengthSq()*e.lengthSq());if(0===t)return Math.PI/2;const i=this.dot(e)/t;return Math.acos(Tn(i,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,i=this.y-e.y,r=this.z-e.z;return t*t+i*i+r*r}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)}setFromSpherical(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)}setFromSphericalCoords(e,t,i){const r=Math.sin(t)*e;return this.x=r*Math.sin(i),this.y=Math.cos(t)*e,this.z=r*Math.cos(i),this}setFromCylindrical(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)}setFromCylindricalCoords(e,t,i){return this.x=e*Math.sin(t),this.y=i,this.z=e*Math.cos(t),this}setFromMatrixPosition(e){const t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this}setFromMatrixScale(e){const t=this.setFromMatrixColumn(e,0).length(),i=this.setFromMatrixColumn(e,1).length(),r=this.setFromMatrixColumn(e,2).length();return this.x=t,this.y=i,this.z=r,this}setFromMatrixColumn(e,t){return this.fromArray(e.elements,4*t)}setFromMatrix3Column(e,t){return this.fromArray(e.elements,3*t)}setFromEuler(e){return this.x=e._x,this.y=e._y,this.z=e._z,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){const e=2*(Math.random()-.5),t=Math.random()*Math.PI*2,i=Math.sqrt(1-e**2);return this.x=i*Math.cos(t),this.y=i*Math.sin(t),this.z=e,this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}}const vx=new S,qR=new Ii;class Hl{constructor(e=new S(1/0,1/0,1/0),t=new S(-1/0,-1/0,-1/0)){this.isBox3=!0,this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromArray(e){let t=1/0,i=1/0,r=1/0,s=-1/0,o=-1/0,a=-1/0;for(let c=0,l=e.length;c<l;c+=3){const u=e[c],h=e[c+1],d=e[c+2];u<t&&(t=u),h<i&&(i=h),d<r&&(r=d),u>s&&(s=u),h>o&&(o=h),d>a&&(a=d)}return this.min.set(t,i,r),this.max.set(s,o,a),this}setFromBufferAttribute(e){let t=1/0,i=1/0,r=1/0,s=-1/0,o=-1/0,a=-1/0;for(let c=0,l=e.count;c<l;c++){const u=e.getX(c),h=e.getY(c),d=e.getZ(c);u<t&&(t=u),h<i&&(i=h),d<r&&(r=d),u>s&&(s=u),h>o&&(o=h),d>a&&(a=d)}return this.min.set(t,i,r),this.max.set(s,o,a),this}setFromPoints(e){this.makeEmpty();for(let t=0,i=e.length;t<i;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){const i=Ya.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(i),this.max.copy(e).add(i),this}setFromObject(e,t=!1){return this.makeEmpty(),this.expandByObject(e,t)}clone(){return(new this.constructor).copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(e){return this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}expandByObject(e,t=!1){e.updateWorldMatrix(!1,!1);const i=e.geometry;if(void 0!==i)if(t&&null!=i.attributes&&void 0!==i.attributes.position){const s=i.attributes.position;for(let o=0,a=s.count;o<a;o++)Ya.fromBufferAttribute(s,o).applyMatrix4(e.matrixWorld),this.expandByPoint(Ya)}else null===i.boundingBox&&i.computeBoundingBox(),bx.copy(i.boundingBox),bx.applyMatrix4(e.matrixWorld),this.union(bx);const r=e.children;for(let s=0,o=r.length;s<o;s++)this.expandByObject(r[s],t);return this}containsPoint(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y||e.z<this.min.z||e.z>this.max.z)}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y||e.max.z<this.min.z||e.min.z>this.max.z)}intersectsSphere(e){return this.clampPoint(e.center,Ya),Ya.distanceToSquared(e.center)<=e.radius*e.radius}intersectsPlane(e){let t,i;return e.normal.x>0?(t=e.normal.x*this.min.x,i=e.normal.x*this.max.x):(t=e.normal.x*this.max.x,i=e.normal.x*this.min.x),e.normal.y>0?(t+=e.normal.y*this.min.y,i+=e.normal.y*this.max.y):(t+=e.normal.y*this.max.y,i+=e.normal.y*this.min.y),e.normal.z>0?(t+=e.normal.z*this.min.z,i+=e.normal.z*this.max.z):(t+=e.normal.z*this.max.z,i+=e.normal.z*this.min.z),t<=-e.constant&&i>=-e.constant}intersectsTriangle(e){if(this.isEmpty())return!1;this.getCenter(cd),Em.subVectors(this.max,cd),Gl.subVectors(e.a,cd),jl.subVectors(e.b,cd),Wl.subVectors(e.c,cd),Vo.subVectors(jl,Gl),Bo.subVectors(Wl,jl),Za.subVectors(Gl,Wl);let t=[0,-Vo.z,Vo.y,0,-Bo.z,Bo.y,0,-Za.z,Za.y,Vo.z,0,-Vo.x,Bo.z,0,-Bo.x,Za.z,0,-Za.x,-Vo.y,Vo.x,0,-Bo.y,Bo.x,0,-Za.y,Za.x,0];return!(!xx(t,Gl,jl,Wl,Em)||(t=[1,0,0,0,1,0,0,0,1],!xx(t,Gl,jl,Wl,Em)))&&(Dm.crossVectors(Vo,Bo),t=[Dm.x,Dm.y,Dm.z],xx(t,Gl,jl,Wl,Em))}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return Ya.copy(e).clamp(this.min,this.max).sub(e).length()}getBoundingSphere(e){return this.getCenter(e.center),e.radius=.5*this.getSize(Ya).length(),e}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}applyMatrix4(e){return this.isEmpty()||(to[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),to[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),to[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),to[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),to[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),to[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),to[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),to[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(to)),this}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}const to=[new S,new S,new S,new S,new S,new S,new S,new S],Ya=new S,bx=new Hl,Gl=new S,jl=new S,Wl=new S,Vo=new S,Bo=new S,Za=new S,cd=new S,Em=new S,Dm=new S,Ka=new S;function xx(n,e,t,i,r){for(let s=0,o=n.length-3;s<=o;s+=3){Ka.fromArray(n,s);const a=r.x*Math.abs(Ka.x)+r.y*Math.abs(Ka.y)+r.z*Math.abs(Ka.z),c=e.dot(Ka),l=t.dot(Ka),u=i.dot(Ka);if(Math.max(-Math.max(c,l,u),Math.min(c,l,u))>a)return!1}return!0}const Cq=new Hl,ld=new S,wx=new S;class $l{constructor(e=new S,t=-1){this.center=e,this.radius=t}set(e,t){return this.center.copy(e),this.radius=t,this}setFromPoints(e,t){const i=this.center;void 0!==t?i.copy(t):Cq.setFromPoints(e).getCenter(i);let r=0;for(let s=0,o=e.length;s<o;s++)r=Math.max(r,i.distanceToSquared(e[s]));return this.radius=Math.sqrt(r),this}copy(e){return this.center.copy(e.center),this.radius=e.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(e){return e.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(e){return e.distanceTo(this.center)-this.radius}intersectsSphere(e){const t=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=t*t}intersectsBox(e){return e.intersectsSphere(this)}intersectsPlane(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius}clampPoint(e,t){const i=this.center.distanceToSquared(e);return t.copy(e),i>this.radius*this.radius&&(t.sub(this.center).normalize(),t.multiplyScalar(this.radius).add(this.center)),t}getBoundingBox(e){return this.isEmpty()?(e.makeEmpty(),e):(e.set(this.center,this.center),e.expandByScalar(this.radius),e)}applyMatrix4(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this}translate(e){return this.center.add(e),this}expandByPoint(e){if(this.isEmpty())return this.center.copy(e),this.radius=0,this;ld.subVectors(e,this.center);const t=ld.lengthSq();if(t>this.radius*this.radius){const i=Math.sqrt(t),r=.5*(i-this.radius);this.center.addScaledVector(ld,r/i),this.radius+=r}return this}union(e){return e.isEmpty()?this:this.isEmpty()?(this.copy(e),this):(!0===this.center.equals(e.center)?this.radius=Math.max(this.radius,e.radius):(wx.subVectors(e.center,this.center).setLength(e.radius),this.expandByPoint(ld.copy(e.center).add(wx)),this.expandByPoint(ld.copy(e.center).sub(wx))),this)}equals(e){return e.center.equals(this.center)&&e.radius===this.radius}clone(){return(new this.constructor).copy(this)}}const no=new S,Mx=new S,Tm=new S,Uo=new S,Cx=new S,Am=new S,Sx=new S;class Im{constructor(e=new S,t=new S(0,0,-1)){this.origin=e,this.direction=t}set(e,t){return this.origin.copy(e),this.direction.copy(t),this}copy(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this}at(e,t){return t.copy(this.direction).multiplyScalar(e).add(this.origin)}lookAt(e){return this.direction.copy(e).sub(this.origin).normalize(),this}recast(e){return this.origin.copy(this.at(e,no)),this}closestPointToPoint(e,t){t.subVectors(e,this.origin);const i=t.dot(this.direction);return i<0?t.copy(this.origin):t.copy(this.direction).multiplyScalar(i).add(this.origin)}distanceToPoint(e){return Math.sqrt(this.distanceSqToPoint(e))}distanceSqToPoint(e){const t=no.subVectors(e,this.origin).dot(this.direction);return t<0?this.origin.distanceToSquared(e):(no.copy(this.direction).multiplyScalar(t).add(this.origin),no.distanceToSquared(e))}distanceSqToSegment(e,t,i,r){Mx.copy(e).add(t).multiplyScalar(.5),Tm.copy(t).sub(e).normalize(),Uo.copy(this.origin).sub(Mx);const s=.5*e.distanceTo(t),o=-this.direction.dot(Tm),a=Uo.dot(this.direction),c=-Uo.dot(Tm),l=Uo.lengthSq(),u=Math.abs(1-o*o);let h,d,f,p;if(u>0)if(h=o*c-a,d=o*a-c,p=s*u,h>=0)if(d>=-p)if(d<=p){const m=1/u;h*=m,d*=m,f=h*(h+o*d+2*a)+d*(o*h+d+2*c)+l}else d=s,h=Math.max(0,-(o*d+a)),f=-h*h+d*(d+2*c)+l;else d=-s,h=Math.max(0,-(o*d+a)),f=-h*h+d*(d+2*c)+l;else d<=-p?(h=Math.max(0,-(-o*s+a)),d=h>0?-s:Math.min(Math.max(-s,-c),s),f=-h*h+d*(d+2*c)+l):d<=p?(h=0,d=Math.min(Math.max(-s,-c),s),f=d*(d+2*c)+l):(h=Math.max(0,-(o*s+a)),d=h>0?s:Math.min(Math.max(-s,-c),s),f=-h*h+d*(d+2*c)+l);else d=o>0?-s:s,h=Math.max(0,-(o*d+a)),f=-h*h+d*(d+2*c)+l;return i&&i.copy(this.direction).multiplyScalar(h).add(this.origin),r&&r.copy(Tm).multiplyScalar(d).add(Mx),f}intersectSphere(e,t){no.subVectors(e.center,this.origin);const i=no.dot(this.direction),r=no.dot(no)-i*i,s=e.radius*e.radius;if(r>s)return null;const o=Math.sqrt(s-r),a=i-o,c=i+o;return a<0&&c<0?null:this.at(a<0?c:a,t)}intersectsSphere(e){return this.distanceSqToPoint(e.center)<=e.radius*e.radius}distanceToPlane(e){const t=e.normal.dot(this.direction);if(0===t)return 0===e.distanceToPoint(this.origin)?0:null;const i=-(this.origin.dot(e.normal)+e.constant)/t;return i>=0?i:null}intersectPlane(e,t){const i=this.distanceToPlane(e);return null===i?null:this.at(i,t)}intersectsPlane(e){const t=e.distanceToPoint(this.origin);return 0===t||e.normal.dot(this.direction)*t<0}intersectBox(e,t){let i,r,s,o,a,c;const l=1/this.direction.x,u=1/this.direction.y,h=1/this.direction.z,d=this.origin;return l>=0?(i=(e.min.x-d.x)*l,r=(e.max.x-d.x)*l):(i=(e.max.x-d.x)*l,r=(e.min.x-d.x)*l),u>=0?(s=(e.min.y-d.y)*u,o=(e.max.y-d.y)*u):(s=(e.max.y-d.y)*u,o=(e.min.y-d.y)*u),i>o||s>r||((s>i||isNaN(i))&&(i=s),(o<r||isNaN(r))&&(r=o),h>=0?(a=(e.min.z-d.z)*h,c=(e.max.z-d.z)*h):(a=(e.max.z-d.z)*h,c=(e.min.z-d.z)*h),i>c||a>r)||((a>i||i!=i)&&(i=a),(c<r||r!=r)&&(r=c),r<0)?null:this.at(i>=0?i:r,t)}intersectsBox(e){return null!==this.intersectBox(e,no)}intersectTriangle(e,t,i,r,s){Cx.subVectors(t,e),Am.subVectors(i,e),Sx.crossVectors(Cx,Am);let a,o=this.direction.dot(Sx);if(o>0){if(r)return null;a=1}else{if(!(o<0))return null;a=-1,o=-o}Uo.subVectors(this.origin,e);const c=a*this.direction.dot(Am.crossVectors(Uo,Am));if(c<0)return null;const l=a*this.direction.dot(Cx.cross(Uo));if(l<0||c+l>o)return null;const u=-a*Uo.dot(Sx);return u<0?null:this.at(u/o,s)}applyMatrix4(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this}equals(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}clone(){return(new this.constructor).copy(this)}}class ct{constructor(){ct.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}set(e,t,i,r,s,o,a,c,l,u,h,d,f,p,m,g){const _=this.elements;return _[0]=e,_[4]=t,_[8]=i,_[12]=r,_[1]=s,_[5]=o,_[9]=a,_[13]=c,_[2]=l,_[6]=u,_[10]=h,_[14]=d,_[3]=f,_[7]=p,_[11]=m,_[15]=g,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return(new ct).fromArray(this.elements)}copy(e){const t=this.elements,i=e.elements;return t[0]=i[0],t[1]=i[1],t[2]=i[2],t[3]=i[3],t[4]=i[4],t[5]=i[5],t[6]=i[6],t[7]=i[7],t[8]=i[8],t[9]=i[9],t[10]=i[10],t[11]=i[11],t[12]=i[12],t[13]=i[13],t[14]=i[14],t[15]=i[15],this}copyPosition(e){const t=this.elements,i=e.elements;return t[12]=i[12],t[13]=i[13],t[14]=i[14],this}setFromMatrix3(e){const t=e.elements;return this.set(t[0],t[3],t[6],0,t[1],t[4],t[7],0,t[2],t[5],t[8],0,0,0,0,1),this}extractBasis(e,t,i){return e.setFromMatrixColumn(this,0),t.setFromMatrixColumn(this,1),i.setFromMatrixColumn(this,2),this}makeBasis(e,t,i){return this.set(e.x,t.x,i.x,0,e.y,t.y,i.y,0,e.z,t.z,i.z,0,0,0,0,1),this}extractRotation(e){const t=this.elements,i=e.elements,r=1/ql.setFromMatrixColumn(e,0).length(),s=1/ql.setFromMatrixColumn(e,1).length(),o=1/ql.setFromMatrixColumn(e,2).length();return t[0]=i[0]*r,t[1]=i[1]*r,t[2]=i[2]*r,t[3]=0,t[4]=i[4]*s,t[5]=i[5]*s,t[6]=i[6]*s,t[7]=0,t[8]=i[8]*o,t[9]=i[9]*o,t[10]=i[10]*o,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromEuler(e){const t=this.elements,i=e.x,r=e.y,s=e.z,o=Math.cos(i),a=Math.sin(i),c=Math.cos(r),l=Math.sin(r),u=Math.cos(s),h=Math.sin(s);if("XYZ"===e.order){const d=o*u,f=o*h,p=a*u,m=a*h;t[0]=c*u,t[4]=-c*h,t[8]=l,t[1]=f+p*l,t[5]=d-m*l,t[9]=-a*c,t[2]=m-d*l,t[6]=p+f*l,t[10]=o*c}else if("YXZ"===e.order){const d=c*u,f=c*h,p=l*u,m=l*h;t[0]=d+m*a,t[4]=p*a-f,t[8]=o*l,t[1]=o*h,t[5]=o*u,t[9]=-a,t[2]=f*a-p,t[6]=m+d*a,t[10]=o*c}else if("ZXY"===e.order){const d=c*u,f=c*h,p=l*u,m=l*h;t[0]=d-m*a,t[4]=-o*h,t[8]=p+f*a,t[1]=f+p*a,t[5]=o*u,t[9]=m-d*a,t[2]=-o*l,t[6]=a,t[10]=o*c}else if("ZYX"===e.order){const d=o*u,f=o*h,p=a*u,m=a*h;t[0]=c*u,t[4]=p*l-f,t[8]=d*l+m,t[1]=c*h,t[5]=m*l+d,t[9]=f*l-p,t[2]=-l,t[6]=a*c,t[10]=o*c}else if("YZX"===e.order){const d=o*c,f=o*l,p=a*c,m=a*l;t[0]=c*u,t[4]=m-d*h,t[8]=p*h+f,t[1]=h,t[5]=o*u,t[9]=-a*u,t[2]=-l*u,t[6]=f*h+p,t[10]=d-m*h}else if("XZY"===e.order){const d=o*c,f=o*l,p=a*c,m=a*l;t[0]=c*u,t[4]=-h,t[8]=l*u,t[1]=d*h+m,t[5]=o*u,t[9]=f*h-p,t[2]=p*h-f,t[6]=a*u,t[10]=m*h+d}return t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromQuaternion(e){return this.compose(Sq,e,Eq)}lookAt(e,t,i){const r=this.elements;return or.subVectors(e,t),0===or.lengthSq()&&(or.z=1),or.normalize(),zo.crossVectors(i,or),0===zo.lengthSq()&&(1===Math.abs(i.z)?or.x+=1e-4:or.z+=1e-4,or.normalize(),zo.crossVectors(i,or)),zo.normalize(),Pm.crossVectors(or,zo),r[0]=zo.x,r[4]=Pm.x,r[8]=or.x,r[1]=zo.y,r[5]=Pm.y,r[9]=or.y,r[2]=zo.z,r[6]=Pm.z,r[10]=or.z,this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const i=e.elements,r=t.elements,s=this.elements,o=i[0],a=i[4],c=i[8],l=i[12],u=i[1],h=i[5],d=i[9],f=i[13],p=i[2],m=i[6],g=i[10],_=i[14],b=i[3],y=i[7],v=i[11],w=i[15],M=r[0],I=r[4],x=r[8],E=r[12],R=r[1],$=r[5],se=r[9],H=r[13],N=r[2],X=r[6],L=r[10],G=r[14],F=r[3],O=r[7],V=r[11],ce=r[15];return s[0]=o*M+a*R+c*N+l*F,s[4]=o*I+a*$+c*X+l*O,s[8]=o*x+a*se+c*L+l*V,s[12]=o*E+a*H+c*G+l*ce,s[1]=u*M+h*R+d*N+f*F,s[5]=u*I+h*$+d*X+f*O,s[9]=u*x+h*se+d*L+f*V,s[13]=u*E+h*H+d*G+f*ce,s[2]=p*M+m*R+g*N+_*F,s[6]=p*I+m*$+g*X+_*O,s[10]=p*x+m*se+g*L+_*V,s[14]=p*E+m*H+g*G+_*ce,s[3]=b*M+y*R+v*N+w*F,s[7]=b*I+y*$+v*X+w*O,s[11]=b*x+y*se+v*L+w*V,s[15]=b*E+y*H+v*G+w*ce,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[4]*=e,t[8]*=e,t[12]*=e,t[1]*=e,t[5]*=e,t[9]*=e,t[13]*=e,t[2]*=e,t[6]*=e,t[10]*=e,t[14]*=e,t[3]*=e,t[7]*=e,t[11]*=e,t[15]*=e,this}determinant(){const e=this.elements,t=e[0],i=e[4],r=e[8],s=e[12],o=e[1],a=e[5],c=e[9],l=e[13],u=e[2],h=e[6],d=e[10],f=e[14];return e[3]*(+s*c*h-r*l*h-s*a*d+i*l*d+r*a*f-i*c*f)+e[7]*(+t*c*f-t*l*d+s*o*d-r*o*f+r*l*u-s*c*u)+e[11]*(+t*l*h-t*a*f-s*o*h+i*o*f+s*a*u-i*l*u)+e[15]*(-r*a*u-t*c*h+t*a*d+r*o*h-i*o*d+i*c*u)}transpose(){const e=this.elements;let t;return t=e[1],e[1]=e[4],e[4]=t,t=e[2],e[2]=e[8],e[8]=t,t=e[6],e[6]=e[9],e[9]=t,t=e[3],e[3]=e[12],e[12]=t,t=e[7],e[7]=e[13],e[13]=t,t=e[11],e[11]=e[14],e[14]=t,this}setPosition(e,t,i){const r=this.elements;return e.isVector3?(r[12]=e.x,r[13]=e.y,r[14]=e.z):(r[12]=e,r[13]=t,r[14]=i),this}invert(){const e=this.elements,t=e[0],i=e[1],r=e[2],s=e[3],o=e[4],a=e[5],c=e[6],l=e[7],u=e[8],h=e[9],d=e[10],f=e[11],p=e[12],m=e[13],g=e[14],_=e[15],b=h*g*l-m*d*l+m*c*f-a*g*f-h*c*_+a*d*_,y=p*d*l-u*g*l-p*c*f+o*g*f+u*c*_-o*d*_,v=u*m*l-p*h*l+p*a*f-o*m*f-u*a*_+o*h*_,w=p*h*c-u*m*c-p*a*d+o*m*d+u*a*g-o*h*g,M=t*b+i*y+r*v+s*w;if(0===M)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const I=1/M;return e[0]=b*I,e[1]=(m*d*s-h*g*s-m*r*f+i*g*f+h*r*_-i*d*_)*I,e[2]=(a*g*s-m*c*s+m*r*l-i*g*l-a*r*_+i*c*_)*I,e[3]=(h*c*s-a*d*s-h*r*l+i*d*l+a*r*f-i*c*f)*I,e[4]=y*I,e[5]=(u*g*s-p*d*s+p*r*f-t*g*f-u*r*_+t*d*_)*I,e[6]=(p*c*s-o*g*s-p*r*l+t*g*l+o*r*_-t*c*_)*I,e[7]=(o*d*s-u*c*s+u*r*l-t*d*l-o*r*f+t*c*f)*I,e[8]=v*I,e[9]=(p*h*s-u*m*s-p*i*f+t*m*f+u*i*_-t*h*_)*I,e[10]=(o*m*s-p*a*s+p*i*l-t*m*l-o*i*_+t*a*_)*I,e[11]=(u*a*s-o*h*s-u*i*l+t*h*l+o*i*f-t*a*f)*I,e[12]=w*I,e[13]=(u*m*r-p*h*r+p*i*d-t*m*d-u*i*g+t*h*g)*I,e[14]=(p*a*r-o*m*r-p*i*c+t*m*c+o*i*g-t*a*g)*I,e[15]=(o*h*r-u*a*r+u*i*c-t*h*c-o*i*d+t*a*d)*I,this}scale(e){const t=this.elements,i=e.x,r=e.y,s=e.z;return t[0]*=i,t[4]*=r,t[8]*=s,t[1]*=i,t[5]*=r,t[9]*=s,t[2]*=i,t[6]*=r,t[10]*=s,t[3]*=i,t[7]*=r,t[11]*=s,this}getMaxScaleOnAxis(){const e=this.elements;return Math.sqrt(Math.max(e[0]*e[0]+e[1]*e[1]+e[2]*e[2],e[4]*e[4]+e[5]*e[5]+e[6]*e[6],e[8]*e[8]+e[9]*e[9]+e[10]*e[10]))}makeTranslation(e,t,i){return this.set(1,0,0,e,0,1,0,t,0,0,1,i,0,0,0,1),this}makeRotationX(e){const t=Math.cos(e),i=Math.sin(e);return this.set(1,0,0,0,0,t,-i,0,0,i,t,0,0,0,0,1),this}makeRotationY(e){const t=Math.cos(e),i=Math.sin(e);return this.set(t,0,i,0,0,1,0,0,-i,0,t,0,0,0,0,1),this}makeRotationZ(e){const t=Math.cos(e),i=Math.sin(e);return this.set(t,-i,0,0,i,t,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(e,t){const i=Math.cos(t),r=Math.sin(t),s=1-i,o=e.x,a=e.y,c=e.z,l=s*o,u=s*a;return this.set(l*o+i,l*a-r*c,l*c+r*a,0,l*a+r*c,u*a+i,u*c-r*o,0,l*c-r*a,u*c+r*o,s*c*c+i,0,0,0,0,1),this}makeScale(e,t,i){return this.set(e,0,0,0,0,t,0,0,0,0,i,0,0,0,0,1),this}makeShear(e,t,i,r,s,o){return this.set(1,i,s,0,e,1,o,0,t,r,1,0,0,0,0,1),this}compose(e,t,i){const r=this.elements,s=t._x,o=t._y,a=t._z,c=t._w,l=s+s,u=o+o,h=a+a,d=s*l,f=s*u,p=s*h,m=o*u,g=o*h,_=a*h,b=c*l,y=c*u,v=c*h,w=i.x,M=i.y,I=i.z;return r[0]=(1-(m+_))*w,r[1]=(f+v)*w,r[2]=(p-y)*w,r[3]=0,r[4]=(f-v)*M,r[5]=(1-(d+_))*M,r[6]=(g+b)*M,r[7]=0,r[8]=(p+y)*I,r[9]=(g-b)*I,r[10]=(1-(d+m))*I,r[11]=0,r[12]=e.x,r[13]=e.y,r[14]=e.z,r[15]=1,this}decompose(e,t,i){const r=this.elements;let s=ql.set(r[0],r[1],r[2]).length();const o=ql.set(r[4],r[5],r[6]).length(),a=ql.set(r[8],r[9],r[10]).length();this.determinant()<0&&(s=-s),e.x=r[12],e.y=r[13],e.z=r[14],es.copy(this);const l=1/s,u=1/o,h=1/a;return es.elements[0]*=l,es.elements[1]*=l,es.elements[2]*=l,es.elements[4]*=u,es.elements[5]*=u,es.elements[6]*=u,es.elements[8]*=h,es.elements[9]*=h,es.elements[10]*=h,t.setFromRotationMatrix(es),i.x=s,i.y=o,i.z=a,this}makePerspective(e,t,i,r,s,o){const a=this.elements,l=2*s/(i-r),u=(t+e)/(t-e),h=(i+r)/(i-r),d=-(o+s)/(o-s),f=-2*o*s/(o-s);return a[0]=2*s/(t-e),a[4]=0,a[8]=u,a[12]=0,a[1]=0,a[5]=l,a[9]=h,a[13]=0,a[2]=0,a[6]=0,a[10]=d,a[14]=f,a[3]=0,a[7]=0,a[11]=-1,a[15]=0,this}makeOrthographic(e,t,i,r,s,o){const a=this.elements,c=1/(t-e),l=1/(i-r),u=1/(o-s),h=(t+e)*c,d=(i+r)*l,f=(o+s)*u;return a[0]=2*c,a[4]=0,a[8]=0,a[12]=-h,a[1]=0,a[5]=2*l,a[9]=0,a[13]=-d,a[2]=0,a[6]=0,a[10]=-2*u,a[14]=-f,a[3]=0,a[7]=0,a[11]=0,a[15]=1,this}equals(e){const t=this.elements,i=e.elements;for(let r=0;r<16;r++)if(t[r]!==i[r])return!1;return!0}fromArray(e,t=0){for(let i=0;i<16;i++)this.elements[i]=e[i+t];return this}toArray(e=[],t=0){const i=this.elements;return e[t]=i[0],e[t+1]=i[1],e[t+2]=i[2],e[t+3]=i[3],e[t+4]=i[4],e[t+5]=i[5],e[t+6]=i[6],e[t+7]=i[7],e[t+8]=i[8],e[t+9]=i[9],e[t+10]=i[10],e[t+11]=i[11],e[t+12]=i[12],e[t+13]=i[13],e[t+14]=i[14],e[t+15]=i[15],e}}const ql=new S,es=new ct,Sq=new S(0,0,0),Eq=new S(1,1,1),zo=new S,Pm=new S,or=new S,XR=new ct,YR=new Ii;let Dq=(()=>{class n{constructor(t=0,i=0,r=0,s=n.DefaultOrder){this.isEuler=!0,this._x=t,this._y=i,this._z=r,this._order=s}get x(){return this._x}set x(t){this._x=t,this._onChangeCallback()}get y(){return this._y}set y(t){this._y=t,this._onChangeCallback()}get z(){return this._z}set z(t){this._z=t,this._onChangeCallback()}get order(){return this._order}set order(t){this._order=t,this._onChangeCallback()}set(t,i,r,s=this._order){return this._x=t,this._y=i,this._z=r,this._order=s,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(t){return this._x=t._x,this._y=t._y,this._z=t._z,this._order=t._order,this._onChangeCallback(),this}setFromRotationMatrix(t,i=this._order,r=!0){const s=t.elements,o=s[0],a=s[4],c=s[8],l=s[1],u=s[5],h=s[9],d=s[2],f=s[6],p=s[10];switch(i){case"XYZ":this._y=Math.asin(Tn(c,-1,1)),Math.abs(c)<.9999999?(this._x=Math.atan2(-h,p),this._z=Math.atan2(-a,o)):(this._x=Math.atan2(f,u),this._z=0);break;case"YXZ":this._x=Math.asin(-Tn(h,-1,1)),Math.abs(h)<.9999999?(this._y=Math.atan2(c,p),this._z=Math.atan2(l,u)):(this._y=Math.atan2(-d,o),this._z=0);break;case"ZXY":this._x=Math.asin(Tn(f,-1,1)),Math.abs(f)<.9999999?(this._y=Math.atan2(-d,p),this._z=Math.atan2(-a,u)):(this._y=0,this._z=Math.atan2(l,o));break;case"ZYX":this._y=Math.asin(-Tn(d,-1,1)),Math.abs(d)<.9999999?(this._x=Math.atan2(f,p),this._z=Math.atan2(l,o)):(this._x=0,this._z=Math.atan2(-a,u));break;case"YZX":this._z=Math.asin(Tn(l,-1,1)),Math.abs(l)<.9999999?(this._x=Math.atan2(-h,u),this._y=Math.atan2(-d,o)):(this._x=0,this._y=Math.atan2(c,p));break;case"XZY":this._z=Math.asin(-Tn(a,-1,1)),Math.abs(a)<.9999999?(this._x=Math.atan2(f,u),this._y=Math.atan2(c,o)):(this._x=Math.atan2(-h,p),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+i)}return this._order=i,!0===r&&this._onChangeCallback(),this}setFromQuaternion(t,i,r){return XR.makeRotationFromQuaternion(t),this.setFromRotationMatrix(XR,i,r)}setFromVector3(t,i=this._order){return this.set(t.x,t.y,t.z,i)}reorder(t){return YR.setFromEuler(this),this.setFromQuaternion(YR,t)}equals(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._order===this._order}fromArray(t){return this._x=t[0],this._y=t[1],this._z=t[2],void 0!==t[3]&&(this._order=t[3]),this._onChangeCallback(),this}toArray(t=[],i=0){return t[i]=this._x,t[i+1]=this._y,t[i+2]=this._z,t[i+3]=this._order,t}_onChange(t){return this._onChangeCallback=t,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}toVector3(){console.error("THREE.Euler: .toVector3() has been removed. Use Vector3.setFromEuler() instead")}}return n.DefaultOrder="XYZ",n.RotationOrders=["XYZ","YZX","ZXY","XZY","YXZ","ZYX"],n})();class Ex{constructor(){this.mask=1}set(e){this.mask=(1<<e|0)>>>0}enable(e){this.mask|=1<<e|0}enableAll(){this.mask=-1}toggle(e){this.mask^=1<<e|0}disable(e){this.mask&=~(1<<e|0)}disableAll(){this.mask=0}test(e){return 0!=(this.mask&e.mask)}isEnabled(e){return 0!=(this.mask&(1<<e|0))}}let Tq=0;const ZR=new S,Xl=new Ii,io=new ct,Rm=new S,ud=new S,Aq=new S,Iq=new Ii,KR=new S(1,0,0),JR=new S(0,1,0),QR=new S(0,0,1),Pq={type:"added"},eO={type:"removed"};let ar=(()=>{class n extends $a{constructor(){super(),this.isObject3D=!0,Object.defineProperty(this,"id",{value:Tq++}),this.uuid=sr(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=n.DefaultUp.clone();const t=new S,i=new Dq,r=new Ii,s=new S(1,1,1);i._onChange(function o(){r.setFromEuler(i,!1)}),r._onChange(function a(){i.setFromQuaternion(r,void 0,!1)}),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:t},rotation:{configurable:!0,enumerable:!0,value:i},quaternion:{configurable:!0,enumerable:!0,value:r},scale:{configurable:!0,enumerable:!0,value:s},modelViewMatrix:{value:new ct},normalMatrix:{value:new Wn}}),this.matrix=new ct,this.matrixWorld=new ct,this.matrixAutoUpdate=n.DefaultMatrixAutoUpdate,this.matrixWorldNeedsUpdate=!1,this.matrixWorldAutoUpdate=n.DefaultMatrixWorldAutoUpdate,this.layers=new Ex,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.userData={}}onBeforeRender(){}onAfterRender(){}applyMatrix4(t){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(t),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(t){return this.quaternion.premultiply(t),this}setRotationFromAxisAngle(t,i){this.quaternion.setFromAxisAngle(t,i)}setRotationFromEuler(t){this.quaternion.setFromEuler(t,!0)}setRotationFromMatrix(t){this.quaternion.setFromRotationMatrix(t)}setRotationFromQuaternion(t){this.quaternion.copy(t)}rotateOnAxis(t,i){return Xl.setFromAxisAngle(t,i),this.quaternion.multiply(Xl),this}rotateOnWorldAxis(t,i){return Xl.setFromAxisAngle(t,i),this.quaternion.premultiply(Xl),this}rotateX(t){return this.rotateOnAxis(KR,t)}rotateY(t){return this.rotateOnAxis(JR,t)}rotateZ(t){return this.rotateOnAxis(QR,t)}translateOnAxis(t,i){return ZR.copy(t).applyQuaternion(this.quaternion),this.position.add(ZR.multiplyScalar(i)),this}translateX(t){return this.translateOnAxis(KR,t)}translateY(t){return this.translateOnAxis(JR,t)}translateZ(t){return this.translateOnAxis(QR,t)}localToWorld(t){return t.applyMatrix4(this.matrixWorld)}worldToLocal(t){return t.applyMatrix4(io.copy(this.matrixWorld).invert())}lookAt(t,i,r){t.isVector3?Rm.copy(t):Rm.set(t,i,r);const s=this.parent;this.updateWorldMatrix(!0,!1),ud.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?io.lookAt(ud,Rm,this.up):io.lookAt(Rm,ud,this.up),this.quaternion.setFromRotationMatrix(io),s&&(io.extractRotation(s.matrixWorld),Xl.setFromRotationMatrix(io),this.quaternion.premultiply(Xl.invert()))}add(t){if(arguments.length>1){for(let i=0;i<arguments.length;i++)this.add(arguments[i]);return this}return t===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",t),this):(t&&t.isObject3D?(null!==t.parent&&t.parent.remove(t),t.parent=this,this.children.push(t),t.dispatchEvent(Pq)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",t),this)}remove(t){if(arguments.length>1){for(let r=0;r<arguments.length;r++)this.remove(arguments[r]);return this}const i=this.children.indexOf(t);return-1!==i&&(t.parent=null,this.children.splice(i,1),t.dispatchEvent(eO)),this}removeFromParent(){const t=this.parent;return null!==t&&t.remove(this),this}clear(){for(let t=0;t<this.children.length;t++){const i=this.children[t];i.parent=null,i.dispatchEvent(eO)}return this.children.length=0,this}attach(t){return this.updateWorldMatrix(!0,!1),io.copy(this.matrixWorld).invert(),null!==t.parent&&(t.parent.updateWorldMatrix(!0,!1),io.multiply(t.parent.matrixWorld)),t.applyMatrix4(io),this.add(t),t.updateWorldMatrix(!1,!0),this}getObjectById(t){return this.getObjectByProperty("id",t)}getObjectByName(t){return this.getObjectByProperty("name",t)}getObjectByProperty(t,i){if(this[t]===i)return this;for(let r=0,s=this.children.length;r<s;r++){const a=this.children[r].getObjectByProperty(t,i);if(void 0!==a)return a}}getWorldPosition(t){return this.updateWorldMatrix(!0,!1),t.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(t){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(ud,t,Aq),t}getWorldScale(t){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(ud,Iq,t),t}getWorldDirection(t){this.updateWorldMatrix(!0,!1);const i=this.matrixWorld.elements;return t.set(i[8],i[9],i[10]).normalize()}raycast(){}traverse(t){t(this);const i=this.children;for(let r=0,s=i.length;r<s;r++)i[r].traverse(t)}traverseVisible(t){if(!1===this.visible)return;t(this);const i=this.children;for(let r=0,s=i.length;r<s;r++)i[r].traverseVisible(t)}traverseAncestors(t){const i=this.parent;null!==i&&(t(i),i.traverseAncestors(t))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(t){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||t)&&(null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,t=!0);const i=this.children;for(let r=0,s=i.length;r<s;r++){const o=i[r];(!0===o.matrixWorldAutoUpdate||!0===t)&&o.updateMatrixWorld(t)}}updateWorldMatrix(t,i){const r=this.parent;if(!0===t&&null!==r&&!0===r.matrixWorldAutoUpdate&&r.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),!0===i){const s=this.children;for(let o=0,a=s.length;o<a;o++){const c=s[o];!0===c.matrixWorldAutoUpdate&&c.updateWorldMatrix(!1,!0)}}}toJSON(t){const i=void 0===t||"string"==typeof t,r={};i&&(t={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},r.metadata={version:4.5,type:"Object",generator:"Object3D.toJSON"});const s={};function o(c,l){return void 0===c[l.uuid]&&(c[l.uuid]=l.toJSON(t)),l.uuid}if(s.uuid=this.uuid,s.type=this.type,""!==this.name&&(s.name=this.name),!0===this.castShadow&&(s.castShadow=!0),!0===this.receiveShadow&&(s.receiveShadow=!0),!1===this.visible&&(s.visible=!1),!1===this.frustumCulled&&(s.frustumCulled=!1),0!==this.renderOrder&&(s.renderOrder=this.renderOrder),"{}"!==JSON.stringify(this.userData)&&(s.userData=this.userData),s.layers=this.layers.mask,s.matrix=this.matrix.toArray(),!1===this.matrixAutoUpdate&&(s.matrixAutoUpdate=!1),this.isInstancedMesh&&(s.type="InstancedMesh",s.count=this.count,s.instanceMatrix=this.instanceMatrix.toJSON(),null!==this.instanceColor&&(s.instanceColor=this.instanceColor.toJSON())),this.isScene)this.background&&(this.background.isColor?s.background=this.background.toJSON():this.background.isTexture&&(s.background=this.background.toJSON(t).uuid)),this.environment&&this.environment.isTexture&&!0!==this.environment.isRenderTargetTexture&&(s.environment=this.environment.toJSON(t).uuid);else if(this.isMesh||this.isLine||this.isPoints){s.geometry=o(t.geometries,this.geometry);const c=this.geometry.parameters;if(void 0!==c&&void 0!==c.shapes){const l=c.shapes;if(Array.isArray(l))for(let u=0,h=l.length;u<h;u++)o(t.shapes,l[u]);else o(t.shapes,l)}}if(this.isSkinnedMesh&&(s.bindMode=this.bindMode,s.bindMatrix=this.bindMatrix.toArray(),void 0!==this.skeleton&&(o(t.skeletons,this.skeleton),s.skeleton=this.skeleton.uuid)),void 0!==this.material)if(Array.isArray(this.material)){const c=[];for(let l=0,u=this.material.length;l<u;l++)c.push(o(t.materials,this.material[l]));s.material=c}else s.material=o(t.materials,this.material);if(this.children.length>0){s.children=[];for(let c=0;c<this.children.length;c++)s.children.push(this.children[c].toJSON(t).object)}if(this.animations.length>0){s.animations=[];for(let c=0;c<this.animations.length;c++)s.animations.push(o(t.animations,this.animations[c]))}if(i){const c=a(t.geometries),l=a(t.materials),u=a(t.textures),h=a(t.images),d=a(t.shapes),f=a(t.skeletons),p=a(t.animations),m=a(t.nodes);c.length>0&&(r.geometries=c),l.length>0&&(r.materials=l),u.length>0&&(r.textures=u),h.length>0&&(r.images=h),d.length>0&&(r.shapes=d),f.length>0&&(r.skeletons=f),p.length>0&&(r.animations=p),m.length>0&&(r.nodes=m)}return r.object=s,r;function a(c){const l=[];for(const u in c){const h=c[u];delete h.metadata,l.push(h)}return l}}clone(t){return(new this.constructor).copy(this,t)}copy(t,i=!0){if(this.name=t.name,this.up.copy(t.up),this.position.copy(t.position),this.rotation.order=t.rotation.order,this.quaternion.copy(t.quaternion),this.scale.copy(t.scale),this.matrix.copy(t.matrix),this.matrixWorld.copy(t.matrixWorld),this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrixWorldNeedsUpdate=t.matrixWorldNeedsUpdate,this.matrixWorldAutoUpdate=t.matrixWorldAutoUpdate,this.layers.mask=t.layers.mask,this.visible=t.visible,this.castShadow=t.castShadow,this.receiveShadow=t.receiveShadow,this.frustumCulled=t.frustumCulled,this.renderOrder=t.renderOrder,this.userData=JSON.parse(JSON.stringify(t.userData)),!0===i)for(let r=0;r<t.children.length;r++)this.add(t.children[r].clone());return this}}return n.DefaultUp=new S(0,1,0),n.DefaultMatrixAutoUpdate=!0,n.DefaultMatrixWorldAutoUpdate=!0,n})();const ts=new S,ro=new S,Dx=new S,so=new S,Yl=new S,Zl=new S,tO=new S,Tx=new S,Ax=new S,Ix=new S;class ns{constructor(e=new S,t=new S,i=new S){this.a=e,this.b=t,this.c=i}static getNormal(e,t,i,r){r.subVectors(i,t),ts.subVectors(e,t),r.cross(ts);const s=r.lengthSq();return s>0?r.multiplyScalar(1/Math.sqrt(s)):r.set(0,0,0)}static getBarycoord(e,t,i,r,s){ts.subVectors(r,t),ro.subVectors(i,t),Dx.subVectors(e,t);const o=ts.dot(ts),a=ts.dot(ro),c=ts.dot(Dx),l=ro.dot(ro),u=ro.dot(Dx),h=o*l-a*a;if(0===h)return s.set(-2,-1,-1);const d=1/h,f=(l*c-a*u)*d,p=(o*u-a*c)*d;return s.set(1-f-p,p,f)}static containsPoint(e,t,i,r){return this.getBarycoord(e,t,i,r,so),so.x>=0&&so.y>=0&&so.x+so.y<=1}static getUV(e,t,i,r,s,o,a,c){return this.getBarycoord(e,t,i,r,so),c.set(0,0),c.addScaledVector(s,so.x),c.addScaledVector(o,so.y),c.addScaledVector(a,so.z),c}static isFrontFacing(e,t,i,r){return ts.subVectors(i,t),ro.subVectors(e,t),ts.cross(ro).dot(r)<0}set(e,t,i){return this.a.copy(e),this.b.copy(t),this.c.copy(i),this}setFromPointsAndIndices(e,t,i,r){return this.a.copy(e[t]),this.b.copy(e[i]),this.c.copy(e[r]),this}setFromAttributeAndIndices(e,t,i,r){return this.a.fromBufferAttribute(e,t),this.b.fromBufferAttribute(e,i),this.c.fromBufferAttribute(e,r),this}clone(){return(new this.constructor).copy(this)}copy(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this}getArea(){return ts.subVectors(this.c,this.b),ro.subVectors(this.a,this.b),.5*ts.cross(ro).length()}getMidpoint(e){return e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(e){return ns.getNormal(this.a,this.b,this.c,e)}getPlane(e){return e.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(e,t){return ns.getBarycoord(e,this.a,this.b,this.c,t)}getUV(e,t,i,r,s){return ns.getUV(e,this.a,this.b,this.c,t,i,r,s)}containsPoint(e){return ns.containsPoint(e,this.a,this.b,this.c)}isFrontFacing(e){return ns.isFrontFacing(this.a,this.b,this.c,e)}intersectsBox(e){return e.intersectsTriangle(this)}closestPointToPoint(e,t){const i=this.a,r=this.b,s=this.c;let o,a;Yl.subVectors(r,i),Zl.subVectors(s,i),Tx.subVectors(e,i);const c=Yl.dot(Tx),l=Zl.dot(Tx);if(c<=0&&l<=0)return t.copy(i);Ax.subVectors(e,r);const u=Yl.dot(Ax),h=Zl.dot(Ax);if(u>=0&&h<=u)return t.copy(r);const d=c*h-u*l;if(d<=0&&c>=0&&u<=0)return o=c/(c-u),t.copy(i).addScaledVector(Yl,o);Ix.subVectors(e,s);const f=Yl.dot(Ix),p=Zl.dot(Ix);if(p>=0&&f<=p)return t.copy(s);const m=f*l-c*p;if(m<=0&&l>=0&&p<=0)return a=l/(l-p),t.copy(i).addScaledVector(Zl,a);const g=u*p-f*h;if(g<=0&&h-u>=0&&f-p>=0)return tO.subVectors(s,r),a=(h-u)/(h-u+(f-p)),t.copy(r).addScaledVector(tO,a);const _=1/(g+m+d);return o=m*_,a=d*_,t.copy(i).addScaledVector(Yl,o).addScaledVector(Zl,a)}equals(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}}let Rq=0;class Ja extends $a{constructor(){super(),this.isMaterial=!0,Object.defineProperty(this,"id",{value:Rq++}),this.uuid=sr(),this.name="",this.type="Material",this.blending=1,this.side=0,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.blendSrc=204,this.blendDst=205,this.blendEquation=100,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.depthFunc=3,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=519,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=7680,this.stencilZFail=7680,this.stencilZPass=7680,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(e){this._alphaTest>0!=e>0&&this.version++,this._alphaTest=e}onBuild(){}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(e){if(void 0!==e)for(const t in e){const i=e[t];if(void 0===i){console.warn("THREE.Material: '"+t+"' parameter is undefined.");continue}const r=this[t];void 0!==r?r&&r.isColor?r.set(i):r&&r.isVector3&&i&&i.isVector3?r.copy(i):this[t]=i:console.warn("THREE."+this.type+": '"+t+"' is not a property of this material.")}}toJSON(e){const t=void 0===e||"string"==typeof e;t&&(e={textures:{},images:{}});const i={metadata:{version:4.5,type:"Material",generator:"Material.toJSON"}};function r(s){const o=[];for(const a in s){const c=s[a];delete c.metadata,o.push(c)}return o}if(i.uuid=this.uuid,i.type=this.type,""!==this.name&&(i.name=this.name),this.color&&this.color.isColor&&(i.color=this.color.getHex()),void 0!==this.roughness&&(i.roughness=this.roughness),void 0!==this.metalness&&(i.metalness=this.metalness),void 0!==this.sheen&&(i.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(i.sheenColor=this.sheenColor.getHex()),void 0!==this.sheenRoughness&&(i.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(i.emissive=this.emissive.getHex()),this.emissiveIntensity&&1!==this.emissiveIntensity&&(i.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(i.specular=this.specular.getHex()),void 0!==this.specularIntensity&&(i.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(i.specularColor=this.specularColor.getHex()),void 0!==this.shininess&&(i.shininess=this.shininess),void 0!==this.clearcoat&&(i.clearcoat=this.clearcoat),void 0!==this.clearcoatRoughness&&(i.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(i.clearcoatMap=this.clearcoatMap.toJSON(e).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(i.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(e).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(i.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(e).uuid,i.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),void 0!==this.iridescence&&(i.iridescence=this.iridescence),void 0!==this.iridescenceIOR&&(i.iridescenceIOR=this.iridescenceIOR),void 0!==this.iridescenceThicknessRange&&(i.iridescenceThicknessRange=this.iridescenceThicknessRange),this.iridescenceMap&&this.iridescenceMap.isTexture&&(i.iridescenceMap=this.iridescenceMap.toJSON(e).uuid),this.iridescenceThicknessMap&&this.iridescenceThicknessMap.isTexture&&(i.iridescenceThicknessMap=this.iridescenceThicknessMap.toJSON(e).uuid),this.map&&this.map.isTexture&&(i.map=this.map.toJSON(e).uuid),this.matcap&&this.matcap.isTexture&&(i.matcap=this.matcap.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(i.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(i.lightMap=this.lightMap.toJSON(e).uuid,i.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(i.aoMap=this.aoMap.toJSON(e).uuid,i.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(i.bumpMap=this.bumpMap.toJSON(e).uuid,i.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(i.normalMap=this.normalMap.toJSON(e).uuid,i.normalMapType=this.normalMapType,i.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(i.displacementMap=this.displacementMap.toJSON(e).uuid,i.displacementScale=this.displacementScale,i.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(i.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(i.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(i.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(i.specularMap=this.specularMap.toJSON(e).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(i.specularIntensityMap=this.specularIntensityMap.toJSON(e).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(i.specularColorMap=this.specularColorMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(i.envMap=this.envMap.toJSON(e).uuid,void 0!==this.combine&&(i.combine=this.combine)),void 0!==this.envMapIntensity&&(i.envMapIntensity=this.envMapIntensity),void 0!==this.reflectivity&&(i.reflectivity=this.reflectivity),void 0!==this.refractionRatio&&(i.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(i.gradientMap=this.gradientMap.toJSON(e).uuid),void 0!==this.transmission&&(i.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(i.transmissionMap=this.transmissionMap.toJSON(e).uuid),void 0!==this.thickness&&(i.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(i.thicknessMap=this.thicknessMap.toJSON(e).uuid),void 0!==this.attenuationDistance&&this.attenuationDistance!==1/0&&(i.attenuationDistance=this.attenuationDistance),void 0!==this.attenuationColor&&(i.attenuationColor=this.attenuationColor.getHex()),void 0!==this.size&&(i.size=this.size),null!==this.shadowSide&&(i.shadowSide=this.shadowSide),void 0!==this.sizeAttenuation&&(i.sizeAttenuation=this.sizeAttenuation),1!==this.blending&&(i.blending=this.blending),0!==this.side&&(i.side=this.side),this.vertexColors&&(i.vertexColors=!0),this.opacity<1&&(i.opacity=this.opacity),!0===this.transparent&&(i.transparent=this.transparent),i.depthFunc=this.depthFunc,i.depthTest=this.depthTest,i.depthWrite=this.depthWrite,i.colorWrite=this.colorWrite,i.stencilWrite=this.stencilWrite,i.stencilWriteMask=this.stencilWriteMask,i.stencilFunc=this.stencilFunc,i.stencilRef=this.stencilRef,i.stencilFuncMask=this.stencilFuncMask,i.stencilFail=this.stencilFail,i.stencilZFail=this.stencilZFail,i.stencilZPass=this.stencilZPass,void 0!==this.rotation&&0!==this.rotation&&(i.rotation=this.rotation),!0===this.polygonOffset&&(i.polygonOffset=!0),0!==this.polygonOffsetFactor&&(i.polygonOffsetFactor=this.polygonOffsetFactor),0!==this.polygonOffsetUnits&&(i.polygonOffsetUnits=this.polygonOffsetUnits),void 0!==this.linewidth&&1!==this.linewidth&&(i.linewidth=this.linewidth),void 0!==this.dashSize&&(i.dashSize=this.dashSize),void 0!==this.gapSize&&(i.gapSize=this.gapSize),void 0!==this.scale&&(i.scale=this.scale),!0===this.dithering&&(i.dithering=!0),this.alphaTest>0&&(i.alphaTest=this.alphaTest),!0===this.alphaToCoverage&&(i.alphaToCoverage=this.alphaToCoverage),!0===this.premultipliedAlpha&&(i.premultipliedAlpha=this.premultipliedAlpha),!0===this.wireframe&&(i.wireframe=this.wireframe),this.wireframeLinewidth>1&&(i.wireframeLinewidth=this.wireframeLinewidth),"round"!==this.wireframeLinecap&&(i.wireframeLinecap=this.wireframeLinecap),"round"!==this.wireframeLinejoin&&(i.wireframeLinejoin=this.wireframeLinejoin),!0===this.flatShading&&(i.flatShading=this.flatShading),!1===this.visible&&(i.visible=!1),!1===this.toneMapped&&(i.toneMapped=!1),!1===this.fog&&(i.fog=!1),"{}"!==JSON.stringify(this.userData)&&(i.userData=this.userData),t){const s=r(e.textures),o=r(e.images);s.length>0&&(i.textures=s),o.length>0&&(i.images=o)}return i}clone(){return(new this.constructor).copy(this)}copy(e){this.name=e.name,this.blending=e.blending,this.side=e.side,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.stencilWriteMask=e.stencilWriteMask,this.stencilFunc=e.stencilFunc,this.stencilRef=e.stencilRef,this.stencilFuncMask=e.stencilFuncMask,this.stencilFail=e.stencilFail,this.stencilZFail=e.stencilZFail,this.stencilZPass=e.stencilZPass,this.stencilWrite=e.stencilWrite;const t=e.clippingPlanes;let i=null;if(null!==t){const r=t.length;i=new Array(r);for(let s=0;s!==r;++s)i[s]=t[s].clone()}return this.clippingPlanes=i,this.clipIntersection=e.clipIntersection,this.clipShadows=e.clipShadows,this.shadowSide=e.shadowSide,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.alphaToCoverage=e.alphaToCoverage,this.premultipliedAlpha=e.premultipliedAlpha,this.visible=e.visible,this.toneMapped=e.toneMapped,this.userData=JSON.parse(JSON.stringify(e.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(e){!0===e&&this.version++}}class Ho extends Ja{constructor(e){super(),this.isMeshBasicMaterial=!0,this.type="MeshBasicMaterial",this.color=new Ie(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=0,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}const Fn=new S,Om=new ee;class qn{constructor(e,t,i){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0,this.name="",this.array=e,this.itemSize=t,this.count=void 0!==e?e.length/t:0,this.normalized=!0===i,this.usage=35044,this.updateRange={offset:0,count:-1},this.version=0}onUploadCallback(){}set needsUpdate(e){!0===e&&this.version++}setUsage(e){return this.usage=e,this}copy(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.usage=e.usage,this}copyAt(e,t,i){e*=this.itemSize,i*=t.itemSize;for(let r=0,s=this.itemSize;r<s;r++)this.array[e+r]=t.array[i+r];return this}copyArray(e){return this.array.set(e),this}applyMatrix3(e){if(2===this.itemSize)for(let t=0,i=this.count;t<i;t++)Om.fromBufferAttribute(this,t),Om.applyMatrix3(e),this.setXY(t,Om.x,Om.y);else if(3===this.itemSize)for(let t=0,i=this.count;t<i;t++)Fn.fromBufferAttribute(this,t),Fn.applyMatrix3(e),this.setXYZ(t,Fn.x,Fn.y,Fn.z);return this}applyMatrix4(e){for(let t=0,i=this.count;t<i;t++)Fn.fromBufferAttribute(this,t),Fn.applyMatrix4(e),this.setXYZ(t,Fn.x,Fn.y,Fn.z);return this}applyNormalMatrix(e){for(let t=0,i=this.count;t<i;t++)Fn.fromBufferAttribute(this,t),Fn.applyNormalMatrix(e),this.setXYZ(t,Fn.x,Fn.y,Fn.z);return this}transformDirection(e){for(let t=0,i=this.count;t<i;t++)Fn.fromBufferAttribute(this,t),Fn.transformDirection(e),this.setXYZ(t,Fn.x,Fn.y,Fn.z);return this}set(e,t=0){return this.array.set(e,t),this}getX(e){let t=this.array[e*this.itemSize];return this.normalized&&(t=eo(t,this.array)),t}setX(e,t){return this.normalized&&(t=Jt(t,this.array)),this.array[e*this.itemSize]=t,this}getY(e){let t=this.array[e*this.itemSize+1];return this.normalized&&(t=eo(t,this.array)),t}setY(e,t){return this.normalized&&(t=Jt(t,this.array)),this.array[e*this.itemSize+1]=t,this}getZ(e){let t=this.array[e*this.itemSize+2];return this.normalized&&(t=eo(t,this.array)),t}setZ(e,t){return this.normalized&&(t=Jt(t,this.array)),this.array[e*this.itemSize+2]=t,this}getW(e){let t=this.array[e*this.itemSize+3];return this.normalized&&(t=eo(t,this.array)),t}setW(e,t){return this.normalized&&(t=Jt(t,this.array)),this.array[e*this.itemSize+3]=t,this}setXY(e,t,i){return e*=this.itemSize,this.normalized&&(t=Jt(t,this.array),i=Jt(i,this.array)),this.array[e+0]=t,this.array[e+1]=i,this}setXYZ(e,t,i,r){return e*=this.itemSize,this.normalized&&(t=Jt(t,this.array),i=Jt(i,this.array),r=Jt(r,this.array)),this.array[e+0]=t,this.array[e+1]=i,this.array[e+2]=r,this}setXYZW(e,t,i,r,s){return e*=this.itemSize,this.normalized&&(t=Jt(t,this.array),i=Jt(i,this.array),r=Jt(r,this.array),s=Jt(s,this.array)),this.array[e+0]=t,this.array[e+1]=i,this.array[e+2]=r,this.array[e+3]=s,this}onUpload(e){return this.onUploadCallback=e,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){const e={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.from(this.array),normalized:this.normalized};return""!==this.name&&(e.name=this.name),35044!==this.usage&&(e.usage=this.usage),(0!==this.updateRange.offset||-1!==this.updateRange.count)&&(e.updateRange=this.updateRange),e}copyColorsArray(){console.error("THREE.BufferAttribute: copyColorsArray() was removed in r144.")}copyVector2sArray(){console.error("THREE.BufferAttribute: copyVector2sArray() was removed in r144.")}copyVector3sArray(){console.error("THREE.BufferAttribute: copyVector3sArray() was removed in r144.")}copyVector4sArray(){console.error("THREE.BufferAttribute: copyVector4sArray() was removed in r144.")}}class nO extends qn{constructor(e,t,i){super(new Uint16Array(e),t,i)}}class iO extends qn{constructor(e,t,i){super(new Uint32Array(e),t,i)}}class Re extends qn{constructor(e,t,i){super(new Float32Array(e),t,i)}}let Oq=0;const Dr=new ct,Px=new ar,Kl=new S,cr=new Hl,hd=new Hl,Jn=new S;class gt extends $a{constructor(){super(),this.isBufferGeometry=!0,Object.defineProperty(this,"id",{value:Oq++}),this.uuid=sr(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(e){return this.index=Array.isArray(e)?new(GR(e)?iO:nO)(e,1):e,this}getAttribute(e){return this.attributes[e]}setAttribute(e,t){return this.attributes[e]=t,this}deleteAttribute(e){return delete this.attributes[e],this}hasAttribute(e){return void 0!==this.attributes[e]}addGroup(e,t,i=0){this.groups.push({start:e,count:t,materialIndex:i})}clearGroups(){this.groups=[]}setDrawRange(e,t){this.drawRange.start=e,this.drawRange.count=t}applyMatrix4(e){const t=this.attributes.position;void 0!==t&&(t.applyMatrix4(e),t.needsUpdate=!0);const i=this.attributes.normal;if(void 0!==i){const s=(new Wn).getNormalMatrix(e);i.applyNormalMatrix(s),i.needsUpdate=!0}const r=this.attributes.tangent;return void 0!==r&&(r.transformDirection(e),r.needsUpdate=!0),null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this}applyQuaternion(e){return Dr.makeRotationFromQuaternion(e),this.applyMatrix4(Dr),this}rotateX(e){return Dr.makeRotationX(e),this.applyMatrix4(Dr),this}rotateY(e){return Dr.makeRotationY(e),this.applyMatrix4(Dr),this}rotateZ(e){return Dr.makeRotationZ(e),this.applyMatrix4(Dr),this}translate(e,t,i){return Dr.makeTranslation(e,t,i),this.applyMatrix4(Dr),this}scale(e,t,i){return Dr.makeScale(e,t,i),this.applyMatrix4(Dr),this}lookAt(e){return Px.lookAt(e),Px.updateMatrix(),this.applyMatrix4(Px.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(Kl).negate(),this.translate(Kl.x,Kl.y,Kl.z),this}setFromPoints(e){const t=[];for(let i=0,r=e.length;i<r;i++){const s=e[i];t.push(s.x,s.y,s.z||0)}return this.setAttribute("position",new Re(t,3)),this}computeBoundingBox(){null===this.boundingBox&&(this.boundingBox=new Hl);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute)return console.error('THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box. Alternatively set "mesh.frustumCulled" to "false".',this),void this.boundingBox.set(new S(-1/0,-1/0,-1/0),new S(1/0,1/0,1/0));if(void 0!==e){if(this.boundingBox.setFromBufferAttribute(e),t)for(let i=0,r=t.length;i<r;i++)cr.setFromBufferAttribute(t[i]),this.morphTargetsRelative?(Jn.addVectors(this.boundingBox.min,cr.min),this.boundingBox.expandByPoint(Jn),Jn.addVectors(this.boundingBox.max,cr.max),this.boundingBox.expandByPoint(Jn)):(this.boundingBox.expandByPoint(cr.min),this.boundingBox.expandByPoint(cr.max))}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){null===this.boundingSphere&&(this.boundingSphere=new $l);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute)return console.error('THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere. Alternatively set "mesh.frustumCulled" to "false".',this),void this.boundingSphere.set(new S,1/0);if(e){const i=this.boundingSphere.center;if(cr.setFromBufferAttribute(e),t)for(let s=0,o=t.length;s<o;s++)hd.setFromBufferAttribute(t[s]),this.morphTargetsRelative?(Jn.addVectors(cr.min,hd.min),cr.expandByPoint(Jn),Jn.addVectors(cr.max,hd.max),cr.expandByPoint(Jn)):(cr.expandByPoint(hd.min),cr.expandByPoint(hd.max));cr.getCenter(i);let r=0;for(let s=0,o=e.count;s<o;s++)Jn.fromBufferAttribute(e,s),r=Math.max(r,i.distanceToSquared(Jn));if(t)for(let s=0,o=t.length;s<o;s++){const a=t[s],c=this.morphTargetsRelative;for(let l=0,u=a.count;l<u;l++)Jn.fromBufferAttribute(a,l),c&&(Kl.fromBufferAttribute(e,l),Jn.add(Kl)),r=Math.max(r,i.distanceToSquared(Jn))}this.boundingSphere.radius=Math.sqrt(r),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){const e=this.index,t=this.attributes;if(null===e||void 0===t.position||void 0===t.normal||void 0===t.uv)return void console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");const i=e.array,r=t.position.array,s=t.normal.array,o=t.uv.array,a=r.length/3;!1===this.hasAttribute("tangent")&&this.setAttribute("tangent",new qn(new Float32Array(4*a),4));const c=this.getAttribute("tangent").array,l=[],u=[];for(let R=0;R<a;R++)l[R]=new S,u[R]=new S;const h=new S,d=new S,f=new S,p=new ee,m=new ee,g=new ee,_=new S,b=new S;function y(R,$,se){h.fromArray(r,3*R),d.fromArray(r,3*$),f.fromArray(r,3*se),p.fromArray(o,2*R),m.fromArray(o,2*$),g.fromArray(o,2*se),d.sub(h),f.sub(h),m.sub(p),g.sub(p);const H=1/(m.x*g.y-g.x*m.y);!isFinite(H)||(_.copy(d).multiplyScalar(g.y).addScaledVector(f,-m.y).multiplyScalar(H),b.copy(f).multiplyScalar(m.x).addScaledVector(d,-g.x).multiplyScalar(H),l[R].add(_),l[$].add(_),l[se].add(_),u[R].add(b),u[$].add(b),u[se].add(b))}let v=this.groups;0===v.length&&(v=[{start:0,count:i.length}]);for(let R=0,$=v.length;R<$;++R){const se=v[R],H=se.start;for(let X=H,L=H+se.count;X<L;X+=3)y(i[X+0],i[X+1],i[X+2])}const w=new S,M=new S,I=new S,x=new S;function E(R){I.fromArray(s,3*R),x.copy(I);const $=l[R];w.copy($),w.sub(I.multiplyScalar(I.dot($))).normalize(),M.crossVectors(x,$);const H=M.dot(u[R])<0?-1:1;c[4*R]=w.x,c[4*R+1]=w.y,c[4*R+2]=w.z,c[4*R+3]=H}for(let R=0,$=v.length;R<$;++R){const se=v[R],H=se.start;for(let X=H,L=H+se.count;X<L;X+=3)E(i[X+0]),E(i[X+1]),E(i[X+2])}}computeVertexNormals(){const e=this.index,t=this.getAttribute("position");if(void 0!==t){let i=this.getAttribute("normal");if(void 0===i)i=new qn(new Float32Array(3*t.count),3),this.setAttribute("normal",i);else for(let d=0,f=i.count;d<f;d++)i.setXYZ(d,0,0,0);const r=new S,s=new S,o=new S,a=new S,c=new S,l=new S,u=new S,h=new S;if(e)for(let d=0,f=e.count;d<f;d+=3){const p=e.getX(d+0),m=e.getX(d+1),g=e.getX(d+2);r.fromBufferAttribute(t,p),s.fromBufferAttribute(t,m),o.fromBufferAttribute(t,g),u.subVectors(o,s),h.subVectors(r,s),u.cross(h),a.fromBufferAttribute(i,p),c.fromBufferAttribute(i,m),l.fromBufferAttribute(i,g),a.add(u),c.add(u),l.add(u),i.setXYZ(p,a.x,a.y,a.z),i.setXYZ(m,c.x,c.y,c.z),i.setXYZ(g,l.x,l.y,l.z)}else for(let d=0,f=t.count;d<f;d+=3)r.fromBufferAttribute(t,d+0),s.fromBufferAttribute(t,d+1),o.fromBufferAttribute(t,d+2),u.subVectors(o,s),h.subVectors(r,s),u.cross(h),i.setXYZ(d+0,u.x,u.y,u.z),i.setXYZ(d+1,u.x,u.y,u.z),i.setXYZ(d+2,u.x,u.y,u.z);this.normalizeNormals(),i.needsUpdate=!0}}merge(){return console.error("THREE.BufferGeometry.merge() has been removed. Use THREE.BufferGeometryUtils.mergeBufferGeometries() instead."),this}normalizeNormals(){const e=this.attributes.normal;for(let t=0,i=e.count;t<i;t++)Jn.fromBufferAttribute(e,t),Jn.normalize(),e.setXYZ(t,Jn.x,Jn.y,Jn.z)}toNonIndexed(){function e(a,c){const l=a.array,u=a.itemSize,h=a.normalized,d=new l.constructor(c.length*u);let f=0,p=0;for(let m=0,g=c.length;m<g;m++){f=a.isInterleavedBufferAttribute?c[m]*a.data.stride+a.offset:c[m]*u;for(let _=0;_<u;_++)d[p++]=l[f++]}return new qn(d,u,h)}if(null===this.index)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;const t=new gt,i=this.index.array,r=this.attributes;for(const a in r){const l=e(r[a],i);t.setAttribute(a,l)}const s=this.morphAttributes;for(const a in s){const c=[],l=s[a];for(let u=0,h=l.length;u<h;u++){const f=e(l[u],i);c.push(f)}t.morphAttributes[a]=c}t.morphTargetsRelative=this.morphTargetsRelative;const o=this.groups;for(let a=0,c=o.length;a<c;a++){const l=o[a];t.addGroup(l.start,l.count,l.materialIndex)}return t}toJSON(){const e={metadata:{version:4.5,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,""!==this.name&&(e.name=this.name),Object.keys(this.userData).length>0&&(e.userData=this.userData),void 0!==this.parameters){const c=this.parameters;for(const l in c)void 0!==c[l]&&(e[l]=c[l]);return e}e.data={attributes:{}};const t=this.index;null!==t&&(e.data.index={type:t.array.constructor.name,array:Array.prototype.slice.call(t.array)});const i=this.attributes;for(const c in i)e.data.attributes[c]=i[c].toJSON(e.data);const r={};let s=!1;for(const c in this.morphAttributes){const l=this.morphAttributes[c],u=[];for(let h=0,d=l.length;h<d;h++)u.push(l[h].toJSON(e.data));u.length>0&&(r[c]=u,s=!0)}s&&(e.data.morphAttributes=r,e.data.morphTargetsRelative=this.morphTargetsRelative);const o=this.groups;o.length>0&&(e.data.groups=JSON.parse(JSON.stringify(o)));const a=this.boundingSphere;return null!==a&&(e.data.boundingSphere={center:a.center.toArray(),radius:a.radius}),e}clone(){return(new this.constructor).copy(this)}copy(e){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const t={};this.name=e.name;const i=e.index;null!==i&&this.setIndex(i.clone(t));const r=e.attributes;for(const l in r)this.setAttribute(l,r[l].clone(t));const s=e.morphAttributes;for(const l in s){const u=[],h=s[l];for(let d=0,f=h.length;d<f;d++)u.push(h[d].clone(t));this.morphAttributes[l]=u}this.morphTargetsRelative=e.morphTargetsRelative;const o=e.groups;for(let l=0,u=o.length;l<u;l++){const h=o[l];this.addGroup(h.start,h.count,h.materialIndex)}const a=e.boundingBox;null!==a&&(this.boundingBox=a.clone());const c=e.boundingSphere;return null!==c&&(this.boundingSphere=c.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this.userData=e.userData,void 0!==e.parameters&&(this.parameters=Object.assign({},e.parameters)),this}dispose(){this.dispatchEvent({type:"dispose"})}}const rO=new ct,Jl=new Im,Rx=new $l,Go=new S,jo=new S,Wo=new S,Ox=new S,kx=new S,Lx=new S,km=new S,Lm=new S,Nm=new S,Fm=new ee,Vm=new ee,Bm=new ee,Nx=new S,Um=new S;class Qn extends ar{constructor(e=new gt,t=new Ho){super(),this.isMesh=!0,this.type="Mesh",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),void 0!==e.morphTargetInfluences&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),void 0!==e.morphTargetDictionary&&(this.morphTargetDictionary=Object.assign({},e.morphTargetDictionary)),this.material=e.material,this.geometry=e.geometry,this}updateMorphTargets(){const t=this.geometry.morphAttributes,i=Object.keys(t);if(i.length>0){const r=t[i[0]];if(void 0!==r){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let s=0,o=r.length;s<o;s++){const a=r[s].name||String(s);this.morphTargetInfluences.push(0),this.morphTargetDictionary[a]=s}}}}raycast(e,t){const i=this.geometry,r=this.material,s=this.matrixWorld;if(void 0===r||(null===i.boundingSphere&&i.computeBoundingSphere(),Rx.copy(i.boundingSphere),Rx.applyMatrix4(s),!1===e.ray.intersectsSphere(Rx))||(rO.copy(s).invert(),Jl.copy(e.ray).applyMatrix4(rO),null!==i.boundingBox&&!1===Jl.intersectsBox(i.boundingBox)))return;let o;const a=i.index,c=i.attributes.position,l=i.morphAttributes.position,u=i.morphTargetsRelative,h=i.attributes.uv,d=i.attributes.uv2,f=i.groups,p=i.drawRange;if(null!==a)if(Array.isArray(r))for(let m=0,g=f.length;m<g;m++){const _=f[m],b=r[_.materialIndex];for(let w=Math.max(_.start,p.start),M=Math.min(a.count,Math.min(_.start+_.count,p.start+p.count));w<M;w+=3){const I=a.getX(w),x=a.getX(w+1),E=a.getX(w+2);o=zm(this,b,e,Jl,c,l,u,h,d,I,x,E),o&&(o.faceIndex=Math.floor(w/3),o.face.materialIndex=_.materialIndex,t.push(o))}}else for(let _=Math.max(0,p.start),b=Math.min(a.count,p.start+p.count);_<b;_+=3){const y=a.getX(_),v=a.getX(_+1),w=a.getX(_+2);o=zm(this,r,e,Jl,c,l,u,h,d,y,v,w),o&&(o.faceIndex=Math.floor(_/3),t.push(o))}else if(void 0!==c)if(Array.isArray(r))for(let m=0,g=f.length;m<g;m++){const _=f[m],b=r[_.materialIndex];for(let w=Math.max(_.start,p.start),M=Math.min(c.count,Math.min(_.start+_.count,p.start+p.count));w<M;w+=3)o=zm(this,b,e,Jl,c,l,u,h,d,w,w+1,w+2),o&&(o.faceIndex=Math.floor(w/3),o.face.materialIndex=_.materialIndex,t.push(o))}else for(let _=Math.max(0,p.start),b=Math.min(c.count,p.start+p.count);_<b;_+=3)o=zm(this,r,e,Jl,c,l,u,h,d,_,_+1,_+2),o&&(o.faceIndex=Math.floor(_/3),t.push(o))}}function zm(n,e,t,i,r,s,o,a,c,l,u,h){Go.fromBufferAttribute(r,l),jo.fromBufferAttribute(r,u),Wo.fromBufferAttribute(r,h);const d=n.morphTargetInfluences;if(s&&d){km.set(0,0,0),Lm.set(0,0,0),Nm.set(0,0,0);for(let p=0,m=s.length;p<m;p++){const g=d[p],_=s[p];0!==g&&(Ox.fromBufferAttribute(_,l),kx.fromBufferAttribute(_,u),Lx.fromBufferAttribute(_,h),o?(km.addScaledVector(Ox,g),Lm.addScaledVector(kx,g),Nm.addScaledVector(Lx,g)):(km.addScaledVector(Ox.sub(Go),g),Lm.addScaledVector(kx.sub(jo),g),Nm.addScaledVector(Lx.sub(Wo),g)))}Go.add(km),jo.add(Lm),Wo.add(Nm)}n.isSkinnedMesh&&(n.boneTransform(l,Go),n.boneTransform(u,jo),n.boneTransform(h,Wo));const f=function kq(n,e,t,i,r,s,o,a){let c;if(c=1===e.side?i.intersectTriangle(o,s,r,!0,a):i.intersectTriangle(r,s,o,2!==e.side,a),null===c)return null;Um.copy(a),Um.applyMatrix4(n.matrixWorld);const l=t.ray.origin.distanceTo(Um);return l<t.near||l>t.far?null:{distance:l,point:Um.clone(),object:n}}(n,e,t,i,Go,jo,Wo,Nx);if(f){a&&(Fm.fromBufferAttribute(a,l),Vm.fromBufferAttribute(a,u),Bm.fromBufferAttribute(a,h),f.uv=ns.getUV(Nx,Go,jo,Wo,Fm,Vm,Bm,new ee)),c&&(Fm.fromBufferAttribute(c,l),Vm.fromBufferAttribute(c,u),Bm.fromBufferAttribute(c,h),f.uv2=ns.getUV(Nx,Go,jo,Wo,Fm,Vm,Bm,new ee));const p={a:l,b:u,c:h,normal:new S,materialIndex:0};ns.getNormal(Go,jo,Wo,p.normal),f.face=p}return f}class Ql extends gt{constructor(e=1,t=1,i=1,r=1,s=1,o=1){super(),this.type="BoxGeometry",this.parameters={width:e,height:t,depth:i,widthSegments:r,heightSegments:s,depthSegments:o};const a=this;r=Math.floor(r),s=Math.floor(s),o=Math.floor(o);const c=[],l=[],u=[],h=[];let d=0,f=0;function p(m,g,_,b,y,v,w,M,I,x,E){const R=v/I,$=w/x,se=v/2,H=w/2,N=M/2,X=I+1,L=x+1;let G=0,F=0;const O=new S;for(let V=0;V<L;V++){const ce=V*$-H;for(let re=0;re<X;re++)O[m]=(re*R-se)*b,O[g]=ce*y,O[_]=N,l.push(O.x,O.y,O.z),O[m]=0,O[g]=0,O[_]=M>0?1:-1,u.push(O.x,O.y,O.z),h.push(re/I),h.push(1-V/x),G+=1}for(let V=0;V<x;V++)for(let ce=0;ce<I;ce++){const fe=d+ce+X*(V+1),pe=d+(ce+1)+X*(V+1),We=d+(ce+1)+X*V;c.push(d+ce+X*V,fe,We),c.push(fe,pe,We),F+=6}a.addGroup(f,F,E),f+=F,d+=G}p("z","y","x",-1,-1,i,t,e,o,s,0),p("z","y","x",1,-1,i,t,-e,o,s,1),p("x","z","y",1,1,e,i,t,r,o,2),p("x","z","y",1,-1,e,i,-t,r,o,3),p("x","y","z",1,-1,e,t,i,r,s,4),p("x","y","z",-1,-1,e,t,-i,r,s,5),this.setIndex(c),this.setAttribute("position",new Re(l,3)),this.setAttribute("normal",new Re(u,3)),this.setAttribute("uv",new Re(h,2))}static fromJSON(e){return new Ql(e.width,e.height,e.depth,e.widthSegments,e.heightSegments,e.depthSegments)}}function eu(n){const e={};for(const t in n){e[t]={};for(const i in n[t]){const r=n[t][i];e[t][i]=r&&(r.isColor||r.isMatrix3||r.isMatrix4||r.isVector2||r.isVector3||r.isVector4||r.isTexture||r.isQuaternion)?r.clone():Array.isArray(r)?r.slice():r}}return e}function Pi(n){const e={};for(let t=0;t<n.length;t++){const i=eu(n[t]);for(const r in i)e[r]=i[r]}return e}const sO={clone:eu,merge:Pi};class xs extends Ja{constructor(e){super(),this.isShaderMaterial=!0,this.type="ShaderMaterial",this.defines={},this.uniforms={},this.uniformsGroups=[],this.vertexShader="void main() {\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",this.fragmentShader="void main() {\n\tgl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );\n}",this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv2:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,void 0!==e&&this.setValues(e)}copy(e){return super.copy(e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=eu(e.uniforms),this.uniformsGroups=function Lq(n){const e=[];for(let t=0;t<n.length;t++)e.push(n[t].clone());return e}(e.uniformsGroups),this.defines=Object.assign({},e.defines),this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.fog=e.fog,this.lights=e.lights,this.clipping=e.clipping,this.extensions=Object.assign({},e.extensions),this.glslVersion=e.glslVersion,this}toJSON(e){const t=super.toJSON(e);t.glslVersion=this.glslVersion,t.uniforms={};for(const r in this.uniforms){const o=this.uniforms[r].value;t.uniforms[r]=o&&o.isTexture?{type:"t",value:o.toJSON(e).uuid}:o&&o.isColor?{type:"c",value:o.getHex()}:o&&o.isVector2?{type:"v2",value:o.toArray()}:o&&o.isVector3?{type:"v3",value:o.toArray()}:o&&o.isVector4?{type:"v4",value:o.toArray()}:o&&o.isMatrix3?{type:"m3",value:o.toArray()}:o&&o.isMatrix4?{type:"m4",value:o.toArray()}:{value:o}}Object.keys(this.defines).length>0&&(t.defines=this.defines),t.vertexShader=this.vertexShader,t.fragmentShader=this.fragmentShader;const i={};for(const r in this.extensions)!0===this.extensions[r]&&(i[r]=!0);return Object.keys(i).length>0&&(t.extensions=i),t}}class Fx extends ar{constructor(){super(),this.isCamera=!0,this.type="Camera",this.matrixWorldInverse=new ct,this.projectionMatrix=new ct,this.projectionMatrixInverse=new ct}copy(e,t){return super.copy(e,t),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this.projectionMatrixInverse.copy(e.projectionMatrixInverse),this}getWorldDirection(e){this.updateWorldMatrix(!0,!1);const t=this.matrixWorld.elements;return e.set(-t[8],-t[9],-t[10]).normalize()}updateMatrixWorld(e){super.updateMatrixWorld(e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(e,t){super.updateWorldMatrix(e,t),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return(new this.constructor).copy(this)}}class ei extends Fx{constructor(e=50,t=1,i=.1,r=2e3){super(),this.isPerspectiveCamera=!0,this.type="PerspectiveCamera",this.fov=e,this.zoom=1,this.near=i,this.far=r,this.focus=10,this.aspect=t,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=null===e.view?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this}setFocalLength(e){const t=.5*this.getFilmHeight()/e;this.fov=2*sd*Math.atan(t),this.updateProjectionMatrix()}getFocalLength(){const e=Math.tan(.5*qa*this.fov);return.5*this.getFilmHeight()/e}getEffectiveFOV(){return 2*sd*Math.atan(Math.tan(.5*qa*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}setViewOffset(e,t,i,r,s,o){this.aspect=e/t,null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=i,this.view.offsetY=r,this.view.width=s,this.view.height=o,this.updateProjectionMatrix()}clearViewOffset(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=this.near;let t=e*Math.tan(.5*qa*this.fov)/this.zoom,i=2*t,r=this.aspect*i,s=-.5*r;const o=this.view;if(null!==this.view&&this.view.enabled){const c=o.fullWidth,l=o.fullHeight;s+=o.offsetX*r/c,t-=o.offsetY*i/l,r*=o.width/c,i*=o.height/l}const a=this.filmOffset;0!==a&&(s+=e*a/this.getFilmWidth()),this.projectionMatrix.makePerspective(s,s+r,t,t-i,e,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.fov=this.fov,t.object.zoom=this.zoom,t.object.near=this.near,t.object.far=this.far,t.object.focus=this.focus,t.object.aspect=this.aspect,null!==this.view&&(t.object.view=Object.assign({},this.view)),t.object.filmGauge=this.filmGauge,t.object.filmOffset=this.filmOffset,t}}class Vq extends ar{constructor(e,t,i){super(),this.type="CubeCamera",this.renderTarget=i;const r=new ei(90,1,e,t);r.layers=this.layers,r.up.set(0,-1,0),r.lookAt(new S(1,0,0)),this.add(r);const s=new ei(90,1,e,t);s.layers=this.layers,s.up.set(0,-1,0),s.lookAt(new S(-1,0,0)),this.add(s);const o=new ei(90,1,e,t);o.layers=this.layers,o.up.set(0,0,1),o.lookAt(new S(0,1,0)),this.add(o);const a=new ei(90,1,e,t);a.layers=this.layers,a.up.set(0,0,-1),a.lookAt(new S(0,-1,0)),this.add(a);const c=new ei(90,1,e,t);c.layers=this.layers,c.up.set(0,-1,0),c.lookAt(new S(0,0,1)),this.add(c);const l=new ei(90,1,e,t);l.layers=this.layers,l.up.set(0,-1,0),l.lookAt(new S(0,0,-1)),this.add(l)}update(e,t){null===this.parent&&this.updateMatrixWorld();const i=this.renderTarget,[r,s,o,a,c,l]=this.children,u=e.getRenderTarget(),h=e.toneMapping,d=e.xr.enabled;e.toneMapping=0,e.xr.enabled=!1;const f=i.texture.generateMipmaps;i.texture.generateMipmaps=!1,e.setRenderTarget(i,0),e.render(t,r),e.setRenderTarget(i,1),e.render(t,s),e.setRenderTarget(i,2),e.render(t,o),e.setRenderTarget(i,3),e.render(t,a),e.setRenderTarget(i,4),e.render(t,c),i.texture.generateMipmaps=f,e.setRenderTarget(i,5),e.render(t,l),e.setRenderTarget(u),e.toneMapping=h,e.xr.enabled=d,i.texture.needsPMREMUpdate=!0}}class Hm extends No{constructor(e,t,i,r,s,o,a,c,l,u){super(e=void 0!==e?e:[],t=void 0!==t?t:301,i,r,s,o,a,c,l,u),this.isCubeTexture=!0,this.flipY=!1}get images(){return this.image}set images(e){this.image=e}}class Bq extends Fo{constructor(e=1,t={}){super(e,e,t),this.isWebGLCubeRenderTarget=!0;const i={width:e,height:e,depth:1};this.texture=new Hm([i,i,i,i,i,i],t.mapping,t.wrapS,t.wrapT,t.magFilter,t.minFilter,t.format,t.type,t.anisotropy,t.encoding),this.texture.isRenderTargetTexture=!0,this.texture.generateMipmaps=void 0!==t.generateMipmaps&&t.generateMipmaps,this.texture.minFilter=void 0!==t.minFilter?t.minFilter:Nn}fromEquirectangularTexture(e,t){this.texture.type=t.type,this.texture.encoding=t.encoding,this.texture.generateMipmaps=t.generateMipmaps,this.texture.minFilter=t.minFilter,this.texture.magFilter=t.magFilter;const i_uniforms={tEquirect:{value:null}},i_vertexShader="\n\n\t\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\t\tvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\n\t\t\t\t\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n\n\t\t\t\t}\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tvWorldDirection = transformDirection( position, modelMatrix );\n\n\t\t\t\t\t#include <begin_vertex>\n\t\t\t\t\t#include <project_vertex>\n\n\t\t\t\t}\n\t\t\t",i_fragmentShader="\n\n\t\t\t\tuniform sampler2D tEquirect;\n\n\t\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\t\t#include <common>\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tvec3 direction = normalize( vWorldDirection );\n\n\t\t\t\t\tvec2 sampleUV = equirectUv( direction );\n\n\t\t\t\t\tgl_FragColor = texture2D( tEquirect, sampleUV );\n\n\t\t\t\t}\n\t\t\t",r=new Ql(5,5,5),s=new xs({name:"CubemapFromEquirect",uniforms:eu(i_uniforms),vertexShader:i_vertexShader,fragmentShader:i_fragmentShader,side:1,blending:0});s.uniforms.tEquirect.value=t;const o=new Qn(r,s),a=t.minFilter;return 1008===t.minFilter&&(t.minFilter=Nn),new Vq(1,10,this).update(e,o),t.minFilter=a,o.geometry.dispose(),o.material.dispose(),this}clear(e,t,i,r){const s=e.getRenderTarget();for(let o=0;o<6;o++)e.setRenderTarget(this,o),e.clear(t,i,r);e.setRenderTarget(s)}}const Vx=new S,Uq=new S,zq=new Wn;class oo{constructor(e=new S(1,0,0),t=0){this.isPlane=!0,this.normal=e,this.constant=t}set(e,t){return this.normal.copy(e),this.constant=t,this}setComponents(e,t,i,r){return this.normal.set(e,t,i),this.constant=r,this}setFromNormalAndCoplanarPoint(e,t){return this.normal.copy(e),this.constant=-t.dot(this.normal),this}setFromCoplanarPoints(e,t,i){const r=Vx.subVectors(i,t).cross(Uq.subVectors(e,t)).normalize();return this.setFromNormalAndCoplanarPoint(r,e),this}copy(e){return this.normal.copy(e.normal),this.constant=e.constant,this}normalize(){const e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(e){return this.normal.dot(e)+this.constant}distanceToSphere(e){return this.distanceToPoint(e.center)-e.radius}projectPoint(e,t){return t.copy(this.normal).multiplyScalar(-this.distanceToPoint(e)).add(e)}intersectLine(e,t){const i=e.delta(Vx),r=this.normal.dot(i);if(0===r)return 0===this.distanceToPoint(e.start)?t.copy(e.start):null;const s=-(e.start.dot(this.normal)+this.constant)/r;return s<0||s>1?null:t.copy(i).multiplyScalar(s).add(e.start)}intersectsLine(e){const t=this.distanceToPoint(e.start),i=this.distanceToPoint(e.end);return t<0&&i>0||i<0&&t>0}intersectsBox(e){return e.intersectsPlane(this)}intersectsSphere(e){return e.intersectsPlane(this)}coplanarPoint(e){return e.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(e,t){const i=t||zq.getNormalMatrix(e),r=this.coplanarPoint(Vx).applyMatrix4(e),s=this.normal.applyMatrix3(i).normalize();return this.constant=-r.dot(s),this}translate(e){return this.constant-=e.dot(this.normal),this}equals(e){return e.normal.equals(this.normal)&&e.constant===this.constant}clone(){return(new this.constructor).copy(this)}}const iu=new $l,Gm=new S;class Bx{constructor(e=new oo,t=new oo,i=new oo,r=new oo,s=new oo,o=new oo){this.planes=[e,t,i,r,s,o]}set(e,t,i,r,s,o){const a=this.planes;return a[0].copy(e),a[1].copy(t),a[2].copy(i),a[3].copy(r),a[4].copy(s),a[5].copy(o),this}copy(e){const t=this.planes;for(let i=0;i<6;i++)t[i].copy(e.planes[i]);return this}setFromProjectionMatrix(e){const t=this.planes,i=e.elements,r=i[0],s=i[1],o=i[2],a=i[3],c=i[4],l=i[5],u=i[6],h=i[7],d=i[8],f=i[9],p=i[10],m=i[11],g=i[12],_=i[13],b=i[14],y=i[15];return t[0].setComponents(a-r,h-c,m-d,y-g).normalize(),t[1].setComponents(a+r,h+c,m+d,y+g).normalize(),t[2].setComponents(a+s,h+l,m+f,y+_).normalize(),t[3].setComponents(a-s,h-l,m-f,y-_).normalize(),t[4].setComponents(a-o,h-u,m-p,y-b).normalize(),t[5].setComponents(a+o,h+u,m+p,y+b).normalize(),this}intersectsObject(e){const t=e.geometry;return null===t.boundingSphere&&t.computeBoundingSphere(),iu.copy(t.boundingSphere).applyMatrix4(e.matrixWorld),this.intersectsSphere(iu)}intersectsSprite(e){return iu.center.set(0,0,0),iu.radius=.7071067811865476,iu.applyMatrix4(e.matrixWorld),this.intersectsSphere(iu)}intersectsSphere(e){const t=this.planes,i=e.center,r=-e.radius;for(let s=0;s<6;s++)if(t[s].distanceToPoint(i)<r)return!1;return!0}intersectsBox(e){const t=this.planes;for(let i=0;i<6;i++){const r=t[i];if(Gm.x=r.normal.x>0?e.max.x:e.min.x,Gm.y=r.normal.y>0?e.max.y:e.min.y,Gm.z=r.normal.z>0?e.max.z:e.min.z,r.distanceToPoint(Gm)<0)return!1}return!0}containsPoint(e){const t=this.planes;for(let i=0;i<6;i++)if(t[i].distanceToPoint(e)<0)return!1;return!0}clone(){return(new this.constructor).copy(this)}}function oO(){let n=null,e=!1,t=null,i=null;function r(s,o){t(s,o),i=n.requestAnimationFrame(r)}return{start:function(){!0!==e&&null!==t&&(i=n.requestAnimationFrame(r),e=!0)},stop:function(){n.cancelAnimationFrame(i),e=!1},setAnimationLoop:function(s){t=s},setContext:function(s){n=s}}}function Hq(n,e){const t=e.isWebGL2,i=new WeakMap;return{get:function o(l){return l.isInterleavedBufferAttribute&&(l=l.data),i.get(l)},remove:function a(l){l.isInterleavedBufferAttribute&&(l=l.data);const u=i.get(l);u&&(n.deleteBuffer(u.buffer),i.delete(l))},update:function c(l,u){if(l.isGLBufferAttribute){const d=i.get(l);return void((!d||d.version<l.version)&&i.set(l,{buffer:l.buffer,type:l.type,bytesPerElement:l.elementSize,version:l.version}))}l.isInterleavedBufferAttribute&&(l=l.data);const h=i.get(l);void 0===h?i.set(l,function r(l,u){const h=l.array,d=l.usage,f=n.createBuffer();let p;if(n.bindBuffer(u,f),n.bufferData(u,h,d),l.onUploadCallback(),h instanceof Float32Array)p=5126;else if(h instanceof Uint16Array)if(l.isFloat16BufferAttribute){if(!t)throw new Error("THREE.WebGLAttributes: Usage of Float16BufferAttribute requires WebGL2.");p=5131}else p=5123;else if(h instanceof Int16Array)p=5122;else if(h instanceof Uint32Array)p=5125;else if(h instanceof Int32Array)p=5124;else if(h instanceof Int8Array)p=5120;else if(h instanceof Uint8Array)p=5121;else{if(!(h instanceof Uint8ClampedArray))throw new Error("THREE.WebGLAttributes: Unsupported buffer data format: "+h);p=5121}return{buffer:f,type:p,bytesPerElement:h.BYTES_PER_ELEMENT,version:l.version}}(l,u)):h.version<l.version&&(function s(l,u,h){const d=u.array,f=u.updateRange;n.bindBuffer(h,l),-1===f.count?n.bufferSubData(h,0,d):(t?n.bufferSubData(h,f.offset*d.BYTES_PER_ELEMENT,d,f.offset,f.count):n.bufferSubData(h,f.offset*d.BYTES_PER_ELEMENT,d.subarray(f.offset,f.offset+f.count)),f.count=-1)}(h.buffer,l,u),h.version=l.version)}}}class dd extends gt{constructor(e=1,t=1,i=1,r=1){super(),this.type="PlaneGeometry",this.parameters={width:e,height:t,widthSegments:i,heightSegments:r};const s=e/2,o=t/2,a=Math.floor(i),c=Math.floor(r),l=a+1,u=c+1,h=e/a,d=t/c,f=[],p=[],m=[],g=[];for(let _=0;_<u;_++){const b=_*d-o;for(let y=0;y<l;y++)p.push(y*h-s,-b,0),m.push(0,0,1),g.push(y/a),g.push(1-_/c)}for(let _=0;_<c;_++)for(let b=0;b<a;b++){const v=b+l*(_+1),w=b+1+l*(_+1),M=b+1+l*_;f.push(b+l*_,v,M),f.push(v,w,M)}this.setIndex(f),this.setAttribute("position",new Re(p,3)),this.setAttribute("normal",new Re(m,3)),this.setAttribute("uv",new Re(g,2))}static fromJSON(e){return new dd(e.width,e.height,e.widthSegments,e.heightSegments)}}const vt={alphamap_fragment:"#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, vUv ).g;\n#endif",alphamap_pars_fragment:"#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",alphatest_fragment:"#ifdef USE_ALPHATEST\n\tif ( diffuseColor.a < alphaTest ) discard;\n#endif",alphatest_pars_fragment:"#ifdef USE_ALPHATEST\n\tuniform float alphaTest;\n#endif",aomap_fragment:"#ifdef USE_AOMAP\n\tfloat ambientOcclusion = ( texture2D( aoMap, vUv2 ).r - 1.0 ) * aoMapIntensity + 1.0;\n\treflectedLight.indirectDiffuse *= ambientOcclusion;\n\t#if defined( USE_ENVMAP ) && defined( STANDARD )\n\t\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\t\treflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );\n\t#endif\n#endif",aomap_pars_fragment:"#ifdef USE_AOMAP\n\tuniform sampler2D aoMap;\n\tuniform float aoMapIntensity;\n#endif",begin_vertex:"vec3 transformed = vec3( position );",beginnormal_vertex:"vec3 objectNormal = vec3( normal );\n#ifdef USE_TANGENT\n\tvec3 objectTangent = vec3( tangent.xyz );\n#endif",bsdfs:"vec3 BRDF_Lambert( const in vec3 diffuseColor ) {\n\treturn RECIPROCAL_PI * diffuseColor;\n}\nvec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {\n\tfloat fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );\n\treturn f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );\n}\nfloat F_Schlick( const in float f0, const in float f90, const in float dotVH ) {\n\tfloat fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );\n\treturn f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );\n}\nvec3 Schlick_to_F0( const in vec3 f, const in float f90, const in float dotVH ) {\n    float x = clamp( 1.0 - dotVH, 0.0, 1.0 );\n    float x2 = x * x;\n    float x5 = clamp( x * x2 * x2, 0.0, 0.9999 );\n    return ( f - vec3( f90 ) * x5 ) / ( 1.0 - x5 );\n}\nfloat V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\tfloat gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\treturn 0.5 / max( gv + gl, EPSILON );\n}\nfloat D_GGX( const in float alpha, const in float dotNH ) {\n\tfloat a2 = pow2( alpha );\n\tfloat denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;\n\treturn RECIPROCAL_PI * a2 / pow2( denom );\n}\nvec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 f0, const in float f90, const in float roughness ) {\n\tfloat alpha = pow2( roughness );\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\tvec3 F = F_Schlick( f0, f90, dotVH );\n\tfloat V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\tfloat D = D_GGX( alpha, dotNH );\n\treturn F * ( V * D );\n}\n#ifdef USE_IRIDESCENCE\n\tvec3 BRDF_GGX_Iridescence( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 f0, const in float f90, const in float iridescence, const in vec3 iridescenceFresnel, const in float roughness ) {\n\t\tfloat alpha = pow2( roughness );\n\t\tvec3 halfDir = normalize( lightDir + viewDir );\n\t\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\t\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\t\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\t\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\t\tvec3 F = mix( F_Schlick( f0, f90, dotVH ), iridescenceFresnel, iridescence );\n\t\tfloat V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\t\tfloat D = D_GGX( alpha, dotNH );\n\t\treturn F * ( V * D );\n\t}\n#endif\nvec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {\n\tconst float LUT_SIZE = 64.0;\n\tconst float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;\n\tconst float LUT_BIAS = 0.5 / LUT_SIZE;\n\tfloat dotNV = saturate( dot( N, V ) );\n\tvec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );\n\tuv = uv * LUT_SCALE + LUT_BIAS;\n\treturn uv;\n}\nfloat LTC_ClippedSphereFormFactor( const in vec3 f ) {\n\tfloat l = length( f );\n\treturn max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );\n}\nvec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {\n\tfloat x = dot( v1, v2 );\n\tfloat y = abs( x );\n\tfloat a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;\n\tfloat b = 3.4175940 + ( 4.1616724 + y ) * y;\n\tfloat v = a / b;\n\tfloat theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;\n\treturn cross( v1, v2 ) * theta_sintheta;\n}\nvec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {\n\tvec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];\n\tvec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];\n\tvec3 lightNormal = cross( v1, v2 );\n\tif( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );\n\tvec3 T1, T2;\n\tT1 = normalize( V - N * dot( V, N ) );\n\tT2 = - cross( N, T1 );\n\tmat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );\n\tvec3 coords[ 4 ];\n\tcoords[ 0 ] = mat * ( rectCoords[ 0 ] - P );\n\tcoords[ 1 ] = mat * ( rectCoords[ 1 ] - P );\n\tcoords[ 2 ] = mat * ( rectCoords[ 2 ] - P );\n\tcoords[ 3 ] = mat * ( rectCoords[ 3 ] - P );\n\tcoords[ 0 ] = normalize( coords[ 0 ] );\n\tcoords[ 1 ] = normalize( coords[ 1 ] );\n\tcoords[ 2 ] = normalize( coords[ 2 ] );\n\tcoords[ 3 ] = normalize( coords[ 3 ] );\n\tvec3 vectorFormFactor = vec3( 0.0 );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );\n\tfloat result = LTC_ClippedSphereFormFactor( vectorFormFactor );\n\treturn vec3( result );\n}\nfloat G_BlinnPhong_Implicit( ) {\n\treturn 0.25;\n}\nfloat D_BlinnPhong( const in float shininess, const in float dotNH ) {\n\treturn RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );\n}\nvec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, 1.0, dotVH );\n\tfloat G = G_BlinnPhong_Implicit( );\n\tfloat D = D_BlinnPhong( shininess, dotNH );\n\treturn F * ( G * D );\n}\n#if defined( USE_SHEEN )\nfloat D_Charlie( float roughness, float dotNH ) {\n\tfloat alpha = pow2( roughness );\n\tfloat invAlpha = 1.0 / alpha;\n\tfloat cos2h = dotNH * dotNH;\n\tfloat sin2h = max( 1.0 - cos2h, 0.0078125 );\n\treturn ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );\n}\nfloat V_Neubelt( float dotNV, float dotNL ) {\n\treturn saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );\n}\nvec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat D = D_Charlie( sheenRoughness, dotNH );\n\tfloat V = V_Neubelt( dotNV, dotNL );\n\treturn sheenColor * ( D * V );\n}\n#endif",iridescence_fragment:"#ifdef USE_IRIDESCENCE\n\tconst mat3 XYZ_TO_REC709 = mat3(\n\t\t 3.2404542, -0.9692660,  0.0556434,\n\t\t-1.5371385,  1.8760108, -0.2040259,\n\t\t-0.4985314,  0.0415560,  1.0572252\n\t);\n\tvec3 Fresnel0ToIor( vec3 fresnel0 ) {\n\t\tvec3 sqrtF0 = sqrt( fresnel0 );\n\t\treturn ( vec3( 1.0 ) + sqrtF0 ) / ( vec3( 1.0 ) - sqrtF0 );\n\t}\n\tvec3 IorToFresnel0( vec3 transmittedIor, float incidentIor ) {\n\t\treturn pow2( ( transmittedIor - vec3( incidentIor ) ) / ( transmittedIor + vec3( incidentIor ) ) );\n\t}\n\tfloat IorToFresnel0( float transmittedIor, float incidentIor ) {\n\t\treturn pow2( ( transmittedIor - incidentIor ) / ( transmittedIor + incidentIor ));\n\t}\n\tvec3 evalSensitivity( float OPD, vec3 shift ) {\n\t\tfloat phase = 2.0 * PI * OPD * 1.0e-9;\n\t\tvec3 val = vec3( 5.4856e-13, 4.4201e-13, 5.2481e-13 );\n\t\tvec3 pos = vec3( 1.6810e+06, 1.7953e+06, 2.2084e+06 );\n\t\tvec3 var = vec3( 4.3278e+09, 9.3046e+09, 6.6121e+09 );\n\t\tvec3 xyz = val * sqrt( 2.0 * PI * var ) * cos( pos * phase + shift ) * exp( - pow2( phase ) * var );\n\t\txyz.x += 9.7470e-14 * sqrt( 2.0 * PI * 4.5282e+09 ) * cos( 2.2399e+06 * phase + shift[ 0 ] ) * exp( - 4.5282e+09 * pow2( phase ) );\n\t\txyz /= 1.0685e-7;\n\t\tvec3 rgb = XYZ_TO_REC709 * xyz;\n\t\treturn rgb;\n\t}\n\tvec3 evalIridescence( float outsideIOR, float eta2, float cosTheta1, float thinFilmThickness, vec3 baseF0 ) {\n\t\tvec3 I;\n\t\tfloat iridescenceIOR = mix( outsideIOR, eta2, smoothstep( 0.0, 0.03, thinFilmThickness ) );\n\t\tfloat sinTheta2Sq = pow2( outsideIOR / iridescenceIOR ) * ( 1.0 - pow2( cosTheta1 ) );\n\t\tfloat cosTheta2Sq = 1.0 - sinTheta2Sq;\n\t\tif ( cosTheta2Sq < 0.0 ) {\n\t\t\t return vec3( 1.0 );\n\t\t}\n\t\tfloat cosTheta2 = sqrt( cosTheta2Sq );\n\t\tfloat R0 = IorToFresnel0( iridescenceIOR, outsideIOR );\n\t\tfloat R12 = F_Schlick( R0, 1.0, cosTheta1 );\n\t\tfloat R21 = R12;\n\t\tfloat T121 = 1.0 - R12;\n\t\tfloat phi12 = 0.0;\n\t\tif ( iridescenceIOR < outsideIOR ) phi12 = PI;\n\t\tfloat phi21 = PI - phi12;\n\t\tvec3 baseIOR = Fresnel0ToIor( clamp( baseF0, 0.0, 0.9999 ) );\t\tvec3 R1 = IorToFresnel0( baseIOR, iridescenceIOR );\n\t\tvec3 R23 = F_Schlick( R1, 1.0, cosTheta2 );\n\t\tvec3 phi23 = vec3( 0.0 );\n\t\tif ( baseIOR[ 0 ] < iridescenceIOR ) phi23[ 0 ] = PI;\n\t\tif ( baseIOR[ 1 ] < iridescenceIOR ) phi23[ 1 ] = PI;\n\t\tif ( baseIOR[ 2 ] < iridescenceIOR ) phi23[ 2 ] = PI;\n\t\tfloat OPD = 2.0 * iridescenceIOR * thinFilmThickness * cosTheta2;\n\t\tvec3 phi = vec3( phi21 ) + phi23;\n\t\tvec3 R123 = clamp( R12 * R23, 1e-5, 0.9999 );\n\t\tvec3 r123 = sqrt( R123 );\n\t\tvec3 Rs = pow2( T121 ) * R23 / ( vec3( 1.0 ) - R123 );\n\t\tvec3 C0 = R12 + Rs;\n\t\tI = C0;\n\t\tvec3 Cm = Rs - T121;\n\t\tfor ( int m = 1; m <= 2; ++ m ) {\n\t\t\tCm *= r123;\n\t\t\tvec3 Sm = 2.0 * evalSensitivity( float( m ) * OPD, float( m ) * phi );\n\t\t\tI += Cm * Sm;\n\t\t}\n\t\treturn max( I, vec3( 0.0 ) );\n\t}\n#endif",bumpmap_pars_fragment:"#ifdef USE_BUMPMAP\n\tuniform sampler2D bumpMap;\n\tuniform float bumpScale;\n\tvec2 dHdxy_fwd() {\n\t\tvec2 dSTdx = dFdx( vUv );\n\t\tvec2 dSTdy = dFdy( vUv );\n\t\tfloat Hll = bumpScale * texture2D( bumpMap, vUv ).x;\n\t\tfloat dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;\n\t\tfloat dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;\n\t\treturn vec2( dBx, dBy );\n\t}\n\tvec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {\n\t\tvec3 vSigmaX = dFdx( surf_pos.xyz );\n\t\tvec3 vSigmaY = dFdy( surf_pos.xyz );\n\t\tvec3 vN = surf_norm;\n\t\tvec3 R1 = cross( vSigmaY, vN );\n\t\tvec3 R2 = cross( vN, vSigmaX );\n\t\tfloat fDet = dot( vSigmaX, R1 ) * faceDirection;\n\t\tvec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\n\t\treturn normalize( abs( fDet ) * surf_norm - vGrad );\n\t}\n#endif",clipping_planes_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvec4 plane;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {\n\t\tplane = clippingPlanes[ i ];\n\t\tif ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;\n\t}\n\t#pragma unroll_loop_end\n\t#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES\n\t\tbool clipped = true;\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {\n\t\t\tplane = clippingPlanes[ i ];\n\t\t\tclipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t\tif ( clipped ) discard;\n\t#endif\n#endif",clipping_planes_pars_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n\tuniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];\n#endif",clipping_planes_pars_vertex:"#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n#endif",clipping_planes_vertex:"#if NUM_CLIPPING_PLANES > 0\n\tvClipPosition = - mvPosition.xyz;\n#endif",color_fragment:"#if defined( USE_COLOR_ALPHA )\n\tdiffuseColor *= vColor;\n#elif defined( USE_COLOR )\n\tdiffuseColor.rgb *= vColor;\n#endif",color_pars_fragment:"#if defined( USE_COLOR_ALPHA )\n\tvarying vec4 vColor;\n#elif defined( USE_COLOR )\n\tvarying vec3 vColor;\n#endif",color_pars_vertex:"#if defined( USE_COLOR_ALPHA )\n\tvarying vec4 vColor;\n#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )\n\tvarying vec3 vColor;\n#endif",color_vertex:"#if defined( USE_COLOR_ALPHA )\n\tvColor = vec4( 1.0 );\n#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )\n\tvColor = vec3( 1.0 );\n#endif\n#ifdef USE_COLOR\n\tvColor *= color;\n#endif\n#ifdef USE_INSTANCING_COLOR\n\tvColor.xyz *= instanceColor.xyz;\n#endif",common:"#define PI 3.141592653589793\n#define PI2 6.283185307179586\n#define PI_HALF 1.5707963267948966\n#define RECIPROCAL_PI 0.3183098861837907\n#define RECIPROCAL_PI2 0.15915494309189535\n#define EPSILON 1e-6\n#ifndef saturate\n#define saturate( a ) clamp( a, 0.0, 1.0 )\n#endif\n#define whiteComplement( a ) ( 1.0 - saturate( a ) )\nfloat pow2( const in float x ) { return x*x; }\nvec3 pow2( const in vec3 x ) { return x*x; }\nfloat pow3( const in float x ) { return x*x*x; }\nfloat pow4( const in float x ) { float x2 = x*x; return x2*x2; }\nfloat max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }\nfloat average( const in vec3 v ) { return dot( v, vec3( 0.3333333 ) ); }\nhighp float rand( const in vec2 uv ) {\n\tconst highp float a = 12.9898, b = 78.233, c = 43758.5453;\n\thighp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );\n\treturn fract( sin( sn ) * c );\n}\n#ifdef HIGH_PRECISION\n\tfloat precisionSafeLength( vec3 v ) { return length( v ); }\n#else\n\tfloat precisionSafeLength( vec3 v ) {\n\t\tfloat maxComponent = max3( abs( v ) );\n\t\treturn length( v / maxComponent ) * maxComponent;\n\t}\n#endif\nstruct IncidentLight {\n\tvec3 color;\n\tvec3 direction;\n\tbool visible;\n};\nstruct ReflectedLight {\n\tvec3 directDiffuse;\n\tvec3 directSpecular;\n\tvec3 indirectDiffuse;\n\tvec3 indirectSpecular;\n};\nstruct GeometricContext {\n\tvec3 position;\n\tvec3 normal;\n\tvec3 viewDir;\n#ifdef USE_CLEARCOAT\n\tvec3 clearcoatNormal;\n#endif\n};\nvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n}\nvec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );\n}\nmat3 transposeMat3( const in mat3 m ) {\n\tmat3 tmp;\n\ttmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );\n\ttmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );\n\ttmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );\n\treturn tmp;\n}\nfloat luminance( const in vec3 rgb ) {\n\tconst vec3 weights = vec3( 0.2126729, 0.7151522, 0.0721750 );\n\treturn dot( weights, rgb );\n}\nbool isPerspectiveMatrix( mat4 m ) {\n\treturn m[ 2 ][ 3 ] == - 1.0;\n}\nvec2 equirectUv( in vec3 dir ) {\n\tfloat u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;\n\tfloat v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\treturn vec2( u, v );\n}",cube_uv_reflection_fragment:"#ifdef ENVMAP_TYPE_CUBE_UV\n\t#define cubeUV_minMipLevel 4.0\n\t#define cubeUV_minTileSize 16.0\n\tfloat getFace( vec3 direction ) {\n\t\tvec3 absDirection = abs( direction );\n\t\tfloat face = - 1.0;\n\t\tif ( absDirection.x > absDirection.z ) {\n\t\t\tif ( absDirection.x > absDirection.y )\n\t\t\t\tface = direction.x > 0.0 ? 0.0 : 3.0;\n\t\t\telse\n\t\t\t\tface = direction.y > 0.0 ? 1.0 : 4.0;\n\t\t} else {\n\t\t\tif ( absDirection.z > absDirection.y )\n\t\t\t\tface = direction.z > 0.0 ? 2.0 : 5.0;\n\t\t\telse\n\t\t\t\tface = direction.y > 0.0 ? 1.0 : 4.0;\n\t\t}\n\t\treturn face;\n\t}\n\tvec2 getUV( vec3 direction, float face ) {\n\t\tvec2 uv;\n\t\tif ( face == 0.0 ) {\n\t\t\tuv = vec2( direction.z, direction.y ) / abs( direction.x );\n\t\t} else if ( face == 1.0 ) {\n\t\t\tuv = vec2( - direction.x, - direction.z ) / abs( direction.y );\n\t\t} else if ( face == 2.0 ) {\n\t\t\tuv = vec2( - direction.x, direction.y ) / abs( direction.z );\n\t\t} else if ( face == 3.0 ) {\n\t\t\tuv = vec2( - direction.z, direction.y ) / abs( direction.x );\n\t\t} else if ( face == 4.0 ) {\n\t\t\tuv = vec2( - direction.x, direction.z ) / abs( direction.y );\n\t\t} else {\n\t\t\tuv = vec2( direction.x, direction.y ) / abs( direction.z );\n\t\t}\n\t\treturn 0.5 * ( uv + 1.0 );\n\t}\n\tvec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {\n\t\tfloat face = getFace( direction );\n\t\tfloat filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );\n\t\tmipInt = max( mipInt, cubeUV_minMipLevel );\n\t\tfloat faceSize = exp2( mipInt );\n\t\tvec2 uv = getUV( direction, face ) * ( faceSize - 2.0 ) + 1.0;\n\t\tif ( face > 2.0 ) {\n\t\t\tuv.y += faceSize;\n\t\t\tface -= 3.0;\n\t\t}\n\t\tuv.x += face * faceSize;\n\t\tuv.x += filterInt * 3.0 * cubeUV_minTileSize;\n\t\tuv.y += 4.0 * ( exp2( CUBEUV_MAX_MIP ) - faceSize );\n\t\tuv.x *= CUBEUV_TEXEL_WIDTH;\n\t\tuv.y *= CUBEUV_TEXEL_HEIGHT;\n\t\t#ifdef texture2DGradEXT\n\t\t\treturn texture2DGradEXT( envMap, uv, vec2( 0.0 ), vec2( 0.0 ) ).rgb;\n\t\t#else\n\t\t\treturn texture2D( envMap, uv ).rgb;\n\t\t#endif\n\t}\n\t#define cubeUV_r0 1.0\n\t#define cubeUV_v0 0.339\n\t#define cubeUV_m0 - 2.0\n\t#define cubeUV_r1 0.8\n\t#define cubeUV_v1 0.276\n\t#define cubeUV_m1 - 1.0\n\t#define cubeUV_r4 0.4\n\t#define cubeUV_v4 0.046\n\t#define cubeUV_m4 2.0\n\t#define cubeUV_r5 0.305\n\t#define cubeUV_v5 0.016\n\t#define cubeUV_m5 3.0\n\t#define cubeUV_r6 0.21\n\t#define cubeUV_v6 0.0038\n\t#define cubeUV_m6 4.0\n\tfloat roughnessToMip( float roughness ) {\n\t\tfloat mip = 0.0;\n\t\tif ( roughness >= cubeUV_r1 ) {\n\t\t\tmip = ( cubeUV_r0 - roughness ) * ( cubeUV_m1 - cubeUV_m0 ) / ( cubeUV_r0 - cubeUV_r1 ) + cubeUV_m0;\n\t\t} else if ( roughness >= cubeUV_r4 ) {\n\t\t\tmip = ( cubeUV_r1 - roughness ) * ( cubeUV_m4 - cubeUV_m1 ) / ( cubeUV_r1 - cubeUV_r4 ) + cubeUV_m1;\n\t\t} else if ( roughness >= cubeUV_r5 ) {\n\t\t\tmip = ( cubeUV_r4 - roughness ) * ( cubeUV_m5 - cubeUV_m4 ) / ( cubeUV_r4 - cubeUV_r5 ) + cubeUV_m4;\n\t\t} else if ( roughness >= cubeUV_r6 ) {\n\t\t\tmip = ( cubeUV_r5 - roughness ) * ( cubeUV_m6 - cubeUV_m5 ) / ( cubeUV_r5 - cubeUV_r6 ) + cubeUV_m5;\n\t\t} else {\n\t\t\tmip = - 2.0 * log2( 1.16 * roughness );\t\t}\n\t\treturn mip;\n\t}\n\tvec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {\n\t\tfloat mip = clamp( roughnessToMip( roughness ), cubeUV_m0, CUBEUV_MAX_MIP );\n\t\tfloat mipF = fract( mip );\n\t\tfloat mipInt = floor( mip );\n\t\tvec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );\n\t\tif ( mipF == 0.0 ) {\n\t\t\treturn vec4( color0, 1.0 );\n\t\t} else {\n\t\t\tvec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );\n\t\t\treturn vec4( mix( color0, color1, mipF ), 1.0 );\n\t\t}\n\t}\n#endif",defaultnormal_vertex:"vec3 transformedNormal = objectNormal;\n#ifdef USE_INSTANCING\n\tmat3 m = mat3( instanceMatrix );\n\ttransformedNormal /= vec3( dot( m[ 0 ], m[ 0 ] ), dot( m[ 1 ], m[ 1 ] ), dot( m[ 2 ], m[ 2 ] ) );\n\ttransformedNormal = m * transformedNormal;\n#endif\ntransformedNormal = normalMatrix * transformedNormal;\n#ifdef FLIP_SIDED\n\ttransformedNormal = - transformedNormal;\n#endif\n#ifdef USE_TANGENT\n\tvec3 transformedTangent = ( modelViewMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\t#ifdef FLIP_SIDED\n\t\ttransformedTangent = - transformedTangent;\n\t#endif\n#endif",displacementmap_pars_vertex:"#ifdef USE_DISPLACEMENTMAP\n\tuniform sampler2D displacementMap;\n\tuniform float displacementScale;\n\tuniform float displacementBias;\n#endif",displacementmap_vertex:"#ifdef USE_DISPLACEMENTMAP\n\ttransformed += normalize( objectNormal ) * ( texture2D( displacementMap, vUv ).x * displacementScale + displacementBias );\n#endif",emissivemap_fragment:"#ifdef USE_EMISSIVEMAP\n\tvec4 emissiveColor = texture2D( emissiveMap, vUv );\n\ttotalEmissiveRadiance *= emissiveColor.rgb;\n#endif",emissivemap_pars_fragment:"#ifdef USE_EMISSIVEMAP\n\tuniform sampler2D emissiveMap;\n#endif",encodings_fragment:"gl_FragColor = linearToOutputTexel( gl_FragColor );",encodings_pars_fragment:"vec4 LinearToLinear( in vec4 value ) {\n\treturn value;\n}\nvec4 LinearTosRGB( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );\n}",envmap_fragment:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvec3 cameraToFrag;\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToFrag = normalize( vWorldPosition - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( cameraToFrag, worldNormal );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );\n\t\t#endif\n\t#else\n\t\tvec3 reflectVec = vReflect;\n\t#endif\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\n\t#else\n\t\tvec4 envColor = vec4( 0.0 );\n\t#endif\n\t#ifdef ENVMAP_BLENDING_MULTIPLY\n\t\toutgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_MIX )\n\t\toutgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_ADD )\n\t\toutgoingLight += envColor.xyz * specularStrength * reflectivity;\n\t#endif\n#endif",envmap_common_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float envMapIntensity;\n\tuniform float flipEnvMap;\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tuniform samplerCube envMap;\n\t#else\n\t\tuniform sampler2D envMap;\n\t#endif\n\t\n#endif",envmap_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float reflectivity;\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\tvarying vec3 vWorldPosition;\n\t\tuniform float refractionRatio;\n\t#else\n\t\tvarying vec3 vReflect;\n\t#endif\n#endif",envmap_pars_vertex:"#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\t\n\t\tvarying vec3 vWorldPosition;\n\t#else\n\t\tvarying vec3 vReflect;\n\t\tuniform float refractionRatio;\n\t#endif\n#endif",envmap_physical_pars_fragment:"#if defined( USE_ENVMAP )\n\tvec3 getIBLIrradiance( const in vec3 normal ) {\n\t\t#if defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, worldNormal, 1.0 );\n\t\t\treturn PI * envMapColor.rgb * envMapIntensity;\n\t\t#else\n\t\t\treturn vec3( 0.0 );\n\t\t#endif\n\t}\n\tvec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {\n\t\t#if defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec3 reflectVec = reflect( - viewDir, normal );\n\t\t\treflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );\n\t\t\treflectVec = inverseTransformDirection( reflectVec, viewMatrix );\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, reflectVec, roughness );\n\t\t\treturn envMapColor.rgb * envMapIntensity;\n\t\t#else\n\t\t\treturn vec3( 0.0 );\n\t\t#endif\n\t}\n#endif",envmap_vertex:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvWorldPosition = worldPosition.xyz;\n\t#else\n\t\tvec3 cameraToVertex;\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToVertex = normalize( worldPosition.xyz - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvReflect = reflect( cameraToVertex, worldNormal );\n\t\t#else\n\t\t\tvReflect = refract( cameraToVertex, worldNormal, refractionRatio );\n\t\t#endif\n\t#endif\n#endif",fog_vertex:"#ifdef USE_FOG\n\tvFogDepth = - mvPosition.z;\n#endif",fog_pars_vertex:"#ifdef USE_FOG\n\tvarying float vFogDepth;\n#endif",fog_fragment:"#ifdef USE_FOG\n\t#ifdef FOG_EXP2\n\t\tfloat fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );\n\t#else\n\t\tfloat fogFactor = smoothstep( fogNear, fogFar, vFogDepth );\n\t#endif\n\tgl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );\n#endif",fog_pars_fragment:"#ifdef USE_FOG\n\tuniform vec3 fogColor;\n\tvarying float vFogDepth;\n\t#ifdef FOG_EXP2\n\t\tuniform float fogDensity;\n\t#else\n\t\tuniform float fogNear;\n\t\tuniform float fogFar;\n\t#endif\n#endif",gradientmap_pars_fragment:"#ifdef USE_GRADIENTMAP\n\tuniform sampler2D gradientMap;\n#endif\nvec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {\n\tfloat dotNL = dot( normal, lightDirection );\n\tvec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );\n\t#ifdef USE_GRADIENTMAP\n\t\treturn vec3( texture2D( gradientMap, coord ).r );\n\t#else\n\t\tvec2 fw = fwidth( coord ) * 0.5;\n\t\treturn mix( vec3( 0.7 ), vec3( 1.0 ), smoothstep( 0.7 - fw.x, 0.7 + fw.x, coord.x ) );\n\t#endif\n}",lightmap_fragment:"#ifdef USE_LIGHTMAP\n\tvec4 lightMapTexel = texture2D( lightMap, vUv2 );\n\tvec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;\n\treflectedLight.indirectDiffuse += lightMapIrradiance;\n#endif",lightmap_pars_fragment:"#ifdef USE_LIGHTMAP\n\tuniform sampler2D lightMap;\n\tuniform float lightMapIntensity;\n#endif",lights_lambert_fragment:"LambertMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularStrength = specularStrength;",lights_lambert_pars_fragment:"varying vec3 vViewPosition;\nstruct LambertMaterial {\n\tvec3 diffuseColor;\n\tfloat specularStrength;\n};\nvoid RE_Direct_Lambert( const in IncidentLight directLight, const in GeometricContext geometry, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Lambert( const in vec3 irradiance, const in GeometricContext geometry, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_Lambert\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Lambert\n#define Material_LightProbeLOD( material )\t(0)",lights_pars_begin:"uniform bool receiveShadow;\nuniform vec3 ambientLightColor;\nuniform vec3 lightProbe[ 9 ];\nvec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {\n\tfloat x = normal.x, y = normal.y, z = normal.z;\n\tvec3 result = shCoefficients[ 0 ] * 0.886227;\n\tresult += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;\n\tresult += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;\n\tresult += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;\n\tresult += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;\n\tresult += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;\n\tresult += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );\n\tresult += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;\n\tresult += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );\n\treturn result;\n}\nvec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {\n\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\tvec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );\n\treturn irradiance;\n}\nvec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {\n\tvec3 irradiance = ambientLightColor;\n\treturn irradiance;\n}\nfloat getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {\n\t#if defined ( PHYSICALLY_CORRECT_LIGHTS )\n\t\tfloat distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );\n\t\tif ( cutoffDistance > 0.0 ) {\n\t\t\tdistanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );\n\t\t}\n\t\treturn distanceFalloff;\n\t#else\n\t\tif ( cutoffDistance > 0.0 && decayExponent > 0.0 ) {\n\t\t\treturn pow( saturate( - lightDistance / cutoffDistance + 1.0 ), decayExponent );\n\t\t}\n\t\treturn 1.0;\n\t#endif\n}\nfloat getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {\n\treturn smoothstep( coneCosine, penumbraCosine, angleCosine );\n}\n#if NUM_DIR_LIGHTS > 0\n\tstruct DirectionalLight {\n\t\tvec3 direction;\n\t\tvec3 color;\n\t};\n\tuniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];\n\tvoid getDirectionalLightInfo( const in DirectionalLight directionalLight, const in GeometricContext geometry, out IncidentLight light ) {\n\t\tlight.color = directionalLight.color;\n\t\tlight.direction = directionalLight.direction;\n\t\tlight.visible = true;\n\t}\n#endif\n#if NUM_POINT_LIGHTS > 0\n\tstruct PointLight {\n\t\tvec3 position;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t};\n\tuniform PointLight pointLights[ NUM_POINT_LIGHTS ];\n\tvoid getPointLightInfo( const in PointLight pointLight, const in GeometricContext geometry, out IncidentLight light ) {\n\t\tvec3 lVector = pointLight.position - geometry.position;\n\t\tlight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tlight.color = pointLight.color;\n\t\tlight.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );\n\t\tlight.visible = ( light.color != vec3( 0.0 ) );\n\t}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\tstruct SpotLight {\n\t\tvec3 position;\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tfloat coneCos;\n\t\tfloat penumbraCos;\n\t};\n\tuniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];\n\tvoid getSpotLightInfo( const in SpotLight spotLight, const in GeometricContext geometry, out IncidentLight light ) {\n\t\tvec3 lVector = spotLight.position - geometry.position;\n\t\tlight.direction = normalize( lVector );\n\t\tfloat angleCos = dot( light.direction, spotLight.direction );\n\t\tfloat spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );\n\t\tif ( spotAttenuation > 0.0 ) {\n\t\t\tfloat lightDistance = length( lVector );\n\t\t\tlight.color = spotLight.color * spotAttenuation;\n\t\t\tlight.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );\n\t\t\tlight.visible = ( light.color != vec3( 0.0 ) );\n\t\t} else {\n\t\t\tlight.color = vec3( 0.0 );\n\t\t\tlight.visible = false;\n\t\t}\n\t}\n#endif\n#if NUM_RECT_AREA_LIGHTS > 0\n\tstruct RectAreaLight {\n\t\tvec3 color;\n\t\tvec3 position;\n\t\tvec3 halfWidth;\n\t\tvec3 halfHeight;\n\t};\n\tuniform sampler2D ltc_1;\tuniform sampler2D ltc_2;\n\tuniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\tstruct HemisphereLight {\n\t\tvec3 direction;\n\t\tvec3 skyColor;\n\t\tvec3 groundColor;\n\t};\n\tuniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];\n\tvec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {\n\t\tfloat dotNL = dot( normal, hemiLight.direction );\n\t\tfloat hemiDiffuseWeight = 0.5 * dotNL + 0.5;\n\t\tvec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );\n\t\treturn irradiance;\n\t}\n#endif",lights_toon_fragment:"ToonMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;",lights_toon_pars_fragment:"varying vec3 vViewPosition;\nstruct ToonMaterial {\n\tvec3 diffuseColor;\n};\nvoid RE_Direct_Toon( const in IncidentLight directLight, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\tvec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_Toon\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Toon\n#define Material_LightProbeLOD( material )\t(0)",lights_phong_fragment:"BlinnPhongMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularColor = specular;\nmaterial.specularShininess = shininess;\nmaterial.specularStrength = specularStrength;",lights_phong_pars_fragment:"varying vec3 vViewPosition;\nstruct BlinnPhongMaterial {\n\tvec3 diffuseColor;\n\tvec3 specularColor;\n\tfloat specularShininess;\n\tfloat specularStrength;\n};\nvoid RE_Direct_BlinnPhong( const in IncidentLight directLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n\treflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularShininess ) * material.specularStrength;\n}\nvoid RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_BlinnPhong\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_BlinnPhong\n#define Material_LightProbeLOD( material )\t(0)",lights_physical_fragment:"PhysicalMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );\nvec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );\nfloat geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );\nmaterial.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;\nmaterial.roughness = min( material.roughness, 1.0 );\n#ifdef IOR\n\tmaterial.ior = ior;\n\t#ifdef SPECULAR\n\t\tfloat specularIntensityFactor = specularIntensity;\n\t\tvec3 specularColorFactor = specularColor;\n\t\t#ifdef USE_SPECULARINTENSITYMAP\n\t\t\tspecularIntensityFactor *= texture2D( specularIntensityMap, vUv ).a;\n\t\t#endif\n\t\t#ifdef USE_SPECULARCOLORMAP\n\t\t\tspecularColorFactor *= texture2D( specularColorMap, vUv ).rgb;\n\t\t#endif\n\t\tmaterial.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );\n\t#else\n\t\tfloat specularIntensityFactor = 1.0;\n\t\tvec3 specularColorFactor = vec3( 1.0 );\n\t\tmaterial.specularF90 = 1.0;\n\t#endif\n\tmaterial.specularColor = mix( min( pow2( ( material.ior - 1.0 ) / ( material.ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor, diffuseColor.rgb, metalnessFactor );\n#else\n\tmaterial.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );\n\tmaterial.specularF90 = 1.0;\n#endif\n#ifdef USE_CLEARCOAT\n\tmaterial.clearcoat = clearcoat;\n\tmaterial.clearcoatRoughness = clearcoatRoughness;\n\tmaterial.clearcoatF0 = vec3( 0.04 );\n\tmaterial.clearcoatF90 = 1.0;\n\t#ifdef USE_CLEARCOATMAP\n\t\tmaterial.clearcoat *= texture2D( clearcoatMap, vUv ).x;\n\t#endif\n\t#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\t\tmaterial.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vUv ).y;\n\t#endif\n\tmaterial.clearcoat = saturate( material.clearcoat );\tmaterial.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );\n\tmaterial.clearcoatRoughness += geometryRoughness;\n\tmaterial.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );\n#endif\n#ifdef USE_IRIDESCENCE\n\tmaterial.iridescence = iridescence;\n\tmaterial.iridescenceIOR = iridescenceIOR;\n\t#ifdef USE_IRIDESCENCEMAP\n\t\tmaterial.iridescence *= texture2D( iridescenceMap, vUv ).r;\n\t#endif\n\t#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\t\tmaterial.iridescenceThickness = (iridescenceThicknessMaximum - iridescenceThicknessMinimum) * texture2D( iridescenceThicknessMap, vUv ).g + iridescenceThicknessMinimum;\n\t#else\n\t\tmaterial.iridescenceThickness = iridescenceThicknessMaximum;\n\t#endif\n#endif\n#ifdef USE_SHEEN\n\tmaterial.sheenColor = sheenColor;\n\t#ifdef USE_SHEENCOLORMAP\n\t\tmaterial.sheenColor *= texture2D( sheenColorMap, vUv ).rgb;\n\t#endif\n\tmaterial.sheenRoughness = clamp( sheenRoughness, 0.07, 1.0 );\n\t#ifdef USE_SHEENROUGHNESSMAP\n\t\tmaterial.sheenRoughness *= texture2D( sheenRoughnessMap, vUv ).a;\n\t#endif\n#endif",lights_physical_pars_fragment:"struct PhysicalMaterial {\n\tvec3 diffuseColor;\n\tfloat roughness;\n\tvec3 specularColor;\n\tfloat specularF90;\n\t#ifdef USE_CLEARCOAT\n\t\tfloat clearcoat;\n\t\tfloat clearcoatRoughness;\n\t\tvec3 clearcoatF0;\n\t\tfloat clearcoatF90;\n\t#endif\n\t#ifdef USE_IRIDESCENCE\n\t\tfloat iridescence;\n\t\tfloat iridescenceIOR;\n\t\tfloat iridescenceThickness;\n\t\tvec3 iridescenceFresnel;\n\t\tvec3 iridescenceF0;\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tvec3 sheenColor;\n\t\tfloat sheenRoughness;\n\t#endif\n\t#ifdef IOR\n\t\tfloat ior;\n\t#endif\n\t#ifdef USE_TRANSMISSION\n\t\tfloat transmission;\n\t\tfloat transmissionAlpha;\n\t\tfloat thickness;\n\t\tfloat attenuationDistance;\n\t\tvec3 attenuationColor;\n\t#endif\n};\nvec3 clearcoatSpecular = vec3( 0.0 );\nvec3 sheenSpecular = vec3( 0.0 );\nfloat IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat r2 = roughness * roughness;\n\tfloat a = roughness < 0.25 ? -339.2 * r2 + 161.4 * roughness - 25.9 : -8.48 * r2 + 14.3 * roughness - 9.95;\n\tfloat b = roughness < 0.25 ? 44.0 * r2 - 23.7 * roughness + 3.26 : 1.97 * r2 - 3.27 * roughness + 0.72;\n\tfloat DG = exp( a * dotNV + b ) + ( roughness < 0.25 ? 0.0 : 0.1 * ( roughness - 0.25 ) );\n\treturn saturate( DG * RECIPROCAL_PI );\n}\nvec2 DFGApprox( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tconst vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );\n\tconst vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );\n\tvec4 r = roughness * c0 + c1;\n\tfloat a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;\n\tvec2 fab = vec2( - 1.04, 1.04 ) * a004 + r.zw;\n\treturn fab;\n}\nvec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {\n\tvec2 fab = DFGApprox( normal, viewDir, roughness );\n\treturn specularColor * fab.x + specularF90 * fab.y;\n}\n#ifdef USE_IRIDESCENCE\nvoid computeMultiscatteringIridescence( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float iridescence, const in vec3 iridescenceF0, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {\n#else\nvoid computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {\n#endif\n\tvec2 fab = DFGApprox( normal, viewDir, roughness );\n\t#ifdef USE_IRIDESCENCE\n\t\tvec3 Fr = mix( specularColor, iridescenceF0, iridescence );\n\t#else\n\t\tvec3 Fr = specularColor;\n\t#endif\n\tvec3 FssEss = Fr * fab.x + specularF90 * fab.y;\n\tfloat Ess = fab.x + fab.y;\n\tfloat Ems = 1.0 - Ess;\n\tvec3 Favg = Fr + ( 1.0 - Fr ) * 0.047619;\tvec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );\n\tsingleScatter += FssEss;\n\tmultiScatter += Fms * Ems;\n}\n#if NUM_RECT_AREA_LIGHTS > 0\n\tvoid RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\t\tvec3 normal = geometry.normal;\n\t\tvec3 viewDir = geometry.viewDir;\n\t\tvec3 position = geometry.position;\n\t\tvec3 lightPos = rectAreaLight.position;\n\t\tvec3 halfWidth = rectAreaLight.halfWidth;\n\t\tvec3 halfHeight = rectAreaLight.halfHeight;\n\t\tvec3 lightColor = rectAreaLight.color;\n\t\tfloat roughness = material.roughness;\n\t\tvec3 rectCoords[ 4 ];\n\t\trectCoords[ 0 ] = lightPos + halfWidth - halfHeight;\t\trectCoords[ 1 ] = lightPos - halfWidth - halfHeight;\n\t\trectCoords[ 2 ] = lightPos - halfWidth + halfHeight;\n\t\trectCoords[ 3 ] = lightPos + halfWidth + halfHeight;\n\t\tvec2 uv = LTC_Uv( normal, viewDir, roughness );\n\t\tvec4 t1 = texture2D( ltc_1, uv );\n\t\tvec4 t2 = texture2D( ltc_2, uv );\n\t\tmat3 mInv = mat3(\n\t\t\tvec3( t1.x, 0, t1.y ),\n\t\t\tvec3(    0, 1,    0 ),\n\t\t\tvec3( t1.z, 0, t1.w )\n\t\t);\n\t\tvec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );\n\t\treflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );\n\t\treflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );\n\t}\n#endif\nvoid RE_Direct_Physical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\t#ifdef USE_CLEARCOAT\n\t\tfloat dotNLcc = saturate( dot( geometry.clearcoatNormal, directLight.direction ) );\n\t\tvec3 ccIrradiance = dotNLcc * directLight.color;\n\t\tclearcoatSpecular += ccIrradiance * BRDF_GGX( directLight.direction, geometry.viewDir, geometry.clearcoatNormal, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tsheenSpecular += irradiance * BRDF_Sheen( directLight.direction, geometry.viewDir, geometry.normal, material.sheenColor, material.sheenRoughness );\n\t#endif\n\t#ifdef USE_IRIDESCENCE\n\t\treflectedLight.directSpecular += irradiance * BRDF_GGX_Iridescence( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness );\n\t#else\n\t\treflectedLight.directSpecular += irradiance * BRDF_GGX( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularF90, material.roughness );\n\t#endif\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {\n\t#ifdef USE_CLEARCOAT\n\t\tclearcoatSpecular += clearcoatRadiance * EnvironmentBRDF( geometry.clearcoatNormal, geometry.viewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tsheenSpecular += irradiance * material.sheenColor * IBLSheenBRDF( geometry.normal, geometry.viewDir, material.sheenRoughness );\n\t#endif\n\tvec3 singleScattering = vec3( 0.0 );\n\tvec3 multiScattering = vec3( 0.0 );\n\tvec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;\n\t#ifdef USE_IRIDESCENCE\n\t\tcomputeMultiscatteringIridescence( geometry.normal, geometry.viewDir, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness, singleScattering, multiScattering );\n\t#else\n\t\tcomputeMultiscattering( geometry.normal, geometry.viewDir, material.specularColor, material.specularF90, material.roughness, singleScattering, multiScattering );\n\t#endif\n\tvec3 totalScattering = singleScattering + multiScattering;\n\tvec3 diffuse = material.diffuseColor * ( 1.0 - max( max( totalScattering.r, totalScattering.g ), totalScattering.b ) );\n\treflectedLight.indirectSpecular += radiance * singleScattering;\n\treflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;\n\treflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;\n}\n#define RE_Direct\t\t\t\tRE_Direct_Physical\n#define RE_Direct_RectArea\t\tRE_Direct_RectArea_Physical\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Physical\n#define RE_IndirectSpecular\t\tRE_IndirectSpecular_Physical\nfloat computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {\n\treturn saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );\n}",lights_fragment_begin:"\nGeometricContext geometry;\ngeometry.position = - vViewPosition;\ngeometry.normal = normal;\ngeometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );\n#ifdef USE_CLEARCOAT\n\tgeometry.clearcoatNormal = clearcoatNormal;\n#endif\n#ifdef USE_IRIDESCENCE\n\tfloat dotNVi = saturate( dot( normal, geometry.viewDir ) );\n\tif ( material.iridescenceThickness == 0.0 ) {\n\t\tmaterial.iridescence = 0.0;\n\t} else {\n\t\tmaterial.iridescence = saturate( material.iridescence );\n\t}\n\tif ( material.iridescence > 0.0 ) {\n\t\tmaterial.iridescenceFresnel = evalIridescence( 1.0, material.iridescenceIOR, dotNVi, material.iridescenceThickness, material.specularColor );\n\t\tmaterial.iridescenceF0 = Schlick_to_F0( material.iridescenceFresnel, 1.0, dotNVi );\n\t}\n#endif\nIncidentLight directLight;\n#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )\n\tPointLight pointLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tpointLight = pointLights[ i ];\n\t\tgetPointLightInfo( pointLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )\n\t\tpointLightShadow = pointLightShadows[ i ];\n\t\tdirectLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )\n\tSpotLight spotLight;\n\tvec4 spotColor;\n\tvec3 spotLightCoord;\n\tbool inSpotLightMap;\n\t#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tspotLight = spotLights[ i ];\n\t\tgetSpotLightInfo( spotLight, geometry, directLight );\n\t\t#if ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )\n\t\t#define SPOT_LIGHT_MAP_INDEX UNROLLED_LOOP_INDEX\n\t\t#elif ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\t#define SPOT_LIGHT_MAP_INDEX NUM_SPOT_LIGHT_MAPS\n\t\t#else\n\t\t#define SPOT_LIGHT_MAP_INDEX ( UNROLLED_LOOP_INDEX - NUM_SPOT_LIGHT_SHADOWS + NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )\n\t\t#endif\n\t\t#if ( SPOT_LIGHT_MAP_INDEX < NUM_SPOT_LIGHT_MAPS )\n\t\t\tspotLightCoord = vSpotLightCoord[ i ].xyz / vSpotLightCoord[ i ].w;\n\t\t\tinSpotLightMap = all( lessThan( abs( spotLightCoord * 2. - 1. ), vec3( 1.0 ) ) );\n\t\t\tspotColor = texture2D( spotLightMap[ SPOT_LIGHT_MAP_INDEX ], spotLightCoord.xy );\n\t\t\tdirectLight.color = inSpotLightMap ? directLight.color * spotColor.rgb : directLight.color;\n\t\t#endif\n\t\t#undef SPOT_LIGHT_MAP_INDEX\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\tspotLightShadow = spotLightShadows[ i ];\n\t\tdirectLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )\n\tDirectionalLight directionalLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tdirectionalLight = directionalLights[ i ];\n\t\tgetDirectionalLightInfo( directionalLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )\n\t\tdirectionalLightShadow = directionalLightShadows[ i ];\n\t\tdirectLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )\n\tRectAreaLight rectAreaLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {\n\t\trectAreaLight = rectAreaLights[ i ];\n\t\tRE_Direct_RectArea( rectAreaLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if defined( RE_IndirectDiffuse )\n\tvec3 iblIrradiance = vec3( 0.0 );\n\tvec3 irradiance = getAmbientLightIrradiance( ambientLightColor );\n\tirradiance += getLightProbeIrradiance( lightProbe, geometry.normal );\n\t#if ( NUM_HEMI_LIGHTS > 0 )\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\t\tirradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry.normal );\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n#endif\n#if defined( RE_IndirectSpecular )\n\tvec3 radiance = vec3( 0.0 );\n\tvec3 clearcoatRadiance = vec3( 0.0 );\n#endif",lights_fragment_maps:"#if defined( RE_IndirectDiffuse )\n\t#ifdef USE_LIGHTMAP\n\t\tvec4 lightMapTexel = texture2D( lightMap, vUv2 );\n\t\tvec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;\n\t\tirradiance += lightMapIrradiance;\n\t#endif\n\t#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )\n\t\tiblIrradiance += getIBLIrradiance( geometry.normal );\n\t#endif\n#endif\n#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )\n\tradiance += getIBLRadiance( geometry.viewDir, geometry.normal, material.roughness );\n\t#ifdef USE_CLEARCOAT\n\t\tclearcoatRadiance += getIBLRadiance( geometry.viewDir, geometry.clearcoatNormal, material.clearcoatRoughness );\n\t#endif\n#endif",lights_fragment_end:"#if defined( RE_IndirectDiffuse )\n\tRE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );\n#endif\n#if defined( RE_IndirectSpecular )\n\tRE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometry, material, reflectedLight );\n#endif",logdepthbuf_fragment:"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tgl_FragDepthEXT = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;\n#endif",logdepthbuf_pars_fragment:"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tuniform float logDepthBufFC;\n\tvarying float vFragDepth;\n\tvarying float vIsPerspective;\n#endif",logdepthbuf_pars_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvarying float vFragDepth;\n\t\tvarying float vIsPerspective;\n\t#else\n\t\tuniform float logDepthBufFC;\n\t#endif\n#endif",logdepthbuf_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvFragDepth = 1.0 + gl_Position.w;\n\t\tvIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );\n\t#else\n\t\tif ( isPerspectiveMatrix( projectionMatrix ) ) {\n\t\t\tgl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;\n\t\t\tgl_Position.z *= gl_Position.w;\n\t\t}\n\t#endif\n#endif",map_fragment:"#ifdef USE_MAP\n\tvec4 sampledDiffuseColor = texture2D( map, vUv );\n\t#ifdef DECODE_VIDEO_TEXTURE\n\t\tsampledDiffuseColor = vec4( mix( pow( sampledDiffuseColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), sampledDiffuseColor.rgb * 0.0773993808, vec3( lessThanEqual( sampledDiffuseColor.rgb, vec3( 0.04045 ) ) ) ), sampledDiffuseColor.w );\n\t#endif\n\tdiffuseColor *= sampledDiffuseColor;\n#endif",map_pars_fragment:"#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif",map_particle_fragment:"#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\tvec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;\n#endif\n#ifdef USE_MAP\n\tdiffuseColor *= texture2D( map, uv );\n#endif\n#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, uv ).g;\n#endif",map_particle_pars_fragment:"#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\tuniform mat3 uvTransform;\n#endif\n#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif\n#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",metalnessmap_fragment:"float metalnessFactor = metalness;\n#ifdef USE_METALNESSMAP\n\tvec4 texelMetalness = texture2D( metalnessMap, vUv );\n\tmetalnessFactor *= texelMetalness.b;\n#endif",metalnessmap_pars_fragment:"#ifdef USE_METALNESSMAP\n\tuniform sampler2D metalnessMap;\n#endif",morphcolor_vertex:"#if defined( USE_MORPHCOLORS ) && defined( MORPHTARGETS_TEXTURE )\n\tvColor *= morphTargetBaseInfluence;\n\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\t#if defined( USE_COLOR_ALPHA )\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ) * morphTargetInfluences[ i ];\n\t\t#elif defined( USE_COLOR )\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ).rgb * morphTargetInfluences[ i ];\n\t\t#endif\n\t}\n#endif",morphnormal_vertex:"#ifdef USE_MORPHNORMALS\n\tobjectNormal *= morphTargetBaseInfluence;\n\t#ifdef MORPHTARGETS_TEXTURE\n\t\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1 ).xyz * morphTargetInfluences[ i ];\n\t\t}\n\t#else\n\t\tobjectNormal += morphNormal0 * morphTargetInfluences[ 0 ];\n\t\tobjectNormal += morphNormal1 * morphTargetInfluences[ 1 ];\n\t\tobjectNormal += morphNormal2 * morphTargetInfluences[ 2 ];\n\t\tobjectNormal += morphNormal3 * morphTargetInfluences[ 3 ];\n\t#endif\n#endif",morphtarget_pars_vertex:"#ifdef USE_MORPHTARGETS\n\tuniform float morphTargetBaseInfluence;\n\t#ifdef MORPHTARGETS_TEXTURE\n\t\tuniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];\n\t\tuniform sampler2DArray morphTargetsTexture;\n\t\tuniform ivec2 morphTargetsTextureSize;\n\t\tvec4 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset ) {\n\t\t\tint texelIndex = vertexIndex * MORPHTARGETS_TEXTURE_STRIDE + offset;\n\t\t\tint y = texelIndex / morphTargetsTextureSize.x;\n\t\t\tint x = texelIndex - y * morphTargetsTextureSize.x;\n\t\t\tivec3 morphUV = ivec3( x, y, morphTargetIndex );\n\t\t\treturn texelFetch( morphTargetsTexture, morphUV, 0 );\n\t\t}\n\t#else\n\t\t#ifndef USE_MORPHNORMALS\n\t\t\tuniform float morphTargetInfluences[ 8 ];\n\t\t#else\n\t\t\tuniform float morphTargetInfluences[ 4 ];\n\t\t#endif\n\t#endif\n#endif",morphtarget_vertex:"#ifdef USE_MORPHTARGETS\n\ttransformed *= morphTargetBaseInfluence;\n\t#ifdef MORPHTARGETS_TEXTURE\n\t\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0 ).xyz * morphTargetInfluences[ i ];\n\t\t}\n\t#else\n\t\ttransformed += morphTarget0 * morphTargetInfluences[ 0 ];\n\t\ttransformed += morphTarget1 * morphTargetInfluences[ 1 ];\n\t\ttransformed += morphTarget2 * morphTargetInfluences[ 2 ];\n\t\ttransformed += morphTarget3 * morphTargetInfluences[ 3 ];\n\t\t#ifndef USE_MORPHNORMALS\n\t\t\ttransformed += morphTarget4 * morphTargetInfluences[ 4 ];\n\t\t\ttransformed += morphTarget5 * morphTargetInfluences[ 5 ];\n\t\t\ttransformed += morphTarget6 * morphTargetInfluences[ 6 ];\n\t\t\ttransformed += morphTarget7 * morphTargetInfluences[ 7 ];\n\t\t#endif\n\t#endif\n#endif",normal_fragment_begin:"float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;\n#ifdef FLAT_SHADED\n\tvec3 fdx = dFdx( vViewPosition );\n\tvec3 fdy = dFdy( vViewPosition );\n\tvec3 normal = normalize( cross( fdx, fdy ) );\n#else\n\tvec3 normal = normalize( vNormal );\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * faceDirection;\n\t#endif\n\t#ifdef USE_TANGENT\n\t\tvec3 tangent = normalize( vTangent );\n\t\tvec3 bitangent = normalize( vBitangent );\n\t\t#ifdef DOUBLE_SIDED\n\t\t\ttangent = tangent * faceDirection;\n\t\t\tbitangent = bitangent * faceDirection;\n\t\t#endif\n\t\t#if defined( TANGENTSPACE_NORMALMAP ) || defined( USE_CLEARCOAT_NORMALMAP )\n\t\t\tmat3 vTBN = mat3( tangent, bitangent, normal );\n\t\t#endif\n\t#endif\n#endif\nvec3 geometryNormal = normal;",normal_fragment_maps:"#ifdef OBJECTSPACE_NORMALMAP\n\tnormal = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\t#ifdef FLIP_SIDED\n\t\tnormal = - normal;\n\t#endif\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * faceDirection;\n\t#endif\n\tnormal = normalize( normalMatrix * normal );\n#elif defined( TANGENTSPACE_NORMALMAP )\n\tvec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\tmapN.xy *= normalScale;\n\t#ifdef USE_TANGENT\n\t\tnormal = normalize( vTBN * mapN );\n\t#else\n\t\tnormal = perturbNormal2Arb( - vViewPosition, normal, mapN, faceDirection );\n\t#endif\n#elif defined( USE_BUMPMAP )\n\tnormal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );\n#endif",normal_pars_fragment:"#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif",normal_pars_vertex:"#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif",normal_vertex:"#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n\t#ifdef USE_TANGENT\n\t\tvTangent = normalize( transformedTangent );\n\t\tvBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );\n\t#endif\n#endif",normalmap_pars_fragment:"#ifdef USE_NORMALMAP\n\tuniform sampler2D normalMap;\n\tuniform vec2 normalScale;\n#endif\n#ifdef OBJECTSPACE_NORMALMAP\n\tuniform mat3 normalMatrix;\n#endif\n#if ! defined ( USE_TANGENT ) && ( defined ( TANGENTSPACE_NORMALMAP ) || defined ( USE_CLEARCOAT_NORMALMAP ) )\n\tvec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm, vec3 mapN, float faceDirection ) {\n\t\tvec3 q0 = dFdx( eye_pos.xyz );\n\t\tvec3 q1 = dFdy( eye_pos.xyz );\n\t\tvec2 st0 = dFdx( vUv.st );\n\t\tvec2 st1 = dFdy( vUv.st );\n\t\tvec3 N = surf_norm;\n\t\tvec3 q1perp = cross( q1, N );\n\t\tvec3 q0perp = cross( N, q0 );\n\t\tvec3 T = q1perp * st0.x + q0perp * st1.x;\n\t\tvec3 B = q1perp * st0.y + q0perp * st1.y;\n\t\tfloat det = max( dot( T, T ), dot( B, B ) );\n\t\tfloat scale = ( det == 0.0 ) ? 0.0 : faceDirection * inversesqrt( det );\n\t\treturn normalize( T * ( mapN.x * scale ) + B * ( mapN.y * scale ) + N * mapN.z );\n\t}\n#endif",clearcoat_normal_fragment_begin:"#ifdef USE_CLEARCOAT\n\tvec3 clearcoatNormal = geometryNormal;\n#endif",clearcoat_normal_fragment_maps:"#ifdef USE_CLEARCOAT_NORMALMAP\n\tvec3 clearcoatMapN = texture2D( clearcoatNormalMap, vUv ).xyz * 2.0 - 1.0;\n\tclearcoatMapN.xy *= clearcoatNormalScale;\n\t#ifdef USE_TANGENT\n\t\tclearcoatNormal = normalize( vTBN * clearcoatMapN );\n\t#else\n\t\tclearcoatNormal = perturbNormal2Arb( - vViewPosition, clearcoatNormal, clearcoatMapN, faceDirection );\n\t#endif\n#endif",clearcoat_pars_fragment:"#ifdef USE_CLEARCOATMAP\n\tuniform sampler2D clearcoatMap;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tuniform sampler2D clearcoatRoughnessMap;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tuniform sampler2D clearcoatNormalMap;\n\tuniform vec2 clearcoatNormalScale;\n#endif",iridescence_pars_fragment:"#ifdef USE_IRIDESCENCEMAP\n\tuniform sampler2D iridescenceMap;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\tuniform sampler2D iridescenceThicknessMap;\n#endif",output_fragment:"#ifdef OPAQUE\ndiffuseColor.a = 1.0;\n#endif\n#ifdef USE_TRANSMISSION\ndiffuseColor.a *= material.transmissionAlpha + 0.1;\n#endif\ngl_FragColor = vec4( outgoingLight, diffuseColor.a );",packing:"vec3 packNormalToRGB( const in vec3 normal ) {\n\treturn normalize( normal ) * 0.5 + 0.5;\n}\nvec3 unpackRGBToNormal( const in vec3 rgb ) {\n\treturn 2.0 * rgb.xyz - 1.0;\n}\nconst float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;\nconst vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256., 256. );\nconst vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );\nconst float ShiftRight8 = 1. / 256.;\nvec4 packDepthToRGBA( const in float v ) {\n\tvec4 r = vec4( fract( v * PackFactors ), v );\n\tr.yzw -= r.xyz * ShiftRight8;\treturn r * PackUpscale;\n}\nfloat unpackRGBAToDepth( const in vec4 v ) {\n\treturn dot( v, UnpackFactors );\n}\nvec2 packDepthToRG( in highp float v ) {\n\treturn packDepthToRGBA( v ).yx;\n}\nfloat unpackRGToDepth( const in highp vec2 v ) {\n\treturn unpackRGBAToDepth( vec4( v.xy, 0.0, 0.0 ) );\n}\nvec4 pack2HalfToRGBA( vec2 v ) {\n\tvec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );\n\treturn vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );\n}\nvec2 unpackRGBATo2Half( vec4 v ) {\n\treturn vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );\n}\nfloat viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( viewZ + near ) / ( near - far );\n}\nfloat orthographicDepthToViewZ( const in float linearClipZ, const in float near, const in float far ) {\n\treturn linearClipZ * ( near - far ) - near;\n}\nfloat viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );\n}\nfloat perspectiveDepthToViewZ( const in float invClipZ, const in float near, const in float far ) {\n\treturn ( near * far ) / ( ( far - near ) * invClipZ - far );\n}",premultiplied_alpha_fragment:"#ifdef PREMULTIPLIED_ALPHA\n\tgl_FragColor.rgb *= gl_FragColor.a;\n#endif",project_vertex:"vec4 mvPosition = vec4( transformed, 1.0 );\n#ifdef USE_INSTANCING\n\tmvPosition = instanceMatrix * mvPosition;\n#endif\nmvPosition = modelViewMatrix * mvPosition;\ngl_Position = projectionMatrix * mvPosition;",dithering_fragment:"#ifdef DITHERING\n\tgl_FragColor.rgb = dithering( gl_FragColor.rgb );\n#endif",dithering_pars_fragment:"#ifdef DITHERING\n\tvec3 dithering( vec3 color ) {\n\t\tfloat grid_position = rand( gl_FragCoord.xy );\n\t\tvec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );\n\t\tdither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );\n\t\treturn color + dither_shift_RGB;\n\t}\n#endif",roughnessmap_fragment:"float roughnessFactor = roughness;\n#ifdef USE_ROUGHNESSMAP\n\tvec4 texelRoughness = texture2D( roughnessMap, vUv );\n\troughnessFactor *= texelRoughness.g;\n#endif",roughnessmap_pars_fragment:"#ifdef USE_ROUGHNESSMAP\n\tuniform sampler2D roughnessMap;\n#endif",shadowmap_pars_fragment:"#if NUM_SPOT_LIGHT_COORDS > 0\n  varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];\n#endif\n#if NUM_SPOT_LIGHT_MAPS > 0\n  uniform sampler2D spotLightMap[ NUM_SPOT_LIGHT_MAPS ];\n#endif\n#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n\tfloat texture2DCompare( sampler2D depths, vec2 uv, float compare ) {\n\t\treturn step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );\n\t}\n\tvec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {\n\t\treturn unpackRGBATo2Half( texture2D( shadow, uv ) );\n\t}\n\tfloat VSMShadow (sampler2D shadow, vec2 uv, float compare ){\n\t\tfloat occlusion = 1.0;\n\t\tvec2 distribution = texture2DDistribution( shadow, uv );\n\t\tfloat hard_shadow = step( compare , distribution.x );\n\t\tif (hard_shadow != 1.0 ) {\n\t\t\tfloat distance = compare - distribution.x ;\n\t\t\tfloat variance = max( 0.00000, distribution.y * distribution.y );\n\t\t\tfloat softness_probability = variance / (variance + distance * distance );\t\t\tsoftness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );\t\t\tocclusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );\n\t\t}\n\t\treturn occlusion;\n\t}\n\tfloat getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\n\t\tfloat shadow = 1.0;\n\t\tshadowCoord.xyz /= shadowCoord.w;\n\t\tshadowCoord.z += shadowBias;\n\t\tbvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );\n\t\tbool inFrustum = all( inFrustumVec );\n\t\tbvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );\n\t\tbool frustumTest = all( frustumTestVec );\n\t\tif ( frustumTest ) {\n\t\t#if defined( SHADOWMAP_TYPE_PCF )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx0 = - texelSize.x * shadowRadius;\n\t\t\tfloat dy0 = - texelSize.y * shadowRadius;\n\t\t\tfloat dx1 = + texelSize.x * shadowRadius;\n\t\t\tfloat dy1 = + texelSize.y * shadowRadius;\n\t\t\tfloat dx2 = dx0 / 2.0;\n\t\t\tfloat dy2 = dy0 / 2.0;\n\t\t\tfloat dx3 = dx1 / 2.0;\n\t\t\tfloat dy3 = dy1 / 2.0;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n\t\t\t) * ( 1.0 / 17.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_PCF_SOFT )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx = texelSize.x;\n\t\t\tfloat dy = texelSize.y;\n\t\t\tvec2 uv = shadowCoord.xy;\n\t\t\tvec2 f = fract( uv * shadowMapSize + 0.5 );\n\t\t\tuv -= f * texelSize;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, uv, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t f.y )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_VSM )\n\t\t\tshadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#else\n\t\t\tshadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#endif\n\t\t}\n\t\treturn shadow;\n\t}\n\tvec2 cubeToUV( vec3 v, float texelSizeY ) {\n\t\tvec3 absV = abs( v );\n\t\tfloat scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );\n\t\tabsV *= scaleToCube;\n\t\tv *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );\n\t\tvec2 planar = v.xy;\n\t\tfloat almostATexel = 1.5 * texelSizeY;\n\t\tfloat almostOne = 1.0 - almostATexel;\n\t\tif ( absV.z >= almostOne ) {\n\t\t\tif ( v.z > 0.0 )\n\t\t\t\tplanar.x = 4.0 - v.x;\n\t\t} else if ( absV.x >= almostOne ) {\n\t\t\tfloat signX = sign( v.x );\n\t\t\tplanar.x = v.z * signX + 2.0 * signX;\n\t\t} else if ( absV.y >= almostOne ) {\n\t\t\tfloat signY = sign( v.y );\n\t\t\tplanar.x = v.x + 2.0 * signY + 2.0;\n\t\t\tplanar.y = v.z * signY - 2.0;\n\t\t}\n\t\treturn vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );\n\t}\n\tfloat getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {\n\t\tvec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );\n\t\tvec3 lightToPosition = shadowCoord.xyz;\n\t\tfloat dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );\t\tdp += shadowBias;\n\t\tvec3 bd3D = normalize( lightToPosition );\n\t\t#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )\n\t\t\tvec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;\n\t\t\treturn (\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#else\n\t\t\treturn texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );\n\t\t#endif\n\t}\n#endif",shadowmap_pars_vertex:"#if NUM_SPOT_LIGHT_COORDS > 0\n  uniform mat4 spotLightMatrix[ NUM_SPOT_LIGHT_COORDS ];\n  varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];\n#endif\n#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n#endif",shadowmap_vertex:"#if defined( USE_SHADOWMAP ) || ( NUM_SPOT_LIGHT_COORDS > 0 )\n\t#if NUM_DIR_LIGHT_SHADOWS > 0 || NUM_SPOT_LIGHT_COORDS > 0 || NUM_POINT_LIGHT_SHADOWS > 0\n\t\tvec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\t\tvec4 shadowWorldPosition;\n\t#endif\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );\n\t\tvDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_SPOT_LIGHT_COORDS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_COORDS; i ++ ) {\n\t\tshadowWorldPosition = worldPosition;\n\t\t#if ( defined( USE_SHADOWMAP ) && UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\t\tshadowWorldPosition.xyz += shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias;\n\t\t#endif\n\t\tvSpotLightCoord[ i ] = spotLightMatrix[ i ] * shadowWorldPosition;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );\n\t\tvPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n#endif",shadowmask_pars_fragment:"float getShadowMask() {\n\tfloat shadow = 1.0;\n\t#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\tdirectionalLight = directionalLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {\n\t\tspotLight = spotLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\tpointLight = pointLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#endif\n\treturn shadow;\n}",skinbase_vertex:"#ifdef USE_SKINNING\n\tmat4 boneMatX = getBoneMatrix( skinIndex.x );\n\tmat4 boneMatY = getBoneMatrix( skinIndex.y );\n\tmat4 boneMatZ = getBoneMatrix( skinIndex.z );\n\tmat4 boneMatW = getBoneMatrix( skinIndex.w );\n#endif",skinning_pars_vertex:"#ifdef USE_SKINNING\n\tuniform mat4 bindMatrix;\n\tuniform mat4 bindMatrixInverse;\n\tuniform highp sampler2D boneTexture;\n\tuniform int boneTextureSize;\n\tmat4 getBoneMatrix( const in float i ) {\n\t\tfloat j = i * 4.0;\n\t\tfloat x = mod( j, float( boneTextureSize ) );\n\t\tfloat y = floor( j / float( boneTextureSize ) );\n\t\tfloat dx = 1.0 / float( boneTextureSize );\n\t\tfloat dy = 1.0 / float( boneTextureSize );\n\t\ty = dy * ( y + 0.5 );\n\t\tvec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );\n\t\tvec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );\n\t\tvec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );\n\t\tvec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );\n\t\tmat4 bone = mat4( v1, v2, v3, v4 );\n\t\treturn bone;\n\t}\n#endif",skinning_vertex:"#ifdef USE_SKINNING\n\tvec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );\n\tvec4 skinned = vec4( 0.0 );\n\tskinned += boneMatX * skinVertex * skinWeight.x;\n\tskinned += boneMatY * skinVertex * skinWeight.y;\n\tskinned += boneMatZ * skinVertex * skinWeight.z;\n\tskinned += boneMatW * skinVertex * skinWeight.w;\n\ttransformed = ( bindMatrixInverse * skinned ).xyz;\n#endif",skinnormal_vertex:"#ifdef USE_SKINNING\n\tmat4 skinMatrix = mat4( 0.0 );\n\tskinMatrix += skinWeight.x * boneMatX;\n\tskinMatrix += skinWeight.y * boneMatY;\n\tskinMatrix += skinWeight.z * boneMatZ;\n\tskinMatrix += skinWeight.w * boneMatW;\n\tskinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;\n\tobjectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;\n\t#ifdef USE_TANGENT\n\t\tobjectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\t#endif\n#endif",specularmap_fragment:"float specularStrength;\n#ifdef USE_SPECULARMAP\n\tvec4 texelSpecular = texture2D( specularMap, vUv );\n\tspecularStrength = texelSpecular.r;\n#else\n\tspecularStrength = 1.0;\n#endif",specularmap_pars_fragment:"#ifdef USE_SPECULARMAP\n\tuniform sampler2D specularMap;\n#endif",tonemapping_fragment:"#if defined( TONE_MAPPING )\n\tgl_FragColor.rgb = toneMapping( gl_FragColor.rgb );\n#endif",tonemapping_pars_fragment:"#ifndef saturate\n#define saturate( a ) clamp( a, 0.0, 1.0 )\n#endif\nuniform float toneMappingExposure;\nvec3 LinearToneMapping( vec3 color ) {\n\treturn toneMappingExposure * color;\n}\nvec3 ReinhardToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\treturn saturate( color / ( vec3( 1.0 ) + color ) );\n}\nvec3 OptimizedCineonToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\tcolor = max( vec3( 0.0 ), color - 0.004 );\n\treturn pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );\n}\nvec3 RRTAndODTFit( vec3 v ) {\n\tvec3 a = v * ( v + 0.0245786 ) - 0.000090537;\n\tvec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;\n\treturn a / b;\n}\nvec3 ACESFilmicToneMapping( vec3 color ) {\n\tconst mat3 ACESInputMat = mat3(\n\t\tvec3( 0.59719, 0.07600, 0.02840 ),\t\tvec3( 0.35458, 0.90834, 0.13383 ),\n\t\tvec3( 0.04823, 0.01566, 0.83777 )\n\t);\n\tconst mat3 ACESOutputMat = mat3(\n\t\tvec3(  1.60475, -0.10208, -0.00327 ),\t\tvec3( -0.53108,  1.10813, -0.07276 ),\n\t\tvec3( -0.07367, -0.00605,  1.07602 )\n\t);\n\tcolor *= toneMappingExposure / 0.6;\n\tcolor = ACESInputMat * color;\n\tcolor = RRTAndODTFit( color );\n\tcolor = ACESOutputMat * color;\n\treturn saturate( color );\n}\nvec3 CustomToneMapping( vec3 color ) { return color; }",transmission_fragment:"#ifdef USE_TRANSMISSION\n\tmaterial.transmission = transmission;\n\tmaterial.transmissionAlpha = 1.0;\n\tmaterial.thickness = thickness;\n\tmaterial.attenuationDistance = attenuationDistance;\n\tmaterial.attenuationColor = attenuationColor;\n\t#ifdef USE_TRANSMISSIONMAP\n\t\tmaterial.transmission *= texture2D( transmissionMap, vUv ).r;\n\t#endif\n\t#ifdef USE_THICKNESSMAP\n\t\tmaterial.thickness *= texture2D( thicknessMap, vUv ).g;\n\t#endif\n\tvec3 pos = vWorldPosition;\n\tvec3 v = normalize( cameraPosition - pos );\n\tvec3 n = inverseTransformDirection( normal, viewMatrix );\n\tvec4 transmission = getIBLVolumeRefraction(\n\t\tn, v, material.roughness, material.diffuseColor, material.specularColor, material.specularF90,\n\t\tpos, modelMatrix, viewMatrix, projectionMatrix, material.ior, material.thickness,\n\t\tmaterial.attenuationColor, material.attenuationDistance );\n\tmaterial.transmissionAlpha = mix( material.transmissionAlpha, transmission.a, material.transmission );\n\ttotalDiffuse = mix( totalDiffuse, transmission.rgb, material.transmission );\n#endif",transmission_pars_fragment:"#ifdef USE_TRANSMISSION\n\tuniform float transmission;\n\tuniform float thickness;\n\tuniform float attenuationDistance;\n\tuniform vec3 attenuationColor;\n\t#ifdef USE_TRANSMISSIONMAP\n\t\tuniform sampler2D transmissionMap;\n\t#endif\n\t#ifdef USE_THICKNESSMAP\n\t\tuniform sampler2D thicknessMap;\n\t#endif\n\tuniform vec2 transmissionSamplerSize;\n\tuniform sampler2D transmissionSamplerMap;\n\tuniform mat4 modelMatrix;\n\tuniform mat4 projectionMatrix;\n\tvarying vec3 vWorldPosition;\n\tvec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {\n\t\tvec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );\n\t\tvec3 modelScale;\n\t\tmodelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );\n\t\tmodelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );\n\t\tmodelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );\n\t\treturn normalize( refractionVector ) * thickness * modelScale;\n\t}\n\tfloat applyIorToRoughness( const in float roughness, const in float ior ) {\n\t\treturn roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );\n\t}\n\tvec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {\n\t\tfloat framebufferLod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );\n\t\t#ifdef texture2DLodEXT\n\t\t\treturn texture2DLodEXT( transmissionSamplerMap, fragCoord.xy, framebufferLod );\n\t\t#else\n\t\t\treturn texture2D( transmissionSamplerMap, fragCoord.xy, framebufferLod );\n\t\t#endif\n\t}\n\tvec3 applyVolumeAttenuation( const in vec3 radiance, const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {\n\t\tif ( isinf( attenuationDistance ) ) {\n\t\t\treturn radiance;\n\t\t} else {\n\t\t\tvec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;\n\t\t\tvec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );\t\t\treturn transmittance * radiance;\n\t\t}\n\t}\n\tvec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,\n\t\tconst in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,\n\t\tconst in mat4 viewMatrix, const in mat4 projMatrix, const in float ior, const in float thickness,\n\t\tconst in vec3 attenuationColor, const in float attenuationDistance ) {\n\t\tvec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );\n\t\tvec3 refractedRayExit = position + transmissionRay;\n\t\tvec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );\n\t\tvec2 refractionCoords = ndcPos.xy / ndcPos.w;\n\t\trefractionCoords += 1.0;\n\t\trefractionCoords /= 2.0;\n\t\tvec4 transmittedLight = getTransmissionSample( refractionCoords, roughness, ior );\n\t\tvec3 attenuatedColor = applyVolumeAttenuation( transmittedLight.rgb, length( transmissionRay ), attenuationColor, attenuationDistance );\n\t\tvec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );\n\t\treturn vec4( ( 1.0 - F ) * attenuatedColor * diffuseColor, transmittedLight.a );\n\t}\n#endif",uv_pars_fragment:"#if ( defined( USE_UV ) && ! defined( UVS_VERTEX_ONLY ) )\n\tvarying vec2 vUv;\n#endif",uv_pars_vertex:"#ifdef USE_UV\n\t#ifdef UVS_VERTEX_ONLY\n\t\tvec2 vUv;\n\t#else\n\t\tvarying vec2 vUv;\n\t#endif\n\tuniform mat3 uvTransform;\n#endif",uv_vertex:"#ifdef USE_UV\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n#endif",uv2_pars_fragment:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvarying vec2 vUv2;\n#endif",uv2_pars_vertex:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tattribute vec2 uv2;\n\tvarying vec2 vUv2;\n\tuniform mat3 uv2Transform;\n#endif",uv2_vertex:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvUv2 = ( uv2Transform * vec3( uv2, 1 ) ).xy;\n#endif",worldpos_vertex:"#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION ) || NUM_SPOT_LIGHT_COORDS > 0\n\tvec4 worldPosition = vec4( transformed, 1.0 );\n\t#ifdef USE_INSTANCING\n\t\tworldPosition = instanceMatrix * worldPosition;\n\t#endif\n\tworldPosition = modelMatrix * worldPosition;\n#endif",background_vert:"varying vec2 vUv;\nuniform mat3 uvTransform;\nvoid main() {\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n\tgl_Position = vec4( position.xy, 1.0, 1.0 );\n}",background_frag:"uniform sampler2D t2D;\nvarying vec2 vUv;\nvoid main() {\n\tgl_FragColor = texture2D( t2D, vUv );\n\t#ifdef DECODE_VIDEO_TEXTURE\n\t\tgl_FragColor = vec4( mix( pow( gl_FragColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), gl_FragColor.rgb * 0.0773993808, vec3( lessThanEqual( gl_FragColor.rgb, vec3( 0.04045 ) ) ) ), gl_FragColor.w );\n\t#endif\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",backgroundCube_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\tgl_Position.z = gl_Position.w;\n}",backgroundCube_frag:"#ifdef ENVMAP_TYPE_CUBE\n\tuniform samplerCube envMap;\n#elif defined( ENVMAP_TYPE_CUBE_UV )\n\tuniform sampler2D envMap;\n#endif\nuniform float flipEnvMap;\nuniform float backgroundBlurriness;\nvarying vec3 vWorldDirection;\n#include <cube_uv_reflection_fragment>\nvoid main() {\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 texColor = textureCube( envMap, vec3( flipEnvMap * vWorldDirection.x, vWorldDirection.yz ) );\n\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\tvec4 texColor = textureCubeUV( envMap, vWorldDirection, backgroundBlurriness );\n\t#else\n\t\tvec4 texColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n\t#endif\n\tgl_FragColor = texColor;\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",cube_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\tgl_Position.z = gl_Position.w;\n}",cube_frag:"uniform samplerCube tCube;\nuniform float tFlip;\nuniform float opacity;\nvarying vec3 vWorldDirection;\nvoid main() {\n\tvec4 texColor = textureCube( tCube, vec3( tFlip * vWorldDirection.x, vWorldDirection.yz ) );\n\tgl_FragColor = texColor;\n\tgl_FragColor.a *= opacity;\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",depth_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvHighPrecisionZW = gl_Position.zw;\n}",depth_frag:"#if DEPTH_PACKING == 3200\n\tuniform float opacity;\n#endif\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#if DEPTH_PACKING == 3200\n\t\tdiffuseColor.a = opacity;\n\t#endif\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <logdepthbuf_fragment>\n\tfloat fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;\n\t#if DEPTH_PACKING == 3200\n\t\tgl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );\n\t#elif DEPTH_PACKING == 3201\n\t\tgl_FragColor = packDepthToRGBA( fragCoordZ );\n\t#endif\n}",distanceRGBA_vert:"#define DISTANCE\nvarying vec3 vWorldPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\tvWorldPosition = worldPosition.xyz;\n}",distanceRGBA_frag:"#define DISTANCE\nuniform vec3 referencePosition;\nuniform float nearDistance;\nuniform float farDistance;\nvarying vec3 vWorldPosition;\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main () {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\tfloat dist = length( vWorldPosition - referencePosition );\n\tdist = ( dist - nearDistance ) / ( farDistance - nearDistance );\n\tdist = saturate( dist );\n\tgl_FragColor = packDepthToRGBA( dist );\n}",equirect_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n}",equirect_frag:"uniform sampler2D tEquirect;\nvarying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvec3 direction = normalize( vWorldDirection );\n\tvec2 sampleUV = equirectUv( direction );\n\tgl_FragColor = texture2D( tEquirect, sampleUV );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",linedashed_vert:"uniform float scale;\nattribute float lineDistance;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\tvLineDistance = scale * lineDistance;\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}",linedashed_frag:"uniform vec3 diffuse;\nuniform float opacity;\nuniform float dashSize;\nuniform float totalSize;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tif ( mod( vLineDistance, totalSize ) > dashSize ) {\n\t\tdiscard;\n\t}\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <color_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",meshbasic_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinbase_vertex>\n\t\t#include <skinnormal_vertex>\n\t\t#include <defaultnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <fog_vertex>\n}",meshbasic_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\t#ifdef USE_LIGHTMAP\n\t\tvec4 lightMapTexel = texture2D( lightMap, vUv2 );\n\t\treflectedLight.indirectDiffuse += lightMapTexel.rgb * lightMapIntensity * RECIPROCAL_PI;\n\t#else\n\t\treflectedLight.indirectDiffuse += vec3( 1.0 );\n\t#endif\n\t#include <aomap_fragment>\n\treflectedLight.indirectDiffuse *= diffuseColor.rgb;\n\tvec3 outgoingLight = reflectedLight.indirectDiffuse;\n\t#include <envmap_fragment>\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshlambert_vert:"#define LAMBERT\nvarying vec3 vViewPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshlambert_frag:"#define LAMBERT\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_lambert_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_lambert_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshmatcap_vert:"#define MATCAP\nvarying vec3 vViewPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <color_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n\tvViewPosition = - mvPosition.xyz;\n}",meshmatcap_frag:"#define MATCAP\nuniform vec3 diffuse;\nuniform float opacity;\nuniform sampler2D matcap;\nvarying vec3 vViewPosition;\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <fog_pars_fragment>\n#include <normal_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tvec3 viewDir = normalize( vViewPosition );\n\tvec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );\n\tvec3 y = cross( viewDir, x );\n\tvec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;\n\t#ifdef USE_MATCAP\n\t\tvec4 matcapColor = texture2D( matcap, uv );\n\t#else\n\t\tvec4 matcapColor = vec4( vec3( mix( 0.2, 0.8, uv.y ) ), 1.0 );\n\t#endif\n\tvec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshnormal_vert:"#define NORMAL\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvarying vec3 vViewPosition;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvViewPosition = - mvPosition.xyz;\n#endif\n}",meshnormal_frag:"#define NORMAL\nuniform float opacity;\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvarying vec3 vViewPosition;\n#endif\n#include <packing>\n#include <uv_pars_fragment>\n#include <normal_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\t#include <logdepthbuf_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tgl_FragColor = vec4( packNormalToRGB( normal ), opacity );\n\t#ifdef OPAQUE\n\t\tgl_FragColor.a = 1.0;\n\t#endif\n}",meshphong_vert:"#define PHONG\nvarying vec3 vViewPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshphong_frag:"#define PHONG\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform vec3 specular;\nuniform float shininess;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_phong_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_phong_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshphysical_vert:"#define STANDARD\nvarying vec3 vViewPosition;\n#ifdef USE_TRANSMISSION\n\tvarying vec3 vWorldPosition;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n#ifdef USE_TRANSMISSION\n\tvWorldPosition = worldPosition.xyz;\n#endif\n}",meshphysical_frag:"#define STANDARD\n#ifdef PHYSICAL\n\t#define IOR\n\t#define SPECULAR\n#endif\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float roughness;\nuniform float metalness;\nuniform float opacity;\n#ifdef IOR\n\tuniform float ior;\n#endif\n#ifdef SPECULAR\n\tuniform float specularIntensity;\n\tuniform vec3 specularColor;\n\t#ifdef USE_SPECULARINTENSITYMAP\n\t\tuniform sampler2D specularIntensityMap;\n\t#endif\n\t#ifdef USE_SPECULARCOLORMAP\n\t\tuniform sampler2D specularColorMap;\n\t#endif\n#endif\n#ifdef USE_CLEARCOAT\n\tuniform float clearcoat;\n\tuniform float clearcoatRoughness;\n#endif\n#ifdef USE_IRIDESCENCE\n\tuniform float iridescence;\n\tuniform float iridescenceIOR;\n\tuniform float iridescenceThicknessMinimum;\n\tuniform float iridescenceThicknessMaximum;\n#endif\n#ifdef USE_SHEEN\n\tuniform vec3 sheenColor;\n\tuniform float sheenRoughness;\n\t#ifdef USE_SHEENCOLORMAP\n\t\tuniform sampler2D sheenColorMap;\n\t#endif\n\t#ifdef USE_SHEENROUGHNESSMAP\n\t\tuniform sampler2D sheenRoughnessMap;\n\t#endif\n#endif\nvarying vec3 vViewPosition;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <bsdfs>\n#include <iridescence_fragment>\n#include <cube_uv_reflection_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_physical_pars_fragment>\n#include <fog_pars_fragment>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_physical_pars_fragment>\n#include <transmission_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <clearcoat_pars_fragment>\n#include <iridescence_pars_fragment>\n#include <roughnessmap_pars_fragment>\n#include <metalnessmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <roughnessmap_fragment>\n\t#include <metalnessmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <clearcoat_normal_fragment_begin>\n\t#include <clearcoat_normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_physical_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;\n\tvec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;\n\t#include <transmission_fragment>\n\tvec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;\n\t#ifdef USE_SHEEN\n\t\tfloat sheenEnergyComp = 1.0 - 0.157 * max3( material.sheenColor );\n\t\toutgoingLight = outgoingLight * sheenEnergyComp + sheenSpecular;\n\t#endif\n\t#ifdef USE_CLEARCOAT\n\t\tfloat dotNVcc = saturate( dot( geometry.clearcoatNormal, geometry.viewDir ) );\n\t\tvec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );\n\t\toutgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + clearcoatSpecular * material.clearcoat;\n\t#endif\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshtoon_vert:"#define TOON\nvarying vec3 vViewPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshtoon_frag:"#define TOON\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <gradientmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_toon_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_toon_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",points_vert:"uniform float size;\nuniform float scale;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\tgl_PointSize = size;\n\t#ifdef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );\n\t#endif\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <fog_vertex>\n}",points_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <color_pars_fragment>\n#include <map_particle_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_particle_fragment>\n\t#include <color_fragment>\n\t#include <alphatest_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",shadow_vert:"#include <common>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\nvoid main() {\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",shadow_frag:"uniform vec3 color;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\nvoid main() {\n\tgl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}",sprite_vert:"uniform float rotation;\nuniform vec2 center;\n#include <common>\n#include <uv_pars_vertex>\n#include <fog_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\tvec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );\n\tvec2 scale;\n\tscale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );\n\tscale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );\n\t#ifndef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) scale *= - mvPosition.z;\n\t#endif\n\tvec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;\n\tvec2 rotatedPosition;\n\trotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;\n\trotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;\n\tmvPosition.xy += rotatedPosition;\n\tgl_Position = projectionMatrix * mvPosition;\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}",sprite_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}"},ve={common:{diffuse:{value:new Ie(16777215)},opacity:{value:1},map:{value:null},uvTransform:{value:new Wn},uv2Transform:{value:new Wn},alphaMap:{value:null},alphaTest:{value:0}},specularmap:{specularMap:{value:null}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1}},emissivemap:{emissiveMap:{value:null}},bumpmap:{bumpMap:{value:null},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalScale:{value:new ee(1,1)}},displacementmap:{displacementMap:{value:null},displacementScale:{value:1},displacementBias:{value:0}},roughnessmap:{roughnessMap:{value:null}},metalnessmap:{metalnessMap:{value:null}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new Ie(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotLightMap:{value:[]},spotShadowMap:{value:[]},spotLightMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new Ie(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaTest:{value:0},uvTransform:{value:new Wn}},sprite:{diffuse:{value:new Ie(16777215)},opacity:{value:1},center:{value:new ee(.5,.5)},rotation:{value:0},map:{value:null},alphaMap:{value:null},alphaTest:{value:0},uvTransform:{value:new Wn}}},ws={basic:{uniforms:Pi([ve.common,ve.specularmap,ve.envmap,ve.aomap,ve.lightmap,ve.fog]),vertexShader:vt.meshbasic_vert,fragmentShader:vt.meshbasic_frag},lambert:{uniforms:Pi([ve.common,ve.specularmap,ve.envmap,ve.aomap,ve.lightmap,ve.emissivemap,ve.bumpmap,ve.normalmap,ve.displacementmap,ve.fog,ve.lights,{emissive:{value:new Ie(0)}}]),vertexShader:vt.meshlambert_vert,fragmentShader:vt.meshlambert_frag},phong:{uniforms:Pi([ve.common,ve.specularmap,ve.envmap,ve.aomap,ve.lightmap,ve.emissivemap,ve.bumpmap,ve.normalmap,ve.displacementmap,ve.fog,ve.lights,{emissive:{value:new Ie(0)},specular:{value:new Ie(1118481)},shininess:{value:30}}]),vertexShader:vt.meshphong_vert,fragmentShader:vt.meshphong_frag},standard:{uniforms:Pi([ve.common,ve.envmap,ve.aomap,ve.lightmap,ve.emissivemap,ve.bumpmap,ve.normalmap,ve.displacementmap,ve.roughnessmap,ve.metalnessmap,ve.fog,ve.lights,{emissive:{value:new Ie(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:vt.meshphysical_vert,fragmentShader:vt.meshphysical_frag},toon:{uniforms:Pi([ve.common,ve.aomap,ve.lightmap,ve.emissivemap,ve.bumpmap,ve.normalmap,ve.displacementmap,ve.gradientmap,ve.fog,ve.lights,{emissive:{value:new Ie(0)}}]),vertexShader:vt.meshtoon_vert,fragmentShader:vt.meshtoon_frag},matcap:{uniforms:Pi([ve.common,ve.bumpmap,ve.normalmap,ve.displacementmap,ve.fog,{matcap:{value:null}}]),vertexShader:vt.meshmatcap_vert,fragmentShader:vt.meshmatcap_frag},points:{uniforms:Pi([ve.points,ve.fog]),vertexShader:vt.points_vert,fragmentShader:vt.points_frag},dashed:{uniforms:Pi([ve.common,ve.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:vt.linedashed_vert,fragmentShader:vt.linedashed_frag},depth:{uniforms:Pi([ve.common,ve.displacementmap]),vertexShader:vt.depth_vert,fragmentShader:vt.depth_frag},normal:{uniforms:Pi([ve.common,ve.bumpmap,ve.normalmap,ve.displacementmap,{opacity:{value:1}}]),vertexShader:vt.meshnormal_vert,fragmentShader:vt.meshnormal_frag},sprite:{uniforms:Pi([ve.sprite,ve.fog]),vertexShader:vt.sprite_vert,fragmentShader:vt.sprite_frag},background:{uniforms:{uvTransform:{value:new Wn},t2D:{value:null}},vertexShader:vt.background_vert,fragmentShader:vt.background_frag},backgroundCube:{uniforms:{envMap:{value:null},flipEnvMap:{value:-1},backgroundBlurriness:{value:0}},vertexShader:vt.backgroundCube_vert,fragmentShader:vt.backgroundCube_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:vt.cube_vert,fragmentShader:vt.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:vt.equirect_vert,fragmentShader:vt.equirect_frag},distanceRGBA:{uniforms:Pi([ve.common,ve.displacementmap,{referencePosition:{value:new S},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:vt.distanceRGBA_vert,fragmentShader:vt.distanceRGBA_frag},shadow:{uniforms:Pi([ve.lights,ve.fog,{color:{value:new Ie(0)},opacity:{value:1}}]),vertexShader:vt.shadow_vert,fragmentShader:vt.shadow_frag}};function zY(n,e,t,i,r,s,o){const a=new Ie(0);let l,u,c=!0===s?0:1,h=null,d=0,f=null;function m(g,_){i.buffers.color.setClear(g.r,g.g,g.b,_,o)}return{getClearColor:function(){return a},setClearColor:function(g,_=1){a.set(g),c=_,m(a,c)},getClearAlpha:function(){return c},setClearAlpha:function(g){c=g,m(a,c)},render:function p(g,_){let b=!1,y=!0===_.isScene?_.background:null;y&&y.isTexture&&(y=(_.backgroundBlurriness>0?t:e).get(y));const v=n.xr,w=v.getSession&&v.getSession();w&&"additive"===w.environmentBlendMode&&(y=null),null===y?m(a,c):y&&y.isColor&&(m(y,1),b=!0),(n.autoClear||b)&&n.clear(n.autoClearColor,n.autoClearDepth,n.autoClearStencil),y&&(y.isCubeTexture||306===y.mapping)?(void 0===u&&(u=new Qn(new Ql(1,1,1),new xs({name:"BackgroundCubeMaterial",uniforms:eu(ws.backgroundCube.uniforms),vertexShader:ws.backgroundCube.vertexShader,fragmentShader:ws.backgroundCube.fragmentShader,side:1,depthTest:!1,depthWrite:!1,fog:!1})),u.geometry.deleteAttribute("normal"),u.geometry.deleteAttribute("uv"),u.onBeforeRender=function(M,I,x){this.matrixWorld.copyPosition(x.matrixWorld)},Object.defineProperty(u.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),r.update(u)),u.material.uniforms.envMap.value=y,u.material.uniforms.flipEnvMap.value=y.isCubeTexture&&!1===y.isRenderTargetTexture?-1:1,u.material.uniforms.backgroundBlurriness.value=_.backgroundBlurriness,(h!==y||d!==y.version||f!==n.toneMapping)&&(u.material.needsUpdate=!0,h=y,d=y.version,f=n.toneMapping),u.layers.enableAll(),g.unshift(u,u.geometry,u.material,0,0,null)):y&&y.isTexture&&(void 0===l&&(l=new Qn(new dd(2,2),new xs({name:"BackgroundMaterial",uniforms:eu(ws.background.uniforms),vertexShader:ws.background.vertexShader,fragmentShader:ws.background.fragmentShader,side:0,depthTest:!1,depthWrite:!1,fog:!1})),l.geometry.deleteAttribute("normal"),Object.defineProperty(l.material,"map",{get:function(){return this.uniforms.t2D.value}}),r.update(l)),l.material.uniforms.t2D.value=y,!0===y.matrixAutoUpdate&&y.updateMatrix(),l.material.uniforms.uvTransform.value.copy(y.matrix),(h!==y||d!==y.version||f!==n.toneMapping)&&(l.material.needsUpdate=!0,h=y,d=y.version,f=n.toneMapping),l.layers.enableAll(),g.unshift(l,l.geometry,l.material,0,0,null))}}}function HY(n,e,t,i){const r=n.getParameter(34921),s=i.isWebGL2?null:e.get("OES_vertex_array_object"),o=i.isWebGL2||null!==s,a={},c=g(null);let l=c,u=!1;function f(N){return i.isWebGL2?n.bindVertexArray(N):s.bindVertexArrayOES(N)}function p(N){return i.isWebGL2?n.deleteVertexArray(N):s.deleteVertexArrayOES(N)}function g(N){const X=[],L=[],G=[];for(let F=0;F<r;F++)X[F]=0,L[F]=0,G[F]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:X,enabledAttributes:L,attributeDivisors:G,object:N,attributes:{},index:null}}function y(){const N=l.newAttributes;for(let X=0,L=N.length;X<L;X++)N[X]=0}function v(N){w(N,0)}function w(N,X){const G=l.enabledAttributes,F=l.attributeDivisors;l.newAttributes[N]=1,0===G[N]&&(n.enableVertexAttribArray(N),G[N]=1),F[N]!==X&&((i.isWebGL2?n:e.get("ANGLE_instanced_arrays"))[i.isWebGL2?"vertexAttribDivisor":"vertexAttribDivisorANGLE"](N,X),F[N]=X)}function M(){const N=l.newAttributes,X=l.enabledAttributes;for(let L=0,G=X.length;L<G;L++)X[L]!==N[L]&&(n.disableVertexAttribArray(L),X[L]=0)}function I(N,X,L,G,F,O){!0!==i.isWebGL2||5124!==L&&5125!==L?n.vertexAttribPointer(N,X,L,G,F,O):n.vertexAttribIPointer(N,X,L,F,O)}function se(){H(),u=!0,l!==c&&(l=c,f(l.object))}function H(){c.geometry=null,c.program=null,c.wireframe=!1}return{setup:function h(N,X,L,G,F){let O=!1;if(o){const V=function m(N,X,L){const G=!0===L.wireframe;let F=a[N.id];void 0===F&&(F={},a[N.id]=F);let O=F[X.id];void 0===O&&(O={},F[X.id]=O);let V=O[G];return void 0===V&&(V=g(function d(){return i.isWebGL2?n.createVertexArray():s.createVertexArrayOES()}()),O[G]=V),V}(G,L,X);l!==V&&(l=V,f(l.object)),O=function _(N,X,L,G){const F=l.attributes,O=X.attributes;let V=0;const ce=L.getAttributes();for(const re in ce)if(ce[re].location>=0){const pe=F[re];let We=O[re];if(void 0===We&&("instanceMatrix"===re&&N.instanceMatrix&&(We=N.instanceMatrix),"instanceColor"===re&&N.instanceColor&&(We=N.instanceColor)),void 0===pe||pe.attribute!==We||We&&pe.data!==We.data)return!0;V++}return l.attributesNum!==V||l.index!==G}(N,G,L,F),O&&function b(N,X,L,G){const F={},O=X.attributes;let V=0;const ce=L.getAttributes();for(const re in ce)if(ce[re].location>=0){let pe=O[re];void 0===pe&&("instanceMatrix"===re&&N.instanceMatrix&&(pe=N.instanceMatrix),"instanceColor"===re&&N.instanceColor&&(pe=N.instanceColor));const We={};We.attribute=pe,pe&&pe.data&&(We.data=pe.data),F[re]=We,V++}l.attributes=F,l.attributesNum=V,l.index=G}(N,G,L,F)}else{const V=!0===X.wireframe;(l.geometry!==G.id||l.program!==L.id||l.wireframe!==V)&&(l.geometry=G.id,l.program=L.id,l.wireframe=V,O=!0)}null!==F&&t.update(F,34963),(O||u)&&(u=!1,function x(N,X,L,G){if(!1===i.isWebGL2&&(N.isInstancedMesh||G.isInstancedBufferGeometry)&&null===e.get("ANGLE_instanced_arrays"))return;y();const F=G.attributes,O=L.getAttributes(),V=X.defaultAttributeValues;for(const ce in O){const re=O[ce];if(re.location>=0){let fe=F[ce];if(void 0===fe&&("instanceMatrix"===ce&&N.instanceMatrix&&(fe=N.instanceMatrix),"instanceColor"===ce&&N.instanceColor&&(fe=N.instanceColor)),void 0!==fe){const pe=fe.normalized,We=fe.itemSize,te=t.get(fe);if(void 0===te)continue;const Be=te.buffer,Fe=te.type,Le=te.bytesPerElement;if(fe.isInterleavedBufferAttribute){const ye=fe.data,ut=ye.stride,oe=fe.offset;if(ye.isInstancedInterleavedBuffer){for(let ne=0;ne<re.locationSize;ne++)w(re.location+ne,ye.meshPerAttribute);!0!==N.isInstancedMesh&&void 0===G._maxInstanceCount&&(G._maxInstanceCount=ye.meshPerAttribute*ye.count)}else for(let ne=0;ne<re.locationSize;ne++)v(re.location+ne);n.bindBuffer(34962,Be);for(let ne=0;ne<re.locationSize;ne++)I(re.location+ne,We/re.locationSize,Fe,pe,ut*Le,(oe+We/re.locationSize*ne)*Le)}else{if(fe.isInstancedBufferAttribute){for(let ye=0;ye<re.locationSize;ye++)w(re.location+ye,fe.meshPerAttribute);!0!==N.isInstancedMesh&&void 0===G._maxInstanceCount&&(G._maxInstanceCount=fe.meshPerAttribute*fe.count)}else for(let ye=0;ye<re.locationSize;ye++)v(re.location+ye);n.bindBuffer(34962,Be);for(let ye=0;ye<re.locationSize;ye++)I(re.location+ye,We/re.locationSize,Fe,pe,We*Le,We/re.locationSize*ye*Le)}}else if(void 0!==V){const pe=V[ce];if(void 0!==pe)switch(pe.length){case 2:n.vertexAttrib2fv(re.location,pe);break;case 3:n.vertexAttrib3fv(re.location,pe);break;case 4:n.vertexAttrib4fv(re.location,pe);break;default:n.vertexAttrib1fv(re.location,pe)}}}}M()}(N,X,L,G),null!==F&&n.bindBuffer(34963,t.get(F).buffer))},reset:se,resetDefaultState:H,dispose:function E(){se();for(const N in a){const X=a[N];for(const L in X){const G=X[L];for(const F in G)p(G[F].object),delete G[F];delete X[L]}delete a[N]}},releaseStatesOfGeometry:function R(N){if(void 0===a[N.id])return;const X=a[N.id];for(const L in X){const G=X[L];for(const F in G)p(G[F].object),delete G[F];delete X[L]}delete a[N.id]},releaseStatesOfProgram:function $(N){for(const X in a){const L=a[X];if(void 0===L[N.id])continue;const G=L[N.id];for(const F in G)p(G[F].object),delete G[F];delete L[N.id]}},initAttributes:y,enableAttribute:v,disableUnusedAttributes:M}}function GY(n,e,t,i){const r=i.isWebGL2;let s;this.setMode=function o(l){s=l},this.render=function a(l,u){n.drawArrays(s,l,u),t.update(u,s,1)},this.renderInstances=function c(l,u,h){if(0===h)return;let d,f;if(r)d=n,f="drawArraysInstanced";else if(d=e.get("ANGLE_instanced_arrays"),f="drawArraysInstancedANGLE",null===d)return void console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");d[f](s,l,u,h),t.update(u,s,h)}}function jY(n,e,t){let i;function s(I){if("highp"===I){if(n.getShaderPrecisionFormat(35633,36338).precision>0&&n.getShaderPrecisionFormat(35632,36338).precision>0)return"highp";I="mediump"}return"mediump"===I&&n.getShaderPrecisionFormat(35633,36337).precision>0&&n.getShaderPrecisionFormat(35632,36337).precision>0?"mediump":"lowp"}const o=typeof WebGL2RenderingContext<"u"&&n instanceof WebGL2RenderingContext||typeof WebGL2ComputeRenderingContext<"u"&&n instanceof WebGL2ComputeRenderingContext;let a=void 0!==t.precision?t.precision:"highp";const c=s(a);c!==a&&(console.warn("THREE.WebGLRenderer:",a,"not supported, using",c,"instead."),a=c);const l=o||e.has("WEBGL_draw_buffers"),u=!0===t.logarithmicDepthBuffer,h=n.getParameter(34930),d=n.getParameter(35660),f=n.getParameter(3379),p=n.getParameter(34076),m=n.getParameter(34921),g=n.getParameter(36347),_=n.getParameter(36348),b=n.getParameter(36349),y=d>0,v=o||e.has("OES_texture_float");return{isWebGL2:o,drawBuffers:l,getMaxAnisotropy:function r(){if(void 0!==i)return i;if(!0===e.has("EXT_texture_filter_anisotropic")){const I=e.get("EXT_texture_filter_anisotropic");i=n.getParameter(I.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else i=0;return i},getMaxPrecision:s,precision:a,logarithmicDepthBuffer:u,maxTextures:h,maxVertexTextures:d,maxTextureSize:f,maxCubemapSize:p,maxAttributes:m,maxVertexUniforms:g,maxVaryings:_,maxFragmentUniforms:b,vertexTextures:y,floatFragmentTextures:v,floatVertexTextures:y&&v,maxSamples:o?n.getParameter(36183):0}}function WY(n){const e=this;let t=null,i=0,r=!1,s=!1;const o=new oo,a=new Wn,c={value:null,needsUpdate:!1};function l(){c.value!==t&&(c.value=t,c.needsUpdate=i>0),e.numPlanes=i,e.numIntersection=0}function u(h,d,f,p){const m=null!==h?h.length:0;let g=null;if(0!==m){if(g=c.value,!0!==p||null===g){const _=f+4*m,b=d.matrixWorldInverse;a.getNormalMatrix(b),(null===g||g.length<_)&&(g=new Float32Array(_));for(let y=0,v=f;y!==m;++y,v+=4)o.copy(h[y]).applyMatrix4(b,a),o.normal.toArray(g,v),g[v+3]=o.constant}c.value=g,c.needsUpdate=!0}return e.numPlanes=m,e.numIntersection=0,g}this.uniform=c,this.numPlanes=0,this.numIntersection=0,this.init=function(h,d,f){const p=0!==h.length||d||0!==i||r;return r=d,t=u(h,f,0),i=h.length,p},this.beginShadows=function(){s=!0,u(null)},this.endShadows=function(){s=!1,l()},this.setState=function(h,d,f){const p=h.clippingPlanes,m=h.clipIntersection,g=h.clipShadows,_=n.get(h);if(!r||null===p||0===p.length||s&&!g)s?u(null):l();else{const b=s?0:i,y=4*b;let v=_.clippingState||null;c.value=v,v=u(p,d,y,f);for(let w=0;w!==y;++w)v[w]=t[w];_.clippingState=v,this.numIntersection=m?this.numPlanes:0,this.numPlanes+=b}}}function $Y(n){let e=new WeakMap;function t(o,a){return 303===a?o.mapping=301:304===a&&(o.mapping=302),o}function r(o){const a=o.target;a.removeEventListener("dispose",r);const c=e.get(a);void 0!==c&&(e.delete(a),c.dispose())}return{get:function i(o){if(o&&o.isTexture&&!1===o.isRenderTargetTexture){const a=o.mapping;if(303===a||304===a){if(e.has(o))return t(e.get(o).texture,o.mapping);{const c=o.image;if(c&&c.height>0){const l=new Bq(c.height/2);return l.fromEquirectangularTexture(n,o),e.set(o,l),o.addEventListener("dispose",r),t(l.texture,o.mapping)}return null}}}return o},dispose:function s(){e=new WeakMap}}}ws.physical={uniforms:Pi([ws.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatNormalScale:{value:new ee(1,1)},clearcoatNormalMap:{value:null},iridescence:{value:0},iridescenceMap:{value:null},iridescenceIOR:{value:1.3},iridescenceThicknessMinimum:{value:100},iridescenceThicknessMaximum:{value:400},iridescenceThicknessMap:{value:null},sheen:{value:0},sheenColor:{value:new Ie(0)},sheenColorMap:{value:null},sheenRoughness:{value:1},sheenRoughnessMap:{value:null},transmission:{value:0},transmissionMap:{value:null},transmissionSamplerSize:{value:new ee},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},attenuationDistance:{value:0},attenuationColor:{value:new Ie(0)},specularIntensity:{value:1},specularIntensityMap:{value:null},specularColor:{value:new Ie(1,1,1)},specularColorMap:{value:null}}]),vertexShader:vt.meshphysical_vert,fragmentShader:vt.meshphysical_frag};class fd extends Fx{constructor(e=-1,t=1,i=1,r=-1,s=.1,o=2e3){super(),this.isOrthographicCamera=!0,this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=e,this.right=t,this.top=i,this.bottom=r,this.near=s,this.far=o,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=null===e.view?null:Object.assign({},e.view),this}setViewOffset(e,t,i,r,s,o){null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=i,this.view.offsetY=r,this.view.width=s,this.view.height=o,this.updateProjectionMatrix()}clearViewOffset(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=(this.right-this.left)/(2*this.zoom),t=(this.top-this.bottom)/(2*this.zoom),i=(this.right+this.left)/2,r=(this.top+this.bottom)/2;let s=i-e,o=i+e,a=r+t,c=r-t;if(null!==this.view&&this.view.enabled){const l=(this.right-this.left)/this.view.fullWidth/this.zoom,u=(this.top-this.bottom)/this.view.fullHeight/this.zoom;s+=l*this.view.offsetX,o=s+l*this.view.width,a-=u*this.view.offsetY,c=a-u*this.view.height}this.projectionMatrix.makeOrthographic(s,o,a,c,this.near,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.zoom=this.zoom,t.object.left=this.left,t.object.right=this.right,t.object.top=this.top,t.object.bottom=this.bottom,t.object.near=this.near,t.object.far=this.far,null!==this.view&&(t.object.view=Object.assign({},this.view)),t}}const aO=[.125,.215,.35,.446,.526,.582],Ux=new fd,cO=new Ie;let zx=null;const ec=(1+Math.sqrt(5))/2,su=1/ec,lO=[new S(1,1,1),new S(-1,1,1),new S(1,1,-1),new S(-1,1,-1),new S(0,ec,su),new S(0,ec,-su),new S(su,0,ec),new S(-su,0,ec),new S(ec,su,0),new S(-ec,su,0)];class uO{constructor(e){this._renderer=e,this._pingPongRenderTarget=null,this._lodMax=0,this._cubeSize=0,this._lodPlanes=[],this._sizeLods=[],this._sigmas=[],this._blurMaterial=null,this._cubemapMaterial=null,this._equirectMaterial=null,this._compileMaterial(this._blurMaterial)}fromScene(e,t=0,i=.1,r=100){zx=this._renderer.getRenderTarget(),this._setSize(256);const s=this._allocateTargets();return s.depthBuffer=!0,this._sceneToCubeUV(e,i,r,s),t>0&&this._blur(s,0,0,t),this._applyPMREM(s),this._cleanup(s),s}fromEquirectangular(e,t=null){return this._fromTexture(e,t)}fromCubemap(e,t=null){return this._fromTexture(e,t)}compileCubemapShader(){null===this._cubemapMaterial&&(this._cubemapMaterial=fO(),this._compileMaterial(this._cubemapMaterial))}compileEquirectangularShader(){null===this._equirectMaterial&&(this._equirectMaterial=dO(),this._compileMaterial(this._equirectMaterial))}dispose(){this._dispose(),null!==this._cubemapMaterial&&this._cubemapMaterial.dispose(),null!==this._equirectMaterial&&this._equirectMaterial.dispose()}_setSize(e){this._lodMax=Math.floor(Math.log2(e)),this._cubeSize=Math.pow(2,this._lodMax)}_dispose(){null!==this._blurMaterial&&this._blurMaterial.dispose(),null!==this._pingPongRenderTarget&&this._pingPongRenderTarget.dispose();for(let e=0;e<this._lodPlanes.length;e++)this._lodPlanes[e].dispose()}_cleanup(e){this._renderer.setRenderTarget(zx),e.scissorTest=!1,jm(e,0,0,e.width,e.height)}_fromTexture(e,t){this._setSize(301===e.mapping||302===e.mapping?0===e.image.length?16:e.image[0].width||e.image[0].image.width:e.image.width/4),zx=this._renderer.getRenderTarget();const i=t||this._allocateTargets();return this._textureToCubeUV(e,i),this._applyPMREM(i),this._cleanup(i),i}_allocateTargets(){const e=3*Math.max(this._cubeSize,112),t=4*this._cubeSize,i={magFilter:Nn,minFilter:Nn,generateMipmaps:!1,type:rd,format:Er,encoding:Ga,depthBuffer:!1},r=hO(e,t,i);if(null===this._pingPongRenderTarget||this._pingPongRenderTarget.width!==e){null!==this._pingPongRenderTarget&&this._dispose(),this._pingPongRenderTarget=hO(e,t,i);const{_lodMax:s}=this;({sizeLods:this._sizeLods,lodPlanes:this._lodPlanes,sigmas:this._sigmas}=function qY(n){const e=[],t=[],i=[];let r=n;const s=n-4+1+aO.length;for(let o=0;o<s;o++){const a=Math.pow(2,r);t.push(a);let c=1/a;o>n-4?c=aO[o-n+4-1]:0===o&&(c=0),i.push(c);const l=1/(a-2),u=-l,h=1+l,d=[u,u,h,u,h,h,u,u,h,h,u,h],f=6,p=6,m=3,g=2,_=1,b=new Float32Array(m*p*f),y=new Float32Array(g*p*f),v=new Float32Array(_*p*f);for(let M=0;M<f;M++){const I=M%3*2/3-1,x=M>2?0:-1;b.set([I,x,0,I+2/3,x,0,I+2/3,x+1,0,I,x,0,I+2/3,x+1,0,I,x+1,0],m*p*M),y.set(d,g*p*M),v.set([M,M,M,M,M,M],_*p*M)}const w=new gt;w.setAttribute("position",new qn(b,m)),w.setAttribute("uv",new qn(y,g)),w.setAttribute("faceIndex",new qn(v,_)),e.push(w),r>4&&r--}return{lodPlanes:e,sizeLods:t,sigmas:i}}(s)),this._blurMaterial=function XY(n,e,t){const i=new Float32Array(20),r=new S(0,1,0);return new xs({name:"SphericalGaussianBlur",defines:{n:20,CUBEUV_TEXEL_WIDTH:1/e,CUBEUV_TEXEL_HEIGHT:1/t,CUBEUV_MAX_MIP:`${n}.0`},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:i},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:r}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform sampler2D envMap;\n\t\t\tuniform int samples;\n\t\t\tuniform float weights[ n ];\n\t\t\tuniform bool latitudinal;\n\t\t\tuniform float dTheta;\n\t\t\tuniform float mipInt;\n\t\t\tuniform vec3 poleAxis;\n\n\t\t\t#define ENVMAP_TYPE_CUBE_UV\n\t\t\t#include <cube_uv_reflection_fragment>\n\n\t\t\tvec3 getSample( float theta, vec3 axis ) {\n\n\t\t\t\tfloat cosTheta = cos( theta );\n\t\t\t\t// Rodrigues' axis-angle rotation\n\t\t\t\tvec3 sampleDirection = vOutputDirection * cosTheta\n\t\t\t\t\t+ cross( axis, vOutputDirection ) * sin( theta )\n\t\t\t\t\t+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );\n\n\t\t\t\treturn bilinearCubeUV( envMap, sampleDirection, mipInt );\n\n\t\t\t}\n\n\t\t\tvoid main() {\n\n\t\t\t\tvec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );\n\n\t\t\t\tif ( all( equal( axis, vec3( 0.0 ) ) ) ) {\n\n\t\t\t\t\taxis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );\n\n\t\t\t\t}\n\n\t\t\t\taxis = normalize( axis );\n\n\t\t\t\tgl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n\t\t\t\tgl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );\n\n\t\t\t\tfor ( int i = 1; i < n; i++ ) {\n\n\t\t\t\t\tif ( i >= samples ) {\n\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tfloat theta = dTheta * float( i );\n\t\t\t\t\tgl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );\n\t\t\t\t\tgl_FragColor.rgb += weights[ i ] * getSample( theta, axis );\n\n\t\t\t\t}\n\n\t\t\t}\n\t\t",blending:0,depthTest:!1,depthWrite:!1})}(s,e,t)}return r}_compileMaterial(e){const t=new Qn(this._lodPlanes[0],e);this._renderer.compile(t,Ux)}_sceneToCubeUV(e,t,i,r){const a=new ei(90,1,t,i),c=[1,-1,1,1,1,1],l=[1,1,1,-1,-1,-1],u=this._renderer,h=u.autoClear,d=u.toneMapping;u.getClearColor(cO),u.toneMapping=0,u.autoClear=!1;const f=new Ho({name:"PMREM.Background",side:1,depthWrite:!1,depthTest:!1}),p=new Qn(new Ql,f);let m=!1;const g=e.background;g?g.isColor&&(f.color.copy(g),e.background=null,m=!0):(f.color.copy(cO),m=!0);for(let _=0;_<6;_++){const b=_%3;0===b?(a.up.set(0,c[_],0),a.lookAt(l[_],0,0)):1===b?(a.up.set(0,0,c[_]),a.lookAt(0,l[_],0)):(a.up.set(0,c[_],0),a.lookAt(0,0,l[_]));const y=this._cubeSize;jm(r,b*y,_>2?y:0,y,y),u.setRenderTarget(r),m&&u.render(p,a),u.render(e,a)}p.geometry.dispose(),p.material.dispose(),u.toneMapping=d,u.autoClear=h,e.background=g}_textureToCubeUV(e,t){const i=this._renderer,r=301===e.mapping||302===e.mapping;r?(null===this._cubemapMaterial&&(this._cubemapMaterial=fO()),this._cubemapMaterial.uniforms.flipEnvMap.value=!1===e.isRenderTargetTexture?-1:1):null===this._equirectMaterial&&(this._equirectMaterial=dO());const s=r?this._cubemapMaterial:this._equirectMaterial,o=new Qn(this._lodPlanes[0],s);s.uniforms.envMap.value=e;const c=this._cubeSize;jm(t,0,0,3*c,2*c),i.setRenderTarget(t),i.render(o,Ux)}_applyPMREM(e){const t=this._renderer,i=t.autoClear;t.autoClear=!1;for(let r=1;r<this._lodPlanes.length;r++){const s=Math.sqrt(this._sigmas[r]*this._sigmas[r]-this._sigmas[r-1]*this._sigmas[r-1]);this._blur(e,r-1,r,s,lO[(r-1)%lO.length])}t.autoClear=i}_blur(e,t,i,r,s){const o=this._pingPongRenderTarget;this._halfBlur(e,o,t,i,r,"latitudinal",s),this._halfBlur(o,e,i,i,r,"longitudinal",s)}_halfBlur(e,t,i,r,s,o,a){const c=this._renderer,l=this._blurMaterial;"latitudinal"!==o&&"longitudinal"!==o&&console.error("blur direction must be either latitudinal or longitudinal!");const h=new Qn(this._lodPlanes[r],l),d=l.uniforms,f=this._sizeLods[i]-1,p=isFinite(s)?Math.PI/(2*f):2*Math.PI/39,m=s/p,g=isFinite(s)?1+Math.floor(3*m):20;g>20&&console.warn(`sigmaRadians, ${s}, is too large and will clip, as it requested ${g} samples when the maximum is set to 20`);const _=[];let b=0;for(let I=0;I<20;++I){const x=I/m,E=Math.exp(-x*x/2);_.push(E),0===I?b+=E:I<g&&(b+=2*E)}for(let I=0;I<_.length;I++)_[I]=_[I]/b;d.envMap.value=e.texture,d.samples.value=g,d.weights.value=_,d.latitudinal.value="latitudinal"===o,a&&(d.poleAxis.value=a);const{_lodMax:y}=this;d.dTheta.value=p,d.mipInt.value=y-i;const v=this._sizeLods[r];jm(t,3*v*(r>y-4?r-y+4:0),4*(this._cubeSize-v),3*v,2*v),c.setRenderTarget(t),c.render(h,Ux)}}function hO(n,e,t){const i=new Fo(n,e,t);return i.texture.mapping=306,i.texture.name="PMREM.cubeUv",i.scissorTest=!0,i}function jm(n,e,t,i,r){n.viewport.set(e,t,i,r),n.scissor.set(e,t,i,r)}function dO(){return new xs({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform sampler2D envMap;\n\n\t\t\t#include <common>\n\n\t\t\tvoid main() {\n\n\t\t\t\tvec3 outputDirection = normalize( vOutputDirection );\n\t\t\t\tvec2 uv = equirectUv( outputDirection );\n\n\t\t\t\tgl_FragColor = vec4( texture2D ( envMap, uv ).rgb, 1.0 );\n\n\t\t\t}\n\t\t",blending:0,depthTest:!1,depthWrite:!1})}function fO(){return new xs({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},flipEnvMap:{value:-1}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tuniform float flipEnvMap;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform samplerCube envMap;\n\n\t\t\tvoid main() {\n\n\t\t\t\tgl_FragColor = textureCube( envMap, vec3( flipEnvMap * vOutputDirection.x, vOutputDirection.yz ) );\n\n\t\t\t}\n\t\t",blending:0,depthTest:!1,depthWrite:!1})}function YY(n){let e=new WeakMap,t=null;function s(a){const c=a.target;c.removeEventListener("dispose",s);const l=e.get(c);void 0!==l&&(e.delete(c),l.dispose())}return{get:function i(a){if(a&&a.isTexture){const c=a.mapping,l=303===c||304===c,u=301===c||302===c;if(l||u){if(a.isRenderTargetTexture&&!0===a.needsPMREMUpdate){a.needsPMREMUpdate=!1;let h=e.get(a);return null===t&&(t=new uO(n)),h=l?t.fromEquirectangular(a,h):t.fromCubemap(a,h),e.set(a,h),h.texture}if(e.has(a))return e.get(a).texture;{const h=a.image;if(l&&h&&h.height>0||u&&h&&function r(a){let c=0;for(let u=0;u<6;u++)void 0!==a[u]&&c++;return 6===c}(h)){null===t&&(t=new uO(n));const d=l?t.fromEquirectangular(a):t.fromCubemap(a);return e.set(a,d),a.addEventListener("dispose",s),d.texture}return null}}}return a},dispose:function o(){e=new WeakMap,null!==t&&(t.dispose(),t=null)}}}function ZY(n){const e={};function t(i){if(void 0!==e[i])return e[i];let r;switch(i){case"WEBGL_depth_texture":r=n.getExtension("WEBGL_depth_texture")||n.getExtension("MOZ_WEBGL_depth_texture")||n.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":r=n.getExtension("EXT_texture_filter_anisotropic")||n.getExtension("MOZ_EXT_texture_filter_anisotropic")||n.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":r=n.getExtension("WEBGL_compressed_texture_s3tc")||n.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||n.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":r=n.getExtension("WEBGL_compressed_texture_pvrtc")||n.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:r=n.getExtension(i)}return e[i]=r,r}return{has:function(i){return null!==t(i)},init:function(i){i.isWebGL2?t("EXT_color_buffer_float"):(t("WEBGL_depth_texture"),t("OES_texture_float"),t("OES_texture_half_float"),t("OES_texture_half_float_linear"),t("OES_standard_derivatives"),t("OES_element_index_uint"),t("OES_vertex_array_object"),t("ANGLE_instanced_arrays")),t("OES_texture_float_linear"),t("EXT_color_buffer_half_float"),t("WEBGL_multisampled_render_to_texture")},get:function(i){const r=t(i);return null===r&&console.warn("THREE.WebGLRenderer: "+i+" extension not supported."),r}}}function KY(n,e,t,i){const r={},s=new WeakMap;function o(h){const d=h.target;null!==d.index&&e.remove(d.index);for(const p in d.attributes)e.remove(d.attributes[p]);d.removeEventListener("dispose",o),delete r[d.id];const f=s.get(d);f&&(e.remove(f),s.delete(d)),i.releaseStatesOfGeometry(d),!0===d.isInstancedBufferGeometry&&delete d._maxInstanceCount,t.memory.geometries--}function l(h){const d=[],f=h.index,p=h.attributes.position;let m=0;if(null!==f){const b=f.array;m=f.version;for(let y=0,v=b.length;y<v;y+=3){const w=b[y+0],M=b[y+1],I=b[y+2];d.push(w,M,M,I,I,w)}}else{m=p.version;for(let y=0,v=p.array.length/3-1;y<v;y+=3){const w=y+0,M=y+1,I=y+2;d.push(w,M,M,I,I,w)}}const g=new(GR(d)?iO:nO)(d,1);g.version=m;const _=s.get(h);_&&e.remove(_),s.set(h,g)}return{get:function a(h,d){return!0===r[d.id]||(d.addEventListener("dispose",o),r[d.id]=!0,t.memory.geometries++),d},update:function c(h){const d=h.attributes;for(const p in d)e.update(d[p],34962);const f=h.morphAttributes;for(const p in f){const m=f[p];for(let g=0,_=m.length;g<_;g++)e.update(m[g],34962)}},getWireframeAttribute:function u(h){const d=s.get(h);if(d){const f=h.index;null!==f&&d.version<f.version&&l(h)}else l(h);return s.get(h)}}}function JY(n,e,t,i){const r=i.isWebGL2;let s,a,c;this.setMode=function o(d){s=d},this.setIndex=function l(d){a=d.type,c=d.bytesPerElement},this.render=function u(d,f){n.drawElements(s,f,a,d*c),t.update(f,s,1)},this.renderInstances=function h(d,f,p){if(0===p)return;let m,g;if(r)m=n,g="drawElementsInstanced";else if(m=e.get("ANGLE_instanced_arrays"),g="drawElementsInstancedANGLE",null===m)return void console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");m[g](s,f,a,d*c,p),t.update(f,s,p)}}function QY(n){const t={frame:0,calls:0,triangles:0,points:0,lines:0};return{memory:{geometries:0,textures:0},render:t,programs:null,autoReset:!0,reset:function r(){t.frame++,t.calls=0,t.triangles=0,t.points=0,t.lines=0},update:function i(s,o,a){switch(t.calls++,o){case 4:t.triangles+=a*(s/3);break;case 1:t.lines+=a*(s/2);break;case 3:t.lines+=a*(s-1);break;case 2:t.lines+=a*s;break;case 0:t.points+=a*s;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",o)}}}}function eZ(n,e){return n[0]-e[0]}function tZ(n,e){return Math.abs(e[1])-Math.abs(n[1])}function nZ(n,e,t){const i={},r=new Float32Array(8),s=new WeakMap,o=new qt,a=[];for(let l=0;l<8;l++)a[l]=[l,0];return{update:function c(l,u,h,d){const f=l.morphTargetInfluences;if(!0===e.isWebGL2){const p=u.morphAttributes.position||u.morphAttributes.normal||u.morphAttributes.color,m=void 0!==p?p.length:0;let g=s.get(u);if(void 0===g||g.count!==m){let X=function(){H.dispose(),s.delete(u),u.removeEventListener("dispose",X)};void 0!==g&&g.texture.dispose();const y=void 0!==u.morphAttributes.position,v=void 0!==u.morphAttributes.normal,w=void 0!==u.morphAttributes.color,M=u.morphAttributes.position||[],I=u.morphAttributes.normal||[],x=u.morphAttributes.color||[];let E=0;!0===y&&(E=1),!0===v&&(E=2),!0===w&&(E=3);let R=u.attributes.position.count*E,$=1;R>e.maxTextureSize&&($=Math.ceil(R/e.maxTextureSize),R=e.maxTextureSize);const se=new Float32Array(R*$*4*m),H=new yx(se,R,$,m);H.type=Lo,H.needsUpdate=!0;const N=4*E;for(let L=0;L<m;L++){const G=M[L],F=I[L],O=x[L],V=R*$*4*L;for(let ce=0;ce<G.count;ce++){const re=ce*N;!0===y&&(o.fromBufferAttribute(G,ce),se[V+re+0]=o.x,se[V+re+1]=o.y,se[V+re+2]=o.z,se[V+re+3]=0),!0===v&&(o.fromBufferAttribute(F,ce),se[V+re+4]=o.x,se[V+re+5]=o.y,se[V+re+6]=o.z,se[V+re+7]=0),!0===w&&(o.fromBufferAttribute(O,ce),se[V+re+8]=o.x,se[V+re+9]=o.y,se[V+re+10]=o.z,se[V+re+11]=4===O.itemSize?o.w:1)}}g={count:m,texture:H,size:new ee(R,$)},s.set(u,g),u.addEventListener("dispose",X)}let _=0;for(let y=0;y<f.length;y++)_+=f[y];const b=u.morphTargetsRelative?1:1-_;d.getUniforms().setValue(n,"morphTargetBaseInfluence",b),d.getUniforms().setValue(n,"morphTargetInfluences",f),d.getUniforms().setValue(n,"morphTargetsTexture",g.texture,t),d.getUniforms().setValue(n,"morphTargetsTextureSize",g.size)}else{const p=void 0===f?0:f.length;let m=i[u.id];if(void 0===m||m.length!==p){m=[];for(let v=0;v<p;v++)m[v]=[v,0];i[u.id]=m}for(let v=0;v<p;v++){const w=m[v];w[0]=v,w[1]=f[v]}m.sort(tZ);for(let v=0;v<8;v++)v<p&&m[v][1]?(a[v][0]=m[v][0],a[v][1]=m[v][1]):(a[v][0]=Number.MAX_SAFE_INTEGER,a[v][1]=0);a.sort(eZ);const g=u.morphAttributes.position,_=u.morphAttributes.normal;let b=0;for(let v=0;v<8;v++){const w=a[v],M=w[0],I=w[1];M!==Number.MAX_SAFE_INTEGER&&I?(g&&u.getAttribute("morphTarget"+v)!==g[M]&&u.setAttribute("morphTarget"+v,g[M]),_&&u.getAttribute("morphNormal"+v)!==_[M]&&u.setAttribute("morphNormal"+v,_[M]),r[v]=I,b+=I):(g&&!0===u.hasAttribute("morphTarget"+v)&&u.deleteAttribute("morphTarget"+v),_&&!0===u.hasAttribute("morphNormal"+v)&&u.deleteAttribute("morphNormal"+v),r[v]=0)}const y=u.morphTargetsRelative?1:1-b;d.getUniforms().setValue(n,"morphTargetBaseInfluence",y),d.getUniforms().setValue(n,"morphTargetInfluences",r)}}}}function iZ(n,e,t,i){let r=new WeakMap;function a(c){const l=c.target;l.removeEventListener("dispose",a),t.remove(l.instanceMatrix),null!==l.instanceColor&&t.remove(l.instanceColor)}return{update:function s(c){const l=i.render.frame,h=e.get(c,c.geometry);return r.get(h)!==l&&(e.update(h),r.set(h,l)),c.isInstancedMesh&&(!1===c.hasEventListener("dispose",a)&&c.addEventListener("dispose",a),t.update(c.instanceMatrix,34962),null!==c.instanceColor&&t.update(c.instanceColor,34962)),h},dispose:function o(){r=new WeakMap}}}const pO=new No,mO=new yx,gO=new $R,_O=new Hm,yO=[],vO=[],bO=new Float32Array(16),xO=new Float32Array(9),wO=new Float32Array(4);function ou(n,e,t){const i=n[0];if(i<=0||i>0)return n;const r=e*t;let s=yO[r];if(void 0===s&&(s=new Float32Array(r),yO[r]=s),0!==e){i.toArray(s,0);for(let o=1,a=0;o!==e;++o)a+=t,n[o].toArray(s,a)}return s}function Xn(n,e){if(n.length!==e.length)return!1;for(let t=0,i=n.length;t<i;t++)if(n[t]!==e[t])return!1;return!0}function Yn(n,e){for(let t=0,i=e.length;t<i;t++)n[t]=e[t]}function Wm(n,e){let t=vO[e];void 0===t&&(t=new Int32Array(e),vO[e]=t);for(let i=0;i!==e;++i)t[i]=n.allocateTextureUnit();return t}function rZ(n,e){const t=this.cache;t[0]!==e&&(n.uniform1f(this.addr,e),t[0]=e)}function sZ(n,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y)&&(n.uniform2f(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(Xn(t,e))return;n.uniform2fv(this.addr,e),Yn(t,e)}}function oZ(n,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(n.uniform3f(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else if(void 0!==e.r)(t[0]!==e.r||t[1]!==e.g||t[2]!==e.b)&&(n.uniform3f(this.addr,e.r,e.g,e.b),t[0]=e.r,t[1]=e.g,t[2]=e.b);else{if(Xn(t,e))return;n.uniform3fv(this.addr,e),Yn(t,e)}}function aZ(n,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(n.uniform4f(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(Xn(t,e))return;n.uniform4fv(this.addr,e),Yn(t,e)}}function cZ(n,e){const t=this.cache,i=e.elements;if(void 0===i){if(Xn(t,e))return;n.uniformMatrix2fv(this.addr,!1,e),Yn(t,e)}else{if(Xn(t,i))return;wO.set(i),n.uniformMatrix2fv(this.addr,!1,wO),Yn(t,i)}}function lZ(n,e){const t=this.cache,i=e.elements;if(void 0===i){if(Xn(t,e))return;n.uniformMatrix3fv(this.addr,!1,e),Yn(t,e)}else{if(Xn(t,i))return;xO.set(i),n.uniformMatrix3fv(this.addr,!1,xO),Yn(t,i)}}function uZ(n,e){const t=this.cache,i=e.elements;if(void 0===i){if(Xn(t,e))return;n.uniformMatrix4fv(this.addr,!1,e),Yn(t,e)}else{if(Xn(t,i))return;bO.set(i),n.uniformMatrix4fv(this.addr,!1,bO),Yn(t,i)}}function hZ(n,e){const t=this.cache;t[0]!==e&&(n.uniform1i(this.addr,e),t[0]=e)}function dZ(n,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y)&&(n.uniform2i(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(Xn(t,e))return;n.uniform2iv(this.addr,e),Yn(t,e)}}function fZ(n,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(n.uniform3i(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else{if(Xn(t,e))return;n.uniform3iv(this.addr,e),Yn(t,e)}}function pZ(n,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(n.uniform4i(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(Xn(t,e))return;n.uniform4iv(this.addr,e),Yn(t,e)}}function mZ(n,e){const t=this.cache;t[0]!==e&&(n.uniform1ui(this.addr,e),t[0]=e)}function gZ(n,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y)&&(n.uniform2ui(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(Xn(t,e))return;n.uniform2uiv(this.addr,e),Yn(t,e)}}function _Z(n,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(n.uniform3ui(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else{if(Xn(t,e))return;n.uniform3uiv(this.addr,e),Yn(t,e)}}function yZ(n,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(n.uniform4ui(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(Xn(t,e))return;n.uniform4uiv(this.addr,e),Yn(t,e)}}function vZ(n,e,t){const i=this.cache,r=t.allocateTextureUnit();i[0]!==r&&(n.uniform1i(this.addr,r),i[0]=r),t.setTexture2D(e||pO,r)}function bZ(n,e,t){const i=this.cache,r=t.allocateTextureUnit();i[0]!==r&&(n.uniform1i(this.addr,r),i[0]=r),t.setTexture3D(e||gO,r)}function xZ(n,e,t){const i=this.cache,r=t.allocateTextureUnit();i[0]!==r&&(n.uniform1i(this.addr,r),i[0]=r),t.setTextureCube(e||_O,r)}function wZ(n,e,t){const i=this.cache,r=t.allocateTextureUnit();i[0]!==r&&(n.uniform1i(this.addr,r),i[0]=r),t.setTexture2DArray(e||mO,r)}function CZ(n,e){n.uniform1fv(this.addr,e)}function SZ(n,e){const t=ou(e,this.size,2);n.uniform2fv(this.addr,t)}function EZ(n,e){const t=ou(e,this.size,3);n.uniform3fv(this.addr,t)}function DZ(n,e){const t=ou(e,this.size,4);n.uniform4fv(this.addr,t)}function TZ(n,e){const t=ou(e,this.size,4);n.uniformMatrix2fv(this.addr,!1,t)}function AZ(n,e){const t=ou(e,this.size,9);n.uniformMatrix3fv(this.addr,!1,t)}function IZ(n,e){const t=ou(e,this.size,16);n.uniformMatrix4fv(this.addr,!1,t)}function PZ(n,e){n.uniform1iv(this.addr,e)}function RZ(n,e){n.uniform2iv(this.addr,e)}function OZ(n,e){n.uniform3iv(this.addr,e)}function kZ(n,e){n.uniform4iv(this.addr,e)}function LZ(n,e){n.uniform1uiv(this.addr,e)}function NZ(n,e){n.uniform2uiv(this.addr,e)}function FZ(n,e){n.uniform3uiv(this.addr,e)}function VZ(n,e){n.uniform4uiv(this.addr,e)}function BZ(n,e,t){const i=this.cache,r=e.length,s=Wm(t,r);Xn(i,s)||(n.uniform1iv(this.addr,s),Yn(i,s));for(let o=0;o!==r;++o)t.setTexture2D(e[o]||pO,s[o])}function UZ(n,e,t){const i=this.cache,r=e.length,s=Wm(t,r);Xn(i,s)||(n.uniform1iv(this.addr,s),Yn(i,s));for(let o=0;o!==r;++o)t.setTexture3D(e[o]||gO,s[o])}function zZ(n,e,t){const i=this.cache,r=e.length,s=Wm(t,r);Xn(i,s)||(n.uniform1iv(this.addr,s),Yn(i,s));for(let o=0;o!==r;++o)t.setTextureCube(e[o]||_O,s[o])}function HZ(n,e,t){const i=this.cache,r=e.length,s=Wm(t,r);Xn(i,s)||(n.uniform1iv(this.addr,s),Yn(i,s));for(let o=0;o!==r;++o)t.setTexture2DArray(e[o]||mO,s[o])}class jZ{constructor(e,t,i){this.id=e,this.addr=i,this.cache=[],this.setValue=function MZ(n){switch(n){case 5126:return rZ;case 35664:return sZ;case 35665:return oZ;case 35666:return aZ;case 35674:return cZ;case 35675:return lZ;case 35676:return uZ;case 5124:case 35670:return hZ;case 35667:case 35671:return dZ;case 35668:case 35672:return fZ;case 35669:case 35673:return pZ;case 5125:return mZ;case 36294:return gZ;case 36295:return _Z;case 36296:return yZ;case 35678:case 36198:case 36298:case 36306:case 35682:return vZ;case 35679:case 36299:case 36307:return bZ;case 35680:case 36300:case 36308:case 36293:return xZ;case 36289:case 36303:case 36311:case 36292:return wZ}}(t.type)}}class WZ{constructor(e,t,i){this.id=e,this.addr=i,this.cache=[],this.size=t.size,this.setValue=function GZ(n){switch(n){case 5126:return CZ;case 35664:return SZ;case 35665:return EZ;case 35666:return DZ;case 35674:return TZ;case 35675:return AZ;case 35676:return IZ;case 5124:case 35670:return PZ;case 35667:case 35671:return RZ;case 35668:case 35672:return OZ;case 35669:case 35673:return kZ;case 5125:return LZ;case 36294:return NZ;case 36295:return FZ;case 36296:return VZ;case 35678:case 36198:case 36298:case 36306:case 35682:return BZ;case 35679:case 36299:case 36307:return UZ;case 35680:case 36300:case 36308:case 36293:return zZ;case 36289:case 36303:case 36311:case 36292:return HZ}}(t.type)}}class $Z{constructor(e){this.id=e,this.seq=[],this.map={}}setValue(e,t,i){const r=this.seq;for(let s=0,o=r.length;s!==o;++s){const a=r[s];a.setValue(e,t[a.id],i)}}}const Gx=/(\w+)(\])?(\[|\.)?/g;function MO(n,e){n.seq.push(e),n.map[e.id]=e}function qZ(n,e,t){const i=n.name,r=i.length;for(Gx.lastIndex=0;;){const s=Gx.exec(i),o=Gx.lastIndex;let a=s[1];const l=s[3];if("]"===s[2]&&(a|=0),void 0===l||"["===l&&o+2===r){MO(t,void 0===l?new jZ(a,n,e):new WZ(a,n,e));break}{let h=t.map[a];void 0===h&&(h=new $Z(a),MO(t,h)),t=h}}}class $m{constructor(e,t){this.seq=[],this.map={};const i=e.getProgramParameter(t,35718);for(let r=0;r<i;++r){const s=e.getActiveUniform(t,r);qZ(s,e.getUniformLocation(t,s.name),this)}}setValue(e,t,i,r){const s=this.map[t];void 0!==s&&s.setValue(e,i,r)}setOptional(e,t,i){const r=t[i];void 0!==r&&this.setValue(e,i,r)}static upload(e,t,i,r){for(let s=0,o=t.length;s!==o;++s){const a=t[s],c=i[a.id];!1!==c.needsUpdate&&a.setValue(e,c.value,r)}}static seqWithValue(e,t){const i=[];for(let r=0,s=e.length;r!==s;++r){const o=e[r];o.id in t&&i.push(o)}return i}}function CO(n,e,t){const i=n.createShader(e);return n.shaderSource(i,t),n.compileShader(i),i}let XZ=0;function SO(n,e,t){const i=n.getShaderParameter(e,35713),r=n.getShaderInfoLog(e).trim();if(i&&""===r)return"";const s=/ERROR: 0:(\d+)/.exec(r);if(s){const o=parseInt(s[1]);return t.toUpperCase()+"\n\n"+r+"\n\n"+function YZ(n,e){const t=n.split("\n"),i=[],r=Math.max(e-6,0),s=Math.min(e+6,t.length);for(let o=r;o<s;o++){const a=o+1;i.push(`${a===e?">":" "} ${a}: ${t[o]}`)}return i.join("\n")}(n.getShaderSource(e),o)}return r}function KZ(n,e){const t=function ZZ(n){switch(n){case Ga:return["Linear","( value )"];case bn:return["sRGB","( value )"];default:return console.warn("THREE.WebGLProgram: Unsupported encoding:",n),["Linear","( value )"]}}(e);return"vec4 "+n+"( vec4 value ) { return LinearTo"+t[0]+t[1]+"; }"}function JZ(n,e){let t;switch(e){case 1:t="Linear";break;case 2:t="Reinhard";break;case 3:t="OptimizedCineon";break;case 4:t="ACESFilmic";break;case 5:t="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",e),t="Linear"}return"vec3 "+n+"( vec3 color ) { return "+t+"ToneMapping( color ); }"}function pd(n){return""!==n}function EO(n,e){const t=e.numSpotLightShadows+e.numSpotLightMaps-e.numSpotLightShadowsWithMaps;return n.replace(/NUM_DIR_LIGHTS/g,e.numDirLights).replace(/NUM_SPOT_LIGHTS/g,e.numSpotLights).replace(/NUM_SPOT_LIGHT_MAPS/g,e.numSpotLightMaps).replace(/NUM_SPOT_LIGHT_COORDS/g,t).replace(/NUM_RECT_AREA_LIGHTS/g,e.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,e.numPointLights).replace(/NUM_HEMI_LIGHTS/g,e.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,e.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS/g,e.numSpotLightShadowsWithMaps).replace(/NUM_SPOT_LIGHT_SHADOWS/g,e.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,e.numPointLightShadows)}function DO(n,e){return n.replace(/NUM_CLIPPING_PLANES/g,e.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,e.numClippingPlanes-e.numClipIntersection)}const nK=/^[ \t]*#include +<([\w\d./]+)>/gm;function jx(n){return n.replace(nK,iK)}function iK(n,e){const t=vt[e];if(void 0===t)throw new Error("Can not resolve #include <"+e+">");return jx(t)}const rK=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function TO(n){return n.replace(rK,sK)}function sK(n,e,t,i){let r="";for(let s=parseInt(e);s<parseInt(t);s++)r+=i.replace(/\[\s*i\s*\]/g,"[ "+s+" ]").replace(/UNROLLED_LOOP_INDEX/g,s);return r}function AO(n){let e="precision "+n.precision+" float;\nprecision "+n.precision+" int;";return"highp"===n.precision?e+="\n#define HIGH_PRECISION":"mediump"===n.precision?e+="\n#define MEDIUM_PRECISION":"lowp"===n.precision&&(e+="\n#define LOW_PRECISION"),e}function hK(n,e,t,i){const r=n.getContext(),s=t.defines;let o=t.vertexShader,a=t.fragmentShader;const c=function oK(n){let e="SHADOWMAP_TYPE_BASIC";return 1===n.shadowMapType?e="SHADOWMAP_TYPE_PCF":2===n.shadowMapType?e="SHADOWMAP_TYPE_PCF_SOFT":3===n.shadowMapType&&(e="SHADOWMAP_TYPE_VSM"),e}(t),l=function aK(n){let e="ENVMAP_TYPE_CUBE";if(n.envMap)switch(n.envMapMode){case 301:case 302:e="ENVMAP_TYPE_CUBE";break;case 306:e="ENVMAP_TYPE_CUBE_UV"}return e}(t),u=function cK(n){let e="ENVMAP_MODE_REFLECTION";return n.envMap&&302===n.envMapMode&&(e="ENVMAP_MODE_REFRACTION"),e}(t),h=function lK(n){let e="ENVMAP_BLENDING_NONE";if(n.envMap)switch(n.combine){case 0:e="ENVMAP_BLENDING_MULTIPLY";break;case 1:e="ENVMAP_BLENDING_MIX";break;case 2:e="ENVMAP_BLENDING_ADD"}return e}(t),d=function uK(n){const e=n.envMapCubeUVHeight;if(null===e)return null;const t=Math.log2(e)-2,i=1/e;return{texelWidth:1/(3*Math.max(Math.pow(2,t),112)),texelHeight:i,maxMip:t}}(t),f=t.isWebGL2?"":function QZ(n){return[n.extensionDerivatives||n.envMapCubeUVHeight||n.bumpMap||n.tangentSpaceNormalMap||n.clearcoatNormalMap||n.flatShading||"physical"===n.shaderID?"#extension GL_OES_standard_derivatives : enable":"",(n.extensionFragDepth||n.logarithmicDepthBuffer)&&n.rendererExtensionFragDepth?"#extension GL_EXT_frag_depth : enable":"",n.extensionDrawBuffers&&n.rendererExtensionDrawBuffers?"#extension GL_EXT_draw_buffers : require":"",(n.extensionShaderTextureLOD||n.envMap||n.transmission)&&n.rendererExtensionShaderTextureLod?"#extension GL_EXT_shader_texture_lod : enable":""].filter(pd).join("\n")}(t),p=function eK(n){const e=[];for(const t in n){const i=n[t];!1!==i&&e.push("#define "+t+" "+i)}return e.join("\n")}(s),m=r.createProgram();let g,_,b=t.glslVersion?"#version "+t.glslVersion+"\n":"";t.isRawShaderMaterial?(g=[p].filter(pd).join("\n"),g.length>0&&(g+="\n"),_=[f,p].filter(pd).join("\n"),_.length>0&&(_+="\n")):(g=[AO(t),"#define SHADER_NAME "+t.shaderName,p,t.instancing?"#define USE_INSTANCING":"",t.instancingColor?"#define USE_INSTANCING_COLOR":"",t.supportsVertexTextures?"#define VERTEX_TEXTURES":"",t.useFog&&t.fog?"#define USE_FOG":"",t.useFog&&t.fogExp2?"#define FOG_EXP2":"",t.map?"#define USE_MAP":"",t.envMap?"#define USE_ENVMAP":"",t.envMap?"#define "+u:"",t.lightMap?"#define USE_LIGHTMAP":"",t.aoMap?"#define USE_AOMAP":"",t.emissiveMap?"#define USE_EMISSIVEMAP":"",t.bumpMap?"#define USE_BUMPMAP":"",t.normalMap?"#define USE_NORMALMAP":"",t.normalMap&&t.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",t.normalMap&&t.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",t.clearcoatMap?"#define USE_CLEARCOATMAP":"",t.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",t.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",t.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",t.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",t.displacementMap&&t.supportsVertexTextures?"#define USE_DISPLACEMENTMAP":"",t.specularMap?"#define USE_SPECULARMAP":"",t.specularIntensityMap?"#define USE_SPECULARINTENSITYMAP":"",t.specularColorMap?"#define USE_SPECULARCOLORMAP":"",t.roughnessMap?"#define USE_ROUGHNESSMAP":"",t.metalnessMap?"#define USE_METALNESSMAP":"",t.alphaMap?"#define USE_ALPHAMAP":"",t.transmission?"#define USE_TRANSMISSION":"",t.transmissionMap?"#define USE_TRANSMISSIONMAP":"",t.thicknessMap?"#define USE_THICKNESSMAP":"",t.sheenColorMap?"#define USE_SHEENCOLORMAP":"",t.sheenRoughnessMap?"#define USE_SHEENROUGHNESSMAP":"",t.vertexTangents?"#define USE_TANGENT":"",t.vertexColors?"#define USE_COLOR":"",t.vertexAlphas?"#define USE_COLOR_ALPHA":"",t.vertexUvs?"#define USE_UV":"",t.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",t.flatShading?"#define FLAT_SHADED":"",t.skinning?"#define USE_SKINNING":"",t.morphTargets?"#define USE_MORPHTARGETS":"",t.morphNormals&&!1===t.flatShading?"#define USE_MORPHNORMALS":"",t.morphColors&&t.isWebGL2?"#define USE_MORPHCOLORS":"",t.morphTargetsCount>0&&t.isWebGL2?"#define MORPHTARGETS_TEXTURE":"",t.morphTargetsCount>0&&t.isWebGL2?"#define MORPHTARGETS_TEXTURE_STRIDE "+t.morphTextureStride:"",t.morphTargetsCount>0&&t.isWebGL2?"#define MORPHTARGETS_COUNT "+t.morphTargetsCount:"",t.doubleSided?"#define DOUBLE_SIDED":"",t.flipSided?"#define FLIP_SIDED":"",t.shadowMapEnabled?"#define USE_SHADOWMAP":"",t.shadowMapEnabled?"#define "+c:"",t.sizeAttenuation?"#define USE_SIZEATTENUATION":"",t.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",t.logarithmicDepthBuffer&&t.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","\tattribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","\tattribute vec3 instanceColor;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_TANGENT","\tattribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","\tattribute vec4 color;","#elif defined( USE_COLOR )","\tattribute vec3 color;","#endif","#if ( defined( USE_MORPHTARGETS ) && ! defined( MORPHTARGETS_TEXTURE ) )","\tattribute vec3 morphTarget0;","\tattribute vec3 morphTarget1;","\tattribute vec3 morphTarget2;","\tattribute vec3 morphTarget3;","\t#ifdef USE_MORPHNORMALS","\t\tattribute vec3 morphNormal0;","\t\tattribute vec3 morphNormal1;","\t\tattribute vec3 morphNormal2;","\t\tattribute vec3 morphNormal3;","\t#else","\t\tattribute vec3 morphTarget4;","\t\tattribute vec3 morphTarget5;","\t\tattribute vec3 morphTarget6;","\t\tattribute vec3 morphTarget7;","\t#endif","#endif","#ifdef USE_SKINNING","\tattribute vec4 skinIndex;","\tattribute vec4 skinWeight;","#endif","\n"].filter(pd).join("\n"),_=[f,AO(t),"#define SHADER_NAME "+t.shaderName,p,t.useFog&&t.fog?"#define USE_FOG":"",t.useFog&&t.fogExp2?"#define FOG_EXP2":"",t.map?"#define USE_MAP":"",t.matcap?"#define USE_MATCAP":"",t.envMap?"#define USE_ENVMAP":"",t.envMap?"#define "+l:"",t.envMap?"#define "+u:"",t.envMap?"#define "+h:"",d?"#define CUBEUV_TEXEL_WIDTH "+d.texelWidth:"",d?"#define CUBEUV_TEXEL_HEIGHT "+d.texelHeight:"",d?"#define CUBEUV_MAX_MIP "+d.maxMip+".0":"",t.lightMap?"#define USE_LIGHTMAP":"",t.aoMap?"#define USE_AOMAP":"",t.emissiveMap?"#define USE_EMISSIVEMAP":"",t.bumpMap?"#define USE_BUMPMAP":"",t.normalMap?"#define USE_NORMALMAP":"",t.normalMap&&t.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",t.normalMap&&t.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",t.clearcoat?"#define USE_CLEARCOAT":"",t.clearcoatMap?"#define USE_CLEARCOATMAP":"",t.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",t.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",t.iridescence?"#define USE_IRIDESCENCE":"",t.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",t.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",t.specularMap?"#define USE_SPECULARMAP":"",t.specularIntensityMap?"#define USE_SPECULARINTENSITYMAP":"",t.specularColorMap?"#define USE_SPECULARCOLORMAP":"",t.roughnessMap?"#define USE_ROUGHNESSMAP":"",t.metalnessMap?"#define USE_METALNESSMAP":"",t.alphaMap?"#define USE_ALPHAMAP":"",t.alphaTest?"#define USE_ALPHATEST":"",t.sheen?"#define USE_SHEEN":"",t.sheenColorMap?"#define USE_SHEENCOLORMAP":"",t.sheenRoughnessMap?"#define USE_SHEENROUGHNESSMAP":"",t.transmission?"#define USE_TRANSMISSION":"",t.transmissionMap?"#define USE_TRANSMISSIONMAP":"",t.thicknessMap?"#define USE_THICKNESSMAP":"",t.decodeVideoTexture?"#define DECODE_VIDEO_TEXTURE":"",t.vertexTangents?"#define USE_TANGENT":"",t.vertexColors||t.instancingColor?"#define USE_COLOR":"",t.vertexAlphas?"#define USE_COLOR_ALPHA":"",t.vertexUvs?"#define USE_UV":"",t.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",t.gradientMap?"#define USE_GRADIENTMAP":"",t.flatShading?"#define FLAT_SHADED":"",t.doubleSided?"#define DOUBLE_SIDED":"",t.flipSided?"#define FLIP_SIDED":"",t.shadowMapEnabled?"#define USE_SHADOWMAP":"",t.shadowMapEnabled?"#define "+c:"",t.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",t.physicallyCorrectLights?"#define PHYSICALLY_CORRECT_LIGHTS":"",t.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",t.logarithmicDepthBuffer&&t.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",0!==t.toneMapping?"#define TONE_MAPPING":"",0!==t.toneMapping?vt.tonemapping_pars_fragment:"",0!==t.toneMapping?JZ("toneMapping",t.toneMapping):"",t.dithering?"#define DITHERING":"",t.opaque?"#define OPAQUE":"",vt.encodings_pars_fragment,KZ("linearToOutputTexel",t.outputEncoding),t.useDepthPacking?"#define DEPTH_PACKING "+t.depthPacking:"","\n"].filter(pd).join("\n")),o=jx(o),o=EO(o,t),o=DO(o,t),a=jx(a),a=EO(a,t),a=DO(a,t),o=TO(o),a=TO(a),t.isWebGL2&&!0!==t.isRawShaderMaterial&&(b="#version 300 es\n",g=["precision mediump sampler2DArray;","#define attribute in","#define varying out","#define texture2D texture"].join("\n")+"\n"+g,_=["#define varying in","300 es"===t.glslVersion?"":"layout(location = 0) out highp vec4 pc_fragColor;","300 es"===t.glslVersion?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join("\n")+"\n"+_);const v=b+_+a,w=CO(r,35633,b+g+o),M=CO(r,35632,v);if(r.attachShader(m,w),r.attachShader(m,M),void 0!==t.index0AttributeName?r.bindAttribLocation(m,0,t.index0AttributeName):!0===t.morphTargets&&r.bindAttribLocation(m,0,"position"),r.linkProgram(m),n.debug.checkShaderErrors){const E=r.getProgramInfoLog(m).trim(),R=r.getShaderInfoLog(w).trim(),$=r.getShaderInfoLog(M).trim();let se=!0,H=!0;if(!1===r.getProgramParameter(m,35714)){se=!1;const N=SO(r,w,"vertex"),X=SO(r,M,"fragment");console.error("THREE.WebGLProgram: Shader Error "+r.getError()+" - VALIDATE_STATUS "+r.getProgramParameter(m,35715)+"\n\nProgram Info Log: "+E+"\n"+N+"\n"+X)}else""!==E?console.warn("THREE.WebGLProgram: Program Info Log:",E):(""===R||""===$)&&(H=!1);H&&(this.diagnostics={runnable:se,programLog:E,vertexShader:{log:R,prefix:g},fragmentShader:{log:$,prefix:_}})}let I,x;return r.deleteShader(w),r.deleteShader(M),this.getUniforms=function(){return void 0===I&&(I=new $m(r,m)),I},this.getAttributes=function(){return void 0===x&&(x=function tK(n,e){const t={},i=n.getProgramParameter(e,35721);for(let r=0;r<i;r++){const s=n.getActiveAttrib(e,r),o=s.name;let a=1;35674===s.type&&(a=2),35675===s.type&&(a=3),35676===s.type&&(a=4),t[o]={type:s.type,location:n.getAttribLocation(e,o),locationSize:a}}return t}(r,m)),x},this.destroy=function(){i.releaseStatesOfProgram(this),r.deleteProgram(m),this.program=void 0},this.name=t.shaderName,this.id=XZ++,this.cacheKey=e,this.usedTimes=1,this.program=m,this.vertexShader=w,this.fragmentShader=M,this}let dK=0;class fK{constructor(){this.shaderCache=new Map,this.materialCache=new Map}update(e){const i=e.fragmentShader,r=this._getShaderStage(e.vertexShader),s=this._getShaderStage(i),o=this._getShaderCacheForMaterial(e);return!1===o.has(r)&&(o.add(r),r.usedTimes++),!1===o.has(s)&&(o.add(s),s.usedTimes++),this}remove(e){const t=this.materialCache.get(e);for(const i of t)i.usedTimes--,0===i.usedTimes&&this.shaderCache.delete(i.code);return this.materialCache.delete(e),this}getVertexShaderID(e){return this._getShaderStage(e.vertexShader).id}getFragmentShaderID(e){return this._getShaderStage(e.fragmentShader).id}dispose(){this.shaderCache.clear(),this.materialCache.clear()}_getShaderCacheForMaterial(e){const t=this.materialCache;let i=t.get(e);return void 0===i&&(i=new Set,t.set(e,i)),i}_getShaderStage(e){const t=this.shaderCache;let i=t.get(e);return void 0===i&&(i=new pK(e),t.set(e,i)),i}}class pK{constructor(e){this.id=dK++,this.code=e,this.usedTimes=0}}function mK(n,e,t,i,r,s,o){const a=new Ex,c=new fK,l=[],u=r.isWebGL2,h=r.logarithmicDepthBuffer,d=r.vertexTextures;let f=r.precision;const p={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"};return{getParameters:function m(x,E,R,$,se){const H=$.fog,N=se.geometry,L=(x.isMeshStandardMaterial?t:e).get(x.envMap||(x.isMeshStandardMaterial?$.environment:null)),G=L&&306===L.mapping?L.image.height:null,F=p[x.type];null!==x.precision&&(f=r.getMaxPrecision(x.precision),f!==x.precision&&console.warn("THREE.WebGLProgram.getParameters:",x.precision,"not supported, using",f,"instead."));const O=N.morphAttributes.position||N.morphAttributes.normal||N.morphAttributes.color,V=void 0!==O?O.length:0;let re,fe,pe,We,ce=0;if(void 0!==N.morphAttributes.position&&(ce=1),void 0!==N.morphAttributes.normal&&(ce=2),void 0!==N.morphAttributes.color&&(ce=3),F){const ut=ws[F];re=ut.vertexShader,fe=ut.fragmentShader}else re=x.vertexShader,fe=x.fragmentShader,c.update(x),pe=c.getVertexShaderID(x),We=c.getFragmentShaderID(x);const te=n.getRenderTarget(),Fe=x.clearcoat>0,Le=x.iridescence>0;return{isWebGL2:u,shaderID:F,shaderName:x.type,vertexShader:re,fragmentShader:fe,defines:x.defines,customVertexShaderID:pe,customFragmentShaderID:We,isRawShaderMaterial:!0===x.isRawShaderMaterial,glslVersion:x.glslVersion,precision:f,instancing:!0===se.isInstancedMesh,instancingColor:!0===se.isInstancedMesh&&null!==se.instanceColor,supportsVertexTextures:d,outputEncoding:null===te?n.outputEncoding:!0===te.isXRRenderTarget?te.texture.encoding:Ga,map:!!x.map,matcap:!!x.matcap,envMap:!!L,envMapMode:L&&L.mapping,envMapCubeUVHeight:G,lightMap:!!x.lightMap,aoMap:!!x.aoMap,emissiveMap:!!x.emissiveMap,bumpMap:!!x.bumpMap,normalMap:!!x.normalMap,objectSpaceNormalMap:1===x.normalMapType,tangentSpaceNormalMap:0===x.normalMapType,decodeVideoTexture:!!x.map&&!0===x.map.isVideoTexture&&x.map.encoding===bn,clearcoat:Fe,clearcoatMap:Fe&&!!x.clearcoatMap,clearcoatRoughnessMap:Fe&&!!x.clearcoatRoughnessMap,clearcoatNormalMap:Fe&&!!x.clearcoatNormalMap,iridescence:Le,iridescenceMap:Le&&!!x.iridescenceMap,iridescenceThicknessMap:Le&&!!x.iridescenceThicknessMap,displacementMap:!!x.displacementMap,roughnessMap:!!x.roughnessMap,metalnessMap:!!x.metalnessMap,specularMap:!!x.specularMap,specularIntensityMap:!!x.specularIntensityMap,specularColorMap:!!x.specularColorMap,opaque:!1===x.transparent&&1===x.blending,alphaMap:!!x.alphaMap,alphaTest:x.alphaTest>0,gradientMap:!!x.gradientMap,sheen:x.sheen>0,sheenColorMap:!!x.sheenColorMap,sheenRoughnessMap:!!x.sheenRoughnessMap,transmission:x.transmission>0,transmissionMap:!!x.transmissionMap,thicknessMap:!!x.thicknessMap,combine:x.combine,vertexTangents:!!x.normalMap&&!!N.attributes.tangent,vertexColors:x.vertexColors,vertexAlphas:!0===x.vertexColors&&!!N.attributes.color&&4===N.attributes.color.itemSize,vertexUvs:!!(x.map||x.bumpMap||x.normalMap||x.specularMap||x.alphaMap||x.emissiveMap||x.roughnessMap||x.metalnessMap||x.clearcoatMap||x.clearcoatRoughnessMap||x.clearcoatNormalMap||x.iridescenceMap||x.iridescenceThicknessMap||x.displacementMap||x.transmissionMap||x.thicknessMap||x.specularIntensityMap||x.specularColorMap||x.sheenColorMap||x.sheenRoughnessMap),uvsVertexOnly:!(x.map||x.bumpMap||x.normalMap||x.specularMap||x.alphaMap||x.emissiveMap||x.roughnessMap||x.metalnessMap||x.clearcoatNormalMap||x.iridescenceMap||x.iridescenceThicknessMap||x.transmission>0||x.transmissionMap||x.thicknessMap||x.specularIntensityMap||x.specularColorMap||x.sheen>0||x.sheenColorMap||x.sheenRoughnessMap||!x.displacementMap),fog:!!H,useFog:!0===x.fog,fogExp2:H&&H.isFogExp2,flatShading:!!x.flatShading,sizeAttenuation:x.sizeAttenuation,logarithmicDepthBuffer:h,skinning:!0===se.isSkinnedMesh,morphTargets:void 0!==N.morphAttributes.position,morphNormals:void 0!==N.morphAttributes.normal,morphColors:void 0!==N.morphAttributes.color,morphTargetsCount:V,morphTextureStride:ce,numDirLights:E.directional.length,numPointLights:E.point.length,numSpotLights:E.spot.length,numSpotLightMaps:E.spotLightMap.length,numRectAreaLights:E.rectArea.length,numHemiLights:E.hemi.length,numDirLightShadows:E.directionalShadowMap.length,numPointLightShadows:E.pointShadowMap.length,numSpotLightShadows:E.spotShadowMap.length,numSpotLightShadowsWithMaps:E.numSpotLightShadowsWithMaps,numClippingPlanes:o.numPlanes,numClipIntersection:o.numIntersection,dithering:x.dithering,shadowMapEnabled:n.shadowMap.enabled&&R.length>0,shadowMapType:n.shadowMap.type,toneMapping:x.toneMapped?n.toneMapping:0,physicallyCorrectLights:n.physicallyCorrectLights,premultipliedAlpha:x.premultipliedAlpha,doubleSided:2===x.side,flipSided:1===x.side,useDepthPacking:!!x.depthPacking,depthPacking:x.depthPacking||0,index0AttributeName:x.index0AttributeName,extensionDerivatives:x.extensions&&x.extensions.derivatives,extensionFragDepth:x.extensions&&x.extensions.fragDepth,extensionDrawBuffers:x.extensions&&x.extensions.drawBuffers,extensionShaderTextureLOD:x.extensions&&x.extensions.shaderTextureLOD,rendererExtensionFragDepth:u||i.has("EXT_frag_depth"),rendererExtensionDrawBuffers:u||i.has("WEBGL_draw_buffers"),rendererExtensionShaderTextureLod:u||i.has("EXT_shader_texture_lod"),customProgramCacheKey:x.customProgramCacheKey()}},getProgramCacheKey:function g(x){const E=[];if(x.shaderID?E.push(x.shaderID):(E.push(x.customVertexShaderID),E.push(x.customFragmentShaderID)),void 0!==x.defines)for(const R in x.defines)E.push(R),E.push(x.defines[R]);return!1===x.isRawShaderMaterial&&(function _(x,E){x.push(E.precision),x.push(E.outputEncoding),x.push(E.envMapMode),x.push(E.envMapCubeUVHeight),x.push(E.combine),x.push(E.vertexUvs),x.push(E.fogExp2),x.push(E.sizeAttenuation),x.push(E.morphTargetsCount),x.push(E.morphAttributeCount),x.push(E.numDirLights),x.push(E.numPointLights),x.push(E.numSpotLights),x.push(E.numSpotLightMaps),x.push(E.numHemiLights),x.push(E.numRectAreaLights),x.push(E.numDirLightShadows),x.push(E.numPointLightShadows),x.push(E.numSpotLightShadows),x.push(E.numSpotLightShadowsWithMaps),x.push(E.shadowMapType),x.push(E.toneMapping),x.push(E.numClippingPlanes),x.push(E.numClipIntersection),x.push(E.depthPacking)}(E,x),function b(x,E){a.disableAll(),E.isWebGL2&&a.enable(0),E.supportsVertexTextures&&a.enable(1),E.instancing&&a.enable(2),E.instancingColor&&a.enable(3),E.map&&a.enable(4),E.matcap&&a.enable(5),E.envMap&&a.enable(6),E.lightMap&&a.enable(7),E.aoMap&&a.enable(8),E.emissiveMap&&a.enable(9),E.bumpMap&&a.enable(10),E.normalMap&&a.enable(11),E.objectSpaceNormalMap&&a.enable(12),E.tangentSpaceNormalMap&&a.enable(13),E.clearcoat&&a.enable(14),E.clearcoatMap&&a.enable(15),E.clearcoatRoughnessMap&&a.enable(16),E.clearcoatNormalMap&&a.enable(17),E.iridescence&&a.enable(18),E.iridescenceMap&&a.enable(19),E.iridescenceThicknessMap&&a.enable(20),E.displacementMap&&a.enable(21),E.specularMap&&a.enable(22),E.roughnessMap&&a.enable(23),E.metalnessMap&&a.enable(24),E.gradientMap&&a.enable(25),E.alphaMap&&a.enable(26),E.alphaTest&&a.enable(27),E.vertexColors&&a.enable(28),E.vertexAlphas&&a.enable(29),E.vertexUvs&&a.enable(30),E.vertexTangents&&a.enable(31),E.uvsVertexOnly&&a.enable(32),x.push(a.mask),a.disableAll(),E.fog&&a.enable(0),E.useFog&&a.enable(1),E.flatShading&&a.enable(2),E.logarithmicDepthBuffer&&a.enable(3),E.skinning&&a.enable(4),E.morphTargets&&a.enable(5),E.morphNormals&&a.enable(6),E.morphColors&&a.enable(7),E.premultipliedAlpha&&a.enable(8),E.shadowMapEnabled&&a.enable(9),E.physicallyCorrectLights&&a.enable(10),E.doubleSided&&a.enable(11),E.flipSided&&a.enable(12),E.useDepthPacking&&a.enable(13),E.dithering&&a.enable(14),E.specularIntensityMap&&a.enable(15),E.specularColorMap&&a.enable(16),E.transmission&&a.enable(17),E.transmissionMap&&a.enable(18),E.thicknessMap&&a.enable(19),E.sheen&&a.enable(20),E.sheenColorMap&&a.enable(21),E.sheenRoughnessMap&&a.enable(22),E.decodeVideoTexture&&a.enable(23),E.opaque&&a.enable(24),x.push(a.mask)}(E,x),E.push(n.outputEncoding)),E.push(x.customProgramCacheKey),E.join()},getUniforms:function y(x){const E=p[x.type];let R;return R=E?sO.clone(ws[E].uniforms):x.uniforms,R},acquireProgram:function v(x,E){let R;for(let $=0,se=l.length;$<se;$++){const H=l[$];if(H.cacheKey===E){R=H,++R.usedTimes;break}}return void 0===R&&(R=new hK(n,E,x,s),l.push(R)),R},releaseProgram:function w(x){if(0==--x.usedTimes){const E=l.indexOf(x);l[E]=l[l.length-1],l.pop(),x.destroy()}},releaseShaderCache:function M(x){c.remove(x)},programs:l,dispose:function I(){c.dispose()}}}function gK(){let n=new WeakMap;return{get:function e(s){let o=n.get(s);return void 0===o&&(o={},n.set(s,o)),o},remove:function t(s){n.delete(s)},update:function i(s,o,a){n.get(s)[o]=a},dispose:function r(){n=new WeakMap}}}function _K(n,e){return n.groupOrder!==e.groupOrder?n.groupOrder-e.groupOrder:n.renderOrder!==e.renderOrder?n.renderOrder-e.renderOrder:n.material.id!==e.material.id?n.material.id-e.material.id:n.z!==e.z?n.z-e.z:n.id-e.id}function IO(n,e){return n.groupOrder!==e.groupOrder?n.groupOrder-e.groupOrder:n.renderOrder!==e.renderOrder?n.renderOrder-e.renderOrder:n.z!==e.z?e.z-n.z:n.id-e.id}function PO(){const n=[];let e=0;const t=[],i=[],r=[];function o(h,d,f,p,m,g){let _=n[e];return void 0===_?(_={id:h.id,object:h,geometry:d,material:f,groupOrder:p,renderOrder:h.renderOrder,z:m,group:g},n[e]=_):(_.id=h.id,_.object=h,_.geometry=d,_.material=f,_.groupOrder=p,_.renderOrder=h.renderOrder,_.z=m,_.group=g),e++,_}return{opaque:t,transmissive:i,transparent:r,init:function s(){e=0,t.length=0,i.length=0,r.length=0},push:function a(h,d,f,p,m,g){const _=o(h,d,f,p,m,g);f.transmission>0?i.push(_):!0===f.transparent?r.push(_):t.push(_)},unshift:function c(h,d,f,p,m,g){const _=o(h,d,f,p,m,g);f.transmission>0?i.unshift(_):!0===f.transparent?r.unshift(_):t.unshift(_)},finish:function u(){for(let h=e,d=n.length;h<d;h++){const f=n[h];if(null===f.id)break;f.id=null,f.object=null,f.geometry=null,f.material=null,f.group=null}},sort:function l(h,d){t.length>1&&t.sort(h||_K),i.length>1&&i.sort(d||IO),r.length>1&&r.sort(d||IO)}}}function yK(){let n=new WeakMap;return{get:function e(i,r){const s=n.get(i);let o;return void 0===s?(o=new PO,n.set(i,[o])):r>=s.length?(o=new PO,s.push(o)):o=s[r],o},dispose:function t(){n=new WeakMap}}}function vK(){const n={};return{get:function(e){if(void 0!==n[e.id])return n[e.id];let t;switch(e.type){case"DirectionalLight":t={direction:new S,color:new Ie};break;case"SpotLight":t={position:new S,direction:new S,color:new Ie,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":t={position:new S,color:new Ie,distance:0,decay:0};break;case"HemisphereLight":t={direction:new S,skyColor:new Ie,groundColor:new Ie};break;case"RectAreaLight":t={color:new Ie,position:new S,halfWidth:new S,halfHeight:new S}}return n[e.id]=t,t}}}let xK=0;function wK(n,e){return(e.castShadow?2:0)-(n.castShadow?2:0)+(e.map?1:0)-(n.map?1:0)}function MK(n,e){const t=new vK,i=function bK(){const n={};return{get:function(e){if(void 0!==n[e.id])return n[e.id];let t;switch(e.type){case"DirectionalLight":case"SpotLight":t={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new ee};break;case"PointLight":t={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new ee,shadowCameraNear:1,shadowCameraFar:1e3}}return n[e.id]=t,t}}}(),r={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1,numSpotMaps:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotLightMap:[],spotShadow:[],spotShadowMap:[],spotLightMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[],numSpotLightShadowsWithMaps:0};for(let u=0;u<9;u++)r.probe.push(new S);const s=new S,o=new ct,a=new ct;return{setup:function c(u,h){let d=0,f=0,p=0;for(let $=0;$<9;$++)r.probe[$].set(0,0,0);let m=0,g=0,_=0,b=0,y=0,v=0,w=0,M=0,I=0,x=0;u.sort(wK);const E=!0!==h?Math.PI:1;for(let $=0,se=u.length;$<se;$++){const H=u[$],N=H.color,X=H.intensity,L=H.distance,G=H.shadow&&H.shadow.map?H.shadow.map.texture:null;if(H.isAmbientLight)d+=N.r*X*E,f+=N.g*X*E,p+=N.b*X*E;else if(H.isLightProbe)for(let F=0;F<9;F++)r.probe[F].addScaledVector(H.sh.coefficients[F],X);else if(H.isDirectionalLight){const F=t.get(H);if(F.color.copy(H.color).multiplyScalar(H.intensity*E),H.castShadow){const O=H.shadow,V=i.get(H);V.shadowBias=O.bias,V.shadowNormalBias=O.normalBias,V.shadowRadius=O.radius,V.shadowMapSize=O.mapSize,r.directionalShadow[m]=V,r.directionalShadowMap[m]=G,r.directionalShadowMatrix[m]=H.shadow.matrix,v++}r.directional[m]=F,m++}else if(H.isSpotLight){const F=t.get(H);F.position.setFromMatrixPosition(H.matrixWorld),F.color.copy(N).multiplyScalar(X*E),F.distance=L,F.coneCos=Math.cos(H.angle),F.penumbraCos=Math.cos(H.angle*(1-H.penumbra)),F.decay=H.decay,r.spot[_]=F;const O=H.shadow;if(H.map&&(r.spotLightMap[I]=H.map,I++,O.updateMatrices(H),H.castShadow&&x++),r.spotLightMatrix[_]=O.matrix,H.castShadow){const V=i.get(H);V.shadowBias=O.bias,V.shadowNormalBias=O.normalBias,V.shadowRadius=O.radius,V.shadowMapSize=O.mapSize,r.spotShadow[_]=V,r.spotShadowMap[_]=G,M++}_++}else if(H.isRectAreaLight){const F=t.get(H);F.color.copy(N).multiplyScalar(X),F.halfWidth.set(.5*H.width,0,0),F.halfHeight.set(0,.5*H.height,0),r.rectArea[b]=F,b++}else if(H.isPointLight){const F=t.get(H);if(F.color.copy(H.color).multiplyScalar(H.intensity*E),F.distance=H.distance,F.decay=H.decay,H.castShadow){const O=H.shadow,V=i.get(H);V.shadowBias=O.bias,V.shadowNormalBias=O.normalBias,V.shadowRadius=O.radius,V.shadowMapSize=O.mapSize,V.shadowCameraNear=O.camera.near,V.shadowCameraFar=O.camera.far,r.pointShadow[g]=V,r.pointShadowMap[g]=G,r.pointShadowMatrix[g]=H.shadow.matrix,w++}r.point[g]=F,g++}else if(H.isHemisphereLight){const F=t.get(H);F.skyColor.copy(H.color).multiplyScalar(X*E),F.groundColor.copy(H.groundColor).multiplyScalar(X*E),r.hemi[y]=F,y++}}b>0&&(e.isWebGL2||!0===n.has("OES_texture_float_linear")?(r.rectAreaLTC1=ve.LTC_FLOAT_1,r.rectAreaLTC2=ve.LTC_FLOAT_2):!0===n.has("OES_texture_half_float_linear")?(r.rectAreaLTC1=ve.LTC_HALF_1,r.rectAreaLTC2=ve.LTC_HALF_2):console.error("THREE.WebGLRenderer: Unable to use RectAreaLight. Missing WebGL extensions.")),r.ambient[0]=d,r.ambient[1]=f,r.ambient[2]=p;const R=r.hash;(R.directionalLength!==m||R.pointLength!==g||R.spotLength!==_||R.rectAreaLength!==b||R.hemiLength!==y||R.numDirectionalShadows!==v||R.numPointShadows!==w||R.numSpotShadows!==M||R.numSpotMaps!==I)&&(r.directional.length=m,r.spot.length=_,r.rectArea.length=b,r.point.length=g,r.hemi.length=y,r.directionalShadow.length=v,r.directionalShadowMap.length=v,r.pointShadow.length=w,r.pointShadowMap.length=w,r.spotShadow.length=M,r.spotShadowMap.length=M,r.directionalShadowMatrix.length=v,r.pointShadowMatrix.length=w,r.spotLightMatrix.length=M+I-x,r.spotLightMap.length=I,r.numSpotLightShadowsWithMaps=x,R.directionalLength=m,R.pointLength=g,R.spotLength=_,R.rectAreaLength=b,R.hemiLength=y,R.numDirectionalShadows=v,R.numPointShadows=w,R.numSpotShadows=M,R.numSpotMaps=I,r.version=xK++)},setupView:function l(u,h){let d=0,f=0,p=0,m=0,g=0;const _=h.matrixWorldInverse;for(let b=0,y=u.length;b<y;b++){const v=u[b];if(v.isDirectionalLight){const w=r.directional[d];w.direction.setFromMatrixPosition(v.matrixWorld),s.setFromMatrixPosition(v.target.matrixWorld),w.direction.sub(s),w.direction.transformDirection(_),d++}else if(v.isSpotLight){const w=r.spot[p];w.position.setFromMatrixPosition(v.matrixWorld),w.position.applyMatrix4(_),w.direction.setFromMatrixPosition(v.matrixWorld),s.setFromMatrixPosition(v.target.matrixWorld),w.direction.sub(s),w.direction.transformDirection(_),p++}else if(v.isRectAreaLight){const w=r.rectArea[m];w.position.setFromMatrixPosition(v.matrixWorld),w.position.applyMatrix4(_),a.identity(),o.copy(v.matrixWorld),o.premultiply(_),a.extractRotation(o),w.halfWidth.set(.5*v.width,0,0),w.halfHeight.set(0,.5*v.height,0),w.halfWidth.applyMatrix4(a),w.halfHeight.applyMatrix4(a),m++}else if(v.isPointLight){const w=r.point[f];w.position.setFromMatrixPosition(v.matrixWorld),w.position.applyMatrix4(_),f++}else if(v.isHemisphereLight){const w=r.hemi[g];w.direction.setFromMatrixPosition(v.matrixWorld),w.direction.transformDirection(_),g++}}},state:r}}function RO(n,e){const t=new MK(n,e),i=[],r=[];return{init:function s(){i.length=0,r.length=0},state:{lightsArray:i,shadowsArray:r,lights:t},setupLights:function c(h){t.setup(i,h)},setupLightsView:function l(h){t.setupView(i,h)},pushLight:function o(h){i.push(h)},pushShadow:function a(h){r.push(h)}}}function CK(n,e){let t=new WeakMap;return{get:function i(s,o=0){const a=t.get(s);let c;return void 0===a?(c=new RO(n,e),t.set(s,[c])):o>=a.length?(c=new RO(n,e),a.push(c)):c=a[o],c},dispose:function r(){t=new WeakMap}}}class OO extends Ja{constructor(e){super(),this.isMeshDepthMaterial=!0,this.type="MeshDepthMaterial",this.depthPacking=3200,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.setValues(e)}copy(e){return super.copy(e),this.depthPacking=e.depthPacking,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this}}class kO extends Ja{constructor(e){super(),this.isMeshDistanceMaterial=!0,this.type="MeshDistanceMaterial",this.referencePosition=new S,this.nearDistance=1,this.farDistance=1e3,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.setValues(e)}copy(e){return super.copy(e),this.referencePosition.copy(e.referencePosition),this.nearDistance=e.nearDistance,this.farDistance=e.farDistance,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this}}function DK(n,e,t){let i=new Bx;const r=new ee,s=new ee,o=new qt,a=new OO({depthPacking:3201}),c=new kO,l={},u=t.maxTextureSize,h={0:1,1:0,2:2},d=new xs({defines:{VSM_SAMPLES:8},uniforms:{shadow_pass:{value:null},resolution:{value:new ee},radius:{value:4}},vertexShader:"void main() {\n\tgl_Position = vec4( position, 1.0 );\n}",fragmentShader:"uniform sampler2D shadow_pass;\nuniform vec2 resolution;\nuniform float radius;\n#include <packing>\nvoid main() {\n\tconst float samples = float( VSM_SAMPLES );\n\tfloat mean = 0.0;\n\tfloat squared_mean = 0.0;\n\tfloat uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );\n\tfloat uvStart = samples <= 1.0 ? 0.0 : - 1.0;\n\tfor ( float i = 0.0; i < samples; i ++ ) {\n\t\tfloat uvOffset = uvStart + i * uvStride;\n\t\t#ifdef HORIZONTAL_PASS\n\t\t\tvec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ) );\n\t\t\tmean += distribution.x;\n\t\t\tsquared_mean += distribution.y * distribution.y + distribution.x * distribution.x;\n\t\t#else\n\t\t\tfloat depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ) );\n\t\t\tmean += depth;\n\t\t\tsquared_mean += depth * depth;\n\t\t#endif\n\t}\n\tmean = mean / samples;\n\tsquared_mean = squared_mean / samples;\n\tfloat std_dev = sqrt( squared_mean - mean * mean );\n\tgl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );\n}"}),f=d.clone();f.defines.HORIZONTAL_PASS=1;const p=new gt;p.setAttribute("position",new qn(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));const m=new Qn(p,d),g=this;function _(v,w){const M=e.update(m);d.defines.VSM_SAMPLES!==v.blurSamples&&(d.defines.VSM_SAMPLES=v.blurSamples,f.defines.VSM_SAMPLES=v.blurSamples,d.needsUpdate=!0,f.needsUpdate=!0),null===v.mapPass&&(v.mapPass=new Fo(r.x,r.y)),d.uniforms.shadow_pass.value=v.map.texture,d.uniforms.resolution.value=v.mapSize,d.uniforms.radius.value=v.radius,n.setRenderTarget(v.mapPass),n.clear(),n.renderBufferDirect(w,null,M,d,m,null),f.uniforms.shadow_pass.value=v.mapPass.texture,f.uniforms.resolution.value=v.mapSize,f.uniforms.radius.value=v.radius,n.setRenderTarget(v.map),n.clear(),n.renderBufferDirect(w,null,M,f,m,null)}function b(v,w,M,I,x,E){let R=null;const $=!0===M.isPointLight?v.customDistanceMaterial:v.customDepthMaterial;if(R=void 0!==$?$:!0===M.isPointLight?c:a,n.localClippingEnabled&&!0===w.clipShadows&&Array.isArray(w.clippingPlanes)&&0!==w.clippingPlanes.length||w.displacementMap&&0!==w.displacementScale||w.alphaMap&&w.alphaTest>0){const se=R.uuid,H=w.uuid;let N=l[se];void 0===N&&(N={},l[se]=N);let X=N[H];void 0===X&&(X=R.clone(),N[H]=X),R=X}return R.visible=w.visible,R.wireframe=w.wireframe,R.side=3===E?null!==w.shadowSide?w.shadowSide:w.side:null!==w.shadowSide?w.shadowSide:h[w.side],R.alphaMap=w.alphaMap,R.alphaTest=w.alphaTest,R.clipShadows=w.clipShadows,R.clippingPlanes=w.clippingPlanes,R.clipIntersection=w.clipIntersection,R.displacementMap=w.displacementMap,R.displacementScale=w.displacementScale,R.displacementBias=w.displacementBias,R.wireframeLinewidth=w.wireframeLinewidth,R.linewidth=w.linewidth,!0===M.isPointLight&&!0===R.isMeshDistanceMaterial&&(R.referencePosition.setFromMatrixPosition(M.matrixWorld),R.nearDistance=I,R.farDistance=x),R}function y(v,w,M,I,x){if(!1===v.visible)return;if(v.layers.test(w.layers)&&(v.isMesh||v.isLine||v.isPoints)&&(v.castShadow||v.receiveShadow&&3===x)&&(!v.frustumCulled||i.intersectsObject(v))){v.modelViewMatrix.multiplyMatrices(M.matrixWorldInverse,v.matrixWorld);const $=e.update(v),se=v.material;if(Array.isArray(se)){const H=$.groups;for(let N=0,X=H.length;N<X;N++){const L=H[N],G=se[L.materialIndex];if(G&&G.visible){const F=b(v,G,I,M.near,M.far,x);n.renderBufferDirect(M,null,$,F,v,L)}}}else if(se.visible){const H=b(v,se,I,M.near,M.far,x);n.renderBufferDirect(M,null,$,H,v,null)}}const R=v.children;for(let $=0,se=R.length;$<se;$++)y(R[$],w,M,I,x)}this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=1,this.render=function(v,w,M){if(!1===g.enabled||!1===g.autoUpdate&&!1===g.needsUpdate||0===v.length)return;const I=n.getRenderTarget(),x=n.getActiveCubeFace(),E=n.getActiveMipmapLevel(),R=n.state;R.setBlending(0),R.buffers.color.setClear(1,1,1,1),R.buffers.depth.setTest(!0),R.setScissorTest(!1);for(let $=0,se=v.length;$<se;$++){const H=v[$],N=H.shadow;if(void 0===N){console.warn("THREE.WebGLShadowMap:",H,"has no shadow.");continue}if(!1===N.autoUpdate&&!1===N.needsUpdate)continue;r.copy(N.mapSize);const X=N.getFrameExtents();r.multiply(X),s.copy(N.mapSize),(r.x>u||r.y>u)&&(r.x>u&&(s.x=Math.floor(u/X.x),r.x=s.x*X.x,N.mapSize.x=s.x),r.y>u&&(s.y=Math.floor(u/X.y),r.y=s.y*X.y,N.mapSize.y=s.y)),null===N.map&&(N.map=new Fo(r.x,r.y,3!==this.type?{minFilter:jn,magFilter:jn}:{}),N.map.texture.name=H.name+".shadowMap",N.camera.updateProjectionMatrix()),n.setRenderTarget(N.map),n.clear();const L=N.getViewportCount();for(let G=0;G<L;G++){const F=N.getViewport(G);o.set(s.x*F.x,s.y*F.y,s.x*F.z,s.y*F.w),R.viewport(o),N.updateMatrices(H,G),i=N.getFrustum(),y(w,M,N.camera,H,this.type)}!0!==N.isPointLightShadow&&3===this.type&&_(N,M),N.needsUpdate=!1}g.needsUpdate=!1,n.setRenderTarget(I,x,E)}}function TK(n,e,t){const i=t.isWebGL2,a=new function r(){let k=!1;const Q=new qt;let he=null;const Ae=new qt(0,0,0,0);return{setMask:function(He){he!==He&&!k&&(n.colorMask(He,He,He,He),he=He)},setLocked:function(He){k=He},setClear:function(He,Ht,ti,vi,yc){!0===yc&&(He*=vi,Ht*=vi,ti*=vi),Q.set(He,Ht,ti,vi),!1===Ae.equals(Q)&&(n.clearColor(He,Ht,ti,vi),Ae.copy(Q))},reset:function(){k=!1,he=null,Ae.set(-1,0,0,0)}}},c=new function s(){let k=!1,Q=null,he=null,Ae=null;return{setTest:function(He){He?Be(2929):Fe(2929)},setMask:function(He){Q!==He&&!k&&(n.depthMask(He),Q=He)},setFunc:function(He){if(he!==He){switch(He){case 0:n.depthFunc(512);break;case 1:n.depthFunc(519);break;case 2:n.depthFunc(513);break;case 3:default:n.depthFunc(515);break;case 4:n.depthFunc(514);break;case 5:n.depthFunc(518);break;case 6:n.depthFunc(516);break;case 7:n.depthFunc(517)}he=He}},setLocked:function(He){k=He},setClear:function(He){Ae!==He&&(n.clearDepth(He),Ae=He)},reset:function(){k=!1,Q=null,he=null,Ae=null}}},l=new function o(){let k=!1,Q=null,he=null,Ae=null,He=null,Ht=null,ti=null,vi=null,yc=null;return{setTest:function(fn){k||(fn?Be(2960):Fe(2960))},setMask:function(fn){Q!==fn&&!k&&(n.stencilMask(fn),Q=fn)},setFunc:function(fn,po,Or){(he!==fn||Ae!==po||He!==Or)&&(n.stencilFunc(fn,po,Or),he=fn,Ae=po,He=Or)},setOp:function(fn,po,Or){(Ht!==fn||ti!==po||vi!==Or)&&(n.stencilOp(fn,po,Or),Ht=fn,ti=po,vi=Or)},setLocked:function(fn){k=fn},setClear:function(fn){yc!==fn&&(n.clearStencil(fn),yc=fn)},reset:function(){k=!1,Q=null,he=null,Ae=null,He=null,Ht=null,ti=null,vi=null,yc=null}}},u=new WeakMap,h=new WeakMap;let d={},f={},p=new WeakMap,m=[],g=null,_=!1,b=null,y=null,v=null,w=null,M=null,I=null,x=null,E=!1,R=null,$=null,se=null,H=null,N=null;const X=n.getParameter(35661);let L=!1,G=0;const F=n.getParameter(7938);-1!==F.indexOf("WebGL")?(G=parseFloat(/^WebGL (\d)/.exec(F)[1]),L=G>=1):-1!==F.indexOf("OpenGL ES")&&(G=parseFloat(/^OpenGL ES (\d)/.exec(F)[1]),L=G>=2);let O=null,V={};const ce=n.getParameter(3088),re=n.getParameter(2978),fe=(new qt).fromArray(ce),pe=(new qt).fromArray(re);function We(k,Q,he){const Ae=new Uint8Array(4),He=n.createTexture();n.bindTexture(k,He),n.texParameteri(k,10241,9728),n.texParameteri(k,10240,9728);for(let Ht=0;Ht<he;Ht++)n.texImage2D(Q+Ht,0,6408,1,1,0,6408,5121,Ae);return He}const te={};function Be(k){!0!==d[k]&&(n.enable(k),d[k]=!0)}function Fe(k){!1!==d[k]&&(n.disable(k),d[k]=!1)}te[3553]=We(3553,3553,1),te[34067]=We(34067,34069,6),a.setClear(0,0,0,1),c.setClear(1),l.setClear(0),Be(2929),c.setFunc(3),be(!1),lt(1),Be(2884),_e(0);const oe={100:32774,101:32778,102:32779};if(i)oe[103]=32775,oe[104]=32776;else{const k=e.get("EXT_blend_minmax");null!==k&&(oe[103]=k.MIN_EXT,oe[104]=k.MAX_EXT)}const ne={200:0,201:1,202:768,204:770,210:776,208:774,206:772,203:769,205:771,209:775,207:773};function _e(k,Q,he,Ae,He,Ht,ti,vi){if(0!==k){if(!1===_&&(Be(3042),_=!0),5===k)He=He||Q,Ht=Ht||he,ti=ti||Ae,(Q!==y||He!==M)&&(n.blendEquationSeparate(oe[Q],oe[He]),y=Q,M=He),(he!==v||Ae!==w||Ht!==I||ti!==x)&&(n.blendFuncSeparate(ne[he],ne[Ae],ne[Ht],ne[ti]),v=he,w=Ae,I=Ht,x=ti),b=k,E=null;else if(k!==b||vi!==E){if((100!==y||100!==M)&&(n.blendEquation(32774),y=100,M=100),vi)switch(k){case 1:n.blendFuncSeparate(1,771,1,771);break;case 2:n.blendFunc(1,1);break;case 3:n.blendFuncSeparate(0,769,0,1);break;case 4:n.blendFuncSeparate(0,768,0,770);break;default:console.error("THREE.WebGLState: Invalid blending: ",k)}else switch(k){case 1:n.blendFuncSeparate(770,771,1,771);break;case 2:n.blendFunc(770,1);break;case 3:n.blendFuncSeparate(0,769,0,1);break;case 4:n.blendFunc(0,768);break;default:console.error("THREE.WebGLState: Invalid blending: ",k)}v=null,w=null,I=null,x=null,b=k,E=vi}}else!0===_&&(Fe(3042),_=!1)}function be(k){R!==k&&(n.frontFace(k?2304:2305),R=k)}function lt(k){0!==k?(Be(2884),k!==$&&n.cullFace(1===k?1029:2===k?1028:1032)):Fe(2884),$=k}function $e(k,Q,he){k?(Be(32823),(H!==Q||N!==he)&&(n.polygonOffset(Q,he),H=Q,N=he)):Fe(32823)}return{buffers:{color:a,depth:c,stencil:l},enable:Be,disable:Fe,bindFramebuffer:function Le(k,Q){return f[k]!==Q&&(n.bindFramebuffer(k,Q),f[k]=Q,i&&(36009===k&&(f[36160]=Q),36160===k&&(f[36009]=Q)),!0)},drawBuffers:function ye(k,Q){let he=m,Ae=!1;if(k)if(he=p.get(Q),void 0===he&&(he=[],p.set(Q,he)),k.isWebGLMultipleRenderTargets){const He=k.texture;if(he.length!==He.length||36064!==he[0]){for(let Ht=0,ti=He.length;Ht<ti;Ht++)he[Ht]=36064+Ht;he.length=He.length,Ae=!0}}else 36064!==he[0]&&(he[0]=36064,Ae=!0);else 1029!==he[0]&&(he[0]=1029,Ae=!0);Ae&&(t.isWebGL2?n.drawBuffers(he):e.get("WEBGL_draw_buffers").drawBuffersWEBGL(he))},useProgram:function ut(k){return g!==k&&(n.useProgram(k),g=k,!0)},setBlending:_e,setMaterial:function ke(k,Q){2===k.side?Fe(2884):Be(2884);let he=1===k.side;Q&&(he=!he),be(he),1===k.blending&&!1===k.transparent?_e(0):_e(k.blending,k.blendEquation,k.blendSrc,k.blendDst,k.blendEquationAlpha,k.blendSrcAlpha,k.blendDstAlpha,k.premultipliedAlpha),c.setFunc(k.depthFunc),c.setTest(k.depthTest),c.setMask(k.depthWrite),a.setMask(k.colorWrite);const Ae=k.stencilWrite;l.setTest(Ae),Ae&&(l.setMask(k.stencilWriteMask),l.setFunc(k.stencilFunc,k.stencilRef,k.stencilFuncMask),l.setOp(k.stencilFail,k.stencilZFail,k.stencilZPass)),$e(k.polygonOffset,k.polygonOffsetFactor,k.polygonOffsetUnits),!0===k.alphaToCoverage?Be(32926):Fe(32926)},setFlipSided:be,setCullFace:lt,setLineWidth:function Qe(k){k!==se&&(L&&n.lineWidth(k),se=k)},setPolygonOffset:$e,setScissorTest:function Xt(k){k?Be(3089):Fe(3089)},activeTexture:function zt(k){void 0===k&&(k=33984+X-1),O!==k&&(n.activeTexture(k),O=k)},bindTexture:function T(k,Q,he){void 0===he&&(he=null===O?33984+X-1:O);let Ae=V[he];void 0===Ae&&(Ae={type:void 0,texture:void 0},V[he]=Ae),(Ae.type!==k||Ae.texture!==Q)&&(O!==he&&(n.activeTexture(he),O=he),n.bindTexture(k,Q||te[k]),Ae.type=k,Ae.texture=Q)},unbindTexture:function C(){const k=V[O];void 0!==k&&void 0!==k.type&&(n.bindTexture(k.type,null),k.type=void 0,k.texture=void 0)},compressedTexImage2D:function q(){try{n.compressedTexImage2D.apply(n,arguments)}catch(k){console.error("THREE.WebGLState:",k)}},compressedTexImage3D:function ue(){try{n.compressedTexImage3D.apply(n,arguments)}catch(k){console.error("THREE.WebGLState:",k)}},texImage2D:function Pe(){try{n.texImage2D.apply(n,arguments)}catch(k){console.error("THREE.WebGLState:",k)}},texImage3D:function De(){try{n.texImage3D.apply(n,arguments)}catch(k){console.error("THREE.WebGLState:",k)}},updateUBOMapping:function Dt(k,Q){let he=h.get(Q);void 0===he&&(he=new WeakMap,h.set(Q,he));let Ae=he.get(k);void 0===Ae&&(Ae=n.getUniformBlockIndex(Q,k.name),he.set(k,Ae))},uniformBlockBinding:function It(k,Q){const Ae=h.get(Q).get(k);u.get(k)!==Ae&&(n.uniformBlockBinding(Q,Ae,k.__bindingPointIndex),u.set(k,Ae))},texStorage2D:function B(){try{n.texStorage2D.apply(n,arguments)}catch(k){console.error("THREE.WebGLState:",k)}},texStorage3D:function Ee(){try{n.texStorage3D.apply(n,arguments)}catch(k){console.error("THREE.WebGLState:",k)}},texSubImage2D:function me(){try{n.texSubImage2D.apply(n,arguments)}catch(k){console.error("THREE.WebGLState:",k)}},texSubImage3D:function Me(){try{n.texSubImage3D.apply(n,arguments)}catch(k){console.error("THREE.WebGLState:",k)}},compressedTexSubImage2D:function et(){try{n.compressedTexSubImage2D.apply(n,arguments)}catch(k){console.error("THREE.WebGLState:",k)}},compressedTexSubImage3D:function P(){try{n.compressedTexSubImage3D.apply(n,arguments)}catch(k){console.error("THREE.WebGLState:",k)}},scissor:function ze(k){!1===fe.equals(k)&&(n.scissor(k.x,k.y,k.z,k.w),fe.copy(k))},viewport:function Ue(k){!1===pe.equals(k)&&(n.viewport(k.x,k.y,k.z,k.w),pe.copy(k))},reset:function Yt(){n.disable(3042),n.disable(2884),n.disable(2929),n.disable(32823),n.disable(3089),n.disable(2960),n.disable(32926),n.blendEquation(32774),n.blendFunc(1,0),n.blendFuncSeparate(1,0,1,0),n.colorMask(!0,!0,!0,!0),n.clearColor(0,0,0,0),n.depthMask(!0),n.depthFunc(513),n.clearDepth(1),n.stencilMask(4294967295),n.stencilFunc(519,0,4294967295),n.stencilOp(7680,7680,7680),n.clearStencil(0),n.cullFace(1029),n.frontFace(2305),n.polygonOffset(0,0),n.activeTexture(33984),n.bindFramebuffer(36160,null),!0===i&&(n.bindFramebuffer(36009,null),n.bindFramebuffer(36008,null)),n.useProgram(null),n.lineWidth(1),n.scissor(0,0,n.canvas.width,n.canvas.height),n.viewport(0,0,n.canvas.width,n.canvas.height),d={},O=null,V={},f={},p=new WeakMap,m=[],g=null,_=!1,b=null,y=null,v=null,w=null,M=null,I=null,x=null,E=!1,R=null,$=null,se=null,H=null,N=null,fe.set(0,0,n.canvas.width,n.canvas.height),pe.set(0,0,n.canvas.width,n.canvas.height),a.reset(),c.reset(),l.reset()}}}function AK(n,e,t,i,r,s,o){const a=r.isWebGL2,c=r.maxTextures,l=r.maxCubemapSize,u=r.maxTextureSize,h=r.maxSamples,d=e.has("WEBGL_multisampled_render_to_texture")?e.get("WEBGL_multisampled_render_to_texture"):null,f=/OculusBrowser/g.test(typeof navigator>"u"?"":navigator.userAgent),p=new WeakMap;let m;const g=new WeakMap;let _=!1;try{_=typeof OffscreenCanvas<"u"&&null!==new OffscreenCanvas(1,1).getContext("2d")}catch{}function b(T,C){return _?new OffscreenCanvas(T,C):ad("canvas")}function y(T,C,q,ue){let me=1;if((T.width>ue||T.height>ue)&&(me=ue/Math.max(T.width,T.height)),me<1||!0===C){if(typeof HTMLImageElement<"u"&&T instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&T instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&T instanceof ImageBitmap){const Me=C?wm:Math.floor,et=Me(me*T.width),P=Me(me*T.height);void 0===m&&(m=b(et,P));const B=q?b(et,P):m;return B.width=et,B.height=P,B.getContext("2d").drawImage(T,0,0,et,P),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+T.width+"x"+T.height+") to ("+et+"x"+P+")."),B}return"data"in T&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+T.width+"x"+T.height+")."),T}return T}function v(T){return px(T.width)&&px(T.height)}function M(T,C){return T.generateMipmaps&&C&&T.minFilter!==jn&&T.minFilter!==Nn}function I(T){n.generateMipmap(T)}function x(T,C,q,ue,me=!1){if(!1===a)return C;if(null!==T){if(void 0!==n[T])return n[T];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+T+"'")}let Me=C;return 6403===C&&(5126===q&&(Me=33326),5131===q&&(Me=33325),5121===q&&(Me=33321)),33319===C&&(5126===q&&(Me=33328),5131===q&&(Me=33327),5121===q&&(Me=33323)),6408===C&&(5126===q&&(Me=34836),5131===q&&(Me=34842),5121===q&&(Me=ue===bn&&!1===me?35907:32856),32819===q&&(Me=32854),32820===q&&(Me=32855)),(33325===Me||33326===Me||33327===Me||33328===Me||34842===Me||34836===Me)&&e.get("EXT_color_buffer_float"),Me}function E(T,C,q){return!0===M(T,q)||T.isFramebufferTexture&&T.minFilter!==jn&&T.minFilter!==Nn?Math.log2(Math.max(C.width,C.height))+1:void 0!==T.mipmaps&&T.mipmaps.length>0?T.mipmaps.length:T.isCompressedTexture&&Array.isArray(T.image)?C.mipmaps.length:1}function R(T){return T===jn||1004===T||1005===T?9728:9729}function $(T){const C=T.target;C.removeEventListener("dispose",$),function H(T){const C=i.get(T);if(void 0===C.__webglInit)return;const q=T.source,ue=g.get(q);if(ue){const me=ue[C.__cacheKey];me.usedTimes--,0===me.usedTimes&&N(T),0===Object.keys(ue).length&&g.delete(q)}i.remove(T)}(C),C.isVideoTexture&&p.delete(C)}function se(T){const C=T.target;C.removeEventListener("dispose",se),function X(T){const C=T.texture,q=i.get(T),ue=i.get(C);if(void 0!==ue.__webglTexture&&(n.deleteTexture(ue.__webglTexture),o.memory.textures--),T.depthTexture&&T.depthTexture.dispose(),T.isWebGLCubeRenderTarget)for(let me=0;me<6;me++)n.deleteFramebuffer(q.__webglFramebuffer[me]),q.__webglDepthbuffer&&n.deleteRenderbuffer(q.__webglDepthbuffer[me]);else{if(n.deleteFramebuffer(q.__webglFramebuffer),q.__webglDepthbuffer&&n.deleteRenderbuffer(q.__webglDepthbuffer),q.__webglMultisampledFramebuffer&&n.deleteFramebuffer(q.__webglMultisampledFramebuffer),q.__webglColorRenderbuffer)for(let me=0;me<q.__webglColorRenderbuffer.length;me++)q.__webglColorRenderbuffer[me]&&n.deleteRenderbuffer(q.__webglColorRenderbuffer[me]);q.__webglDepthRenderbuffer&&n.deleteRenderbuffer(q.__webglDepthRenderbuffer)}if(T.isWebGLMultipleRenderTargets)for(let me=0,Me=C.length;me<Me;me++){const et=i.get(C[me]);et.__webglTexture&&(n.deleteTexture(et.__webglTexture),o.memory.textures--),i.remove(C[me])}i.remove(C),i.remove(T)}(C)}function N(T){const C=i.get(T);n.deleteTexture(C.__webglTexture),delete g.get(T.source)[C.__cacheKey],o.memory.textures--}let L=0;function V(T,C){const q=i.get(T);if(T.isVideoTexture&&function Xt(T){const C=o.render.frame;p.get(T)!==C&&(p.set(T,C),T.update())}(T),!1===T.isRenderTargetTexture&&T.version>0&&q.__version!==T.version){const ue=T.image;if(null===ue)console.warn("THREE.WebGLRenderer: Texture marked for update but no image data found.");else{if(!1!==ue.complete)return void Fe(q,T,C);console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete")}}t.bindTexture(3553,q.__webglTexture,33984+C)}const pe={1e3:10497,[Ai]:33071,1002:33648},We={[jn]:9728,1004:9984,1005:9986,[Nn]:9729,1007:9985,1008:9987};function te(T,C,q){if(q?(n.texParameteri(T,10242,pe[C.wrapS]),n.texParameteri(T,10243,pe[C.wrapT]),(32879===T||35866===T)&&n.texParameteri(T,32882,pe[C.wrapR]),n.texParameteri(T,10240,We[C.magFilter]),n.texParameteri(T,10241,We[C.minFilter])):(n.texParameteri(T,10242,33071),n.texParameteri(T,10243,33071),(32879===T||35866===T)&&n.texParameteri(T,32882,33071),(C.wrapS!==Ai||C.wrapT!==Ai)&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping."),n.texParameteri(T,10240,R(C.magFilter)),n.texParameteri(T,10241,R(C.minFilter)),C.minFilter!==jn&&C.minFilter!==Nn&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter.")),!0===e.has("EXT_texture_filter_anisotropic")){const ue=e.get("EXT_texture_filter_anisotropic");if(C.type===Lo&&!1===e.has("OES_texture_float_linear")||!1===a&&C.type===rd&&!1===e.has("OES_texture_half_float_linear"))return;(C.anisotropy>1||i.get(C).__currentAnisotropy)&&(n.texParameterf(T,ue.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(C.anisotropy,r.getMaxAnisotropy())),i.get(C).__currentAnisotropy=C.anisotropy)}}function Be(T,C){let q=!1;void 0===T.__webglInit&&(T.__webglInit=!0,C.addEventListener("dispose",$));const ue=C.source;let me=g.get(ue);void 0===me&&(me={},g.set(ue,me));const Me=function O(T){const C=[];return C.push(T.wrapS),C.push(T.wrapT),C.push(T.wrapR||0),C.push(T.magFilter),C.push(T.minFilter),C.push(T.anisotropy),C.push(T.internalFormat),C.push(T.format),C.push(T.type),C.push(T.generateMipmaps),C.push(T.premultiplyAlpha),C.push(T.flipY),C.push(T.unpackAlignment),C.push(T.encoding),C.join()}(C);if(Me!==T.__cacheKey){void 0===me[Me]&&(me[Me]={texture:n.createTexture(),usedTimes:0},o.memory.textures++,q=!0),me[Me].usedTimes++;const et=me[T.__cacheKey];void 0!==et&&(me[T.__cacheKey].usedTimes--,0===et.usedTimes&&N(C)),T.__cacheKey=Me,T.__webglTexture=me[Me].texture}return q}function Fe(T,C,q){let ue=3553;(C.isDataArrayTexture||C.isCompressedArrayTexture)&&(ue=35866),C.isData3DTexture&&(ue=32879);const me=Be(T,C),Me=C.source;t.bindTexture(ue,T.__webglTexture,33984+q);const et=i.get(Me);if(Me.version!==et.__version||!0===me){t.activeTexture(33984+q),n.pixelStorei(37440,C.flipY),n.pixelStorei(37441,C.premultiplyAlpha),n.pixelStorei(3317,C.unpackAlignment),n.pixelStorei(37443,0);const P=function w(T){return!a&&(T.wrapS!==Ai||T.wrapT!==Ai||T.minFilter!==jn&&T.minFilter!==Nn)}(C)&&!1===v(C.image);let B=y(C.image,P,!1,u);B=zt(C,B);const Ee=v(B)||a,Pe=s.convert(C.format,C.encoding);let Ue,De=s.convert(C.type),ze=x(C.internalFormat,Pe,De,C.encoding,C.isVideoTexture);te(ue,C,Ee);const Dt=C.mipmaps,It=a&&!0!==C.isVideoTexture,Yt=void 0===et.__version||!0===me,k=E(C,B,Ee);if(C.isDepthTexture)ze=6402,a?ze=C.type===Lo?36012:C.type===za?33190:C.type===Ll?35056:33189:C.type===Lo&&console.error("WebGLRenderer: Floating point depth texture requires WebGL2."),C.format===Ha&&6402===ze&&1012!==C.type&&C.type!==za&&(console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),C.type=za,De=s.convert(C.type)),C.format===Nl&&6402===ze&&(ze=34041,C.type!==Ll&&(console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),C.type=Ll,De=s.convert(C.type))),Yt&&(It?t.texStorage2D(3553,1,ze,B.width,B.height):t.texImage2D(3553,0,ze,B.width,B.height,0,Pe,De,null));else if(C.isDataTexture)if(Dt.length>0&&Ee){It&&Yt&&t.texStorage2D(3553,k,ze,Dt[0].width,Dt[0].height);for(let Q=0,he=Dt.length;Q<he;Q++)Ue=Dt[Q],It?t.texSubImage2D(3553,Q,0,0,Ue.width,Ue.height,Pe,De,Ue.data):t.texImage2D(3553,Q,ze,Ue.width,Ue.height,0,Pe,De,Ue.data);C.generateMipmaps=!1}else It?(Yt&&t.texStorage2D(3553,k,ze,B.width,B.height),t.texSubImage2D(3553,0,0,0,B.width,B.height,Pe,De,B.data)):t.texImage2D(3553,0,ze,B.width,B.height,0,Pe,De,B.data);else if(C.isCompressedTexture)if(C.isCompressedArrayTexture){It&&Yt&&t.texStorage3D(35866,k,ze,Dt[0].width,Dt[0].height,B.depth);for(let Q=0,he=Dt.length;Q<he;Q++)Ue=Dt[Q],C.format!==Er?null!==Pe?It?t.compressedTexSubImage3D(35866,Q,0,0,0,Ue.width,Ue.height,B.depth,Pe,Ue.data,0,0):t.compressedTexImage3D(35866,Q,ze,Ue.width,Ue.height,B.depth,0,Ue.data,0,0):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):It?t.texSubImage3D(35866,Q,0,0,0,Ue.width,Ue.height,B.depth,Pe,De,Ue.data):t.texImage3D(35866,Q,ze,Ue.width,Ue.height,B.depth,0,Pe,De,Ue.data)}else{It&&Yt&&t.texStorage2D(3553,k,ze,Dt[0].width,Dt[0].height);for(let Q=0,he=Dt.length;Q<he;Q++)Ue=Dt[Q],C.format!==Er?null!==Pe?It?t.compressedTexSubImage2D(3553,Q,0,0,Ue.width,Ue.height,Pe,Ue.data):t.compressedTexImage2D(3553,Q,ze,Ue.width,Ue.height,0,Ue.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):It?t.texSubImage2D(3553,Q,0,0,Ue.width,Ue.height,Pe,De,Ue.data):t.texImage2D(3553,Q,ze,Ue.width,Ue.height,0,Pe,De,Ue.data)}else if(C.isDataArrayTexture)It?(Yt&&t.texStorage3D(35866,k,ze,B.width,B.height,B.depth),t.texSubImage3D(35866,0,0,0,0,B.width,B.height,B.depth,Pe,De,B.data)):t.texImage3D(35866,0,ze,B.width,B.height,B.depth,0,Pe,De,B.data);else if(C.isData3DTexture)It?(Yt&&t.texStorage3D(32879,k,ze,B.width,B.height,B.depth),t.texSubImage3D(32879,0,0,0,0,B.width,B.height,B.depth,Pe,De,B.data)):t.texImage3D(32879,0,ze,B.width,B.height,B.depth,0,Pe,De,B.data);else if(C.isFramebufferTexture){if(Yt)if(It)t.texStorage2D(3553,k,ze,B.width,B.height);else{let Q=B.width,he=B.height;for(let Ae=0;Ae<k;Ae++)t.texImage2D(3553,Ae,ze,Q,he,0,Pe,De,null),Q>>=1,he>>=1}}else if(Dt.length>0&&Ee){It&&Yt&&t.texStorage2D(3553,k,ze,Dt[0].width,Dt[0].height);for(let Q=0,he=Dt.length;Q<he;Q++)Ue=Dt[Q],It?t.texSubImage2D(3553,Q,0,0,Pe,De,Ue):t.texImage2D(3553,Q,ze,Pe,De,Ue);C.generateMipmaps=!1}else It?(Yt&&t.texStorage2D(3553,k,ze,B.width,B.height),t.texSubImage2D(3553,0,0,0,Pe,De,B)):t.texImage2D(3553,0,ze,Pe,De,B);M(C,Ee)&&I(ue),et.__version=Me.version,C.onUpdate&&C.onUpdate(C)}T.__version=C.version}function ye(T,C,q,ue,me){const Me=s.convert(q.format,q.encoding),et=s.convert(q.type),P=x(q.internalFormat,Me,et,q.encoding);i.get(C).__hasExternalTextures||(32879===me||35866===me?t.texImage3D(me,0,P,C.width,C.height,C.depth,0,Me,et,null):t.texImage2D(me,0,P,C.width,C.height,0,Me,et,null)),t.bindFramebuffer(36160,T),$e(C)?d.framebufferTexture2DMultisampleEXT(36160,ue,me,i.get(q).__webglTexture,0,Qe(C)):(3553===me||me>=34069&&me<=34074)&&n.framebufferTexture2D(36160,ue,me,i.get(q).__webglTexture,0),t.bindFramebuffer(36160,null)}function ut(T,C,q){if(n.bindRenderbuffer(36161,T),C.depthBuffer&&!C.stencilBuffer){let ue=33189;if(q||$e(C)){const me=C.depthTexture;me&&me.isDepthTexture&&(me.type===Lo?ue=36012:me.type===za&&(ue=33190));const Me=Qe(C);$e(C)?d.renderbufferStorageMultisampleEXT(36161,Me,ue,C.width,C.height):n.renderbufferStorageMultisample(36161,Me,ue,C.width,C.height)}else n.renderbufferStorage(36161,ue,C.width,C.height);n.framebufferRenderbuffer(36160,36096,36161,T)}else if(C.depthBuffer&&C.stencilBuffer){const ue=Qe(C);q&&!1===$e(C)?n.renderbufferStorageMultisample(36161,ue,35056,C.width,C.height):$e(C)?d.renderbufferStorageMultisampleEXT(36161,ue,35056,C.width,C.height):n.renderbufferStorage(36161,34041,C.width,C.height),n.framebufferRenderbuffer(36160,33306,36161,T)}else{const ue=!0===C.isWebGLMultipleRenderTargets?C.texture:[C.texture];for(let me=0;me<ue.length;me++){const Me=ue[me],et=s.convert(Me.format,Me.encoding),P=s.convert(Me.type),B=x(Me.internalFormat,et,P,Me.encoding),Ee=Qe(C);q&&!1===$e(C)?n.renderbufferStorageMultisample(36161,Ee,B,C.width,C.height):$e(C)?d.renderbufferStorageMultisampleEXT(36161,Ee,B,C.width,C.height):n.renderbufferStorage(36161,B,C.width,C.height)}}n.bindRenderbuffer(36161,null)}function ne(T){const C=i.get(T),q=!0===T.isWebGLCubeRenderTarget;if(T.depthTexture&&!C.__autoAllocateDepthBuffer){if(q)throw new Error("target.depthTexture not supported in Cube render targets");!function oe(T,C){if(C&&C.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(t.bindFramebuffer(36160,T),!C.depthTexture||!C.depthTexture.isDepthTexture)throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");(!i.get(C.depthTexture).__webglTexture||C.depthTexture.image.width!==C.width||C.depthTexture.image.height!==C.height)&&(C.depthTexture.image.width=C.width,C.depthTexture.image.height=C.height,C.depthTexture.needsUpdate=!0),V(C.depthTexture,0);const ue=i.get(C.depthTexture).__webglTexture,me=Qe(C);if(C.depthTexture.format===Ha)$e(C)?d.framebufferTexture2DMultisampleEXT(36160,36096,3553,ue,0,me):n.framebufferTexture2D(36160,36096,3553,ue,0);else{if(C.depthTexture.format!==Nl)throw new Error("Unknown depthTexture format");$e(C)?d.framebufferTexture2DMultisampleEXT(36160,33306,3553,ue,0,me):n.framebufferTexture2D(36160,33306,3553,ue,0)}}(C.__webglFramebuffer,T)}else if(q){C.__webglDepthbuffer=[];for(let ue=0;ue<6;ue++)t.bindFramebuffer(36160,C.__webglFramebuffer[ue]),C.__webglDepthbuffer[ue]=n.createRenderbuffer(),ut(C.__webglDepthbuffer[ue],T,!1)}else t.bindFramebuffer(36160,C.__webglFramebuffer),C.__webglDepthbuffer=n.createRenderbuffer(),ut(C.__webglDepthbuffer,T,!1);t.bindFramebuffer(36160,null)}function Qe(T){return Math.min(h,T.samples)}function $e(T){const C=i.get(T);return a&&T.samples>0&&!0===e.has("WEBGL_multisampled_render_to_texture")&&!1!==C.__useRenderToTexture}function zt(T,C){const q=T.encoding,ue=T.format,me=T.type;return!0===T.isCompressedTexture||!0===T.isVideoTexture||1035===T.format||q!==Ga&&(q===bn?!1===a?!0===e.has("EXT_sRGB")&&ue===Er?(T.format=1035,T.minFilter=Nn,T.generateMipmaps=!1):C=WR.sRGBToLinear(C):(ue!==Er||me!==Ua)&&console.warn("THREE.WebGLTextures: sRGB encoded textures have to use RGBAFormat and UnsignedByteType."):console.error("THREE.WebGLTextures: Unsupported texture encoding:",q)),C}this.allocateTextureUnit=function F(){const T=L;return T>=c&&console.warn("THREE.WebGLTextures: Trying to use "+T+" texture units while this GPU supports only "+c),L+=1,T},this.resetTextureUnits=function G(){L=0},this.setTexture2D=V,this.setTexture2DArray=function ce(T,C){const q=i.get(T);T.version>0&&q.__version!==T.version?Fe(q,T,C):t.bindTexture(35866,q.__webglTexture,33984+C)},this.setTexture3D=function re(T,C){const q=i.get(T);T.version>0&&q.__version!==T.version?Fe(q,T,C):t.bindTexture(32879,q.__webglTexture,33984+C)},this.setTextureCube=function fe(T,C){const q=i.get(T);T.version>0&&q.__version!==T.version?function Le(T,C,q){if(6!==C.image.length)return;const ue=Be(T,C),me=C.source;t.bindTexture(34067,T.__webglTexture,33984+q);const Me=i.get(me);if(me.version!==Me.__version||!0===ue){t.activeTexture(33984+q),n.pixelStorei(37440,C.flipY),n.pixelStorei(37441,C.premultiplyAlpha),n.pixelStorei(3317,C.unpackAlignment),n.pixelStorei(37443,0);const et=C.isCompressedTexture||C.image[0].isCompressedTexture,P=C.image[0]&&C.image[0].isDataTexture,B=[];for(let Q=0;Q<6;Q++)B[Q]=et||P?P?C.image[Q].image:C.image[Q]:y(C.image[Q],!1,!0,l),B[Q]=zt(C,B[Q]);const Ee=B[0],Pe=v(Ee)||a,De=s.convert(C.format,C.encoding),ze=s.convert(C.type),Ue=x(C.internalFormat,De,ze,C.encoding),Dt=a&&!0!==C.isVideoTexture,It=void 0===Me.__version||!0===ue;let k,Yt=E(C,Ee,Pe);if(te(34067,C,Pe),et){Dt&&It&&t.texStorage2D(34067,Yt,Ue,Ee.width,Ee.height);for(let Q=0;Q<6;Q++){k=B[Q].mipmaps;for(let he=0;he<k.length;he++){const Ae=k[he];C.format!==Er?null!==De?Dt?t.compressedTexSubImage2D(34069+Q,he,0,0,Ae.width,Ae.height,De,Ae.data):t.compressedTexImage2D(34069+Q,he,Ue,Ae.width,Ae.height,0,Ae.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):Dt?t.texSubImage2D(34069+Q,he,0,0,Ae.width,Ae.height,De,ze,Ae.data):t.texImage2D(34069+Q,he,Ue,Ae.width,Ae.height,0,De,ze,Ae.data)}}}else{k=C.mipmaps,Dt&&It&&(k.length>0&&Yt++,t.texStorage2D(34067,Yt,Ue,B[0].width,B[0].height));for(let Q=0;Q<6;Q++)if(P){Dt?t.texSubImage2D(34069+Q,0,0,0,B[Q].width,B[Q].height,De,ze,B[Q].data):t.texImage2D(34069+Q,0,Ue,B[Q].width,B[Q].height,0,De,ze,B[Q].data);for(let he=0;he<k.length;he++){const He=k[he].image[Q].image;Dt?t.texSubImage2D(34069+Q,he+1,0,0,He.width,He.height,De,ze,He.data):t.texImage2D(34069+Q,he+1,Ue,He.width,He.height,0,De,ze,He.data)}}else{Dt?t.texSubImage2D(34069+Q,0,0,0,De,ze,B[Q]):t.texImage2D(34069+Q,0,Ue,De,ze,B[Q]);for(let he=0;he<k.length;he++){const Ae=k[he];Dt?t.texSubImage2D(34069+Q,he+1,0,0,De,ze,Ae.image[Q]):t.texImage2D(34069+Q,he+1,Ue,De,ze,Ae.image[Q])}}}M(C,Pe)&&I(34067),Me.__version=me.version,C.onUpdate&&C.onUpdate(C)}T.__version=C.version}(q,T,C):t.bindTexture(34067,q.__webglTexture,33984+C)},this.rebindTextures=function _e(T,C,q){const ue=i.get(T);void 0!==C&&ye(ue.__webglFramebuffer,T,T.texture,36064,3553),void 0!==q&&ne(T)},this.setupRenderTarget=function ke(T){const C=T.texture,q=i.get(T),ue=i.get(C);T.addEventListener("dispose",se),!0!==T.isWebGLMultipleRenderTargets&&(void 0===ue.__webglTexture&&(ue.__webglTexture=n.createTexture()),ue.__version=C.version,o.memory.textures++);const me=!0===T.isWebGLCubeRenderTarget,Me=!0===T.isWebGLMultipleRenderTargets,et=v(T)||a;if(me){q.__webglFramebuffer=[];for(let P=0;P<6;P++)q.__webglFramebuffer[P]=n.createFramebuffer()}else{if(q.__webglFramebuffer=n.createFramebuffer(),Me)if(r.drawBuffers){const P=T.texture;for(let B=0,Ee=P.length;B<Ee;B++){const Pe=i.get(P[B]);void 0===Pe.__webglTexture&&(Pe.__webglTexture=n.createTexture(),o.memory.textures++)}}else console.warn("THREE.WebGLRenderer: WebGLMultipleRenderTargets can only be used with WebGL2 or WEBGL_draw_buffers extension.");if(a&&T.samples>0&&!1===$e(T)){const P=Me?C:[C];q.__webglMultisampledFramebuffer=n.createFramebuffer(),q.__webglColorRenderbuffer=[],t.bindFramebuffer(36160,q.__webglMultisampledFramebuffer);for(let B=0;B<P.length;B++){const Ee=P[B];q.__webglColorRenderbuffer[B]=n.createRenderbuffer(),n.bindRenderbuffer(36161,q.__webglColorRenderbuffer[B]);const Pe=s.convert(Ee.format,Ee.encoding),De=s.convert(Ee.type),ze=x(Ee.internalFormat,Pe,De,Ee.encoding,!0===T.isXRRenderTarget),Ue=Qe(T);n.renderbufferStorageMultisample(36161,Ue,ze,T.width,T.height),n.framebufferRenderbuffer(36160,36064+B,36161,q.__webglColorRenderbuffer[B])}n.bindRenderbuffer(36161,null),T.depthBuffer&&(q.__webglDepthRenderbuffer=n.createRenderbuffer(),ut(q.__webglDepthRenderbuffer,T,!0)),t.bindFramebuffer(36160,null)}}if(me){t.bindTexture(34067,ue.__webglTexture),te(34067,C,et);for(let P=0;P<6;P++)ye(q.__webglFramebuffer[P],T,C,36064,34069+P);M(C,et)&&I(34067),t.unbindTexture()}else if(Me){const P=T.texture;for(let B=0,Ee=P.length;B<Ee;B++){const Pe=P[B],De=i.get(Pe);t.bindTexture(3553,De.__webglTexture),te(3553,Pe,et),ye(q.__webglFramebuffer,T,Pe,36064+B,3553),M(Pe,et)&&I(3553)}t.unbindTexture()}else{let P=3553;(T.isWebGL3DRenderTarget||T.isWebGLArrayRenderTarget)&&(a?P=T.isWebGL3DRenderTarget?32879:35866:console.error("THREE.WebGLTextures: THREE.Data3DTexture and THREE.DataArrayTexture only supported with WebGL2.")),t.bindTexture(P,ue.__webglTexture),te(P,C,et),ye(q.__webglFramebuffer,T,C,36064,P),M(C,et)&&I(P),t.unbindTexture()}T.depthBuffer&&ne(T)},this.updateRenderTargetMipmap=function be(T){const C=v(T)||a,q=!0===T.isWebGLMultipleRenderTargets?T.texture:[T.texture];for(let ue=0,me=q.length;ue<me;ue++){const Me=q[ue];if(M(Me,C)){const et=T.isWebGLCubeRenderTarget?34067:3553,P=i.get(Me).__webglTexture;t.bindTexture(et,P),I(et),t.unbindTexture()}}},this.updateMultisampleRenderTarget=function lt(T){if(a&&T.samples>0&&!1===$e(T)){const C=T.isWebGLMultipleRenderTargets?T.texture:[T.texture],q=T.width,ue=T.height;let me=16384;const Me=[],et=T.stencilBuffer?33306:36096,P=i.get(T),B=!0===T.isWebGLMultipleRenderTargets;if(B)for(let Ee=0;Ee<C.length;Ee++)t.bindFramebuffer(36160,P.__webglMultisampledFramebuffer),n.framebufferRenderbuffer(36160,36064+Ee,36161,null),t.bindFramebuffer(36160,P.__webglFramebuffer),n.framebufferTexture2D(36009,36064+Ee,3553,null,0);t.bindFramebuffer(36008,P.__webglMultisampledFramebuffer),t.bindFramebuffer(36009,P.__webglFramebuffer);for(let Ee=0;Ee<C.length;Ee++){Me.push(36064+Ee),T.depthBuffer&&Me.push(et);const Pe=void 0!==P.__ignoreDepthValues&&P.__ignoreDepthValues;if(!1===Pe&&(T.depthBuffer&&(me|=256),T.stencilBuffer&&(me|=1024)),B&&n.framebufferRenderbuffer(36008,36064,36161,P.__webglColorRenderbuffer[Ee]),!0===Pe&&(n.invalidateFramebuffer(36008,[et]),n.invalidateFramebuffer(36009,[et])),B){const De=i.get(C[Ee]).__webglTexture;n.framebufferTexture2D(36009,36064,3553,De,0)}n.blitFramebuffer(0,0,q,ue,0,0,q,ue,me,9728),f&&n.invalidateFramebuffer(36008,Me)}if(t.bindFramebuffer(36008,null),t.bindFramebuffer(36009,null),B)for(let Ee=0;Ee<C.length;Ee++){t.bindFramebuffer(36160,P.__webglMultisampledFramebuffer),n.framebufferRenderbuffer(36160,36064+Ee,36161,P.__webglColorRenderbuffer[Ee]);const Pe=i.get(C[Ee]).__webglTexture;t.bindFramebuffer(36160,P.__webglFramebuffer),n.framebufferTexture2D(36009,36064+Ee,3553,Pe,0)}t.bindFramebuffer(36009,P.__webglMultisampledFramebuffer)}},this.setupDepthRenderbuffer=ne,this.setupFrameBufferTexture=ye,this.useMultisampledRTT=$e}function IK(n,e,t){const i=t.isWebGL2;return{convert:function r(s,o=null){let a;if(s===Ua)return 5121;if(1017===s)return 32819;if(1018===s)return 32820;if(1010===s)return 5120;if(1011===s)return 5122;if(1012===s)return 5123;if(1013===s)return 5124;if(s===za)return 5125;if(s===Lo)return 5126;if(s===rd)return i?5131:(a=e.get("OES_texture_half_float"),null!==a?a.HALF_FLOAT_OES:null);if(1021===s)return 6406;if(s===Er)return 6408;if(1024===s)return 6409;if(1025===s)return 6410;if(s===Ha)return 6402;if(s===Nl)return 34041;if(1028===s)return 6403;if(1022===s)return console.warn("THREE.WebGLRenderer: THREE.RGBFormat has been removed. Use THREE.RGBAFormat instead. https://github.com/mrdoob/three.js/pull/23228"),6408;if(1035===s)return a=e.get("EXT_sRGB"),null!==a?a.SRGB_ALPHA_EXT:null;if(1029===s)return 36244;if(1030===s)return 33319;if(1031===s)return 33320;if(1033===s)return 36249;if(33776===s||33777===s||33778===s||33779===s)if(o===bn){if(a=e.get("WEBGL_compressed_texture_s3tc_srgb"),null===a)return null;if(33776===s)return a.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(33777===s)return a.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(33778===s)return a.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(33779===s)return a.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else{if(a=e.get("WEBGL_compressed_texture_s3tc"),null===a)return null;if(33776===s)return a.COMPRESSED_RGB_S3TC_DXT1_EXT;if(33777===s)return a.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(33778===s)return a.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(33779===s)return a.COMPRESSED_RGBA_S3TC_DXT5_EXT}if(35840===s||35841===s||35842===s||35843===s){if(a=e.get("WEBGL_compressed_texture_pvrtc"),null===a)return null;if(35840===s)return a.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(35841===s)return a.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(35842===s)return a.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(35843===s)return a.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}if(36196===s)return a=e.get("WEBGL_compressed_texture_etc1"),null!==a?a.COMPRESSED_RGB_ETC1_WEBGL:null;if(37492===s||37496===s){if(a=e.get("WEBGL_compressed_texture_etc"),null===a)return null;if(37492===s)return o===bn?a.COMPRESSED_SRGB8_ETC2:a.COMPRESSED_RGB8_ETC2;if(37496===s)return o===bn?a.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:a.COMPRESSED_RGBA8_ETC2_EAC}if(37808===s||37809===s||37810===s||37811===s||37812===s||37813===s||37814===s||37815===s||37816===s||37817===s||37818===s||37819===s||37820===s||37821===s){if(a=e.get("WEBGL_compressed_texture_astc"),null===a)return null;if(37808===s)return o===bn?a.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:a.COMPRESSED_RGBA_ASTC_4x4_KHR;if(37809===s)return o===bn?a.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:a.COMPRESSED_RGBA_ASTC_5x4_KHR;if(37810===s)return o===bn?a.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:a.COMPRESSED_RGBA_ASTC_5x5_KHR;if(37811===s)return o===bn?a.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:a.COMPRESSED_RGBA_ASTC_6x5_KHR;if(37812===s)return o===bn?a.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:a.COMPRESSED_RGBA_ASTC_6x6_KHR;if(37813===s)return o===bn?a.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:a.COMPRESSED_RGBA_ASTC_8x5_KHR;if(37814===s)return o===bn?a.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:a.COMPRESSED_RGBA_ASTC_8x6_KHR;if(37815===s)return o===bn?a.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:a.COMPRESSED_RGBA_ASTC_8x8_KHR;if(37816===s)return o===bn?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:a.COMPRESSED_RGBA_ASTC_10x5_KHR;if(37817===s)return o===bn?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:a.COMPRESSED_RGBA_ASTC_10x6_KHR;if(37818===s)return o===bn?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:a.COMPRESSED_RGBA_ASTC_10x8_KHR;if(37819===s)return o===bn?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:a.COMPRESSED_RGBA_ASTC_10x10_KHR;if(37820===s)return o===bn?a.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:a.COMPRESSED_RGBA_ASTC_12x10_KHR;if(37821===s)return o===bn?a.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:a.COMPRESSED_RGBA_ASTC_12x12_KHR}if(36492===s){if(a=e.get("EXT_texture_compression_bptc"),null===a)return null;if(36492===s)return o===bn?a.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:a.COMPRESSED_RGBA_BPTC_UNORM_EXT}return s===Ll?i?34042:(a=e.get("WEBGL_depth_texture"),null!==a?a.UNSIGNED_INT_24_8_WEBGL:null):void 0!==n[s]?n[s]:null}}}class PK extends ei{constructor(e=[]){super(),this.isArrayCamera=!0,this.cameras=e}}class lr extends ar{constructor(){super(),this.isGroup=!0,this.type="Group"}}const RK={type:"move"};class Wx{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return null===this._hand&&(this._hand=new lr,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return null===this._targetRay&&(this._targetRay=new lr,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new S,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new S),this._targetRay}getGripSpace(){return null===this._grip&&(this._grip=new lr,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new S,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new S),this._grip}dispatchEvent(e){return null!==this._targetRay&&this._targetRay.dispatchEvent(e),null!==this._grip&&this._grip.dispatchEvent(e),null!==this._hand&&this._hand.dispatchEvent(e),this}disconnect(e){return this.dispatchEvent({type:"disconnected",data:e}),null!==this._targetRay&&(this._targetRay.visible=!1),null!==this._grip&&(this._grip.visible=!1),null!==this._hand&&(this._hand.visible=!1),this}update(e,t,i){let r=null,s=null,o=null;const a=this._targetRay,c=this._grip,l=this._hand;if(e&&"visible-blurred"!==t.session.visibilityState){if(l&&e.hand){o=!0;for(const m of e.hand.values()){const g=t.getJointPose(m,i);if(void 0===l.joints[m.jointName]){const b=new lr;b.matrixAutoUpdate=!1,b.visible=!1,l.joints[m.jointName]=b,l.add(b)}const _=l.joints[m.jointName];null!==g&&(_.matrix.fromArray(g.transform.matrix),_.matrix.decompose(_.position,_.rotation,_.scale),_.jointRadius=g.radius),_.visible=null!==g}const d=l.joints["index-finger-tip"].position.distanceTo(l.joints["thumb-tip"].position),f=.02,p=.005;l.inputState.pinching&&d>f+p?(l.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:e.handedness,target:this})):!l.inputState.pinching&&d<=f-p&&(l.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:e.handedness,target:this}))}else null!==c&&e.gripSpace&&(s=t.getPose(e.gripSpace,i),null!==s&&(c.matrix.fromArray(s.transform.matrix),c.matrix.decompose(c.position,c.rotation,c.scale),s.linearVelocity?(c.hasLinearVelocity=!0,c.linearVelocity.copy(s.linearVelocity)):c.hasLinearVelocity=!1,s.angularVelocity?(c.hasAngularVelocity=!0,c.angularVelocity.copy(s.angularVelocity)):c.hasAngularVelocity=!1));null!==a&&(r=t.getPose(e.targetRaySpace,i),null===r&&null!==s&&(r=s),null!==r&&(a.matrix.fromArray(r.transform.matrix),a.matrix.decompose(a.position,a.rotation,a.scale),r.linearVelocity?(a.hasLinearVelocity=!0,a.linearVelocity.copy(r.linearVelocity)):a.hasLinearVelocity=!1,r.angularVelocity?(a.hasAngularVelocity=!0,a.angularVelocity.copy(r.angularVelocity)):a.hasAngularVelocity=!1,this.dispatchEvent(RK)))}return null!==a&&(a.visible=null!==r),null!==c&&(c.visible=null!==s),null!==l&&(l.visible=null!==o),this}}class OK extends No{constructor(e,t,i,r,s,o,a,c,l,u){if((u=void 0!==u?u:Ha)!==Ha&&u!==Nl)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");void 0===i&&u===Ha&&(i=za),void 0===i&&u===Nl&&(i=Ll),super(null,r,s,o,a,c,u,i,l),this.isDepthTexture=!0,this.image={width:e,height:t},this.magFilter=void 0!==a?a:jn,this.minFilter=void 0!==c?c:jn,this.flipY=!1,this.generateMipmaps=!1}}class kK extends $a{constructor(e,t){super();const i=this;let r=null,s=1,o=null,a="local-floor",c=null,l=null,u=null,h=null,d=null,f=null;const p=t.getContextAttributes();let m=null,g=null;const _=[],b=[],y=new ei;y.layers.enable(1),y.viewport=new qt;const v=new ei;v.layers.enable(2),v.viewport=new qt;const w=[y,v],M=new PK;M.layers.enable(1),M.layers.enable(2);let I=null,x=null;function E(O){const V=b.indexOf(O.inputSource);if(-1===V)return;const ce=_[V];void 0!==ce&&ce.dispatchEvent({type:O.type,data:O.inputSource})}function R(){r.removeEventListener("select",E),r.removeEventListener("selectstart",E),r.removeEventListener("selectend",E),r.removeEventListener("squeeze",E),r.removeEventListener("squeezestart",E),r.removeEventListener("squeezeend",E),r.removeEventListener("end",R),r.removeEventListener("inputsourceschange",$);for(let O=0;O<_.length;O++){const V=b[O];null!==V&&(b[O]=null,_[O].disconnect(V))}I=null,x=null,e.setRenderTarget(m),d=null,h=null,u=null,r=null,g=null,F.stop(),i.isPresenting=!1,i.dispatchEvent({type:"sessionend"})}function $(O){for(let V=0;V<O.removed.length;V++){const ce=O.removed[V],re=b.indexOf(ce);re>=0&&(b[re]=null,_[re].dispatchEvent({type:"disconnected",data:ce}))}for(let V=0;V<O.added.length;V++){const ce=O.added[V];let re=b.indexOf(ce);if(-1===re){for(let pe=0;pe<_.length;pe++){if(pe>=b.length){b.push(ce),re=pe;break}if(null===b[pe]){b[pe]=ce,re=pe;break}}if(-1===re)break}const fe=_[re];fe&&fe.dispatchEvent({type:"connected",data:ce})}}this.cameraAutoUpdate=!0,this.enabled=!1,this.isPresenting=!1,this.getController=function(O){let V=_[O];return void 0===V&&(V=new Wx,_[O]=V),V.getTargetRaySpace()},this.getControllerGrip=function(O){let V=_[O];return void 0===V&&(V=new Wx,_[O]=V),V.getGripSpace()},this.getHand=function(O){let V=_[O];return void 0===V&&(V=new Wx,_[O]=V),V.getHandSpace()},this.setFramebufferScaleFactor=function(O){s=O,!0===i.isPresenting&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(O){a=O,!0===i.isPresenting&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return c||o},this.setReferenceSpace=function(O){c=O},this.getBaseLayer=function(){return null!==h?h:d},this.getBinding=function(){return u},this.getFrame=function(){return f},this.getSession=function(){return r},this.setSession=function(){var O=function h7(n){return function(){var e=this,t=arguments;return new Promise(function(i,r){var s=n.apply(e,t);function o(c){oR(s,i,r,o,a,"next",c)}function a(c){oR(s,i,r,o,a,"throw",c)}o(void 0)})}}(function*(V){if(r=V,null!==r){if(m=e.getRenderTarget(),r.addEventListener("select",E),r.addEventListener("selectstart",E),r.addEventListener("selectend",E),r.addEventListener("squeeze",E),r.addEventListener("squeezestart",E),r.addEventListener("squeezeend",E),r.addEventListener("end",R),r.addEventListener("inputsourceschange",$),!0!==p.xrCompatible&&(yield t.makeXRCompatible()),void 0===r.renderState.layers||!1===e.capabilities.isWebGL2)d=new XRWebGLLayer(r,t,{antialias:void 0!==r.renderState.layers||p.antialias,alpha:p.alpha,depth:p.depth,stencil:p.stencil,framebufferScaleFactor:s}),r.updateRenderState({baseLayer:d}),g=new Fo(d.framebufferWidth,d.framebufferHeight,{format:Er,type:Ua,encoding:e.outputEncoding,stencilBuffer:p.stencil});else{let ce=null,re=null,fe=null;p.depth&&(fe=p.stencil?35056:33190,ce=p.stencil?Nl:Ha,re=p.stencil?Ll:za);const pe={colorFormat:32856,depthFormat:fe,scaleFactor:s};u=new XRWebGLBinding(r,t),h=u.createProjectionLayer(pe),r.updateRenderState({layers:[h]}),g=new Fo(h.textureWidth,h.textureHeight,{format:Er,type:Ua,depthTexture:new OK(h.textureWidth,h.textureHeight,re,void 0,void 0,void 0,void 0,void 0,void 0,ce),stencilBuffer:p.stencil,encoding:e.outputEncoding,samples:p.antialias?4:0}),e.properties.get(g).__ignoreDepthValues=h.ignoreDepthValues}g.isXRRenderTarget=!0,this.setFoveation(1),c=null,o=yield r.requestReferenceSpace(a),F.setContext(r),F.start(),i.isPresenting=!0,i.dispatchEvent({type:"sessionstart"})}});return function(V){return O.apply(this,arguments)}}();const se=new S,H=new S;function X(O,V){null===V?O.matrixWorld.copy(O.matrix):O.matrixWorld.multiplyMatrices(V.matrixWorld,O.matrix),O.matrixWorldInverse.copy(O.matrixWorld).invert()}this.updateCamera=function(O){if(null===r)return;M.near=v.near=y.near=O.near,M.far=v.far=y.far=O.far,(I!==M.near||x!==M.far)&&(r.updateRenderState({depthNear:M.near,depthFar:M.far}),I=M.near,x=M.far);const V=O.parent,ce=M.cameras;X(M,V);for(let fe=0;fe<ce.length;fe++)X(ce[fe],V);M.matrixWorld.decompose(M.position,M.quaternion,M.scale),O.matrix.copy(M.matrix),O.matrix.decompose(O.position,O.quaternion,O.scale);const re=O.children;for(let fe=0,pe=re.length;fe<pe;fe++)re[fe].updateMatrixWorld(!0);2===ce.length?function N(O,V,ce){se.setFromMatrixPosition(V.matrixWorld),H.setFromMatrixPosition(ce.matrixWorld);const re=se.distanceTo(H),fe=V.projectionMatrix.elements,pe=ce.projectionMatrix.elements,We=fe[14]/(fe[10]-1),te=fe[14]/(fe[10]+1),Be=(fe[9]+1)/fe[5],Fe=(fe[9]-1)/fe[5],Le=(fe[8]-1)/fe[0],ye=(pe[8]+1)/pe[0],ut=We*Le,oe=We*ye,ne=re/(-Le+ye),_e=ne*-Le;V.matrixWorld.decompose(O.position,O.quaternion,O.scale),O.translateX(_e),O.translateZ(ne),O.matrixWorld.compose(O.position,O.quaternion,O.scale),O.matrixWorldInverse.copy(O.matrixWorld).invert();const ke=We+ne,be=te+ne;O.projectionMatrix.makePerspective(ut-_e,oe+(re-_e),Be*te/be*ke,Fe*te/be*ke,ke,be)}(M,y,v):M.projectionMatrix.copy(y.projectionMatrix)},this.getCamera=function(){return M},this.getFoveation=function(){return null!==h?h.fixedFoveation:null!==d?d.fixedFoveation:void 0},this.setFoveation=function(O){null!==h&&(h.fixedFoveation=O),null!==d&&void 0!==d.fixedFoveation&&(d.fixedFoveation=O)};let L=null;const F=new oO;F.setAnimationLoop(function G(O,V){if(l=V.getViewerPose(c||o),f=V,null!==l){const ce=l.views;null!==d&&(e.setRenderTargetFramebuffer(g,d.framebuffer),e.setRenderTarget(g));let re=!1;ce.length!==M.cameras.length&&(M.cameras.length=0,re=!0);for(let fe=0;fe<ce.length;fe++){const pe=ce[fe];let We=null;if(null!==d)We=d.getViewport(pe);else{const Be=u.getViewSubImage(h,pe);We=Be.viewport,0===fe&&(e.setRenderTargetTextures(g,Be.colorTexture,h.ignoreDepthValues?void 0:Be.depthStencilTexture),e.setRenderTarget(g))}let te=w[fe];void 0===te&&(te=new ei,te.layers.enable(fe),te.viewport=new qt,w[fe]=te),te.matrix.fromArray(pe.transform.matrix),te.projectionMatrix.fromArray(pe.projectionMatrix),te.viewport.set(We.x,We.y,We.width,We.height),0===fe&&M.matrix.copy(te.matrix),!0===re&&M.cameras.push(te)}}for(let ce=0;ce<_.length;ce++){const re=b[ce],fe=_[ce];null!==re&&void 0!==fe&&fe.update(re,V,c||o)}L&&L(O,V),f=null}),this.setAnimationLoop=function(O){L=O},this.dispose=function(){}}}function LK(n,e){function r(m,g){m.opacity.value=g.opacity,g.color&&m.diffuse.value.copy(g.color),g.emissive&&m.emissive.value.copy(g.emissive).multiplyScalar(g.emissiveIntensity),g.map&&(m.map.value=g.map),g.alphaMap&&(m.alphaMap.value=g.alphaMap),g.bumpMap&&(m.bumpMap.value=g.bumpMap,m.bumpScale.value=g.bumpScale,1===g.side&&(m.bumpScale.value*=-1)),g.displacementMap&&(m.displacementMap.value=g.displacementMap,m.displacementScale.value=g.displacementScale,m.displacementBias.value=g.displacementBias),g.emissiveMap&&(m.emissiveMap.value=g.emissiveMap),g.normalMap&&(m.normalMap.value=g.normalMap,m.normalScale.value.copy(g.normalScale),1===g.side&&m.normalScale.value.negate()),g.specularMap&&(m.specularMap.value=g.specularMap),g.alphaTest>0&&(m.alphaTest.value=g.alphaTest);const _=e.get(g).envMap;if(_&&(m.envMap.value=_,m.flipEnvMap.value=_.isCubeTexture&&!1===_.isRenderTargetTexture?-1:1,m.reflectivity.value=g.reflectivity,m.ior.value=g.ior,m.refractionRatio.value=g.refractionRatio),g.lightMap){m.lightMap.value=g.lightMap;const v=!0!==n.physicallyCorrectLights?Math.PI:1;m.lightMapIntensity.value=g.lightMapIntensity*v}let b,y;g.aoMap&&(m.aoMap.value=g.aoMap,m.aoMapIntensity.value=g.aoMapIntensity),g.map?b=g.map:g.specularMap?b=g.specularMap:g.displacementMap?b=g.displacementMap:g.normalMap?b=g.normalMap:g.bumpMap?b=g.bumpMap:g.roughnessMap?b=g.roughnessMap:g.metalnessMap?b=g.metalnessMap:g.alphaMap?b=g.alphaMap:g.emissiveMap?b=g.emissiveMap:g.clearcoatMap?b=g.clearcoatMap:g.clearcoatNormalMap?b=g.clearcoatNormalMap:g.clearcoatRoughnessMap?b=g.clearcoatRoughnessMap:g.iridescenceMap?b=g.iridescenceMap:g.iridescenceThicknessMap?b=g.iridescenceThicknessMap:g.specularIntensityMap?b=g.specularIntensityMap:g.specularColorMap?b=g.specularColorMap:g.transmissionMap?b=g.transmissionMap:g.thicknessMap?b=g.thicknessMap:g.sheenColorMap?b=g.sheenColorMap:g.sheenRoughnessMap&&(b=g.sheenRoughnessMap),void 0!==b&&(b.isWebGLRenderTarget&&(b=b.texture),!0===b.matrixAutoUpdate&&b.updateMatrix(),m.uvTransform.value.copy(b.matrix)),g.aoMap?y=g.aoMap:g.lightMap&&(y=g.lightMap),void 0!==y&&(y.isWebGLRenderTarget&&(y=y.texture),!0===y.matrixAutoUpdate&&y.updateMatrix(),m.uv2Transform.value.copy(y.matrix))}return{refreshFogUniforms:function t(m,g){m.fogColor.value.copy(g.color),g.isFog?(m.fogNear.value=g.near,m.fogFar.value=g.far):g.isFogExp2&&(m.fogDensity.value=g.density)},refreshMaterialUniforms:function i(m,g,_,b,y){g.isMeshBasicMaterial||g.isMeshLambertMaterial?r(m,g):g.isMeshToonMaterial?(r(m,g),function u(m,g){g.gradientMap&&(m.gradientMap.value=g.gradientMap)}(m,g)):g.isMeshPhongMaterial?(r(m,g),function l(m,g){m.specular.value.copy(g.specular),m.shininess.value=Math.max(g.shininess,1e-4)}(m,g)):g.isMeshStandardMaterial?(r(m,g),function h(m,g){m.roughness.value=g.roughness,m.metalness.value=g.metalness,g.roughnessMap&&(m.roughnessMap.value=g.roughnessMap),g.metalnessMap&&(m.metalnessMap.value=g.metalnessMap),e.get(g).envMap&&(m.envMapIntensity.value=g.envMapIntensity)}(m,g),g.isMeshPhysicalMaterial&&function d(m,g,_){m.ior.value=g.ior,g.sheen>0&&(m.sheenColor.value.copy(g.sheenColor).multiplyScalar(g.sheen),m.sheenRoughness.value=g.sheenRoughness,g.sheenColorMap&&(m.sheenColorMap.value=g.sheenColorMap),g.sheenRoughnessMap&&(m.sheenRoughnessMap.value=g.sheenRoughnessMap)),g.clearcoat>0&&(m.clearcoat.value=g.clearcoat,m.clearcoatRoughness.value=g.clearcoatRoughness,g.clearcoatMap&&(m.clearcoatMap.value=g.clearcoatMap),g.clearcoatRoughnessMap&&(m.clearcoatRoughnessMap.value=g.clearcoatRoughnessMap),g.clearcoatNormalMap&&(m.clearcoatNormalScale.value.copy(g.clearcoatNormalScale),m.clearcoatNormalMap.value=g.clearcoatNormalMap,1===g.side&&m.clearcoatNormalScale.value.negate())),g.iridescence>0&&(m.iridescence.value=g.iridescence,m.iridescenceIOR.value=g.iridescenceIOR,m.iridescenceThicknessMinimum.value=g.iridescenceThicknessRange[0],m.iridescenceThicknessMaximum.value=g.iridescenceThicknessRange[1],g.iridescenceMap&&(m.iridescenceMap.value=g.iridescenceMap),g.iridescenceThicknessMap&&(m.iridescenceThicknessMap.value=g.iridescenceThicknessMap)),g.transmission>0&&(m.transmission.value=g.transmission,m.transmissionSamplerMap.value=_.texture,m.transmissionSamplerSize.value.set(_.width,_.height),g.transmissionMap&&(m.transmissionMap.value=g.transmissionMap),m.thickness.value=g.thickness,g.thicknessMap&&(m.thicknessMap.value=g.thicknessMap),m.attenuationDistance.value=g.attenuationDistance,m.attenuationColor.value.copy(g.attenuationColor)),m.specularIntensity.value=g.specularIntensity,m.specularColor.value.copy(g.specularColor),g.specularIntensityMap&&(m.specularIntensityMap.value=g.specularIntensityMap),g.specularColorMap&&(m.specularColorMap.value=g.specularColorMap)}(m,g,y)):g.isMeshMatcapMaterial?(r(m,g),function f(m,g){g.matcap&&(m.matcap.value=g.matcap)}(m,g)):g.isMeshDepthMaterial?r(m,g):g.isMeshDistanceMaterial?(r(m,g),function p(m,g){m.referencePosition.value.copy(g.referencePosition),m.nearDistance.value=g.nearDistance,m.farDistance.value=g.farDistance}(m,g)):g.isMeshNormalMaterial?r(m,g):g.isLineBasicMaterial?(function s(m,g){m.diffuse.value.copy(g.color),m.opacity.value=g.opacity}(m,g),g.isLineDashedMaterial&&function o(m,g){m.dashSize.value=g.dashSize,m.totalSize.value=g.dashSize+g.gapSize,m.scale.value=g.scale}(m,g)):g.isPointsMaterial?function a(m,g,_,b){let y;m.diffuse.value.copy(g.color),m.opacity.value=g.opacity,m.size.value=g.size*_,m.scale.value=.5*b,g.map&&(m.map.value=g.map),g.alphaMap&&(m.alphaMap.value=g.alphaMap),g.alphaTest>0&&(m.alphaTest.value=g.alphaTest),g.map?y=g.map:g.alphaMap&&(y=g.alphaMap),void 0!==y&&(!0===y.matrixAutoUpdate&&y.updateMatrix(),m.uvTransform.value.copy(y.matrix))}(m,g,_,b):g.isSpriteMaterial?function c(m,g){let _;m.diffuse.value.copy(g.color),m.opacity.value=g.opacity,m.rotation.value=g.rotation,g.map&&(m.map.value=g.map),g.alphaMap&&(m.alphaMap.value=g.alphaMap),g.alphaTest>0&&(m.alphaTest.value=g.alphaTest),g.map?_=g.map:g.alphaMap&&(_=g.alphaMap),void 0!==_&&(!0===_.matrixAutoUpdate&&_.updateMatrix(),m.uvTransform.value.copy(_.matrix))}(m,g):g.isShadowMaterial?(m.color.value.copy(g.color),m.opacity.value=g.opacity):g.isShaderMaterial&&(g.uniformsNeedUpdate=!1)}}}function NK(n,e,t,i){let r={},s={},o=[];const a=t.isWebGL2?n.getParameter(35375):0;function f(b,y,v){const w=b.value;if(void 0===v[y])return v[y]="number"==typeof w?w:w.clone(),!0;if("number"==typeof w){if(v[y]!==w)return v[y]=w,!0}else{const M=v[y];if(!1===M.equals(w))return M.copy(w),!0}return!1}function m(b){const y=b.value,v={boundary:0,storage:0};return"number"==typeof y?(v.boundary=4,v.storage=4):y.isVector2?(v.boundary=8,v.storage=8):y.isVector3||y.isColor?(v.boundary=16,v.storage=12):y.isVector4?(v.boundary=16,v.storage=16):y.isMatrix3?(v.boundary=48,v.storage=48):y.isMatrix4?(v.boundary=64,v.storage=64):y.isTexture?console.warn("THREE.WebGLRenderer: Texture samplers can not be part of an uniforms group."):console.warn("THREE.WebGLRenderer: Unsupported uniform value type.",y),v}function g(b){const y=b.target;y.removeEventListener("dispose",g);const v=o.indexOf(y.__bindingPointIndex);o.splice(v,1),n.deleteBuffer(r[y.id]),delete r[y.id],delete s[y.id]}return{bind:function c(b,y){i.uniformBlockBinding(b,y.program)},update:function l(b,y){let v=r[b.id];void 0===v&&(function p(b){const y=b.uniforms;let v=0;let M=0;for(let I=0,x=y.length;I<x;I++){const E=y[I],R=m(E);if(E.__data=new Float32Array(R.storage/Float32Array.BYTES_PER_ELEMENT),E.__offset=v,I>0){M=v%16;const $=16-M;0!==M&&$-R.boundary<0&&(v+=16-M,E.__offset=v)}v+=R.storage}M=v%16,M>0&&(v+=16-M),b.__size=v,b.__cache={}}(b),v=function u(b){const y=function h(){for(let b=0;b<a;b++)if(-1===o.indexOf(b))return o.push(b),b;return console.error("THREE.WebGLRenderer: Maximum number of simultaneously usable uniforms groups reached."),0}();b.__bindingPointIndex=y;const v=n.createBuffer(),w=b.__size,M=b.usage;return n.bindBuffer(35345,v),n.bufferData(35345,w,M),n.bindBuffer(35345,null),n.bindBufferBase(35345,y,v),v}(b),r[b.id]=v,b.addEventListener("dispose",g)),i.updateUBOMapping(b,y.program);const M=e.render.frame;s[b.id]!==M&&(function d(b){const v=b.uniforms,w=b.__cache;n.bindBuffer(35345,r[b.id]);for(let M=0,I=v.length;M<I;M++){const x=v[M];if(!0===f(x,M,w)){const E=x.value,R=x.__offset;"number"==typeof E?(x.__data[0]=E,n.bufferSubData(35345,R,x.__data)):(x.value.isMatrix3?(x.__data[0]=x.value.elements[0],x.__data[1]=x.value.elements[1],x.__data[2]=x.value.elements[2],x.__data[3]=x.value.elements[0],x.__data[4]=x.value.elements[3],x.__data[5]=x.value.elements[4],x.__data[6]=x.value.elements[5],x.__data[7]=x.value.elements[0],x.__data[8]=x.value.elements[6],x.__data[9]=x.value.elements[7],x.__data[10]=x.value.elements[8],x.__data[11]=x.value.elements[0]):E.toArray(x.__data),n.bufferSubData(35345,R,x.__data))}}n.bindBuffer(35345,null)}(b),s[b.id]=M)},dispose:function _(){for(const b in r)n.deleteBuffer(r[b]);o=[],r={},s={}}}}function $x(n={}){this.isWebGLRenderer=!0;const e=void 0!==n.canvas?n.canvas:function FK(){const n=ad("canvas");return n.style.display="block",n}(),t=void 0!==n.context?n.context:null,i=void 0===n.depth||n.depth,r=void 0===n.stencil||n.stencil,s=void 0!==n.antialias&&n.antialias,o=void 0===n.premultipliedAlpha||n.premultipliedAlpha,a=void 0!==n.preserveDrawingBuffer&&n.preserveDrawingBuffer,c=void 0!==n.powerPreference?n.powerPreference:"default",l=void 0!==n.failIfMajorPerformanceCaveat&&n.failIfMajorPerformanceCaveat;let u;u=null!==t?t.getContextAttributes().alpha:void 0!==n.alpha&&n.alpha;let h=null,d=null;const f=[],p=[];this.domElement=e,this.debug={checkShaderErrors:!0},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.outputEncoding=Ga,this.physicallyCorrectLights=!1,this.toneMapping=0,this.toneMappingExposure=1,Object.defineProperties(this,{gammaFactor:{get:function(){return console.warn("THREE.WebGLRenderer: .gammaFactor has been removed."),2},set:function(){console.warn("THREE.WebGLRenderer: .gammaFactor has been removed.")}}});const m=this;let g=!1,_=0,b=0,y=null,v=-1,w=null;const M=new qt,I=new qt;let x=null,E=e.width,R=e.height,$=1,se=null,H=null;const N=new qt(0,0,E,R),X=new qt(0,0,E,R);let L=!1;const G=new Bx;let F=!1,O=!1,V=null;const ce=new ct,re=new ee,fe=new S,pe={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};function We(){return null===y?$:1}let Fe,Le,ye,ut,oe,ne,_e,ke,be,lt,Qe,$e,Xt,zt,T,C,q,ue,me,Me,et,P,B,Ee,te=t;function Be(D,z){for(let J=0;J<D.length;J++){const ie=e.getContext(D[J],z);if(null!==ie)return ie}return null}try{const D={alpha:!0,depth:i,stencil:r,antialias:s,premultipliedAlpha:o,preserveDrawingBuffer:a,powerPreference:c,failIfMajorPerformanceCaveat:l};if("setAttribute"in e&&e.setAttribute("data-engine","three.js r146"),e.addEventListener("webglcontextlost",ze,!1),e.addEventListener("webglcontextrestored",Ue,!1),e.addEventListener("webglcontextcreationerror",Dt,!1),null===te){const z=["webgl2","webgl","experimental-webgl"];if(!0===m.isWebGL1Renderer&&z.shift(),te=Be(z,D),null===te)throw Be(z)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}void 0===te.getShaderPrecisionFormat&&(te.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(D){throw console.error("THREE.WebGLRenderer: "+D.message),D}function Pe(){Fe=new ZY(te),Le=new jY(te,Fe,n),Fe.init(Le),P=new IK(te,Fe,Le),ye=new TK(te,Fe,Le),ut=new QY,oe=new gK,ne=new AK(te,Fe,ye,oe,Le,P,ut),_e=new $Y(m),ke=new YY(m),be=new Hq(te,Le),B=new HY(te,Fe,be,Le),lt=new KY(te,be,ut,B),Qe=new iZ(te,lt,be,ut),me=new nZ(te,Le,ne),C=new WY(oe),$e=new mK(m,_e,ke,Fe,Le,B,C),Xt=new LK(m,oe),zt=new yK,T=new CK(Fe,Le),ue=new zY(m,_e,ke,ye,Qe,u,o),q=new DK(m,Qe,Le),Ee=new NK(te,ut,Le,ye),Me=new GY(te,Fe,ut,Le),et=new JY(te,Fe,ut,Le),ut.programs=$e.programs,m.capabilities=Le,m.extensions=Fe,m.properties=oe,m.renderLists=zt,m.shadowMap=q,m.state=ye,m.info=ut}Pe();const De=new kK(m,te);function ze(D){D.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),g=!0}function Ue(){console.log("THREE.WebGLRenderer: Context Restored."),g=!1;const D=ut.autoReset,z=q.enabled,J=q.autoUpdate,U=q.needsUpdate,ie=q.type;Pe(),ut.autoReset=D,q.enabled=z,q.autoUpdate=J,q.needsUpdate=U,q.type=ie}function Dt(D){console.error("THREE.WebGLRenderer: A WebGL context could not be created. Reason: ",D.statusMessage)}function It(D){const z=D.target;z.removeEventListener("dispose",It),function Yt(D){(function k(D){const z=oe.get(D).programs;void 0!==z&&(z.forEach(function(J){$e.releaseProgram(J)}),D.isShaderMaterial&&$e.releaseShaderCache(D))})(D),oe.remove(D)}(z)}this.xr=De,this.getContext=function(){return te},this.getContextAttributes=function(){return te.getContextAttributes()},this.forceContextLoss=function(){const D=Fe.get("WEBGL_lose_context");D&&D.loseContext()},this.forceContextRestore=function(){const D=Fe.get("WEBGL_lose_context");D&&D.restoreContext()},this.getPixelRatio=function(){return $},this.setPixelRatio=function(D){void 0!==D&&($=D,this.setSize(E,R,!1))},this.getSize=function(D){return D.set(E,R)},this.setSize=function(D,z,J){De.isPresenting?console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting."):(E=D,R=z,e.width=Math.floor(D*$),e.height=Math.floor(z*$),!1!==J&&(e.style.width=D+"px",e.style.height=z+"px"),this.setViewport(0,0,D,z))},this.getDrawingBufferSize=function(D){return D.set(E*$,R*$).floor()},this.setDrawingBufferSize=function(D,z,J){E=D,R=z,$=J,e.width=Math.floor(D*J),e.height=Math.floor(z*J),this.setViewport(0,0,D,z)},this.getCurrentViewport=function(D){return D.copy(M)},this.getViewport=function(D){return D.copy(N)},this.setViewport=function(D,z,J,U){D.isVector4?N.set(D.x,D.y,D.z,D.w):N.set(D,z,J,U),ye.viewport(M.copy(N).multiplyScalar($).floor())},this.getScissor=function(D){return D.copy(X)},this.setScissor=function(D,z,J,U){D.isVector4?X.set(D.x,D.y,D.z,D.w):X.set(D,z,J,U),ye.scissor(I.copy(X).multiplyScalar($).floor())},this.getScissorTest=function(){return L},this.setScissorTest=function(D){ye.setScissorTest(L=D)},this.setOpaqueSort=function(D){se=D},this.setTransparentSort=function(D){H=D},this.getClearColor=function(D){return D.copy(ue.getClearColor())},this.setClearColor=function(){ue.setClearColor.apply(ue,arguments)},this.getClearAlpha=function(){return ue.getClearAlpha()},this.setClearAlpha=function(){ue.setClearAlpha.apply(ue,arguments)},this.clear=function(D=!0,z=!0,J=!0){let U=0;D&&(U|=16384),z&&(U|=256),J&&(U|=1024),te.clear(U)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){e.removeEventListener("webglcontextlost",ze,!1),e.removeEventListener("webglcontextrestored",Ue,!1),e.removeEventListener("webglcontextcreationerror",Dt,!1),zt.dispose(),T.dispose(),oe.dispose(),_e.dispose(),ke.dispose(),Qe.dispose(),B.dispose(),Ee.dispose(),$e.dispose(),De.dispose(),De.removeEventListener("sessionstart",Ae),De.removeEventListener("sessionend",He),V&&(V.dispose(),V=null),Ht.stop()},this.renderBufferDirect=function(D,z,J,U,ie,Xe){null===z&&(z=pe);const ht=ie.isMesh&&ie.matrixWorld.determinant()<0,wt=function qre(D,z,J,U,ie){!0!==z.isScene&&(z=pe),ne.resetTextureUnits();const Xe=z.fog,wt=null===y?m.outputEncoding:!0===y.isXRRenderTarget?y.texture.encoding:Ga,bt=(U.isMeshStandardMaterial?ke:_e).get(U.envMap||(U.isMeshStandardMaterial?z.environment:null)),Gt=!0===U.vertexColors&&!!J.attributes.color&&4===J.attributes.color.itemSize,St=!!U.normalMap&&!!J.attributes.tangent,Rt=!!J.morphAttributes.position,wn=!!J.morphAttributes.normal,vc=!!J.morphAttributes.color,Au=U.toneMapped?m.toneMapping:0,Iu=J.morphAttributes.position||J.morphAttributes.normal||J.morphAttributes.color,As=void 0!==Iu?Iu.length:0,jt=oe.get(U),Pu=d.state.lights;!0!==F||!0!==O&&D===w||C.setState(U,D,D===w&&U.id===v);let Vn=!1;U.version===jt.__version?(jt.needsLights&&jt.lightsStateVersion!==Pu.state.version||jt.outputEncoding!==wt||ie.isInstancedMesh&&!1===jt.instancing||!ie.isInstancedMesh&&!0===jt.instancing||ie.isSkinnedMesh&&!1===jt.skinning||!ie.isSkinnedMesh&&!0===jt.skinning||jt.envMap!==bt||!0===U.fog&&jt.fog!==Xe||void 0!==jt.numClippingPlanes&&(jt.numClippingPlanes!==C.numPlanes||jt.numIntersection!==C.numIntersection)||jt.vertexAlphas!==Gt||jt.vertexTangents!==St||jt.morphTargets!==Rt||jt.morphNormals!==wn||jt.morphColors!==vc||jt.toneMapping!==Au||!0===Le.isWebGL2&&jt.morphTargetsCount!==As)&&(Vn=!0):(Vn=!0,jt.__version=U.version);let kr=jt.currentProgram;!0===Vn&&(kr=Or(U,z,ie));let ra=!1,Zd=!1,jM=!1;const Li=kr.getUniforms(),bc=jt.uniforms;if(ye.useProgram(kr.program)&&(ra=!0,Zd=!0,jM=!0),U.id!==v&&(v=U.id,Zd=!0),ra||w!==D){if(Li.setValue(te,"projectionMatrix",D.projectionMatrix),Le.logarithmicDepthBuffer&&Li.setValue(te,"logDepthBufFC",2/(Math.log(D.far+1)/Math.LN2)),w!==D&&(w=D,Zd=!0,jM=!0),U.isShaderMaterial||U.isMeshPhongMaterial||U.isMeshToonMaterial||U.isMeshStandardMaterial||U.envMap){const fr=Li.map.cameraPosition;void 0!==fr&&fr.setValue(te,fe.setFromMatrixPosition(D.matrixWorld))}(U.isMeshPhongMaterial||U.isMeshToonMaterial||U.isMeshLambertMaterial||U.isMeshBasicMaterial||U.isMeshStandardMaterial||U.isShaderMaterial)&&Li.setValue(te,"isOrthographic",!0===D.isOrthographicCamera),(U.isMeshPhongMaterial||U.isMeshToonMaterial||U.isMeshLambertMaterial||U.isMeshBasicMaterial||U.isMeshStandardMaterial||U.isShaderMaterial||U.isShadowMaterial||ie.isSkinnedMesh)&&Li.setValue(te,"viewMatrix",D.matrixWorldInverse)}if(ie.isSkinnedMesh){Li.setOptional(te,ie,"bindMatrix"),Li.setOptional(te,ie,"bindMatrixInverse");const fr=ie.skeleton;fr&&(Le.floatVertexTextures?(null===fr.boneTexture&&fr.computeBoneTexture(),Li.setValue(te,"boneTexture",fr.boneTexture,ne),Li.setValue(te,"boneTextureSize",fr.boneTextureSize)):console.warn("THREE.WebGLRenderer: SkinnedMesh can only be used with WebGL 2. With WebGL 1 OES_texture_float and vertex textures support is required."))}const WM=J.morphAttributes;if((void 0!==WM.position||void 0!==WM.normal||void 0!==WM.color&&!0===Le.isWebGL2)&&me.update(ie,J,U,kr),(Zd||jt.receiveShadow!==ie.receiveShadow)&&(jt.receiveShadow=ie.receiveShadow,Li.setValue(te,"receiveShadow",ie.receiveShadow)),U.isMeshGouraudMaterial&&null!==U.envMap&&(bc.envMap.value=bt,bc.flipEnvMap.value=bt.isCubeTexture&&!1===bt.isRenderTargetTexture?-1:1),Zd&&(Li.setValue(te,"toneMappingExposure",m.toneMappingExposure),jt.needsLights&&function Xre(D,z){D.ambientLightColor.needsUpdate=z,D.lightProbe.needsUpdate=z,D.directionalLights.needsUpdate=z,D.directionalLightShadows.needsUpdate=z,D.pointLights.needsUpdate=z,D.pointLightShadows.needsUpdate=z,D.spotLights.needsUpdate=z,D.spotLightShadows.needsUpdate=z,D.rectAreaLights.needsUpdate=z,D.hemisphereLights.needsUpdate=z}(bc,jM),Xe&&!0===U.fog&&Xt.refreshFogUniforms(bc,Xe),Xt.refreshMaterialUniforms(bc,U,$,R,V),$m.upload(te,jt.uniformsList,bc,ne)),U.isShaderMaterial&&!0===U.uniformsNeedUpdate&&($m.upload(te,jt.uniformsList,bc,ne),U.uniformsNeedUpdate=!1),U.isSpriteMaterial&&Li.setValue(te,"center",ie.center),Li.setValue(te,"modelViewMatrix",ie.modelViewMatrix),Li.setValue(te,"normalMatrix",ie.normalMatrix),Li.setValue(te,"modelMatrix",ie.matrixWorld),U.isShaderMaterial||U.isRawShaderMaterial){const fr=U.uniformsGroups;for(let $M=0,Zre=fr.length;$M<Zre;$M++)if(Le.isWebGL2){const LF=fr[$M];Ee.update(LF,kr),Ee.bind(LF,kr)}else console.warn("THREE.WebGLRenderer: Uniform Buffer Objects can only be used with WebGL 2.")}return kr}(D,z,J,U,ie);ye.setMaterial(U,ht);let bt=J.index;const Gt=J.attributes.position;if(null===bt){if(void 0===Gt||0===Gt.count)return}else if(0===bt.count)return;let St=1;!0===U.wireframe&&(bt=lt.getWireframeAttribute(J),St=2),B.setup(ie,U,wt,J,bt);let Rt,wn=Me;null!==bt&&(Rt=be.get(bt),wn=et,wn.setIndex(Rt));const vc=null!==bt?bt.count:Gt.count,Au=J.drawRange.start*St,Iu=J.drawRange.count*St,As=null!==Xe?Xe.start*St:0,jt=null!==Xe?Xe.count*St:1/0,Pu=Math.max(Au,As),Vn=Math.min(vc,Au+Iu,As+jt)-1,kr=Math.max(0,Vn-Pu+1);if(0!==kr){if(ie.isMesh)!0===U.wireframe?(ye.setLineWidth(U.wireframeLinewidth*We()),wn.setMode(1)):wn.setMode(4);else if(ie.isLine){let ra=U.linewidth;void 0===ra&&(ra=1),ye.setLineWidth(ra*We()),wn.setMode(ie.isLineSegments?1:ie.isLineLoop?2:3)}else ie.isPoints?wn.setMode(0):ie.isSprite&&wn.setMode(4);if(ie.isInstancedMesh)wn.renderInstances(Pu,kr,ie.count);else if(J.isInstancedBufferGeometry){const ra=Math.min(J.instanceCount,J._maxInstanceCount);wn.renderInstances(Pu,kr,ra)}else wn.render(Pu,kr)}},this.compile=function(D,z){function J(U,ie,Xe){!0===U.transparent&&2===U.side?(U.side=1,U.needsUpdate=!0,Or(U,ie,Xe),U.side=0,U.needsUpdate=!0,Or(U,ie,Xe),U.side=2):Or(U,ie,Xe)}d=T.get(D),d.init(),p.push(d),D.traverseVisible(function(U){U.isLight&&U.layers.test(z.layers)&&(d.pushLight(U),U.castShadow&&d.pushShadow(U))}),d.setupLights(m.physicallyCorrectLights),D.traverse(function(U){const ie=U.material;if(ie)if(Array.isArray(ie))for(let Xe=0;Xe<ie.length;Xe++)J(ie[Xe],D,U);else J(ie,D,U)}),p.pop(),d=null};let Q=null;function Ae(){Ht.stop()}function He(){Ht.start()}const Ht=new oO;function ti(D,z,J,U){if(!1===D.visible)return;if(D.layers.test(z.layers))if(D.isGroup)J=D.renderOrder;else if(D.isLOD)!0===D.autoUpdate&&D.update(z);else if(D.isLight)d.pushLight(D),D.castShadow&&d.pushShadow(D);else if(D.isSprite){if(!D.frustumCulled||G.intersectsSprite(D)){U&&fe.setFromMatrixPosition(D.matrixWorld).applyMatrix4(ce);const ht=Qe.update(D),wt=D.material;wt.visible&&h.push(D,ht,wt,J,fe.z,null)}}else if((D.isMesh||D.isLine||D.isPoints)&&(D.isSkinnedMesh&&D.skeleton.frame!==ut.render.frame&&(D.skeleton.update(),D.skeleton.frame=ut.render.frame),!D.frustumCulled||G.intersectsObject(D))){U&&fe.setFromMatrixPosition(D.matrixWorld).applyMatrix4(ce);const ht=Qe.update(D),wt=D.material;if(Array.isArray(wt)){const bt=ht.groups;for(let Gt=0,St=bt.length;Gt<St;Gt++){const Rt=bt[Gt],wn=wt[Rt.materialIndex];wn&&wn.visible&&h.push(D,ht,wn,J,fe.z,Rt)}}else wt.visible&&h.push(D,ht,wt,J,fe.z,null)}const Xe=D.children;for(let ht=0,wt=Xe.length;ht<wt;ht++)ti(Xe[ht],z,J,U)}function vi(D,z,J,U){const ie=D.opaque,Xe=D.transmissive,ht=D.transparent;d.setupLightsView(J),Xe.length>0&&function yc(D,z,J){const U=Le.isWebGL2;null===V&&(V=new Fo(1,1,{generateMipmaps:!0,type:Fe.has("EXT_color_buffer_half_float")?rd:Ua,minFilter:1008,samples:U&&!0===s?4:0})),m.getDrawingBufferSize(re),U?V.setSize(re.x,re.y):V.setSize(wm(re.x),wm(re.y));const ie=m.getRenderTarget();m.setRenderTarget(V),m.clear();const Xe=m.toneMapping;m.toneMapping=0,fn(D,z,J),m.toneMapping=Xe,ne.updateMultisampleRenderTarget(V),ne.updateRenderTargetMipmap(V),m.setRenderTarget(ie)}(ie,z,J),U&&ye.viewport(M.copy(U)),ie.length>0&&fn(ie,z,J),Xe.length>0&&fn(Xe,z,J),ht.length>0&&fn(ht,z,J),ye.buffers.depth.setTest(!0),ye.buffers.depth.setMask(!0),ye.buffers.color.setMask(!0),ye.setPolygonOffset(!1)}function fn(D,z,J){const U=!0===z.isScene?z.overrideMaterial:null;for(let ie=0,Xe=D.length;ie<Xe;ie++){const ht=D[ie],wt=ht.object,bt=ht.geometry,Gt=null===U?ht.material:U,St=ht.group;wt.layers.test(J.layers)&&po(wt,z,J,bt,Gt,St)}}function po(D,z,J,U,ie,Xe){D.onBeforeRender(m,z,J,U,ie,Xe),D.modelViewMatrix.multiplyMatrices(J.matrixWorldInverse,D.matrixWorld),D.normalMatrix.getNormalMatrix(D.modelViewMatrix),ie.onBeforeRender(m,z,J,U,D,Xe),!0===ie.transparent&&2===ie.side?(ie.side=1,ie.needsUpdate=!0,m.renderBufferDirect(J,z,U,ie,D,Xe),ie.side=0,ie.needsUpdate=!0,m.renderBufferDirect(J,z,U,ie,D,Xe),ie.side=2):m.renderBufferDirect(J,z,U,ie,D,Xe),D.onAfterRender(m,z,J,U,ie,Xe)}function Or(D,z,J){!0!==z.isScene&&(z=pe);const U=oe.get(D),ie=d.state.lights,ht=ie.state.version,wt=$e.getParameters(D,ie.state,d.state.shadowsArray,z,J),bt=$e.getProgramCacheKey(wt);let Gt=U.programs;U.environment=D.isMeshStandardMaterial?z.environment:null,U.fog=z.fog,U.envMap=(D.isMeshStandardMaterial?ke:_e).get(D.envMap||U.environment),void 0===Gt&&(D.addEventListener("dispose",It),Gt=new Map,U.programs=Gt);let St=Gt.get(bt);if(void 0!==St){if(U.currentProgram===St&&U.lightsStateVersion===ht)return kF(D,wt),St}else wt.uniforms=$e.getUniforms(D),D.onBuild(J,wt,m),D.onBeforeCompile(wt,m),St=$e.acquireProgram(wt,bt),Gt.set(bt,St),U.uniforms=wt.uniforms;const Rt=U.uniforms;(!D.isShaderMaterial&&!D.isRawShaderMaterial||!0===D.clipping)&&(Rt.clippingPlanes=C.uniform),kF(D,wt),U.needsLights=function Yre(D){return D.isMeshLambertMaterial||D.isMeshToonMaterial||D.isMeshPhongMaterial||D.isMeshStandardMaterial||D.isShadowMaterial||D.isShaderMaterial&&!0===D.lights}(D),U.lightsStateVersion=ht,U.needsLights&&(Rt.ambientLightColor.value=ie.state.ambient,Rt.lightProbe.value=ie.state.probe,Rt.directionalLights.value=ie.state.directional,Rt.directionalLightShadows.value=ie.state.directionalShadow,Rt.spotLights.value=ie.state.spot,Rt.spotLightShadows.value=ie.state.spotShadow,Rt.rectAreaLights.value=ie.state.rectArea,Rt.ltc_1.value=ie.state.rectAreaLTC1,Rt.ltc_2.value=ie.state.rectAreaLTC2,Rt.pointLights.value=ie.state.point,Rt.pointLightShadows.value=ie.state.pointShadow,Rt.hemisphereLights.value=ie.state.hemi,Rt.directionalShadowMap.value=ie.state.directionalShadowMap,Rt.directionalShadowMatrix.value=ie.state.directionalShadowMatrix,Rt.spotShadowMap.value=ie.state.spotShadowMap,Rt.spotLightMatrix.value=ie.state.spotLightMatrix,Rt.spotLightMap.value=ie.state.spotLightMap,Rt.pointShadowMap.value=ie.state.pointShadowMap,Rt.pointShadowMatrix.value=ie.state.pointShadowMatrix);const wn=St.getUniforms(),vc=$m.seqWithValue(wn.seq,Rt);return U.currentProgram=St,U.uniformsList=vc,St}function kF(D,z){const J=oe.get(D);J.outputEncoding=z.outputEncoding,J.instancing=z.instancing,J.skinning=z.skinning,J.morphTargets=z.morphTargets,J.morphNormals=z.morphNormals,J.morphColors=z.morphColors,J.morphTargetsCount=z.morphTargetsCount,J.numClippingPlanes=z.numClippingPlanes,J.numIntersection=z.numClipIntersection,J.vertexAlphas=z.vertexAlphas,J.vertexTangents=z.vertexTangents,J.toneMapping=z.toneMapping}Ht.setAnimationLoop(function he(D){Q&&Q(D)}),typeof self<"u"&&Ht.setContext(self),this.setAnimationLoop=function(D){Q=D,De.setAnimationLoop(D),null===D?Ht.stop():Ht.start()},De.addEventListener("sessionstart",Ae),De.addEventListener("sessionend",He),this.render=function(D,z){if(void 0===z||!0===z.isCamera){if(!0!==g){if(!0===D.matrixWorldAutoUpdate&&D.updateMatrixWorld(),null===z.parent&&!0===z.matrixWorldAutoUpdate&&z.updateMatrixWorld(),!0===De.enabled&&!0===De.isPresenting&&(!0===De.cameraAutoUpdate&&De.updateCamera(z),z=De.getCamera()),!0===D.isScene&&D.onBeforeRender(m,D,z,y),d=T.get(D,p.length),d.init(),p.push(d),ce.multiplyMatrices(z.projectionMatrix,z.matrixWorldInverse),G.setFromProjectionMatrix(ce),O=this.localClippingEnabled,F=C.init(this.clippingPlanes,O,z),h=zt.get(D,f.length),h.init(),f.push(h),ti(D,z,0,m.sortObjects),h.finish(),!0===m.sortObjects&&h.sort(se,H),!0===F&&C.beginShadows(),q.render(d.state.shadowsArray,D,z),!0===F&&C.endShadows(),!0===this.info.autoReset&&this.info.reset(),ue.render(h,D),d.setupLights(m.physicallyCorrectLights),z.isArrayCamera){const U=z.cameras;for(let ie=0,Xe=U.length;ie<Xe;ie++){const ht=U[ie];vi(h,D,ht,ht.viewport)}}else vi(h,D,z);null!==y&&(ne.updateMultisampleRenderTarget(y),ne.updateRenderTargetMipmap(y)),!0===D.isScene&&D.onAfterRender(m,D,z),B.resetDefaultState(),v=-1,w=null,p.pop(),d=p.length>0?p[p.length-1]:null,f.pop(),h=f.length>0?f[f.length-1]:null}}else console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.")},this.getActiveCubeFace=function(){return _},this.getActiveMipmapLevel=function(){return b},this.getRenderTarget=function(){return y},this.setRenderTargetTextures=function(D,z,J){oe.get(D.texture).__webglTexture=z,oe.get(D.depthTexture).__webglTexture=J;const U=oe.get(D);U.__hasExternalTextures=!0,U.__hasExternalTextures&&(U.__autoAllocateDepthBuffer=void 0===J,U.__autoAllocateDepthBuffer||!0===Fe.has("WEBGL_multisampled_render_to_texture")&&(console.warn("THREE.WebGLRenderer: Render-to-texture extension was disabled because an external texture was provided"),U.__useRenderToTexture=!1))},this.setRenderTargetFramebuffer=function(D,z){const J=oe.get(D);J.__webglFramebuffer=z,J.__useDefaultFramebuffer=void 0===z},this.setRenderTarget=function(D,z=0,J=0){y=D,_=z,b=J;let U=!0,ie=null,Xe=!1,ht=!1;if(D){const bt=oe.get(D);void 0!==bt.__useDefaultFramebuffer?(ye.bindFramebuffer(36160,null),U=!1):void 0===bt.__webglFramebuffer?ne.setupRenderTarget(D):bt.__hasExternalTextures&&ne.rebindTextures(D,oe.get(D.texture).__webglTexture,oe.get(D.depthTexture).__webglTexture);const Gt=D.texture;(Gt.isData3DTexture||Gt.isDataArrayTexture||Gt.isCompressedArrayTexture)&&(ht=!0);const St=oe.get(D).__webglFramebuffer;D.isWebGLCubeRenderTarget?(ie=St[z],Xe=!0):ie=Le.isWebGL2&&D.samples>0&&!1===ne.useMultisampledRTT(D)?oe.get(D).__webglMultisampledFramebuffer:St,M.copy(D.viewport),I.copy(D.scissor),x=D.scissorTest}else M.copy(N).multiplyScalar($).floor(),I.copy(X).multiplyScalar($).floor(),x=L;if(ye.bindFramebuffer(36160,ie)&&Le.drawBuffers&&U&&ye.drawBuffers(D,ie),ye.viewport(M),ye.scissor(I),ye.setScissorTest(x),Xe){const bt=oe.get(D.texture);te.framebufferTexture2D(36160,36064,34069+z,bt.__webglTexture,J)}else if(ht){const bt=oe.get(D.texture);te.framebufferTextureLayer(36160,36064,bt.__webglTexture,J||0,z||0)}v=-1},this.readRenderTargetPixels=function(D,z,J,U,ie,Xe,ht){if(!D||!D.isWebGLRenderTarget)return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");let wt=oe.get(D).__webglFramebuffer;if(D.isWebGLCubeRenderTarget&&void 0!==ht&&(wt=wt[ht]),wt){ye.bindFramebuffer(36160,wt);try{const bt=D.texture,Gt=bt.format,St=bt.type;if(Gt!==Er&&P.convert(Gt)!==te.getParameter(35739))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");const Rt=St===rd&&(Fe.has("EXT_color_buffer_half_float")||Le.isWebGL2&&Fe.has("EXT_color_buffer_float"));if(!(St===Ua||P.convert(St)===te.getParameter(35738)||St===Lo&&(Le.isWebGL2||Fe.has("OES_texture_float")||Fe.has("WEBGL_color_buffer_float"))||Rt))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");z>=0&&z<=D.width-U&&J>=0&&J<=D.height-ie&&te.readPixels(z,J,U,ie,P.convert(Gt),P.convert(St),Xe)}finally{const bt=null!==y?oe.get(y).__webglFramebuffer:null;ye.bindFramebuffer(36160,bt)}}},this.copyFramebufferToTexture=function(D,z,J=0){const U=Math.pow(2,-J),ie=Math.floor(z.image.width*U),Xe=Math.floor(z.image.height*U);ne.setTexture2D(z,0),te.copyTexSubImage2D(3553,J,0,0,D.x,D.y,ie,Xe),ye.unbindTexture()},this.copyTextureToTexture=function(D,z,J,U=0){const ie=z.image.width,Xe=z.image.height,ht=P.convert(J.format),wt=P.convert(J.type);ne.setTexture2D(J,0),te.pixelStorei(37440,J.flipY),te.pixelStorei(37441,J.premultiplyAlpha),te.pixelStorei(3317,J.unpackAlignment),z.isDataTexture?te.texSubImage2D(3553,U,D.x,D.y,ie,Xe,ht,wt,z.image.data):z.isCompressedTexture?te.compressedTexSubImage2D(3553,U,D.x,D.y,z.mipmaps[0].width,z.mipmaps[0].height,ht,z.mipmaps[0].data):te.texSubImage2D(3553,U,D.x,D.y,ht,wt,z.image),0===U&&J.generateMipmaps&&te.generateMipmap(3553),ye.unbindTexture()},this.copyTextureToTexture3D=function(D,z,J,U,ie=0){if(m.isWebGL1Renderer)return void console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: can only be used with WebGL2.");const Xe=D.max.x-D.min.x+1,ht=D.max.y-D.min.y+1,wt=D.max.z-D.min.z+1,bt=P.convert(U.format),Gt=P.convert(U.type);let St;if(U.isData3DTexture)ne.setTexture3D(U,0),St=32879;else{if(!U.isDataArrayTexture)return void console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: only supports THREE.DataTexture3D and THREE.DataTexture2DArray.");ne.setTexture2DArray(U,0),St=35866}te.pixelStorei(37440,U.flipY),te.pixelStorei(37441,U.premultiplyAlpha),te.pixelStorei(3317,U.unpackAlignment);const Rt=te.getParameter(3314),wn=te.getParameter(32878),vc=te.getParameter(3316),Au=te.getParameter(3315),Iu=te.getParameter(32877),As=J.isCompressedTexture?J.mipmaps[0]:J.image;te.pixelStorei(3314,As.width),te.pixelStorei(32878,As.height),te.pixelStorei(3316,D.min.x),te.pixelStorei(3315,D.min.y),te.pixelStorei(32877,D.min.z),J.isDataTexture||J.isData3DTexture?te.texSubImage3D(St,ie,z.x,z.y,z.z,Xe,ht,wt,bt,Gt,As.data):J.isCompressedArrayTexture?(console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: untested support for compressed srcTexture."),te.compressedTexSubImage3D(St,ie,z.x,z.y,z.z,Xe,ht,wt,bt,As.data)):te.texSubImage3D(St,ie,z.x,z.y,z.z,Xe,ht,wt,bt,Gt,As),te.pixelStorei(3314,Rt),te.pixelStorei(32878,wn),te.pixelStorei(3316,vc),te.pixelStorei(3315,Au),te.pixelStorei(32877,Iu),0===ie&&U.generateMipmaps&&te.generateMipmap(St),ye.unbindTexture()},this.initTexture=function(D){D.isCubeTexture?ne.setTextureCube(D,0):D.isData3DTexture?ne.setTexture3D(D,0):D.isDataArrayTexture||D.isCompressedArrayTexture?ne.setTexture2DArray(D,0):ne.setTexture2D(D,0),ye.unbindTexture()},this.resetState=function(){_=0,b=0,y=null,ye.reset(),B.reset()},typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}(class VK extends $x{}).prototype.isWebGL1Renderer=!0;class Yx extends ar{constructor(){super(),this.isScene=!0,this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.backgroundBlurriness=0,this.overrideMaterial=null,typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(e,t){return super.copy(e,t),null!==e.background&&(this.background=e.background.clone()),null!==e.environment&&(this.environment=e.environment.clone()),null!==e.fog&&(this.fog=e.fog.clone()),this.backgroundBlurriness=e.backgroundBlurriness,null!==e.overrideMaterial&&(this.overrideMaterial=e.overrideMaterial.clone()),this.matrixAutoUpdate=e.matrixAutoUpdate,this}toJSON(e){const t=super.toJSON(e);return null!==this.fog&&(t.object.fog=this.fog.toJSON()),this.backgroundBlurriness>0&&(t.backgroundBlurriness=this.backgroundBlurriness),t}get autoUpdate(){return console.warn("THREE.Scene: autoUpdate was renamed to matrixWorldAutoUpdate in r144."),this.matrixWorldAutoUpdate}set autoUpdate(e){console.warn("THREE.Scene: autoUpdate was renamed to matrixWorldAutoUpdate in r144."),this.matrixWorldAutoUpdate=e}}class du extends gt{constructor(e=1,t=1,i=1,r=8,s=1,o=!1,a=0,c=2*Math.PI){super(),this.type="CylinderGeometry",this.parameters={radiusTop:e,radiusBottom:t,height:i,radialSegments:r,heightSegments:s,openEnded:o,thetaStart:a,thetaLength:c};const l=this;r=Math.floor(r),s=Math.floor(s);const u=[],h=[],d=[],f=[];let p=0;const m=[],g=i/2;let _=0;function y(v){const w=p,M=new ee,I=new S;let x=0;const E=!0===v?e:t,R=!0===v?1:-1;for(let se=1;se<=r;se++)h.push(0,g*R,0),d.push(0,R,0),f.push(.5,.5),p++;const $=p;for(let se=0;se<=r;se++){const N=se/r*c+a,X=Math.cos(N),L=Math.sin(N);I.x=E*L,I.y=g*R,I.z=E*X,h.push(I.x,I.y,I.z),d.push(0,R,0),M.x=.5*X+.5,M.y=.5*L*R+.5,f.push(M.x,M.y),p++}for(let se=0;se<r;se++){const H=w+se,N=$+se;!0===v?u.push(N,N+1,H):u.push(N+1,N,H),x+=3}l.addGroup(_,x,!0===v?1:2),_+=x}(function b(){const v=new S,w=new S;let M=0;const I=(t-e)/i;for(let x=0;x<=s;x++){const E=[],R=x/s,$=R*(t-e)+e;for(let se=0;se<=r;se++){const H=se/r,N=H*c+a,X=Math.sin(N),L=Math.cos(N);w.x=$*X,w.y=-R*i+g,w.z=$*L,h.push(w.x,w.y,w.z),v.set(X,I,L).normalize(),d.push(v.x,v.y,v.z),f.push(H,1-R),E.push(p++)}m.push(E)}for(let x=0;x<r;x++)for(let E=0;E<s;E++){const $=m[E+1][x],se=m[E+1][x+1],H=m[E][x+1];u.push(m[E][x],$,H),u.push($,se,H),M+=6}l.addGroup(_,M,0),_+=M})(),!1===o&&(e>0&&y(!0),t>0&&y(!1)),this.setIndex(u),this.setAttribute("position",new Re(h,3)),this.setAttribute("normal",new Re(d,3)),this.setAttribute("uv",new Re(f,2))}static fromJSON(e){return new du(e.radiusTop,e.radiusBottom,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}}class Ed extends gt{constructor(e=1,t=32,i=16,r=0,s=2*Math.PI,o=0,a=Math.PI){super(),this.type="SphereGeometry",this.parameters={radius:e,widthSegments:t,heightSegments:i,phiStart:r,phiLength:s,thetaStart:o,thetaLength:a},t=Math.max(3,Math.floor(t)),i=Math.max(2,Math.floor(i));const c=Math.min(o+a,Math.PI);let l=0;const u=[],h=new S,d=new S,f=[],p=[],m=[],g=[];for(let _=0;_<=i;_++){const b=[],y=_/i;let v=0;0==_&&0==o?v=.5/t:_==i&&c==Math.PI&&(v=-.5/t);for(let w=0;w<=t;w++){const M=w/t;h.x=-e*Math.cos(r+M*s)*Math.sin(o+y*a),h.y=e*Math.cos(o+y*a),h.z=e*Math.sin(r+M*s)*Math.sin(o+y*a),p.push(h.x,h.y,h.z),d.copy(h).normalize(),m.push(d.x,d.y,d.z),g.push(M+v,1-y),b.push(l++)}u.push(b)}for(let _=0;_<i;_++)for(let b=0;b<t;b++){const y=u[_][b+1],v=u[_][b],w=u[_+1][b],M=u[_+1][b+1];(0!==_||o>0)&&f.push(y,v,M),(_!==i-1||c<Math.PI)&&f.push(v,w,M)}this.setIndex(f),this.setAttribute("position",new Re(p,3)),this.setAttribute("normal",new Re(m,3)),this.setAttribute("uv",new Re(g,2))}static fromJSON(e){return new Ed(e.radius,e.widthSegments,e.heightSegments,e.phiStart,e.phiLength,e.thetaStart,e.thetaLength)}}class _k extends Ja{constructor(e){super(),this.isMeshStandardMaterial=!0,this.defines={STANDARD:""},this.type="MeshStandardMaterial",this.color=new Ie(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Ie(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new ee(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapIntensity=1,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.defines={STANDARD:""},this.color.copy(e.color),this.roughness=e.roughness,this.metalness=e.metalness,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.roughnessMap=e.roughnessMap,this.metalnessMap=e.metalnessMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapIntensity=e.envMapIntensity,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class yk extends _k{constructor(e){super(),this.isMeshPhysicalMaterial=!0,this.defines={STANDARD:"",PHYSICAL:""},this.type="MeshPhysicalMaterial",this.clearcoatMap=null,this.clearcoatRoughness=0,this.clearcoatRoughnessMap=null,this.clearcoatNormalScale=new ee(1,1),this.clearcoatNormalMap=null,this.ior=1.5,Object.defineProperty(this,"reflectivity",{get:function(){return Tn(2.5*(this.ior-1)/(this.ior+1),0,1)},set:function(t){this.ior=(1+.4*t)/(1-.4*t)}}),this.iridescenceMap=null,this.iridescenceIOR=1.3,this.iridescenceThicknessRange=[100,400],this.iridescenceThicknessMap=null,this.sheenColor=new Ie(0),this.sheenColorMap=null,this.sheenRoughness=1,this.sheenRoughnessMap=null,this.transmissionMap=null,this.thickness=0,this.thicknessMap=null,this.attenuationDistance=1/0,this.attenuationColor=new Ie(1,1,1),this.specularIntensity=1,this.specularIntensityMap=null,this.specularColor=new Ie(1,1,1),this.specularColorMap=null,this._sheen=0,this._clearcoat=0,this._iridescence=0,this._transmission=0,this.setValues(e)}get sheen(){return this._sheen}set sheen(e){this._sheen>0!=e>0&&this.version++,this._sheen=e}get clearcoat(){return this._clearcoat}set clearcoat(e){this._clearcoat>0!=e>0&&this.version++,this._clearcoat=e}get iridescence(){return this._iridescence}set iridescence(e){this._iridescence>0!=e>0&&this.version++,this._iridescence=e}get transmission(){return this._transmission}set transmission(e){this._transmission>0!=e>0&&this.version++,this._transmission=e}copy(e){return super.copy(e),this.defines={STANDARD:"",PHYSICAL:""},this.clearcoat=e.clearcoat,this.clearcoatMap=e.clearcoatMap,this.clearcoatRoughness=e.clearcoatRoughness,this.clearcoatRoughnessMap=e.clearcoatRoughnessMap,this.clearcoatNormalMap=e.clearcoatNormalMap,this.clearcoatNormalScale.copy(e.clearcoatNormalScale),this.ior=e.ior,this.iridescence=e.iridescence,this.iridescenceMap=e.iridescenceMap,this.iridescenceIOR=e.iridescenceIOR,this.iridescenceThicknessRange=[...e.iridescenceThicknessRange],this.iridescenceThicknessMap=e.iridescenceThicknessMap,this.sheen=e.sheen,this.sheenColor.copy(e.sheenColor),this.sheenColorMap=e.sheenColorMap,this.sheenRoughness=e.sheenRoughness,this.sheenRoughnessMap=e.sheenRoughnessMap,this.transmission=e.transmission,this.transmissionMap=e.transmissionMap,this.thickness=e.thickness,this.thicknessMap=e.thicknessMap,this.attenuationDistance=e.attenuationDistance,this.attenuationColor.copy(e.attenuationColor),this.specularIntensity=e.specularIntensity,this.specularIntensityMap=e.specularIntensityMap,this.specularColor.copy(e.specularColor),this.specularColorMap=e.specularColorMap,this}}class ww extends Ja{constructor(e){super(),this.isMeshLambertMaterial=!0,this.type="MeshLambertMaterial",this.color=new Ie(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Ie(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new ee(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=0,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}function Tr(n,e,t){return Mw(n)?new n.constructor(n.subarray(e,void 0!==t?t:n.length)):n.slice(e,t)}function ic(n,e,t){return!n||!t&&n.constructor===e?n:"number"==typeof e.BYTES_PER_ELEMENT?new e(n):Array.prototype.slice.call(n)}function Mw(n){return ArrayBuffer.isView(n)&&!(n instanceof DataView)}class dg{constructor(e,t,i,r){this.parameterPositions=e,this._cachedIndex=0,this.resultBuffer=void 0!==r?r:new t.constructor(i),this.sampleValues=t,this.valueSize=i,this.settings=null,this.DefaultSettings_={}}evaluate(e){const t=this.parameterPositions;let i=this._cachedIndex,r=t[i],s=t[i-1];e:{t:{let o;n:{i:if(!(e<r)){for(let a=i+2;;){if(void 0===r){if(e<s)break i;return i=t.length,this._cachedIndex=i,this.copySampleValue_(i-1)}if(i===a)break;if(s=r,r=t[++i],e<r)break t}o=t.length;break n}if(e>=s)break e;{const a=t[1];e<a&&(i=2,s=a);for(let c=i-2;;){if(void 0===s)return this._cachedIndex=0,this.copySampleValue_(0);if(i===c)break;if(r=s,s=t[--i-1],e>=s)break t}o=i,i=0}}for(;i<o;){const a=i+o>>>1;e<t[a]?o=a:i=a+1}if(r=t[i],s=t[i-1],void 0===s)return this._cachedIndex=0,this.copySampleValue_(0);if(void 0===r)return i=t.length,this._cachedIndex=i,this.copySampleValue_(i-1)}this._cachedIndex=i,this.intervalChanged_(i,s,r)}return this.interpolate_(i,s,e,r)}getSettings_(){return this.settings||this.DefaultSettings_}copySampleValue_(e){const t=this.resultBuffer,i=this.sampleValues,r=this.valueSize,s=e*r;for(let o=0;o!==r;++o)t[o]=i[s+o];return t}interpolate_(){throw new Error("call to abstract method")}intervalChanged_(){}}class VJ extends dg{constructor(e,t,i,r){super(e,t,i,r),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0,this.DefaultSettings_={endingStart:2400,endingEnd:2400}}intervalChanged_(e,t,i){const r=this.parameterPositions;let s=e-2,o=e+1,a=r[s],c=r[o];if(void 0===a)switch(this.getSettings_().endingStart){case 2401:s=e,a=2*t-i;break;case 2402:s=r.length-2,a=t+r[s]-r[s+1];break;default:s=e,a=i}if(void 0===c)switch(this.getSettings_().endingEnd){case 2401:o=e,c=2*i-t;break;case 2402:o=1,c=i+r[1]-r[0];break;default:o=e-1,c=t}const l=.5*(i-t),u=this.valueSize;this._weightPrev=l/(t-a),this._weightNext=l/(c-i),this._offsetPrev=s*u,this._offsetNext=o*u}interpolate_(e,t,i,r){const s=this.resultBuffer,o=this.sampleValues,a=this.valueSize,c=e*a,l=c-a,u=this._offsetPrev,h=this._offsetNext,d=this._weightPrev,f=this._weightNext,p=(i-t)/(r-t),m=p*p,g=m*p,_=-d*g+2*d*m-d*p,b=(1+d)*g+(-1.5-2*d)*m+(-.5+d)*p+1,y=(-1-f)*g+(1.5+f)*m+.5*p,v=f*g-f*m;for(let w=0;w!==a;++w)s[w]=_*o[u+w]+b*o[l+w]+y*o[c+w]+v*o[h+w];return s}}class bk extends dg{constructor(e,t,i,r){super(e,t,i,r)}interpolate_(e,t,i,r){const s=this.resultBuffer,o=this.sampleValues,a=this.valueSize,c=e*a,l=c-a,u=(i-t)/(r-t),h=1-u;for(let d=0;d!==a;++d)s[d]=o[l+d]*h+o[c+d]*u;return s}}class BJ extends dg{constructor(e,t,i,r){super(e,t,i,r)}interpolate_(e){return this.copySampleValue_(e-1)}}class Cs{constructor(e,t,i,r){if(void 0===e)throw new Error("THREE.KeyframeTrack: track name is undefined");if(void 0===t||0===t.length)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+e);this.name=e,this.times=ic(t,this.TimeBufferType),this.values=ic(i,this.ValueBufferType),this.setInterpolation(r||this.DefaultInterpolation)}static toJSON(e){const t=e.constructor;let i;if(t.toJSON!==this.toJSON)i=t.toJSON(e);else{i={name:e.name,times:ic(e.times,Array),values:ic(e.values,Array)};const r=e.getInterpolation();r!==e.DefaultInterpolation&&(i.interpolation=r)}return i.type=e.ValueTypeName,i}InterpolantFactoryMethodDiscrete(e){return new BJ(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodLinear(e){return new bk(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodSmooth(e){return new VJ(this.times,this.values,this.getValueSize(),e)}setInterpolation(e){let t;switch(e){case 2300:t=this.InterpolantFactoryMethodDiscrete;break;case 2301:t=this.InterpolantFactoryMethodLinear;break;case 2302:t=this.InterpolantFactoryMethodSmooth}if(void 0===t){const i="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(void 0===this.createInterpolant){if(e===this.DefaultInterpolation)throw new Error(i);this.setInterpolation(this.DefaultInterpolation)}return console.warn("THREE.KeyframeTrack:",i),this}return this.createInterpolant=t,this}getInterpolation(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return 2300;case this.InterpolantFactoryMethodLinear:return 2301;case this.InterpolantFactoryMethodSmooth:return 2302}}getValueSize(){return this.values.length/this.times.length}shift(e){if(0!==e){const t=this.times;for(let i=0,r=t.length;i!==r;++i)t[i]+=e}return this}scale(e){if(1!==e){const t=this.times;for(let i=0,r=t.length;i!==r;++i)t[i]*=e}return this}trim(e,t){const i=this.times,r=i.length;let s=0,o=r-1;for(;s!==r&&i[s]<e;)++s;for(;-1!==o&&i[o]>t;)--o;if(++o,0!==s||o!==r){s>=o&&(o=Math.max(o,1),s=o-1);const a=this.getValueSize();this.times=Tr(i,s,o),this.values=Tr(this.values,s*a,o*a)}return this}validate(){let e=!0;const t=this.getValueSize();t-Math.floor(t)!=0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),e=!1);const i=this.times,r=this.values,s=i.length;0===s&&(console.error("THREE.KeyframeTrack: Track is empty.",this),e=!1);let o=null;for(let a=0;a!==s;a++){const c=i[a];if("number"==typeof c&&isNaN(c)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,a,c),e=!1;break}if(null!==o&&o>c){console.error("THREE.KeyframeTrack: Out of order keys.",this,a,c,o),e=!1;break}o=c}if(void 0!==r&&Mw(r))for(let a=0,c=r.length;a!==c;++a){const l=r[a];if(isNaN(l)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,a,l),e=!1;break}}return e}optimize(){const e=Tr(this.times),t=Tr(this.values),i=this.getValueSize(),r=2302===this.getInterpolation(),s=e.length-1;let o=1;for(let a=1;a<s;++a){let c=!1;const l=e[a];if(l!==e[a+1]&&(1!==a||l!==e[0]))if(r)c=!0;else{const h=a*i,d=h-i,f=h+i;for(let p=0;p!==i;++p){const m=t[h+p];if(m!==t[d+p]||m!==t[f+p]){c=!0;break}}}if(c){if(a!==o){e[o]=e[a];const h=a*i,d=o*i;for(let f=0;f!==i;++f)t[d+f]=t[h+f]}++o}}if(s>0){e[o]=e[s];for(let a=s*i,c=o*i,l=0;l!==i;++l)t[c+l]=t[a+l];++o}return o!==e.length?(this.times=Tr(e,0,o),this.values=Tr(t,0,o*i)):(this.times=e,this.values=t),this}clone(){const e=Tr(this.times,0),t=Tr(this.values,0),r=new(0,this.constructor)(this.name,e,t);return r.createInterpolant=this.createInterpolant,r}}Cs.prototype.TimeBufferType=Float32Array,Cs.prototype.ValueBufferType=Float32Array,Cs.prototype.DefaultInterpolation=2301;class mu extends Cs{}mu.prototype.ValueTypeName="bool",mu.prototype.ValueBufferType=Array,mu.prototype.DefaultInterpolation=2300,mu.prototype.InterpolantFactoryMethodLinear=void 0,mu.prototype.InterpolantFactoryMethodSmooth=void 0;(class xk extends Cs{}).prototype.ValueTypeName="color";(class fg extends Cs{}).prototype.ValueTypeName="number";class UJ extends dg{constructor(e,t,i,r){super(e,t,i,r)}interpolate_(e,t,i,r){const s=this.resultBuffer,o=this.sampleValues,a=this.valueSize,c=(i-t)/(r-t);let l=e*a;for(let u=l+a;l!==u;l+=4)Ii.slerpFlat(s,0,o,l-a,o,l,c);return s}}class Dd extends Cs{InterpolantFactoryMethodLinear(e){return new UJ(this.times,this.values,this.getValueSize(),e)}}Dd.prototype.ValueTypeName="quaternion",Dd.prototype.DefaultInterpolation=2301,Dd.prototype.InterpolantFactoryMethodSmooth=void 0;class gu extends Cs{}gu.prototype.ValueTypeName="string",gu.prototype.ValueBufferType=Array,gu.prototype.DefaultInterpolation=2300,gu.prototype.InterpolantFactoryMethodLinear=void 0,gu.prototype.InterpolantFactoryMethodSmooth=void 0;(class pg extends Cs{}).prototype.ValueTypeName="vector";class jJ extends Error{constructor(e,t){super(e),this.response=t}}class Mk extends ar{constructor(e,t=1){super(),this.isLight=!0,this.type="Light",this.color=new Ie(e),this.intensity=t}dispose(){}copy(e,t){return super.copy(e,t),this.color.copy(e.color),this.intensity=e.intensity,this}toJSON(e){const t=super.toJSON(e);return t.object.color=this.color.getHex(),t.object.intensity=this.intensity,void 0!==this.groundColor&&(t.object.groundColor=this.groundColor.getHex()),void 0!==this.distance&&(t.object.distance=this.distance),void 0!==this.angle&&(t.object.angle=this.angle),void 0!==this.decay&&(t.object.decay=this.decay),void 0!==this.penumbra&&(t.object.penumbra=this.penumbra),void 0!==this.shadow&&(t.object.shadow=this.shadow.toJSON()),t}}const Ew=new ct,Ck=new S,Sk=new S;class $J{constructor(e){this.camera=e,this.bias=0,this.normalBias=0,this.radius=1,this.blurSamples=8,this.mapSize=new ee(512,512),this.map=null,this.mapPass=null,this.matrix=new ct,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new Bx,this._frameExtents=new ee(1,1),this._viewportCount=1,this._viewports=[new qt(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(e){const t=this.camera,i=this.matrix;Ck.setFromMatrixPosition(e.matrixWorld),t.position.copy(Ck),Sk.setFromMatrixPosition(e.target.matrixWorld),t.lookAt(Sk),t.updateMatrixWorld(),Ew.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),this._frustum.setFromProjectionMatrix(Ew),i.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),i.multiply(Ew)}getViewport(e){return this._viewports[e]}getFrameExtents(){return this._frameExtents}dispose(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}copy(e){return this.camera=e.camera.clone(),this.bias=e.bias,this.radius=e.radius,this.mapSize.copy(e.mapSize),this}clone(){return(new this.constructor).copy(this)}toJSON(){const e={};return 0!==this.bias&&(e.bias=this.bias),0!==this.normalBias&&(e.normalBias=this.normalBias),1!==this.radius&&(e.radius=this.radius),(512!==this.mapSize.x||512!==this.mapSize.y)&&(e.mapSize=this.mapSize.toArray()),e.camera=this.camera.toJSON(!1).object,delete e.camera.matrix,e}}class KJ extends $J{constructor(){super(new fd(-5,5,5,-5,.5,500)),this.isDirectionalLightShadow=!0}}class Tw extends Mk{constructor(e,t){super(e,t),this.isDirectionalLight=!0,this.type="DirectionalLight",this.position.copy(ar.DefaultUp),this.updateMatrix(),this.target=new ar,this.shadow=new KJ}dispose(){this.shadow.dispose()}copy(e){return super.copy(e),this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}class Aw extends Mk{constructor(e,t){super(e,t),this.isAmbientLight=!0,this.type="AmbientLight"}}class Ok{constructor(e=!0){this.autoStart=e,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}start(){this.startTime=kk(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0}stop(){this.getElapsedTime(),this.running=!1,this.autoStart=!1}getElapsedTime(){return this.getDelta(),this.elapsedTime}getDelta(){let e=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){const t=kk();e=(t-this.oldTime)/1e3,this.oldTime=t,this.elapsedTime+=e}return e}}function kk(){return(typeof performance>"u"?Date:performance).now()}const Pw="\\[\\]\\.:\\/",aQ=new RegExp("["+Pw+"]","g"),Rw="[^"+Pw+"]",cQ="[^"+Pw.replace("\\.","")+"]",fQ=new RegExp("^"+/((?:WC+[\/:])*)/.source.replace("WC",Rw)+/(WCOD+)?/.source.replace("WCOD",cQ)+/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",Rw)+/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",Rw)+"$"),pQ=["material","materials","bones","map"];class mQ{constructor(e,t,i){const r=i||ln.parseTrackName(t);this._targetGroup=e,this._bindings=e.subscribe_(t,r)}getValue(e,t){this.bind();const r=this._bindings[this._targetGroup.nCachedObjects_];void 0!==r&&r.getValue(e,t)}setValue(e,t){const i=this._bindings;for(let r=this._targetGroup.nCachedObjects_,s=i.length;r!==s;++r)i[r].setValue(e,t)}bind(){const e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,i=e.length;t!==i;++t)e[t].bind()}unbind(){const e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,i=e.length;t!==i;++t)e[t].unbind()}}let ln=(()=>{class n{constructor(t,i,r){this.path=i,this.parsedPath=r||n.parseTrackName(i),this.node=n.findNode(t,this.parsedPath.nodeName)||t,this.rootNode=t,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}static create(t,i,r){return t&&t.isAnimationObjectGroup?new n.Composite(t,i,r):new n(t,i,r)}static sanitizeNodeName(t){return t.replace(/\s/g,"_").replace(aQ,"")}static parseTrackName(t){const i=fQ.exec(t);if(null===i)throw new Error("PropertyBinding: Cannot parse trackName: "+t);const r={nodeName:i[2],objectName:i[3],objectIndex:i[4],propertyName:i[5],propertyIndex:i[6]},s=r.nodeName&&r.nodeName.lastIndexOf(".");if(void 0!==s&&-1!==s){const o=r.nodeName.substring(s+1);-1!==pQ.indexOf(o)&&(r.nodeName=r.nodeName.substring(0,s),r.objectName=o)}if(null===r.propertyName||0===r.propertyName.length)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+t);return r}static findNode(t,i){if(void 0===i||""===i||"."===i||-1===i||i===t.name||i===t.uuid)return t;if(t.skeleton){const r=t.skeleton.getBoneByName(i);if(void 0!==r)return r}if(t.children){const r=function(o){for(let a=0;a<o.length;a++){const c=o[a];if(c.name===i||c.uuid===i)return c;const l=r(c.children);if(l)return l}return null},s=r(t.children);if(s)return s}return null}_getValue_unavailable(){}_setValue_unavailable(){}_getValue_direct(t,i){t[i]=this.targetObject[this.propertyName]}_getValue_array(t,i){const r=this.resolvedProperty;for(let s=0,o=r.length;s!==o;++s)t[i++]=r[s]}_getValue_arrayElement(t,i){t[i]=this.resolvedProperty[this.propertyIndex]}_getValue_toArray(t,i){this.resolvedProperty.toArray(t,i)}_setValue_direct(t,i){this.targetObject[this.propertyName]=t[i]}_setValue_direct_setNeedsUpdate(t,i){this.targetObject[this.propertyName]=t[i],this.targetObject.needsUpdate=!0}_setValue_direct_setMatrixWorldNeedsUpdate(t,i){this.targetObject[this.propertyName]=t[i],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_array(t,i){const r=this.resolvedProperty;for(let s=0,o=r.length;s!==o;++s)r[s]=t[i++]}_setValue_array_setNeedsUpdate(t,i){const r=this.resolvedProperty;for(let s=0,o=r.length;s!==o;++s)r[s]=t[i++];this.targetObject.needsUpdate=!0}_setValue_array_setMatrixWorldNeedsUpdate(t,i){const r=this.resolvedProperty;for(let s=0,o=r.length;s!==o;++s)r[s]=t[i++];this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_arrayElement(t,i){this.resolvedProperty[this.propertyIndex]=t[i]}_setValue_arrayElement_setNeedsUpdate(t,i){this.resolvedProperty[this.propertyIndex]=t[i],this.targetObject.needsUpdate=!0}_setValue_arrayElement_setMatrixWorldNeedsUpdate(t,i){this.resolvedProperty[this.propertyIndex]=t[i],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_fromArray(t,i){this.resolvedProperty.fromArray(t,i)}_setValue_fromArray_setNeedsUpdate(t,i){this.resolvedProperty.fromArray(t,i),this.targetObject.needsUpdate=!0}_setValue_fromArray_setMatrixWorldNeedsUpdate(t,i){this.resolvedProperty.fromArray(t,i),this.targetObject.matrixWorldNeedsUpdate=!0}_getValue_unbound(t,i){this.bind(),this.getValue(t,i)}_setValue_unbound(t,i){this.bind(),this.setValue(t,i)}bind(){let t=this.node;const i=this.parsedPath,r=i.objectName,s=i.propertyName;let o=i.propertyIndex;if(t||(t=n.findNode(this.rootNode,i.nodeName)||this.rootNode,this.node=t),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!t)return void console.error("THREE.PropertyBinding: Trying to update node for track: "+this.path+" but it wasn't found.");if(r){let u=i.objectIndex;switch(r){case"materials":if(!t.material)return void console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);if(!t.material.materials)return void console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);t=t.material.materials;break;case"bones":if(!t.skeleton)return void console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);t=t.skeleton.bones;for(let h=0;h<t.length;h++)if(t[h].name===u){u=h;break}break;case"map":if("map"in t){t=t.map;break}if(!t.material)return void console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);if(!t.material.map)return void console.error("THREE.PropertyBinding: Can not bind to material.map as node.material does not have a map.",this);t=t.material.map;break;default:if(void 0===t[r])return void console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);t=t[r]}if(void 0!==u){if(void 0===t[u])return void console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,t);t=t[u]}}const a=t[s];if(void 0===a)return void console.error("THREE.PropertyBinding: Trying to update property for track: "+i.nodeName+"."+s+" but it wasn't found.",t);let c=this.Versioning.None;this.targetObject=t,void 0!==t.needsUpdate?c=this.Versioning.NeedsUpdate:void 0!==t.matrixWorldNeedsUpdate&&(c=this.Versioning.MatrixWorldNeedsUpdate);let l=this.BindingType.Direct;if(void 0!==o){if("morphTargetInfluences"===s){if(!t.geometry)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);if(!t.geometry.morphAttributes)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);void 0!==t.morphTargetDictionary[o]&&(o=t.morphTargetDictionary[o])}l=this.BindingType.ArrayElement,this.resolvedProperty=a,this.propertyIndex=o}else void 0!==a.fromArray&&void 0!==a.toArray?(l=this.BindingType.HasFromToArray,this.resolvedProperty=a):Array.isArray(a)?(l=this.BindingType.EntireArray,this.resolvedProperty=a):this.propertyName=s;this.getValue=this.GetterByBindingType[l],this.setValue=this.SetterByBindingTypeAndVersioning[l][c]}unbind(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}return n.Composite=mQ,n})();ln.prototype.BindingType={Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3},ln.prototype.Versioning={None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2},ln.prototype.GetterByBindingType=[ln.prototype._getValue_direct,ln.prototype._getValue_array,ln.prototype._getValue_arrayElement,ln.prototype._getValue_toArray],ln.prototype.SetterByBindingTypeAndVersioning=[[ln.prototype._setValue_direct,ln.prototype._setValue_direct_setNeedsUpdate,ln.prototype._setValue_direct_setMatrixWorldNeedsUpdate],[ln.prototype._setValue_array,ln.prototype._setValue_array_setNeedsUpdate,ln.prototype._setValue_array_setMatrixWorldNeedsUpdate],[ln.prototype._setValue_arrayElement,ln.prototype._setValue_arrayElement_setNeedsUpdate,ln.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate],[ln.prototype._setValue_fromArray,ln.prototype._setValue_fromArray_setNeedsUpdate,ln.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate]],new Float32Array(1);class Bk{constructor(e=1,t=0,i=0){return this.radius=e,this.phi=t,this.theta=i,this}set(e,t,i){return this.radius=e,this.phi=t,this.theta=i,this}copy(e){return this.radius=e.radius,this.phi=e.phi,this.theta=e.theta,this}makeSafe(){return this.phi=Math.max(1e-6,Math.min(Math.PI-1e-6,this.phi)),this}setFromVector3(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}setFromCartesianCoords(e,t,i){return this.radius=Math.sqrt(e*e+t*t+i*i),0===this.radius?(this.theta=0,this.phi=0):(this.theta=Math.atan2(e,i),this.phi=Math.acos(Tn(t/this.radius,-1,1))),this}clone(){return(new this.constructor).copy(this)}}typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:"146"}})),typeof window<"u"&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__="146");class Cg{constructor(e){for(;e>2*Math.PI;)e-=2*Math.PI;for(;e<0;)e+=2*Math.PI;this.angle=e}getNormalVector(){return new at(Math.cos(this.angle+Math.PI/2),Math.sin(this.angle+Math.PI/2)).normalized()}withTransformation(e){const t=this.getNormalVector(),r=new S(t.x,t.y,0).applyMatrix3(e),s=new at(r.x,r.y);return console.log(s.x),new Cg(Math.atan(s.y/s.x)+Math.PI/2)}}class Ad{constructor(e,t){for(this.angle=t;e>=2*Math.PI;)e-=2*Math.PI;for(;e<=0;)e+=2*Math.PI;Math.abs(e-2*Math.PI)<.1&&(e=0),this.startAngle=e}getStartBoundingVector(){return new at(Math.cos(this.startAngle),Math.sin(this.startAngle))}getTransformedWeylChamber(e){const i=new S(Math.cos(this.startAngle),Math.sin(this.startAngle),0).applyMatrix3(e);let r=Math.atan(i.y/i.x);i.x<0&&(r+=Math.PI);const o=new S(Math.cos(this.angle+this.startAngle),Math.sin(this.angle+this.startAngle),0).applyMatrix3(e);let a=Math.atan(o.y/o.x);return o.x<0&&(a+=Math.PI),console.log("Start",r),console.log("End",a),r<a?new Ad(r,a-r):new Ad(a,r-a)}}class dn{constructor(e){this.isSimple=!1,this.isPositive=!0,this.angle=e.angle,this.length=e.length,this.isSimple=e.isSimple,this.isPositive=null==e.isPositive||e.isPositive}equal(e){return e.getVector().equal(this.getVector())}getNegative(){return new dn({angle:this.angle+Math.PI,length:this.length,isSimple:!1,isPositive:!1})}getVector(){return new at(Math.cos(this.angle)*this.length,Math.sin(this.angle)*this.length)}getVectorUnderTransformation(e){const t=this.getVector(),r=new S(t.x,t.y,0).applyMatrix3(e);return new at(r.x,r.y)}get name(){let e=this.getVector();return`(${Math.round(e.x)} ${Math.round(e.y)})`}getHyperplane(){return new Cg(this.angle+Math.PI/2)}}class lc{constructor(e,t,i,r){this._positiveRoots=[],this.coxeterMatrix=[],this.type=e,this.coxeterMatrix=t,this._positiveRoots=i,this._minimumAngle=r}getAllRoots(){const e=[...this._positiveRoots];return this._positiveRoots.forEach(t=>{e.push(t.getNegative())}),e}getCoxeterMatrix(){return this.coxeterMatrix}getHyperplanes(){const e=[];for(let t of this._positiveRoots)e.push(new Cg(t.angle+Math.PI/2));return e.sort((t,i)=>t.angle<i.angle?-1:t.angle===i.angle?0:1),e}getPositiveRoots(){return this._positiveRoots}getAllWeylChambers(){const e=[],t=this.getHyperplanes();for(let i of t){const r=new Ad(i.angle,this._minimumAngle),s=new Ad(i.angle+Math.PI,this._minimumAngle);e.push(r),e.push(s)}return console.log(e),e.sort((i,r)=>i.startAngle<r.startAngle?-1:i.startAngle===r.startAngle?0:1),e}getFundamentalWeylChamber(){return this.getAllWeylChambers().filter(t=>this.getBase().every(s=>s.getVector().dot(t.getStartBoundingVector())>=-.01))[0]}getBase(){return this.getPositiveRoots().filter(e=>e.isSimple)}getLengthOfTransformation(e){let t=this.getPositiveRoots();return t.map(s=>s.getVectorUnderTransformation(e)).filter(s=>t.every(o=>!o.getVector().equal(s))).length}}var Oi=(()=>{return(n=Oi||(Oi={})).A1="A1",n.A1_A1="A1_A1",n.D2="D2",n.A2="A2",n.B2="B2",n.G2="G2",n.C2="C2",Oi;var n})();const MQ=new lc(Oi.A1,[1],[new dn({angle:0,length:1,isSimple:!0})],Math.PI),CQ=new lc(Oi.A1_A1,[1,2,2,1],[new dn({angle:0,length:1,isSimple:!0}),new dn({angle:Math.PI/2,length:1,isSimple:!0})],Math.PI/2),SQ=new lc(Oi.D2,[1,2,2,1],[new dn({angle:Math.PI/4,length:1,isSimple:!0}),new dn({angle:Math.PI/2+Math.PI/4,length:1,isSimple:!0})],Math.PI/2),Sg={A1:MQ,A1_A1:CQ,A2:new lc(Oi.A2,[1,3,3,1],[new dn({angle:Math.PI/2+Math.PI/6,length:1,isSimple:!0}),new dn({angle:Math.PI/2-Math.PI/3+Math.PI/6,length:1,isSimple:!1}),new dn({angle:Math.PI/2+Math.PI/3+Math.PI+Math.PI/6,length:1,isSimple:!0})],Math.PI/3),B2:new lc(Oi.B2,[1,4,4,1],[new dn({angle:0,length:1,isSimple:!0}),new dn({angle:Math.PI/4,length:Math.sqrt(2),isSimple:!1}),new dn({angle:Math.PI/2,length:1,isSimple:!1}),new dn({angle:3*Math.PI/4,length:Math.sqrt(2),isSimple:!0})],Math.PI/4),C2:new lc(Oi.C2,[1,4,4,1],[new dn({angle:0,length:1,isSimple:!0}),new dn({angle:Math.PI/4,length:1/Math.sqrt(2),isSimple:!1}),new dn({angle:Math.PI/2,length:1,isSimple:!1}),new dn({angle:3*Math.PI/4,length:1/Math.sqrt(2),isSimple:!0})],Math.PI/4),G2:new lc(Oi.G2,[1,6,6,1],[new dn({angle:0,length:1,isSimple:!0}),new dn({angle:Math.PI/6,length:Math.sqrt(3),isSimple:!1}),new dn({angle:2*Math.PI/6,length:1,isSimple:!1}),new dn({angle:Math.PI/2,length:Math.sqrt(3),isSimple:!1}),new dn({angle:Math.PI/6+Math.PI/2,length:1,isSimple:!1}),new dn({angle:2*Math.PI/6+Math.PI/2,length:Math.sqrt(3),isSimple:!0})],Math.PI/6),D2:SQ};class Id{constructor(e){this.points=[],this.points=e.points,this.color=e.color}}var Zn=(()=>{return(n=Zn||(Zn={}))[n.base=0]="base",n[n.positiveRoots=1]="positiveRoots",n[n.highlight=2]="highlight",Zn;var n})();const Ar={A1:[de.red],A1_A1:[de.red,de.blue],A2:[de.red,de.blue,de.yellow],D2:[de.red,de.blue],B2:[de.red,de.blue,de.yellow,de.green],G2:[de.red,de.orange,de.yellow,de.turqouis,de.green,de.blue],C2:[de.red,de.blue,de.yellow,de.green],A3:[de.red,de.orange,de.yellow,de.turqouis,de.green,de.blue],D3:[de.red,de.orange,de.yellow,de.turqouis,de.green,de.blue],C3:[de.redDark,de.red,de.orange,de.yellow,de.turqouis,de.green,de.greenDark,de.azul,de.purpleDark],B3:[de.redDark,de.red,de.orange,de.yellow,de.turqouis,de.green,de.greenDark,de.azul,de.purpleDark]};class Ss{constructor(){this.rootSystem=Sg.A2,this.repaintEvent=new ui}switchRootSystem(e){e.type!=this.rootSystem.type&&(this.rootSystem=e,this.repaintEvent.next())}getRoots(){return this.rootSystem.getAllRoots()}getPositiveRoots(){return this.rootSystem.getPositiveRoots()}getWeylChambers(){return this.rootSystem.getAllWeylChambers()}getFundamentalWeylChamber(){return this.rootSystem.getFundamentalWeylChamber()}getType(){return this.rootSystem.type}getBase(){return this.rootSystem.getBase()}static#e=this.\u0275fac=function(t){return new(t||Ss)};static#t=this.\u0275prov=Te({token:Ss,factory:Ss.\u0275fac,providedIn:"root"})}class Xo{constructor(){this.currentTranformation=(new Wn).identity(),this.appliedMirrorings=[],this.transformationChanged=new ui,this.objectsTransformationActsOn=["ROOTS","WEYL_CHAMBERS"]}transformationAppliedTo(e){return this.objectsTransformationActsOn.includes(e)}getCurrentTransformedObjects(){return this.objectsTransformationActsOn}addTransformedObjectType(e){this.objectsTransformationActsOn.push(e),this.transformationChanged.next()}removeTransformedObjectType(e){this.objectsTransformationActsOn=this.objectsTransformationActsOn.filter(t=>t!=e),this.transformationChanged.next()}resetTransformation(){this.appliedMirrorings=[],this.currentTranformation=(new Wn).identity(),this.transformationChanged.next()}mirrorOnPlaneOfRoot(e){this.appliedMirrorings.push(e);const i=e.getHyperplane().getNormalVector().normalized(),r=(new Wn).fromArray([1-2*i.x*i.x,-2*i.x*i.y,0,-2*i.x*i.y,1-2*i.y*i.y,0,0,0,1]);this.currentTranformation=r.multiply(this.currentTranformation),this.transformationChanged.next()}static#e=this.\u0275fac=function(t){return new(t||Xo)};static#t=this.\u0275prov=Te({token:Xo,factory:Xo.\u0275fac,providedIn:"root"})}class yu{constructor(e,t,i,r,s){this.canvas=e,this.rootSystem=t,this.coord=i,this.painter=r,this.transformService=s,this.paintLayer=Ut.default,this.colorMode=Zn.base,this.repaintEvent=new ui,this.highlightedRoots=[],this.highlightedHyperplanes=[],t.repaintEvent.subscribe(()=>{this.clearHyperplaneHighlight(),this.clearRootHighlight()})}paint(e){const t=this.rootSystem.getRoots();this.paintExtraGeometry();for(let i of t)this.paintRoot(i),i.isPositive&&this.paintHyperplane(i);null!=e&&(this.paintLayer=e)}switchColorMode(e){this.colorMode=e,this.repaintEvent.next()}highlightRoot(e){this.highlightedRoots.push(e),this.repaintEvent.next()}highlightHyperplaneToRoot(e){this.highlightedHyperplanes.push(e),this.repaintEvent.next()}rootIsHighlighted(e){return this.highlightedRoots.some(t=>t.equal(e))}removeHighlightFromRoot(e){this.highlightedRoots=this.highlightedRoots.filter(t=>!e.equal(t)),this.repaintEvent.next()}hyperplaneToRootHighlighted(e){return this.highlightedHyperplanes.some(t=>t.equal(e))}removeHighlightOfHyperplaneToRoot(e){this.highlightedHyperplanes=this.highlightedHyperplanes.filter(t=>!e.equal(t)),this.repaintEvent.next()}allRootsHighlighted(){return this.highlightedRoots.length==this.rootSystem.getPositiveRoots().length}allHyperplanesHighlighted(){return this.highlightedHyperplanes.length==this.rootSystem.getPositiveRoots().length}clearRootHighlight(){this.highlightedRoots=[],this.repaintEvent.next()}clearHyperplaneHighlight(){this.highlightedHyperplanes=[],this.repaintEvent.next()}highlightAllRoots(){this.highlightedRoots=this.rootSystem.getPositiveRoots(),this.repaintEvent.next()}highlightAllHyperplanes(){this.highlightedHyperplanes=this.rootSystem.getPositiveRoots(),this.repaintEvent.next()}paintExtraGeometry(){switch(this.rootSystem.getType()){case Oi.A2:this.paintTriangle();break;case Oi.B2:case Oi.C2:this.paintSquare();break;case Oi.G2:this.paintHexagon()}}paintVectorEnd(e,t){this.painter.paintCircle(new sR({center:e,color:t,radius:16}),Ut.layer4)}paintVectorLine(e,t){const i=new Tl({start:e,end:t,color:"#ffffff",width:7});this.painter.paintLine(i,Ut.layer3)}paintRoot(e){const t=e.getVector();let i=de.white;if(this.paintVectorLine(new at(0,0),t),this.colorMode==Zn.base)i=e.isSimple?de.brightRed:de.brightGreen;else if(this.colorMode==Zn.positiveRoots)i=e.isPositive?de.brightRed:de.brightGreen;else if(this.rootIsHighlighted(e)||this.rootIsHighlighted(e.getNegative())){const r=this.rootSystem.getPositiveRoots().findIndex(s=>s.equal(e)||s.equal(e.getNegative()));i=Ar[this.rootSystem.getType()][r]}if(this.transformService.transformationAppliedTo("ROOTS")){const r=e.getVectorUnderTransformation(this.transformService.currentTranformation);this.paintVectorEnd(r,i)}else this.paintVectorEnd(e.getVector(),i)}paintHyperplane(e){let t=de.white;if(this.hyperplaneToRootHighlighted(e)||this.hyperplaneToRootHighlighted(e.getNegative())){const c=this.rootSystem.getPositiveRoots().findIndex(l=>l.equal(e)||l.equal(e.getNegative()));t=Ar[this.rootSystem.getType()][c]}let i=e.getHyperplane();this.transformService.transformationAppliedTo("HYPERPLANES")&&(i=e.getHyperplane().withTransformation(this.transformService.currentTranformation));const s=i.angle/(2*Math.PI)*360,o=this.coord.getCrossLength()/2,a=new Tl({start:new at(-o,0),end:new at(o,0),color:t,width:2,dashed:!0,dashString:"12 12"});this.painter.paintLine(a,Ut.layer3).transform({rotate:-s})}paintTriangle(){let e=new Id({points:[new at(Math.cos(Math.PI/3+Math.PI/6),Math.sin(Math.PI/3+Math.PI/6)),new at(Math.cos(Math.PI+Math.PI/6),Math.sin(Math.PI+Math.PI/6)),new at(Math.cos(2*Math.PI-Math.PI/3+Math.PI/6),Math.sin(2*Math.PI-Math.PI/3+Math.PI/6))],color:"#9999CC"});this.painter.paintPolygon(e,Ut.layer3).opacity(.5)}paintSquare(){let e=new Id({points:[new at(.5,.5),new at(-.5,.5),new at(-.5,-.5),new at(.5,-.5)],color:"#9999CC"});this.painter.paintPolygon(e,Ut.layer3).opacity(.5).transform({rotate:45})}paintHexagon(){let e=new Id({points:[new at(.8,0),new at(.8*Math.cos(Math.PI/3),.8*Math.sin(Math.PI/3)),new at(.8*Math.cos(2*Math.PI/3),.8*Math.sin(2*Math.PI/3)),new at(.8*Math.cos(3*Math.PI/3),.8*Math.sin(3*Math.PI/3)),new at(.8*Math.cos(4*Math.PI/3),.8*Math.sin(4*Math.PI/3)),new at(.8*Math.cos(5*Math.PI/3),.8*Math.sin(5*Math.PI/3))],color:"#9999CC"});this.painter.paintPolygon(e,Ut.layer3).opacity(.5).transform({rotate:30})}static#e=this.\u0275fac=function(t){return new(t||yu)(le(Ks),le(Ss),le(Oo),le(Fa),le(Xo))};static#t=this.\u0275prov=Te({token:yu,factory:yu.\u0275fac,providedIn:"root"})}class Pd{constructor(e,t,i,r){this.rootSystemService=e,this.painter=t,this.coord=i,this.transformService=r,this.paintLayer=Ut.default}paint(e){let t=this.rootSystemService.getFundamentalWeylChamber();this.transformService.transformationAppliedTo("WEYL_CHAMBERS")&&(t=t.getTransformedWeylChamber(this.transformService.currentTranformation)),this.weylChamber=this.paintWeylChamber(t),this.paintLayer=e??Ut.default}paintWeylChamber(e){let t=this.coord.getCrossLength();const i=new at(Math.cos(e.startAngle)*t,Math.sin(e.startAngle)*t),r=new at(Math.cos(e.startAngle+e.angle)*t,Math.sin(e.startAngle+e.angle)*t);if(Math.abs(e.angle-Math.PI)<.01){const s=new at(i.y,-i.x);s.x+=i.x,s.y+=i.y;const o=new at(-r.y,-r.x);o.x+=r.x,o.y+=r.y;const a=this.painter.paintPolygon(new Id({points:[i,s,o,r],color:de.purple300}),this.paintLayer);return a.opacity(.4),a}{const s=this.painter.paintPolygon(new Id({points:[r,new at(0,0),i],color:de.purple300}),this.paintLayer);return s.opacity(.4),s}}transformWeylChamber(e){this.transformation=e;const t=e.rotate/(2*Math.PI)*360,i=this.coord.getCenterPoint();this.weylChamber.animate(250).transform({rotate:t,flip:"none"!==this.transformation.flip&&this.transformation.flip,originX:i.x,originY:i.y})}static#e=this.\u0275fac=function(t){return new(t||Pd)(le(Ss),le(Fa),le(Oo),le(Xo))};static#t=this.\u0275prov=Te({token:Pd,factory:Pd.\u0275fac,providedIn:"root"})}class Eg{constructor(e,t,i){this.rootSystemService=e,this.activatedRoute=t,this.router=i,this.RootSystems=Oi,this.activatedRoute.params.subscribe(r=>{console.log("Change!");let s=decodeURI(r.root_system||"");null!=Sg[s]&&this.rootSystemService.switchRootSystem(Sg[s])})}ngOnInit(){}switchToRootSystem(e){this.rootSystemService.switchRootSystem(Sg[e]),this.router.navigate(["/2D",{root_system:e}])}getSelectedRootSystem(){return this.rootSystemService.getType()}static#e=this.\u0275fac=function(t){return new(t||Eg)(j(Ss),j(_s),j(Ln))};static#t=this.\u0275cmp=ii({type:Eg,selectors:[["app-switch-root-system-panel"]],decls:31,vars:14,consts:[["id","switch-panel-container"],["id","switch-panel"],["id","root-systems-container"],[1,"root-system-item",3,"click"],["src","assets/A1.svg",1,"root-system-image"],[1,"root-system-title"],["src","assets/A1_A1.svg",1,"root-system-image"],["src","assets/D2.svg",1,"root-system-image"],["src","assets/A2.svg",1,"root-system-image"],["src","assets/G2.svg",1,"root-system-image"],["src","assets/C2.svg",1,"root-system-image"],["src","assets/B2.svg",1,"root-system-image"]],template:function(t,i){1&t&&(W(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3),Oe("click",function(){return i.switchToRootSystem(i.RootSystems.A1)}),it(4,"img",4),W(5,"small",5),Ce(6,"A1"),Y()(),W(7,"div",3),Oe("click",function(){return i.switchToRootSystem(i.RootSystems.A1_A1)}),it(8,"img",6),W(9,"small",5),Ce(10,"A1 \u2715 A1"),Y()(),W(11,"div",3),Oe("click",function(){return i.switchToRootSystem(i.RootSystems.D2)}),it(12,"img",7),W(13,"small",5),Ce(14,"D2"),Y()(),W(15,"div",3),Oe("click",function(){return i.switchToRootSystem(i.RootSystems.A2)}),it(16,"img",8),W(17,"small",5),Ce(18,"A2"),Y()(),W(19,"div",3),Oe("click",function(){return i.switchToRootSystem(i.RootSystems.G2)}),it(20,"img",9),W(21,"small",5),Ce(22,"G2"),Y()(),W(23,"div",3),Oe("click",function(){return i.switchToRootSystem(i.RootSystems.C2)}),it(24,"img",10),W(25,"small",5),Ce(26,"C2"),Y()(),W(27,"div",3),Oe("click",function(){return i.switchToRootSystem(i.RootSystems.B2)}),it(28,"img",11),W(29,"small",5),Ce(30,"B2"),Y()()()()()),2&t&&(ge(3),yn("selected","A1"==i.getSelectedRootSystem()),ge(4),yn("selected","A1_A1"==i.getSelectedRootSystem()),ge(4),yn("selected","D2"==i.getSelectedRootSystem()),ge(4),yn("selected","A2"==i.getSelectedRootSystem()),ge(4),yn("selected","G2"==i.getSelectedRootSystem()),ge(4),yn("selected","C2"==i.getSelectedRootSystem()),ge(4),yn("selected","B2"==i.getSelectedRootSystem()))},styles:["#switch-panel-container[_ngcontent-%COMP%]{left:0;top:0;width:100%;display:grid;justify-content:center;padding-top:8px;position:absolute}#switch-panel-container[_ngcontent-%COMP%]   #switch-panel[_ngcontent-%COMP%]{left:160px;top:8px;padding:12px;box-sizing:border-box;height:max-content;background-color:#fff;border-radius:8px;shadow:var(--light-shadow);display:grid;align-content:flex-start;justify-content:center}#switch-panel-container[_ngcontent-%COMP%]   #switch-panel[_ngcontent-%COMP%]   #root-systems-container[_ngcontent-%COMP%]{display:grid;grid-template-rows:1fr;grid-auto-flow:column;grid-gap:8px}#switch-panel-container[_ngcontent-%COMP%]   #switch-panel[_ngcontent-%COMP%]   #root-systems-container[_ngcontent-%COMP%]   .root-system-item[_ngcontent-%COMP%]{padding:15px;border:var(--border-thin);border-radius:4px;display:grid;justify-content:center;align-content:center;align-items:center;transition:.15s all ease-in-out;cursor:pointer;position:relative;height:72px;box-sizing:border-box}#switch-panel-container[_ngcontent-%COMP%]   #switch-panel[_ngcontent-%COMP%]   #root-systems-container[_ngcontent-%COMP%]   .root-system-item.selected[_ngcontent-%COMP%], #switch-panel-container[_ngcontent-%COMP%]   #switch-panel[_ngcontent-%COMP%]   #root-systems-container[_ngcontent-%COMP%]   .root-system-item[_ngcontent-%COMP%]:hover{background-color:var(--purple-light)}#switch-panel-container[_ngcontent-%COMP%]   #switch-panel[_ngcontent-%COMP%]   #root-systems-container[_ngcontent-%COMP%]   .root-system-item[_ngcontent-%COMP%]   .root-system-image[_ngcontent-%COMP%]{position:relative;top:-6px;width:40px}#switch-panel-container[_ngcontent-%COMP%]   #switch-panel[_ngcontent-%COMP%]   #root-systems-container[_ngcontent-%COMP%]   .root-system-item[_ngcontent-%COMP%]   .root-system-title[_ngcontent-%COMP%]{font-size:11px;font-weight:600;position:absolute;bottom:4px;color:var(--text-light);text-align:center;width:100%}"]})}class Yk{}class IQ{}const uo="*";function Dg(n,e){return{type:7,name:n,definitions:e,options:{}}}function Tg(n,e=null){return{type:4,styles:e,timings:n}}function Zk(n,e=null){return{type:2,steps:n,options:e}}function Ir(n){return{type:6,styles:n,offset:null}}function Es(n,e,t){return{type:0,name:n,styles:e,options:t}}function Ag(n,e,t=null){return{type:1,expr:n,animation:e,options:t}}function Kk(n){Promise.resolve().then(n)}class Rd{constructor(e=0,t=0){this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._originalOnDoneFns=[],this._originalOnStartFns=[],this._started=!1,this._destroyed=!1,this._finished=!1,this._position=0,this.parentPlayer=null,this.totalTime=e+t}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(e=>e()),this._onDoneFns=[])}onStart(e){this._originalOnStartFns.push(e),this._onStartFns.push(e)}onDone(e){this._originalOnDoneFns.push(e),this._onDoneFns.push(e)}onDestroy(e){this._onDestroyFns.push(e)}hasStarted(){return this._started}init(){}play(){this.hasStarted()||(this._onStart(),this.triggerMicrotask()),this._started=!0}triggerMicrotask(){Kk(()=>this._onFinish())}_onStart(){this._onStartFns.forEach(e=>e()),this._onStartFns=[]}pause(){}restart(){}finish(){this._onFinish()}destroy(){this._destroyed||(this._destroyed=!0,this.hasStarted()||this._onStart(),this.finish(),this._onDestroyFns.forEach(e=>e()),this._onDestroyFns=[])}reset(){this._started=!1,this._finished=!1,this._onStartFns=this._originalOnStartFns,this._onDoneFns=this._originalOnDoneFns}setPosition(e){this._position=this.totalTime?e*this.totalTime:1}getPosition(){return this.totalTime?this._position/this.totalTime:1}triggerCallback(e){const t="start"==e?this._onStartFns:this._onDoneFns;t.forEach(i=>i()),t.length=0}}class Jk{constructor(e){this._onDoneFns=[],this._onStartFns=[],this._finished=!1,this._started=!1,this._destroyed=!1,this._onDestroyFns=[],this.parentPlayer=null,this.totalTime=0,this.players=e;let t=0,i=0,r=0;const s=this.players.length;0==s?Kk(()=>this._onFinish()):this.players.forEach(o=>{o.onDone(()=>{++t==s&&this._onFinish()}),o.onDestroy(()=>{++i==s&&this._onDestroy()}),o.onStart(()=>{++r==s&&this._onStart()})}),this.totalTime=this.players.reduce((o,a)=>Math.max(o,a.totalTime),0)}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(e=>e()),this._onDoneFns=[])}init(){this.players.forEach(e=>e.init())}onStart(e){this._onStartFns.push(e)}_onStart(){this.hasStarted()||(this._started=!0,this._onStartFns.forEach(e=>e()),this._onStartFns=[])}onDone(e){this._onDoneFns.push(e)}onDestroy(e){this._onDestroyFns.push(e)}hasStarted(){return this._started}play(){this.parentPlayer||this.init(),this._onStart(),this.players.forEach(e=>e.play())}pause(){this.players.forEach(e=>e.pause())}restart(){this.players.forEach(e=>e.restart())}finish(){this._onFinish(),this.players.forEach(e=>e.finish())}destroy(){this._onDestroy()}_onDestroy(){this._destroyed||(this._destroyed=!0,this._onFinish(),this.players.forEach(e=>e.destroy()),this._onDestroyFns.forEach(e=>e()),this._onDestroyFns=[])}reset(){this.players.forEach(e=>e.reset()),this._destroyed=!1,this._finished=!1,this._started=!1}setPosition(e){const t=e*this.totalTime;this.players.forEach(i=>{const r=i.totalTime?Math.min(1,t/i.totalTime):1;i.setPosition(r)})}getPosition(){const e=this.players.reduce((t,i)=>null===t||i.totalTime>t.totalTime?i:t,null);return null!=e?e.getPosition():0}beforeDestroy(){this.players.forEach(e=>{e.beforeDestroy&&e.beforeDestroy()})}triggerCallback(e){const t="start"==e?this._onStartFns:this._onDoneFns;t.forEach(i=>i()),t.length=0}}const is=new xe("NgValueAccessor");let sM;try{sM=typeof Intl<"u"&&Intl.v8BreakIterator}catch{sM=!1}let Fd,oM=(()=>{class n{constructor(t){this._platformId=t,this.isBrowser=this._platformId?function wG(n){return n===TA}(this._platformId):"object"==typeof document&&!!document,this.EDGE=this.isBrowser&&/(edge)/i.test(navigator.userAgent),this.TRIDENT=this.isBrowser&&/(msie|trident)/i.test(navigator.userAgent),this.BLINK=this.isBrowser&&!(!window.chrome&&!sM)&&typeof CSS<"u"&&!this.EDGE&&!this.TRIDENT,this.WEBKIT=this.isBrowser&&/AppleWebKit/i.test(navigator.userAgent)&&!this.BLINK&&!this.EDGE&&!this.TRIDENT,this.IOS=this.isBrowser&&/iPad|iPhone|iPod/.test(navigator.userAgent)&&!("MSStream"in window),this.FIREFOX=this.isBrowser&&/(firefox|minefield)/i.test(navigator.userAgent),this.ANDROID=this.isBrowser&&/android/i.test(navigator.userAgent)&&!this.TRIDENT,this.SAFARI=this.isBrowser&&/safari/i.test(navigator.userAgent)&&this.WEBKIT}}return n.\u0275fac=function(t){return new(t||n)(le(s0))},n.\u0275prov=Te({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();function aM(n){return function Pee(){if(null==Fd&&typeof window<"u")try{window.addEventListener("test",null,Object.defineProperty({},"passive",{get:()=>Fd=!0}))}finally{Fd=Fd||!1}return Fd}()?n:!!n.capture}function fc(n){return null!=n&&"false"!=`${n}`}function oN(n){return Array.isArray(n)?n:[n]}function aN(n){return n instanceof oi?n.nativeElement:n}class Hee extends Ni{constructor(e,t){super()}schedule(e,t=0){return this}}const zg={setInterval(n,e,...t){const{delegate:i}=zg;return i?.setInterval?i.setInterval(n,e,...t):setInterval(n,e,...t)},clearInterval(n){const{delegate:e}=zg;return(e?.clearInterval||clearInterval)(n)},delegate:void 0},cN={now:()=>(cN.delegate||Date).now(),delegate:void 0};class Vd{constructor(e,t=Vd.now){this.schedulerActionCtor=e,this.now=t}schedule(e,t=0,i){return new this.schedulerActionCtor(this,e).schedule(i,t)}}Vd.now=cN.now;const Wee=new class jee extends Vd{constructor(e,t=Vd.now){super(e,t),this.actions=[],this._active=!1}flush(e){const{actions:t}=this;if(this._active)return void t.push(e);let i;this._active=!0;do{if(i=e.execute(e.state,e.delay))break}while(e=t.shift());if(this._active=!1,i){for(;e=t.shift();)e.unsubscribe();throw i}}}(class Gee extends Hee{constructor(e,t){super(e,t),this.scheduler=e,this.work=t,this.pending=!1}schedule(e,t=0){var i;if(this.closed)return this;this.state=e;const r=this.id,s=this.scheduler;return null!=r&&(this.id=this.recycleAsyncId(s,r,t)),this.pending=!0,this.delay=t,this.id=null!==(i=this.id)&&void 0!==i?i:this.requestAsyncId(s,this.id,t),this}requestAsyncId(e,t,i=0){return zg.setInterval(e.flush.bind(e,this),i)}recycleAsyncId(e,t,i=0){if(null!=i&&this.delay===i&&!1===this.pending)return t;null!=t&&zg.clearInterval(t)}execute(e,t){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;const i=this._execute(e,t);if(i)return i;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(e,t){let r,i=!1;try{this.work(e)}catch(s){i=!0,r=s||new Error("Scheduled action threw falsy error")}if(i)return this.unsubscribe(),r}unsubscribe(){if(!this.closed){const{id:e,scheduler:t}=this,{actions:i}=t;this.work=this.state=this.scheduler=null,this.pending=!1,xc(i,this),null!=e&&(this.id=this.recycleAsyncId(t,e,null)),this.delay=null,super.unsubscribe()}}});function qee(n){return In((e,t)=>{pr(n).subscribe(Cn(t,()=>t.complete(),C_)),!t.closed&&e.subscribe(t)})}const lN=new Set;let xu,Xee=(()=>{class n{constructor(t){this._platform=t,this._matchMedia=this._platform.isBrowser&&window.matchMedia?window.matchMedia.bind(window):Zee}matchMedia(t){return(this._platform.WEBKIT||this._platform.BLINK)&&function Yee(n){if(!lN.has(n))try{xu||(xu=document.createElement("style"),xu.setAttribute("type","text/css"),document.head.appendChild(xu)),xu.sheet&&(xu.sheet.insertRule(`@media ${n} {body{ }}`,0),lN.add(n))}catch(e){console.error(e)}}(t),this._matchMedia(t)}}return n.\u0275fac=function(t){return new(t||n)(le(oM))},n.\u0275prov=Te({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();function Zee(n){return{matches:"all"===n||""===n,media:n,addListener:()=>{},removeListener:()=>{}}}let Kee=(()=>{class n{constructor(t,i){this._mediaMatcher=t,this._zone=i,this._queries=new Map,this._destroySubject=new ui}ngOnDestroy(){this._destroySubject.next(),this._destroySubject.complete()}isMatched(t){return uN(oN(t)).some(r=>this._registerQuery(r).mql.matches)}observe(t){let s=W0(uN(oN(t)).map(o=>this._registerQuery(o).observable));return s=Pp(s.pipe(Da(1)),s.pipe(function zee(n){return ms((e,t)=>n<=t)}(1),function $ee(n,e=Wee){return In((t,i)=>{let r=null,s=null,o=null;const a=()=>{if(r){r.unsubscribe(),r=null;const l=s;s=null,i.next(l)}};function c(){const l=o+n,u=e.now();if(u<l)return r=this.schedule(void 0,l-u),void i.add(r);a()}t.subscribe(Cn(i,l=>{s=l,o=e.now(),r||(r=e.schedule(c,n),i.add(r))},()=>{a(),i.complete()},void 0,()=>{s=r=null}))})}(0))),s.pipe(tt(o=>{const a={matches:!1,breakpoints:{}};return o.forEach(({matches:c,query:l})=>{a.matches=a.matches||c,a.breakpoints[l]=c}),a}))}_registerQuery(t){if(this._queries.has(t))return this._queries.get(t);const i=this._mediaMatcher.matchMedia(t),s={observable:new Mn(o=>{const a=c=>this._zone.run(()=>o.next(c));return i.addListener(a),()=>{i.removeListener(a)}}).pipe(aI(i),tt(({matches:o})=>({query:t,matches:o})),qee(this._destroySubject)),mql:i};return this._queries.set(t,s),s}}return n.\u0275fac=function(t){return new(t||n)(le(Xee),le(on))},n.\u0275prov=Te({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();function uN(n){return n.map(e=>e.split(",")).reduce((e,t)=>e.concat(t)).map(e=>e.trim())}const pN="cdk-high-contrast-black-on-white",mN="cdk-high-contrast-white-on-black",lM="cdk-high-contrast-active";let cte=(()=>{class n{constructor(t,i){this._platform=t,this._document=i,this._breakpointSubscription=Ot(Kee).observe("(forced-colors: active)").subscribe(()=>{this._hasCheckedHighContrastMode&&(this._hasCheckedHighContrastMode=!1,this._applyBodyHighContrastModeCssClasses())})}getHighContrastMode(){if(!this._platform.isBrowser)return 0;const t=this._document.createElement("div");t.style.backgroundColor="rgb(1,2,3)",t.style.position="absolute",this._document.body.appendChild(t);const i=this._document.defaultView||window,r=i&&i.getComputedStyle?i.getComputedStyle(t):null,s=(r&&r.backgroundColor||"").replace(/ /g,"");switch(t.remove(),s){case"rgb(0,0,0)":case"rgb(45,50,54)":case"rgb(32,32,32)":return 2;case"rgb(255,255,255)":case"rgb(255,250,239)":return 1}return 0}ngOnDestroy(){this._breakpointSubscription.unsubscribe()}_applyBodyHighContrastModeCssClasses(){if(!this._hasCheckedHighContrastMode&&this._platform.isBrowser&&this._document.body){const t=this._document.body.classList;t.remove(lM,pN,mN),this._hasCheckedHighContrastMode=!0;const i=this.getHighContrastMode();1===i?t.add(lM,pN):2===i&&t.add(lM,mN)}}}return n.\u0275fac=function(t){return new(t||n)(le(oM),le(hn))},n.\u0275prov=Te({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),gN=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=bi({type:n}),n.\u0275inj=hi({}),n})();const dte=new xe("mat-sanity-checks",{providedIn:"root",factory:function hte(){return!0}});let wu=(()=>{class n{constructor(t,i,r){this._sanityChecks=i,this._document=r,this._hasDoneGlobalChecks=!1,t._applyBodyHighContrastModeCssClasses(),this._hasDoneGlobalChecks||(this._hasDoneGlobalChecks=!0)}_checkIsEnabled(t){return!function Oee(){return typeof __karma__<"u"&&!!__karma__||typeof jasmine<"u"&&!!jasmine||typeof jest<"u"&&!!jest||typeof Mocha<"u"&&!!Mocha}()&&("boolean"==typeof this._sanityChecks?this._sanityChecks:!!this._sanityChecks[t])}}return n.\u0275fac=function(t){return new(t||n)(le(cte),le(dte,8),le(hn))},n.\u0275mod=bi({type:n}),n.\u0275inj=hi({imports:[gN,gN]}),n})();function fte(n){return class extends n{constructor(...e){super(...e),this._disabled=!1}get disabled(){return this._disabled}set disabled(e){this._disabled=fc(e)}}}function vN(n,e){return class extends n{constructor(...t){super(...t),this.defaultColor=e,this.color=e}get color(){return this._color}set color(t){const i=t||this.defaultColor;i!==this._color&&(this._color&&this._elementRef.nativeElement.classList.remove(`mat-${this._color}`),i&&this._elementRef.nativeElement.classList.add(`mat-${i}`),this._color=i)}}}function pte(n){return class extends n{constructor(...e){super(...e),this._disableRipple=!1}get disableRipple(){return this._disableRipple}set disableRipple(e){this._disableRipple=fc(e)}}}function mte(n,e=0){return class extends n{constructor(...t){super(...t),this._tabIndex=e,this.defaultTabIndex=e}get tabIndex(){return this.disabled?-1:this._tabIndex}set tabIndex(t){this._tabIndex=null!=t?function Bee(n,e=0){return function Uee(n){return!isNaN(parseFloat(n))&&!isNaN(Number(n))}(n)?Number(n):e}(t):this.defaultTabIndex}}}class _te{constructor(e,t,i,r=!1){this._renderer=e,this.element=t,this.config=i,this._animationForciblyDisabledThroughCss=r,this.state=3}fadeOut(){this._renderer.fadeOutRipple(this)}}const bN={enterDuration:225,exitDuration:150},uM=aM({passive:!0}),xN=["mousedown","touchstart"],wN=["mouseup","mouseleave","touchend","touchcancel"];class vte{constructor(e,t,i,r){this._target=e,this._ngZone=t,this._isPointerDown=!1,this._activeRipples=new Map,this._pointerUpEventsRegistered=!1,r.isBrowser&&(this._containerElement=aN(i))}fadeInRipple(e,t,i={}){const r=this._containerRect=this._containerRect||this._containerElement.getBoundingClientRect(),s={...bN,...i.animation};i.centered&&(e=r.left+r.width/2,t=r.top+r.height/2);const o=i.radius||function bte(n,e,t){const i=Math.max(Math.abs(n-t.left),Math.abs(n-t.right)),r=Math.max(Math.abs(e-t.top),Math.abs(e-t.bottom));return Math.sqrt(i*i+r*r)}(e,t,r),a=e-r.left,c=t-r.top,l=s.enterDuration,u=document.createElement("div");u.classList.add("mat-ripple-element"),u.style.left=a-o+"px",u.style.top=c-o+"px",u.style.height=2*o+"px",u.style.width=2*o+"px",null!=i.color&&(u.style.backgroundColor=i.color),u.style.transitionDuration=`${l}ms`,this._containerElement.appendChild(u);const h=window.getComputedStyle(u),f=h.transitionDuration,p="none"===h.transitionProperty||"0s"===f||"0s, 0s"===f,m=new _te(this,u,i,p);u.style.transform="scale3d(1, 1, 1)",m.state=0,i.persistent||(this._mostRecentTransientRipple=m);let g=null;return!p&&(l||s.exitDuration)&&this._ngZone.runOutsideAngular(()=>{const _=()=>this._finishRippleTransition(m),b=()=>this._destroyRipple(m);u.addEventListener("transitionend",_),u.addEventListener("transitioncancel",b),g={onTransitionEnd:_,onTransitionCancel:b}}),this._activeRipples.set(m,g),(p||!l)&&this._finishRippleTransition(m),m}fadeOutRipple(e){if(2===e.state||3===e.state)return;const t=e.element,i={...bN,...e.config.animation};t.style.transitionDuration=`${i.exitDuration}ms`,t.style.opacity="0",e.state=2,(e._animationForciblyDisabledThroughCss||!i.exitDuration)&&this._finishRippleTransition(e)}fadeOutAll(){this._getActiveRipples().forEach(e=>e.fadeOut())}fadeOutAllNonPersistent(){this._getActiveRipples().forEach(e=>{e.config.persistent||e.fadeOut()})}setupTriggerEvents(e){const t=aN(e);!t||t===this._triggerElement||(this._removeTriggerEvents(),this._triggerElement=t,this._registerEvents(xN))}handleEvent(e){"mousedown"===e.type?this._onMousedown(e):"touchstart"===e.type?this._onTouchStart(e):this._onPointerUp(),this._pointerUpEventsRegistered||(this._registerEvents(wN),this._pointerUpEventsRegistered=!0)}_finishRippleTransition(e){0===e.state?this._startFadeOutTransition(e):2===e.state&&this._destroyRipple(e)}_startFadeOutTransition(e){const t=e===this._mostRecentTransientRipple,{persistent:i}=e.config;e.state=1,!i&&(!t||!this._isPointerDown)&&e.fadeOut()}_destroyRipple(e){const t=this._activeRipples.get(e)??null;this._activeRipples.delete(e),this._activeRipples.size||(this._containerRect=null),e===this._mostRecentTransientRipple&&(this._mostRecentTransientRipple=null),e.state=3,null!==t&&(e.element.removeEventListener("transitionend",t.onTransitionEnd),e.element.removeEventListener("transitioncancel",t.onTransitionCancel)),e.element.remove()}_onMousedown(e){const t=function ste(n){return 0===n.buttons||0===n.offsetX&&0===n.offsetY}(e),i=this._lastTouchStartEvent&&Date.now()<this._lastTouchStartEvent+800;!this._target.rippleDisabled&&!t&&!i&&(this._isPointerDown=!0,this.fadeInRipple(e.clientX,e.clientY,this._target.rippleConfig))}_onTouchStart(e){if(!this._target.rippleDisabled&&!function ote(n){const e=n.touches&&n.touches[0]||n.changedTouches&&n.changedTouches[0];return!(!e||-1!==e.identifier||null!=e.radiusX&&1!==e.radiusX||null!=e.radiusY&&1!==e.radiusY)}(e)){this._lastTouchStartEvent=Date.now(),this._isPointerDown=!0;const t=e.changedTouches;for(let i=0;i<t.length;i++)this.fadeInRipple(t[i].clientX,t[i].clientY,this._target.rippleConfig)}}_onPointerUp(){!this._isPointerDown||(this._isPointerDown=!1,this._getActiveRipples().forEach(e=>{!e.config.persistent&&(1===e.state||e.config.terminateOnPointerUp&&0===e.state)&&e.fadeOut()}))}_registerEvents(e){this._ngZone.runOutsideAngular(()=>{e.forEach(t=>{this._triggerElement.addEventListener(t,this,uM)})})}_getActiveRipples(){return Array.from(this._activeRipples.keys())}_removeTriggerEvents(){this._triggerElement&&(xN.forEach(e=>{this._triggerElement.removeEventListener(e,this,uM)}),this._pointerUpEventsRegistered&&wN.forEach(e=>{this._triggerElement.removeEventListener(e,this,uM)}))}}const xte=new xe("mat-ripple-global-options");let MN=(()=>{class n{constructor(t,i,r,s,o){this._elementRef=t,this._animationMode=o,this.radius=0,this._disabled=!1,this._isInitialized=!1,this._globalOptions=s||{},this._rippleRenderer=new vte(this,i,t,r)}get disabled(){return this._disabled}set disabled(t){t&&this.fadeOutAllNonPersistent(),this._disabled=t,this._setupTriggerEventsIfEnabled()}get trigger(){return this._trigger||this._elementRef.nativeElement}set trigger(t){this._trigger=t,this._setupTriggerEventsIfEnabled()}ngOnInit(){this._isInitialized=!0,this._setupTriggerEventsIfEnabled()}ngOnDestroy(){this._rippleRenderer._removeTriggerEvents()}fadeOutAll(){this._rippleRenderer.fadeOutAll()}fadeOutAllNonPersistent(){this._rippleRenderer.fadeOutAllNonPersistent()}get rippleConfig(){return{centered:this.centered,radius:this.radius,color:this.color,animation:{...this._globalOptions.animation,..."NoopAnimations"===this._animationMode?{enterDuration:0,exitDuration:0}:{},...this.animation},terminateOnPointerUp:this._globalOptions.terminateOnPointerUp}}get rippleDisabled(){return this.disabled||!!this._globalOptions.disabled}_setupTriggerEventsIfEnabled(){!this.disabled&&this._isInitialized&&this._rippleRenderer.setupTriggerEvents(this.trigger)}launch(t,i=0,r){return"number"==typeof t?this._rippleRenderer.fadeInRipple(t,i,{...this.rippleConfig,...r}):this._rippleRenderer.fadeInRipple(0,0,{...this.rippleConfig,...t})}}return n.\u0275fac=function(t){return new(t||n)(j(oi),j(on),j(oM),j(xte,8),j(cp,8))},n.\u0275dir=Ke({type:n,selectors:[["","mat-ripple",""],["","matRipple",""]],hostAttrs:[1,"mat-ripple"],hostVars:2,hostBindings:function(t,i){2&t&&yn("mat-ripple-unbounded",i.unbounded)},inputs:{color:["matRippleColor","color"],unbounded:["matRippleUnbounded","unbounded"],centered:["matRippleCentered","centered"],radius:["matRippleRadius","radius"],animation:["matRippleAnimation","animation"],disabled:["matRippleDisabled","disabled"],trigger:["matRippleTrigger","trigger"]},exportAs:["matRipple"]}),n})(),wte=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=bi({type:n}),n.\u0275inj=hi({imports:[wu,wu]}),n})();const Mte=["input"],Cte=["label"],Ste=["*"],Ete=new xe("mat-checkbox-default-options",{providedIn:"root",factory:CN});function CN(){return{color:"accent",clickAction:"check-indeterminate"}}const Dte={provide:is,useExisting:$t(()=>Ud),multi:!0};class Tte{}let Ate=0;const SN=CN(),Ite=mte(vN(pte(fte(class{constructor(n){this._elementRef=n}}))));let Pte=(()=>{class n extends Ite{constructor(t,i,r,s,o,a,c){super(i),this._changeDetectorRef=r,this._ngZone=s,this._animationMode=a,this._options=c,this.ariaLabel="",this.ariaLabelledby=null,this.labelPosition="after",this.name=null,this.change=new sn,this.indeterminateChange=new sn,this._onTouched=()=>{},this._currentAnimationClass="",this._currentCheckState=0,this._controlValueAccessorChangeFn=()=>{},this._checked=!1,this._disabled=!1,this._indeterminate=!1,this._options=this._options||SN,this.color=this.defaultColor=this._options.color||SN.color,this.tabIndex=parseInt(o)||0,this.id=this._uniqueId=`${t}${++Ate}`}get inputId(){return`${this.id||this._uniqueId}-input`}get required(){return this._required}set required(t){this._required=fc(t)}ngAfterViewInit(){this._syncIndeterminate(this._indeterminate)}get checked(){return this._checked}set checked(t){const i=fc(t);i!=this.checked&&(this._checked=i,this._changeDetectorRef.markForCheck())}get disabled(){return this._disabled}set disabled(t){const i=fc(t);i!==this.disabled&&(this._disabled=i,this._changeDetectorRef.markForCheck())}get indeterminate(){return this._indeterminate}set indeterminate(t){const i=t!=this._indeterminate;this._indeterminate=fc(t),i&&(this._transitionCheckState(this._indeterminate?3:this.checked?1:2),this.indeterminateChange.emit(this._indeterminate)),this._syncIndeterminate(this._indeterminate)}_isRippleDisabled(){return this.disableRipple||this.disabled}_onLabelTextChange(){this._changeDetectorRef.detectChanges()}writeValue(t){this.checked=!!t}registerOnChange(t){this._controlValueAccessorChangeFn=t}registerOnTouched(t){this._onTouched=t}setDisabledState(t){this.disabled=t}_getAriaChecked(){return this.checked?"true":this.indeterminate?"mixed":"false"}_transitionCheckState(t){let i=this._currentCheckState,r=this._getAnimationTargetElement();if(i!==t&&r&&(this._currentAnimationClass&&r.classList.remove(this._currentAnimationClass),this._currentAnimationClass=this._getAnimationClassForCheckStateTransition(i,t),this._currentCheckState=t,this._currentAnimationClass.length>0)){r.classList.add(this._currentAnimationClass);const s=this._currentAnimationClass;this._ngZone.runOutsideAngular(()=>{setTimeout(()=>{r.classList.remove(s)},1e3)})}}_emitChangeEvent(){this._controlValueAccessorChangeFn(this.checked),this.change.emit(this._createChangeEvent(this.checked)),this._inputElement&&(this._inputElement.nativeElement.checked=this.checked)}toggle(){this.checked=!this.checked,this._controlValueAccessorChangeFn(this.checked)}_handleInputClick(){const t=this._options?.clickAction;this.disabled||"noop"===t?!this.disabled&&"noop"===t&&(this._inputElement.nativeElement.checked=this.checked,this._inputElement.nativeElement.indeterminate=this.indeterminate):(this.indeterminate&&"check"!==t&&Promise.resolve().then(()=>{this._indeterminate=!1,this.indeterminateChange.emit(this._indeterminate)}),this._checked=!this._checked,this._transitionCheckState(this._checked?1:2),this._emitChangeEvent())}_onInteractionEvent(t){t.stopPropagation()}_onBlur(){Promise.resolve().then(()=>{this._onTouched(),this._changeDetectorRef.markForCheck()})}_getAnimationClassForCheckStateTransition(t,i){if("NoopAnimations"===this._animationMode)return"";switch(t){case 0:if(1===i)return this._animationClasses.uncheckedToChecked;if(3==i)return this._checked?this._animationClasses.checkedToIndeterminate:this._animationClasses.uncheckedToIndeterminate;break;case 2:return 1===i?this._animationClasses.uncheckedToChecked:this._animationClasses.uncheckedToIndeterminate;case 1:return 2===i?this._animationClasses.checkedToUnchecked:this._animationClasses.checkedToIndeterminate;case 3:return 1===i?this._animationClasses.indeterminateToChecked:this._animationClasses.indeterminateToUnchecked}return""}_syncIndeterminate(t){const i=this._inputElement;i&&(i.nativeElement.indeterminate=t)}}return n.\u0275fac=function(t){Bf()},n.\u0275dir=Ke({type:n,viewQuery:function(t,i){if(1&t&&(xr(Mte,5),xr(Cte,5),xr(MN,5)),2&t){let r;tr(r=nr())&&(i._inputElement=r.first),tr(r=nr())&&(i._labelElement=r.first),tr(r=nr())&&(i.ripple=r.first)}},inputs:{ariaLabel:["aria-label","ariaLabel"],ariaLabelledby:["aria-labelledby","ariaLabelledby"],ariaDescribedby:["aria-describedby","ariaDescribedby"],id:"id",required:"required",labelPosition:"labelPosition",name:"name",value:"value",checked:"checked",disabled:"disabled",indeterminate:"indeterminate"},outputs:{change:"change",indeterminateChange:"indeterminateChange"},features:[Pt]}),n})(),Ud=(()=>{class n extends Pte{constructor(t,i,r,s,o,a){super("mat-mdc-checkbox-",t,i,r,s,o,a),this._animationClasses={uncheckedToChecked:"mdc-checkbox--anim-unchecked-checked",uncheckedToIndeterminate:"mdc-checkbox--anim-unchecked-indeterminate",checkedToUnchecked:"mdc-checkbox--anim-checked-unchecked",checkedToIndeterminate:"mdc-checkbox--anim-checked-indeterminate",indeterminateToChecked:"mdc-checkbox--anim-indeterminate-checked",indeterminateToUnchecked:"mdc-checkbox--anim-indeterminate-unchecked"}}focus(){this._inputElement.nativeElement.focus()}_createChangeEvent(t){const i=new Tte;return i.source=this,i.checked=t,i}_getAnimationTargetElement(){return this._inputElement?.nativeElement}_onInputClick(){super._handleInputClick()}_preventBubblingFromLabel(t){t.target&&this._labelElement.nativeElement.contains(t.target)&&t.stopPropagation()}}return n.\u0275fac=function(t){return new(t||n)(j(oi),j(Mo),j(on),kc("tabindex"),j(cp,8),j(Ete,8))},n.\u0275cmp=ii({type:n,selectors:[["mat-checkbox"]],hostAttrs:[1,"mat-mdc-checkbox"],hostVars:12,hostBindings:function(t,i){2&t&&(Nv("id",i.id),er("tabindex",null)("aria-label",null)("aria-labelledby",null),yn("_mat-animation-noopable","NoopAnimations"===i._animationMode)("mdc-checkbox--disabled",i.disabled)("mat-mdc-checkbox-disabled",i.disabled)("mat-mdc-checkbox-checked",i.checked))},inputs:{disableRipple:"disableRipple",color:"color",tabIndex:"tabIndex"},exportAs:["matCheckbox"],features:[nn([Dte]),Pt],ngContentSelectors:Ste,decls:15,vars:19,consts:[[1,"mdc-form-field",3,"click"],[1,"mdc-checkbox"],["checkbox",""],[1,"mat-mdc-checkbox-touch-target",3,"click"],["type","checkbox",1,"mdc-checkbox__native-control",3,"checked","disabled","id","required","tabIndex","blur","click","change"],["input",""],[1,"mdc-checkbox__ripple"],[1,"mdc-checkbox__background"],["focusable","false","viewBox","0 0 24 24","aria-hidden","true",1,"mdc-checkbox__checkmark"],["fill","none","d","M1.73,12.91 8.1,19.28 22.79,4.59",1,"mdc-checkbox__checkmark-path"],[1,"mdc-checkbox__mixedmark"],["mat-ripple","",1,"mat-mdc-checkbox-ripple","mat-mdc-focus-indicator",3,"matRippleTrigger","matRippleDisabled","matRippleCentered"],[3,"for"],["label",""]],template:function(t,i){if(1&t&&(Rv(),W(0,"div",0),Oe("click",function(s){return i._preventBubblingFromLabel(s)}),W(1,"div",1,2)(3,"div",3),Oe("click",function(){return i._onInputClick()}),Y(),W(4,"input",4,5),Oe("blur",function(){return i._onBlur()})("click",function(){return i._onInputClick()})("change",function(s){return i._onInteractionEvent(s)}),Y(),it(6,"div",6),W(7,"div",7),function qC(){nt.lFrame.currentNamespace="svg"}(),W(8,"svg",8),it(9,"path",9),Y(),function XC(){!function g3(){nt.lFrame.currentNamespace=null}()}(),it(10,"div",10),Y(),it(11,"div",11),Y(),W(12,"label",12,13),Ov(14),Y()()),2&t){const r=function C1(n){return function Tc(n,e){return n[e]}(function c3(){return nt.lFrame.contextLView}(),22+n)}(2);yn("mdc-form-field--align-end","before"==i.labelPosition),ge(4),yn("mdc-checkbox--selected",i.checked),Ge("checked",i.checked)("disabled",i.disabled)("id",i.inputId)("required",i.required)("tabIndex",i.tabIndex),er("aria-checked",i._getAriaChecked())("aria-label",i.ariaLabel||null)("aria-labelledby",i.ariaLabelledby)("aria-describedby",i.ariaDescribedby)("name",i.name)("value",i.value),ge(7),Ge("matRippleTrigger",r)("matRippleDisabled",i.disableRipple||i.disabled)("matRippleCentered",!0),ge(1),Ge("for",i.inputId)}},dependencies:[MN],styles:['.mdc-touch-target-wrapper{display:inline}@keyframes mdc-checkbox-unchecked-checked-checkmark-path{0%,50%{stroke-dashoffset:29.7833385}50%{animation-timing-function:cubic-bezier(0, 0, 0.2, 1)}100%{stroke-dashoffset:0}}@keyframes mdc-checkbox-unchecked-indeterminate-mixedmark{0%,68.2%{transform:scaleX(0)}68.2%{animation-timing-function:cubic-bezier(0, 0, 0, 1)}100%{transform:scaleX(1)}}@keyframes mdc-checkbox-checked-unchecked-checkmark-path{from{animation-timing-function:cubic-bezier(0.4, 0, 1, 1);opacity:1;stroke-dashoffset:0}to{opacity:0;stroke-dashoffset:-29.7833385}}@keyframes mdc-checkbox-checked-indeterminate-checkmark{from{animation-timing-function:cubic-bezier(0, 0, 0.2, 1);transform:rotate(0deg);opacity:1}to{transform:rotate(45deg);opacity:0}}@keyframes mdc-checkbox-indeterminate-checked-checkmark{from{animation-timing-function:cubic-bezier(0.14, 0, 0, 1);transform:rotate(45deg);opacity:0}to{transform:rotate(360deg);opacity:1}}@keyframes mdc-checkbox-checked-indeterminate-mixedmark{from{animation-timing-function:mdc-animation-deceleration-curve-timing-function;transform:rotate(-45deg);opacity:0}to{transform:rotate(0deg);opacity:1}}@keyframes mdc-checkbox-indeterminate-checked-mixedmark{from{animation-timing-function:cubic-bezier(0.14, 0, 0, 1);transform:rotate(0deg);opacity:1}to{transform:rotate(315deg);opacity:0}}@keyframes mdc-checkbox-indeterminate-unchecked-mixedmark{0%{animation-timing-function:linear;transform:scaleX(1);opacity:1}32.8%,100%{transform:scaleX(0);opacity:0}}.mdc-checkbox{display:inline-block;position:relative;flex:0 0 18px;box-sizing:content-box;width:18px;height:18px;line-height:0;white-space:nowrap;cursor:pointer;vertical-align:bottom}.mdc-checkbox[hidden]{display:none}.mdc-checkbox.mdc-ripple-upgraded--background-focused .mdc-checkbox__focus-ring,.mdc-checkbox:not(.mdc-ripple-upgraded):focus .mdc-checkbox__focus-ring{pointer-events:none;border:2px solid rgba(0,0,0,0);border-radius:6px;box-sizing:content-box;position:absolute;top:50%;left:50%;transform:translate(-50%, -50%);height:100%;width:100%}@media screen and (forced-colors: active){.mdc-checkbox.mdc-ripple-upgraded--background-focused .mdc-checkbox__focus-ring,.mdc-checkbox:not(.mdc-ripple-upgraded):focus .mdc-checkbox__focus-ring{border-color:CanvasText}}.mdc-checkbox.mdc-ripple-upgraded--background-focused .mdc-checkbox__focus-ring::after,.mdc-checkbox:not(.mdc-ripple-upgraded):focus .mdc-checkbox__focus-ring::after{content:"";border:2px solid rgba(0,0,0,0);border-radius:8px;display:block;position:absolute;top:50%;left:50%;transform:translate(-50%, -50%);height:calc(100% + 4px);width:calc(100% + 4px)}@media screen and (forced-colors: active){.mdc-checkbox.mdc-ripple-upgraded--background-focused .mdc-checkbox__focus-ring::after,.mdc-checkbox:not(.mdc-ripple-upgraded):focus .mdc-checkbox__focus-ring::after{border-color:CanvasText}}@media all and (-ms-high-contrast: none){.mdc-checkbox .mdc-checkbox__focus-ring{display:none}}@media screen and (forced-colors: active),(-ms-high-contrast: active){.mdc-checkbox__mixedmark{margin:0 1px}}.mdc-checkbox--disabled{cursor:default;pointer-events:none}.mdc-checkbox__background{display:inline-flex;position:absolute;align-items:center;justify-content:center;box-sizing:border-box;width:18px;height:18px;border:2px solid currentColor;border-radius:2px;background-color:rgba(0,0,0,0);pointer-events:none;will-change:background-color,border-color;transition:background-color 90ms 0ms cubic-bezier(0.4, 0, 0.6, 1),border-color 90ms 0ms cubic-bezier(0.4, 0, 0.6, 1)}.mdc-checkbox__checkmark{position:absolute;top:0;right:0;bottom:0;left:0;width:100%;opacity:0;transition:opacity 180ms 0ms cubic-bezier(0.4, 0, 0.6, 1)}.mdc-checkbox--upgraded .mdc-checkbox__checkmark{opacity:1}.mdc-checkbox__checkmark-path{transition:stroke-dashoffset 180ms 0ms cubic-bezier(0.4, 0, 0.6, 1);stroke:currentColor;stroke-width:3.12px;stroke-dashoffset:29.7833385;stroke-dasharray:29.7833385}.mdc-checkbox__mixedmark{width:100%;height:0;transform:scaleX(0) rotate(0deg);border-width:1px;border-style:solid;opacity:0;transition:opacity 90ms 0ms cubic-bezier(0.4, 0, 0.6, 1),transform 90ms 0ms cubic-bezier(0.4, 0, 0.6, 1)}.mdc-checkbox--anim-unchecked-checked .mdc-checkbox__background,.mdc-checkbox--anim-unchecked-indeterminate .mdc-checkbox__background,.mdc-checkbox--anim-checked-unchecked .mdc-checkbox__background,.mdc-checkbox--anim-indeterminate-unchecked .mdc-checkbox__background{animation-duration:180ms;animation-timing-function:linear}.mdc-checkbox--anim-unchecked-checked .mdc-checkbox__checkmark-path{animation:mdc-checkbox-unchecked-checked-checkmark-path 180ms linear 0s;transition:none}.mdc-checkbox--anim-unchecked-indeterminate .mdc-checkbox__mixedmark{animation:mdc-checkbox-unchecked-indeterminate-mixedmark 90ms linear 0s;transition:none}.mdc-checkbox--anim-checked-unchecked .mdc-checkbox__checkmark-path{animation:mdc-checkbox-checked-unchecked-checkmark-path 90ms linear 0s;transition:none}.mdc-checkbox--anim-checked-indeterminate .mdc-checkbox__checkmark{animation:mdc-checkbox-checked-indeterminate-checkmark 90ms linear 0s;transition:none}.mdc-checkbox--anim-checked-indeterminate .mdc-checkbox__mixedmark{animation:mdc-checkbox-checked-indeterminate-mixedmark 90ms linear 0s;transition:none}.mdc-checkbox--anim-indeterminate-checked .mdc-checkbox__checkmark{animation:mdc-checkbox-indeterminate-checked-checkmark 500ms linear 0s;transition:none}.mdc-checkbox--anim-indeterminate-checked .mdc-checkbox__mixedmark{animation:mdc-checkbox-indeterminate-checked-mixedmark 500ms linear 0s;transition:none}.mdc-checkbox--anim-indeterminate-unchecked .mdc-checkbox__mixedmark{animation:mdc-checkbox-indeterminate-unchecked-mixedmark 300ms linear 0s;transition:none}.mdc-checkbox__native-control:checked~.mdc-checkbox__background,.mdc-checkbox__native-control:indeterminate~.mdc-checkbox__background,.mdc-checkbox__native-control[data-indeterminate=true]~.mdc-checkbox__background{transition:border-color 90ms 0ms cubic-bezier(0, 0, 0.2, 1),background-color 90ms 0ms cubic-bezier(0, 0, 0.2, 1)}.mdc-checkbox__native-control:checked~.mdc-checkbox__background .mdc-checkbox__checkmark-path,.mdc-checkbox__native-control:indeterminate~.mdc-checkbox__background .mdc-checkbox__checkmark-path,.mdc-checkbox__native-control[data-indeterminate=true]~.mdc-checkbox__background .mdc-checkbox__checkmark-path{stroke-dashoffset:0}.mdc-checkbox__native-control{position:absolute;margin:0;padding:0;opacity:0;cursor:inherit}.mdc-checkbox__native-control:disabled{cursor:default;pointer-events:none}.mdc-checkbox--touch{margin:calc((var(--mdc-checkbox-state-layer-size, 48px) - var(--mdc-checkbox-state-layer-size, 40px)) / 2)}.mdc-checkbox--touch .mdc-checkbox__native-control{top:calc((var(--mdc-checkbox-state-layer-size, 40px) - var(--mdc-checkbox-state-layer-size, 48px)) / 2);right:calc((var(--mdc-checkbox-state-layer-size, 40px) - var(--mdc-checkbox-state-layer-size, 48px)) / 2);left:calc((var(--mdc-checkbox-state-layer-size, 40px) - var(--mdc-checkbox-state-layer-size, 48px)) / 2);width:var(--mdc-checkbox-state-layer-size, 48px);height:var(--mdc-checkbox-state-layer-size, 48px)}.mdc-checkbox__native-control:checked~.mdc-checkbox__background .mdc-checkbox__checkmark{transition:opacity 180ms 0ms cubic-bezier(0, 0, 0.2, 1),transform 180ms 0ms cubic-bezier(0, 0, 0.2, 1);opacity:1}.mdc-checkbox__native-control:checked~.mdc-checkbox__background .mdc-checkbox__mixedmark{transform:scaleX(1) rotate(-45deg)}.mdc-checkbox__native-control:indeterminate~.mdc-checkbox__background .mdc-checkbox__checkmark,.mdc-checkbox__native-control[data-indeterminate=true]~.mdc-checkbox__background .mdc-checkbox__checkmark{transform:rotate(45deg);opacity:0;transition:opacity 90ms 0ms cubic-bezier(0.4, 0, 0.6, 1),transform 90ms 0ms cubic-bezier(0.4, 0, 0.6, 1)}.mdc-checkbox__native-control:indeterminate~.mdc-checkbox__background .mdc-checkbox__mixedmark,.mdc-checkbox__native-control[data-indeterminate=true]~.mdc-checkbox__background .mdc-checkbox__mixedmark{transform:scaleX(1) rotate(0deg);opacity:1}.mdc-checkbox.mdc-checkbox--upgraded .mdc-checkbox__background,.mdc-checkbox.mdc-checkbox--upgraded .mdc-checkbox__checkmark,.mdc-checkbox.mdc-checkbox--upgraded .mdc-checkbox__checkmark-path,.mdc-checkbox.mdc-checkbox--upgraded .mdc-checkbox__mixedmark{transition:none}.mdc-form-field{display:inline-flex;align-items:center;vertical-align:middle}.mdc-form-field[hidden]{display:none}.mdc-form-field>label{margin-left:0;margin-right:auto;padding-left:4px;padding-right:0;order:0}[dir=rtl] .mdc-form-field>label,.mdc-form-field>label[dir=rtl]{margin-left:auto;margin-right:0}[dir=rtl] .mdc-form-field>label,.mdc-form-field>label[dir=rtl]{padding-left:0;padding-right:4px}.mdc-form-field--nowrap>label{text-overflow:ellipsis;overflow:hidden;white-space:nowrap}.mdc-form-field--align-end>label{margin-left:auto;margin-right:0;padding-left:0;padding-right:4px;order:-1}[dir=rtl] .mdc-form-field--align-end>label,.mdc-form-field--align-end>label[dir=rtl]{margin-left:0;margin-right:auto}[dir=rtl] .mdc-form-field--align-end>label,.mdc-form-field--align-end>label[dir=rtl]{padding-left:4px;padding-right:0}.mdc-form-field--space-between{justify-content:space-between}.mdc-form-field--space-between>label{margin:0}[dir=rtl] .mdc-form-field--space-between>label,.mdc-form-field--space-between>label[dir=rtl]{margin:0}.mat-mdc-checkbox{display:inline-block;position:relative}.mat-mdc-checkbox .mdc-checkbox{padding:calc((var(--mdc-checkbox-state-layer-size, 40px) - 18px) / 2);margin:calc((var(--mdc-checkbox-state-layer-size, 40px) - var(--mdc-checkbox-state-layer-size, 40px)) / 2)}.mat-mdc-checkbox .mdc-checkbox .mdc-checkbox__native-control[disabled]:not(:checked):not(:indeterminate):not([data-indeterminate=true])~.mdc-checkbox__background{border-color:var(--mdc-checkbox-disabled-unselected-icon-color, rgba(0, 0, 0, 0.38));background-color:transparent}.mat-mdc-checkbox .mdc-checkbox .mdc-checkbox__native-control[disabled]:checked~.mdc-checkbox__background,.mat-mdc-checkbox .mdc-checkbox .mdc-checkbox__native-control[disabled]:indeterminate~.mdc-checkbox__background,.mat-mdc-checkbox .mdc-checkbox .mdc-checkbox__native-control[data-indeterminate=true][disabled]~.mdc-checkbox__background{border-color:transparent;background-color:var(--mdc-checkbox-disabled-selected-icon-color, rgba(0, 0, 0, 0.38))}.mat-mdc-checkbox .mdc-checkbox .mdc-checkbox__native-control:enabled~.mdc-checkbox__background .mdc-checkbox__checkmark{color:var(--mdc-checkbox-selected-checkmark-color, #fff)}.mat-mdc-checkbox .mdc-checkbox .mdc-checkbox__native-control:enabled~.mdc-checkbox__background .mdc-checkbox__mixedmark{border-color:var(--mdc-checkbox-selected-checkmark-color, #fff)}.mat-mdc-checkbox .mdc-checkbox .mdc-checkbox__native-control:disabled~.mdc-checkbox__background .mdc-checkbox__checkmark{color:var(--mdc-checkbox-disabled-selected-checkmark-color, #fff)}.mat-mdc-checkbox .mdc-checkbox .mdc-checkbox__native-control:disabled~.mdc-checkbox__background .mdc-checkbox__mixedmark{border-color:var(--mdc-checkbox-disabled-selected-checkmark-color, #fff)}.mat-mdc-checkbox .mdc-checkbox .mdc-checkbox__native-control:enabled:not(:checked):not(:indeterminate):not([data-indeterminate=true])~.mdc-checkbox__background{border-color:var(--mdc-checkbox-unselected-icon-color, rgba(0, 0, 0, 0.54));background-color:transparent}.mat-mdc-checkbox .mdc-checkbox .mdc-checkbox__native-control:enabled:checked~.mdc-checkbox__background,.mat-mdc-checkbox .mdc-checkbox .mdc-checkbox__native-control:enabled:indeterminate~.mdc-checkbox__background,.mat-mdc-checkbox .mdc-checkbox .mdc-checkbox__native-control[data-indeterminate=true]:enabled~.mdc-checkbox__background{border-color:var(--mdc-checkbox-selected-icon-color, var(--mdc-theme-secondary, #018786));background-color:var(--mdc-checkbox-selected-icon-color, var(--mdc-theme-secondary, #018786))}@keyframes mdc-checkbox-fade-in-background-8A000000FF01878600000000FF018786{0%{border-color:var(--mdc-checkbox-unselected-icon-color, rgba(0, 0, 0, 0.54));background-color:transparent}50%{border-color:var(--mdc-checkbox-selected-icon-color, var(--mdc-theme-secondary, #018786));background-color:var(--mdc-checkbox-selected-icon-color, var(--mdc-theme-secondary, #018786))}}@keyframes mdc-checkbox-fade-out-background-8A000000FF01878600000000FF018786{0%,80%{border-color:var(--mdc-checkbox-selected-icon-color, var(--mdc-theme-secondary, #018786));background-color:var(--mdc-checkbox-selected-icon-color, var(--mdc-theme-secondary, #018786))}100%{border-color:var(--mdc-checkbox-unselected-icon-color, rgba(0, 0, 0, 0.54));background-color:transparent}}.mat-mdc-checkbox .mdc-checkbox.mdc-checkbox--anim-unchecked-checked .mdc-checkbox__native-control:enabled~.mdc-checkbox__background,.mat-mdc-checkbox .mdc-checkbox.mdc-checkbox--anim-unchecked-indeterminate .mdc-checkbox__native-control:enabled~.mdc-checkbox__background{animation-name:mdc-checkbox-fade-in-background-8A000000FF01878600000000FF018786}.mat-mdc-checkbox .mdc-checkbox.mdc-checkbox--anim-checked-unchecked .mdc-checkbox__native-control:enabled~.mdc-checkbox__background,.mat-mdc-checkbox .mdc-checkbox.mdc-checkbox--anim-indeterminate-unchecked .mdc-checkbox__native-control:enabled~.mdc-checkbox__background{animation-name:mdc-checkbox-fade-out-background-8A000000FF01878600000000FF018786}.mat-mdc-checkbox .mdc-checkbox:hover .mdc-checkbox__native-control:enabled:not(:checked):not(:indeterminate):not([data-indeterminate=true])~.mdc-checkbox__background{border-color:var(--mdc-checkbox-unselected-hover-icon-color, var(--mdc-theme-secondary, #018786));background-color:transparent}.mat-mdc-checkbox .mdc-checkbox:hover .mdc-checkbox__native-control:enabled:checked~.mdc-checkbox__background,.mat-mdc-checkbox .mdc-checkbox:hover .mdc-checkbox__native-control:enabled:indeterminate~.mdc-checkbox__background,.mat-mdc-checkbox .mdc-checkbox:hover .mdc-checkbox__native-control[data-indeterminate=true]:enabled~.mdc-checkbox__background{border-color:var(--mdc-checkbox-selected-hover-icon-color, var(--mdc-theme-secondary, #018786));background-color:var(--mdc-checkbox-selected-hover-icon-color, var(--mdc-theme-secondary, #018786))}@keyframes mdc-checkbox-fade-in-background-FF018786FF01878600000000FF018786{0%{border-color:var(--mdc-checkbox-unselected-hover-icon-color, var(--mdc-theme-secondary, #018786));background-color:transparent}50%{border-color:var(--mdc-checkbox-selected-hover-icon-color, var(--mdc-theme-secondary, #018786));background-color:var(--mdc-checkbox-selected-hover-icon-color, var(--mdc-theme-secondary, #018786))}}@keyframes mdc-checkbox-fade-out-background-FF018786FF01878600000000FF018786{0%,80%{border-color:var(--mdc-checkbox-selected-hover-icon-color, var(--mdc-theme-secondary, #018786));background-color:var(--mdc-checkbox-selected-hover-icon-color, var(--mdc-theme-secondary, #018786))}100%{border-color:var(--mdc-checkbox-unselected-hover-icon-color, var(--mdc-theme-secondary, #018786));background-color:transparent}}.mat-mdc-checkbox .mdc-checkbox:hover.mdc-checkbox--anim-unchecked-checked .mdc-checkbox__native-control:enabled~.mdc-checkbox__background,.mat-mdc-checkbox .mdc-checkbox:hover.mdc-checkbox--anim-unchecked-indeterminate .mdc-checkbox__native-control:enabled~.mdc-checkbox__background{animation-name:mdc-checkbox-fade-in-background-FF018786FF01878600000000FF018786}.mat-mdc-checkbox .mdc-checkbox:hover.mdc-checkbox--anim-checked-unchecked .mdc-checkbox__native-control:enabled~.mdc-checkbox__background,.mat-mdc-checkbox .mdc-checkbox:hover.mdc-checkbox--anim-indeterminate-unchecked .mdc-checkbox__native-control:enabled~.mdc-checkbox__background{animation-name:mdc-checkbox-fade-out-background-FF018786FF01878600000000FF018786}.mat-mdc-checkbox .mdc-checkbox.mdc-ripple-upgraded--background-focused .mdc-checkbox__native-control:enabled:not(:checked):not(:indeterminate):not([data-indeterminate=true])~.mdc-checkbox__background,.mat-mdc-checkbox .mdc-checkbox:not(.mdc-ripple-upgraded):focus .mdc-checkbox__native-control:enabled:not(:checked):not(:indeterminate):not([data-indeterminate=true])~.mdc-checkbox__background{border-color:var(--mdc-checkbox-unselected-focus-icon-color, var(--mdc-theme-secondary, #018786));background-color:transparent}.mat-mdc-checkbox .mdc-checkbox.mdc-ripple-upgraded--background-focused .mdc-checkbox__native-control:enabled:checked~.mdc-checkbox__background,.mat-mdc-checkbox .mdc-checkbox.mdc-ripple-upgraded--background-focused .mdc-checkbox__native-control:enabled:indeterminate~.mdc-checkbox__background,.mat-mdc-checkbox .mdc-checkbox.mdc-ripple-upgraded--background-focused .mdc-checkbox__native-control[data-indeterminate=true]:enabled~.mdc-checkbox__background,.mat-mdc-checkbox .mdc-checkbox:not(.mdc-ripple-upgraded):focus .mdc-checkbox__native-control:enabled:checked~.mdc-checkbox__background,.mat-mdc-checkbox .mdc-checkbox:not(.mdc-ripple-upgraded):focus .mdc-checkbox__native-control:enabled:indeterminate~.mdc-checkbox__background,.mat-mdc-checkbox .mdc-checkbox:not(.mdc-ripple-upgraded):focus .mdc-checkbox__native-control[data-indeterminate=true]:enabled~.mdc-checkbox__background{border-color:var(--mdc-checkbox-selected-focus-icon-color, var(--mdc-theme-secondary, #018786));background-color:var(--mdc-checkbox-selected-focus-icon-color, var(--mdc-theme-secondary, #018786))}@keyframes mdc-checkbox-fade-in-background-FF018786FF01878600000000FF018786{0%{border-color:var(--mdc-checkbox-unselected-focus-icon-color, var(--mdc-theme-secondary, #018786));background-color:transparent}50%{border-color:var(--mdc-checkbox-selected-focus-icon-color, var(--mdc-theme-secondary, #018786));background-color:var(--mdc-checkbox-selected-focus-icon-color, var(--mdc-theme-secondary, #018786))}}@keyframes mdc-checkbox-fade-out-background-FF018786FF01878600000000FF018786{0%,80%{border-color:var(--mdc-checkbox-selected-focus-icon-color, var(--mdc-theme-secondary, #018786));background-color:var(--mdc-checkbox-selected-focus-icon-color, var(--mdc-theme-secondary, #018786))}100%{border-color:var(--mdc-checkbox-unselected-focus-icon-color, var(--mdc-theme-secondary, #018786));background-color:transparent}}.mat-mdc-checkbox .mdc-checkbox.mdc-ripple-upgraded--background-focused.mdc-checkbox--anim-unchecked-checked .mdc-checkbox__native-control:enabled~.mdc-checkbox__background,.mat-mdc-checkbox .mdc-checkbox.mdc-ripple-upgraded--background-focused.mdc-checkbox--anim-unchecked-indeterminate .mdc-checkbox__native-control:enabled~.mdc-checkbox__background,.mat-mdc-checkbox .mdc-checkbox:not(.mdc-ripple-upgraded):focus.mdc-checkbox--anim-unchecked-checked .mdc-checkbox__native-control:enabled~.mdc-checkbox__background,.mat-mdc-checkbox .mdc-checkbox:not(.mdc-ripple-upgraded):focus.mdc-checkbox--anim-unchecked-indeterminate .mdc-checkbox__native-control:enabled~.mdc-checkbox__background{animation-name:mdc-checkbox-fade-in-background-FF018786FF01878600000000FF018786}.mat-mdc-checkbox .mdc-checkbox.mdc-ripple-upgraded--background-focused.mdc-checkbox--anim-checked-unchecked .mdc-checkbox__native-control:enabled~.mdc-checkbox__background,.mat-mdc-checkbox .mdc-checkbox.mdc-ripple-upgraded--background-focused.mdc-checkbox--anim-indeterminate-unchecked .mdc-checkbox__native-control:enabled~.mdc-checkbox__background,.mat-mdc-checkbox .mdc-checkbox:not(.mdc-ripple-upgraded):focus.mdc-checkbox--anim-checked-unchecked .mdc-checkbox__native-control:enabled~.mdc-checkbox__background,.mat-mdc-checkbox .mdc-checkbox:not(.mdc-ripple-upgraded):focus.mdc-checkbox--anim-indeterminate-unchecked .mdc-checkbox__native-control:enabled~.mdc-checkbox__background{animation-name:mdc-checkbox-fade-out-background-FF018786FF01878600000000FF018786}.mat-mdc-checkbox .mdc-checkbox:not(:disabled):active .mdc-checkbox__native-control:enabled:not(:checked):not(:indeterminate):not([data-indeterminate=true])~.mdc-checkbox__background{border-color:var(--mdc-checkbox-unselected-pressed-icon-color, rgba(0, 0, 0, 0.54));background-color:transparent}.mat-mdc-checkbox .mdc-checkbox:not(:disabled):active .mdc-checkbox__native-control:enabled:checked~.mdc-checkbox__background,.mat-mdc-checkbox .mdc-checkbox:not(:disabled):active .mdc-checkbox__native-control:enabled:indeterminate~.mdc-checkbox__background,.mat-mdc-checkbox .mdc-checkbox:not(:disabled):active .mdc-checkbox__native-control[data-indeterminate=true]:enabled~.mdc-checkbox__background{border-color:var(--mdc-checkbox-selected-pressed-icon-color, var(--mdc-theme-secondary, #018786));background-color:var(--mdc-checkbox-selected-pressed-icon-color, var(--mdc-theme-secondary, #018786))}@keyframes mdc-checkbox-fade-in-background-8A000000FF01878600000000FF018786{0%{border-color:var(--mdc-checkbox-unselected-pressed-icon-color, rgba(0, 0, 0, 0.54));background-color:transparent}50%{border-color:var(--mdc-checkbox-selected-pressed-icon-color, var(--mdc-theme-secondary, #018786));background-color:var(--mdc-checkbox-selected-pressed-icon-color, var(--mdc-theme-secondary, #018786))}}@keyframes mdc-checkbox-fade-out-background-8A000000FF01878600000000FF018786{0%,80%{border-color:var(--mdc-checkbox-selected-pressed-icon-color, var(--mdc-theme-secondary, #018786));background-color:var(--mdc-checkbox-selected-pressed-icon-color, var(--mdc-theme-secondary, #018786))}100%{border-color:var(--mdc-checkbox-unselected-pressed-icon-color, rgba(0, 0, 0, 0.54));background-color:transparent}}.mat-mdc-checkbox .mdc-checkbox:not(:disabled):active.mdc-checkbox--anim-unchecked-checked .mdc-checkbox__native-control:enabled~.mdc-checkbox__background,.mat-mdc-checkbox .mdc-checkbox:not(:disabled):active.mdc-checkbox--anim-unchecked-indeterminate .mdc-checkbox__native-control:enabled~.mdc-checkbox__background{animation-name:mdc-checkbox-fade-in-background-8A000000FF01878600000000FF018786}.mat-mdc-checkbox .mdc-checkbox:not(:disabled):active.mdc-checkbox--anim-checked-unchecked .mdc-checkbox__native-control:enabled~.mdc-checkbox__background,.mat-mdc-checkbox .mdc-checkbox:not(:disabled):active.mdc-checkbox--anim-indeterminate-unchecked .mdc-checkbox__native-control:enabled~.mdc-checkbox__background{animation-name:mdc-checkbox-fade-out-background-8A000000FF01878600000000FF018786}.mat-mdc-checkbox .mdc-checkbox .mdc-checkbox__background{top:calc((var(--mdc-checkbox-state-layer-size, 40px) - 18px) / 2);left:calc((var(--mdc-checkbox-state-layer-size, 40px) - 18px) / 2)}.mat-mdc-checkbox .mdc-checkbox .mdc-checkbox__native-control{top:calc((var(--mdc-checkbox-state-layer-size, 40px) - var(--mdc-checkbox-state-layer-size, 40px)) / 2);right:calc((var(--mdc-checkbox-state-layer-size, 40px) - var(--mdc-checkbox-state-layer-size, 40px)) / 2);left:calc((var(--mdc-checkbox-state-layer-size, 40px) - var(--mdc-checkbox-state-layer-size, 40px)) / 2);width:var(--mdc-checkbox-state-layer-size, 40px);height:var(--mdc-checkbox-state-layer-size, 40px)}.mat-mdc-checkbox .mdc-checkbox:hover .mdc-checkbox__native-control:not([disabled])~.mdc-checkbox__ripple{opacity:.04;transform:scale(1);transition:opacity 80ms 0 cubic-bezier(0, 0, 0.2, 1),transform 80ms 0 cubic-bezier(0, 0, 0.2, 1)}.mat-mdc-checkbox .mdc-checkbox .mdc-checkbox__native-control:not([disabled]):focus~.mdc-checkbox__ripple{opacity:.16}.mat-mdc-checkbox .mdc-checkbox__background{-webkit-print-color-adjust:exact;color-adjust:exact}.mat-mdc-checkbox._mat-animation-noopable *,.mat-mdc-checkbox._mat-animation-noopable *::before{transition:none !important;animation:none !important}.mat-mdc-checkbox label{cursor:pointer}.mat-mdc-checkbox.mat-mdc-checkbox-disabled label{cursor:default}.mat-mdc-checkbox label:empty{display:none}.mat-mdc-checkbox .mdc-checkbox__native-control:focus:enabled:not(:checked):not(:indeterminate):not([data-indeterminate=true])~.mdc-checkbox__background{border-color:var(--mdc-checkbox-unselected-focus-icon-color, black)}.cdk-high-contrast-active .mat-mdc-checkbox.mat-mdc-checkbox-disabled{opacity:.5}.cdk-high-contrast-active .mat-mdc-checkbox .mdc-checkbox__checkmark{--mdc-checkbox-selected-checkmark-color: CanvasText;--mdc-checkbox-disabled-selected-checkmark-color: CanvasText}.mat-mdc-checkbox .mdc-checkbox__ripple{opacity:0}.mat-mdc-checkbox-ripple,.mdc-checkbox__ripple{top:0;left:0;right:0;bottom:0;position:absolute;border-radius:50%;pointer-events:none}.mat-mdc-checkbox-ripple:not(:empty),.mdc-checkbox__ripple:not(:empty){transform:translateZ(0)}.mat-mdc-checkbox-touch-target{position:absolute;top:50%;height:48px;left:50%;width:48px;transform:translate(-50%, -50%)}.mat-mdc-checkbox-ripple::before{border-radius:50%}.mdc-checkbox__native-control:focus~.mat-mdc-focus-indicator::before{content:""}'],encapsulation:2,changeDetection:0}),n})(),EN=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=bi({type:n}),n.\u0275inj=hi({}),n})(),kte=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=bi({type:n}),n.\u0275inj=hi({imports:[wu,wte,EN,wu,EN]}),n})();class hM{}class Jo{constructor(e){this.normalizedNames=new Map,this.lazyUpdate=null,e?this.lazyInit="string"==typeof e?()=>{this.headers=new Map,e.split("\n").forEach(t=>{const i=t.indexOf(":");if(i>0){const r=t.slice(0,i),s=r.toLowerCase(),o=t.slice(i+1).trim();this.maybeSetNormalizedName(r,s),this.headers.has(s)?this.headers.get(s).push(o):this.headers.set(s,[o])}})}:()=>{this.headers=new Map,Object.keys(e).forEach(t=>{let i=e[t];const r=t.toLowerCase();"string"==typeof i&&(i=[i]),i.length>0&&(this.headers.set(r,i),this.maybeSetNormalizedName(t,r))})}:this.headers=new Map}has(e){return this.init(),this.headers.has(e.toLowerCase())}get(e){this.init();const t=this.headers.get(e.toLowerCase());return t&&t.length>0?t[0]:null}keys(){return this.init(),Array.from(this.normalizedNames.values())}getAll(e){return this.init(),this.headers.get(e.toLowerCase())||null}append(e,t){return this.clone({name:e,value:t,op:"a"})}set(e,t){return this.clone({name:e,value:t,op:"s"})}delete(e,t){return this.clone({name:e,value:t,op:"d"})}maybeSetNormalizedName(e,t){this.normalizedNames.has(t)||this.normalizedNames.set(t,e)}init(){this.lazyInit&&(this.lazyInit instanceof Jo?this.copyFrom(this.lazyInit):this.lazyInit(),this.lazyInit=null,this.lazyUpdate&&(this.lazyUpdate.forEach(e=>this.applyUpdate(e)),this.lazyUpdate=null))}copyFrom(e){e.init(),Array.from(e.headers.keys()).forEach(t=>{this.headers.set(t,e.headers.get(t)),this.normalizedNames.set(t,e.normalizedNames.get(t))})}clone(e){const t=new Jo;return t.lazyInit=this.lazyInit&&this.lazyInit instanceof Jo?this.lazyInit:this,t.lazyUpdate=(this.lazyUpdate||[]).concat([e]),t}applyUpdate(e){const t=e.name.toLowerCase();switch(e.op){case"a":case"s":let i=e.value;if("string"==typeof i&&(i=[i]),0===i.length)return;this.maybeSetNormalizedName(e.name,t);const r=("a"===e.op?this.headers.get(t):void 0)||[];r.push(...i),this.headers.set(t,r);break;case"d":const s=e.value;if(s){let o=this.headers.get(t);if(!o)return;o=o.filter(a=>-1===s.indexOf(a)),0===o.length?(this.headers.delete(t),this.normalizedNames.delete(t)):this.headers.set(t,o)}else this.headers.delete(t),this.normalizedNames.delete(t)}}forEach(e){this.init(),Array.from(this.normalizedNames.keys()).forEach(t=>e(this.normalizedNames.get(t),this.headers.get(t)))}}class Lte{encodeKey(e){return TN(e)}encodeValue(e){return TN(e)}decodeKey(e){return decodeURIComponent(e)}decodeValue(e){return decodeURIComponent(e)}}const Fte=/%(\d[a-f0-9])/gi,Vte={40:"@","3A":":",24:"$","2C":",","3B":";","3D":"=","3F":"?","2F":"/"};function TN(n){return encodeURIComponent(n).replace(Fte,(e,t)=>Vte[t]??e)}function Hg(n){return`${n}`}class Qo{constructor(e={}){if(this.updates=null,this.cloneFrom=null,this.encoder=e.encoder||new Lte,e.fromString){if(e.fromObject)throw new Error("Cannot specify both fromString and fromObject.");this.map=function Nte(n,e){const t=new Map;return n.length>0&&n.replace(/^\?/,"").split("&").forEach(r=>{const s=r.indexOf("="),[o,a]=-1==s?[e.decodeKey(r),""]:[e.decodeKey(r.slice(0,s)),e.decodeValue(r.slice(s+1))],c=t.get(o)||[];c.push(a),t.set(o,c)}),t}(e.fromString,this.encoder)}else e.fromObject?(this.map=new Map,Object.keys(e.fromObject).forEach(t=>{const i=e.fromObject[t],r=Array.isArray(i)?i.map(Hg):[Hg(i)];this.map.set(t,r)})):this.map=null}has(e){return this.init(),this.map.has(e)}get(e){this.init();const t=this.map.get(e);return t?t[0]:null}getAll(e){return this.init(),this.map.get(e)||null}keys(){return this.init(),Array.from(this.map.keys())}append(e,t){return this.clone({param:e,value:t,op:"a"})}appendAll(e){const t=[];return Object.keys(e).forEach(i=>{const r=e[i];Array.isArray(r)?r.forEach(s=>{t.push({param:i,value:s,op:"a"})}):t.push({param:i,value:r,op:"a"})}),this.clone(t)}set(e,t){return this.clone({param:e,value:t,op:"s"})}delete(e,t){return this.clone({param:e,value:t,op:"d"})}toString(){return this.init(),this.keys().map(e=>{const t=this.encoder.encodeKey(e);return this.map.get(e).map(i=>t+"="+this.encoder.encodeValue(i)).join("&")}).filter(e=>""!==e).join("&")}clone(e){const t=new Qo({encoder:this.encoder});return t.cloneFrom=this.cloneFrom||this,t.updates=(this.updates||[]).concat(e),t}init(){null===this.map&&(this.map=new Map),null!==this.cloneFrom&&(this.cloneFrom.init(),this.cloneFrom.keys().forEach(e=>this.map.set(e,this.cloneFrom.map.get(e))),this.updates.forEach(e=>{switch(e.op){case"a":case"s":const t=("a"===e.op?this.map.get(e.param):void 0)||[];t.push(Hg(e.value)),this.map.set(e.param,t);break;case"d":if(void 0===e.value){this.map.delete(e.param);break}{let i=this.map.get(e.param)||[];const r=i.indexOf(Hg(e.value));-1!==r&&i.splice(r,1),i.length>0?this.map.set(e.param,i):this.map.delete(e.param)}}}),this.cloneFrom=this.updates=null)}}class Bte{constructor(){this.map=new Map}set(e,t){return this.map.set(e,t),this}get(e){return this.map.has(e)||this.map.set(e,e.defaultValue()),this.map.get(e)}delete(e){return this.map.delete(e),this}has(e){return this.map.has(e)}keys(){return this.map.keys()}}function AN(n){return typeof ArrayBuffer<"u"&&n instanceof ArrayBuffer}function IN(n){return typeof Blob<"u"&&n instanceof Blob}function PN(n){return typeof FormData<"u"&&n instanceof FormData}class zd{constructor(e,t,i,r){let s;if(this.url=t,this.body=null,this.reportProgress=!1,this.withCredentials=!1,this.responseType="json",this.method=e.toUpperCase(),function Ute(n){switch(n){case"DELETE":case"GET":case"HEAD":case"OPTIONS":case"JSONP":return!1;default:return!0}}(this.method)||r?(this.body=void 0!==i?i:null,s=r):s=i,s&&(this.reportProgress=!!s.reportProgress,this.withCredentials=!!s.withCredentials,s.responseType&&(this.responseType=s.responseType),s.headers&&(this.headers=s.headers),s.context&&(this.context=s.context),s.params&&(this.params=s.params)),this.headers||(this.headers=new Jo),this.context||(this.context=new Bte),this.params){const o=this.params.toString();if(0===o.length)this.urlWithParams=t;else{const a=t.indexOf("?");this.urlWithParams=t+(-1===a?"?":a<t.length-1?"&":"")+o}}else this.params=new Qo,this.urlWithParams=t}serializeBody(){return null===this.body?null:AN(this.body)||IN(this.body)||PN(this.body)||function zte(n){return typeof URLSearchParams<"u"&&n instanceof URLSearchParams}(this.body)||"string"==typeof this.body?this.body:this.body instanceof Qo?this.body.toString():"object"==typeof this.body||"boolean"==typeof this.body||Array.isArray(this.body)?JSON.stringify(this.body):this.body.toString()}detectContentTypeHeader(){return null===this.body||PN(this.body)?null:IN(this.body)?this.body.type||null:AN(this.body)?null:"string"==typeof this.body?"text/plain":this.body instanceof Qo?"application/x-www-form-urlencoded;charset=UTF-8":"object"==typeof this.body||"number"==typeof this.body||"boolean"==typeof this.body?"application/json":null}clone(e={}){const t=e.method||this.method,i=e.url||this.url,r=e.responseType||this.responseType,s=void 0!==e.body?e.body:this.body,o=void 0!==e.withCredentials?e.withCredentials:this.withCredentials,a=void 0!==e.reportProgress?e.reportProgress:this.reportProgress;let c=e.headers||this.headers,l=e.params||this.params;const u=e.context??this.context;return void 0!==e.setHeaders&&(c=Object.keys(e.setHeaders).reduce((h,d)=>h.set(d,e.setHeaders[d]),c)),e.setParams&&(l=Object.keys(e.setParams).reduce((h,d)=>h.set(d,e.setParams[d]),l)),new zd(t,i,s,{params:l,headers:c,context:u,reportProgress:a,responseType:r,withCredentials:o})}}var li=(()=>((li=li||{})[li.Sent=0]="Sent",li[li.UploadProgress=1]="UploadProgress",li[li.ResponseHeader=2]="ResponseHeader",li[li.DownloadProgress=3]="DownloadProgress",li[li.Response=4]="Response",li[li.User=5]="User",li))();class Hte{constructor(e,t=200,i="OK"){this.headers=e.headers||new Jo,this.status=void 0!==e.status?e.status:t,this.statusText=e.statusText||i,this.url=e.url||null,this.ok=this.status>=200&&this.status<300}}class dM extends Hte{constructor(e={}){super(e),this.type=li.Response,this.body=void 0!==e.body?e.body:null}clone(e={}){return new dM({body:void 0!==e.body?e.body:this.body,headers:e.headers||this.headers,status:void 0!==e.status?e.status:this.status,statusText:e.statusText||this.statusText,url:e.url||this.url||void 0})}}function fM(n,e){return{body:e,headers:n.headers,context:n.context,observe:n.observe,params:n.params,reportProgress:n.reportProgress,responseType:n.responseType,withCredentials:n.withCredentials}}let pM=(()=>{class n{constructor(t){this.handler=t}request(t,i,r={}){let s;if(t instanceof zd)s=t;else{let c,l;c=r.headers instanceof Jo?r.headers:new Jo(r.headers),r.params&&(l=r.params instanceof Qo?r.params:new Qo({fromObject:r.params})),s=new zd(t,i,void 0!==r.body?r.body:null,{headers:c,context:r.context,params:l,reportProgress:r.reportProgress,responseType:r.responseType||"json",withCredentials:r.withCredentials})}const o=Ve(s).pipe(Eo(c=>this.handler.handle(c)));if(t instanceof zd||"events"===r.observe)return o;const a=o.pipe(ms(c=>c instanceof dM));switch(r.observe||"body"){case"body":switch(s.responseType){case"arraybuffer":return a.pipe(tt(c=>{if(null!==c.body&&!(c.body instanceof ArrayBuffer))throw new Error("Response is not an ArrayBuffer.");return c.body}));case"blob":return a.pipe(tt(c=>{if(null!==c.body&&!(c.body instanceof Blob))throw new Error("Response is not a Blob.");return c.body}));case"text":return a.pipe(tt(c=>{if(null!==c.body&&"string"!=typeof c.body)throw new Error("Response is not a string.");return c.body}));default:return a.pipe(tt(c=>c.body))}case"response":return a;default:throw new Error(`Unreachable: unhandled observe type ${r.observe}}`)}}delete(t,i={}){return this.request("DELETE",t,i)}get(t,i={}){return this.request("GET",t,i)}head(t,i={}){return this.request("HEAD",t,i)}jsonp(t,i){return this.request("JSONP",t,{params:(new Qo).append(i,"JSONP_CALLBACK"),observe:"body",responseType:"json"})}options(t,i={}){return this.request("OPTIONS",t,i)}patch(t,i,r={}){return this.request("PATCH",t,fM(r,i))}post(t,i,r={}){return this.request("POST",t,fM(r,i))}put(t,i,r={}){return this.request("PUT",t,fM(r,i))}}return n.\u0275fac=function(t){return new(t||n)(le(hM))},n.\u0275prov=Te({token:n,factory:n.\u0275fac}),n})();const tne=["*"];let jg;function Hd(n){return function nne(){if(void 0===jg&&(jg=null,typeof window<"u")){const n=window;void 0!==n.trustedTypes&&(jg=n.trustedTypes.createPolicy("angular#components",{createHTML:e=>e}))}return jg}()?.createHTML(n)||n}function BN(n){return Error(`Unable to find icon with the name "${n}"`)}function UN(n){return Error(`The URL provided to MatIconRegistry was not trusted as a resource URL via Angular's DomSanitizer. Attempted URL was "${n}".`)}function zN(n){return Error(`The literal provided to MatIconRegistry was not trusted as safe HTML by Angular's DomSanitizer. Attempted literal was "${n}".`)}class pc{constructor(e,t,i){this.url=e,this.svgText=t,this.options=i}}let Wg=(()=>{class n{constructor(t,i,r,s){this._httpClient=t,this._sanitizer=i,this._errorHandler=s,this._svgIconConfigs=new Map,this._iconSetConfigs=new Map,this._cachedIconsByUrl=new Map,this._inProgressUrlFetches=new Map,this._fontCssClassesByAlias=new Map,this._resolvers=[],this._defaultFontSetClass=["material-icons","mat-ligature-font"],this._document=r}addSvgIcon(t,i,r){return this.addSvgIconInNamespace("",t,i,r)}addSvgIconLiteral(t,i,r){return this.addSvgIconLiteralInNamespace("",t,i,r)}addSvgIconInNamespace(t,i,r,s){return this._addSvgIconConfig(t,i,new pc(r,null,s))}addSvgIconResolver(t){return this._resolvers.push(t),this}addSvgIconLiteralInNamespace(t,i,r,s){const o=this._sanitizer.sanitize(Lt.HTML,r);if(!o)throw zN(r);const a=Hd(o);return this._addSvgIconConfig(t,i,new pc("",a,s))}addSvgIconSet(t,i){return this.addSvgIconSetInNamespace("",t,i)}addSvgIconSetLiteral(t,i){return this.addSvgIconSetLiteralInNamespace("",t,i)}addSvgIconSetInNamespace(t,i,r){return this._addSvgIconSetConfig(t,new pc(i,null,r))}addSvgIconSetLiteralInNamespace(t,i,r){const s=this._sanitizer.sanitize(Lt.HTML,i);if(!s)throw zN(i);const o=Hd(s);return this._addSvgIconSetConfig(t,new pc("",o,r))}registerFontClassAlias(t,i=t){return this._fontCssClassesByAlias.set(t,i),this}classNameForFontAlias(t){return this._fontCssClassesByAlias.get(t)||t}setDefaultFontSetClass(...t){return this._defaultFontSetClass=t,this}getDefaultFontSetClass(){return this._defaultFontSetClass}getSvgIconFromUrl(t){const i=this._sanitizer.sanitize(Lt.RESOURCE_URL,t);if(!i)throw UN(t);const r=this._cachedIconsByUrl.get(i);return r?Ve($g(r)):this._loadSvgIconFromConfig(new pc(t,null)).pipe(Gn(s=>this._cachedIconsByUrl.set(i,s)),tt(s=>$g(s)))}getNamedSvgIcon(t,i=""){const r=HN(i,t);let s=this._svgIconConfigs.get(r);if(s)return this._getSvgFromConfig(s);if(s=this._getIconConfigFromResolvers(i,t),s)return this._svgIconConfigs.set(r,s),this._getSvgFromConfig(s);const o=this._iconSetConfigs.get(i);return o?this._getSvgFromIconSetConfigs(t,o):ll(BN(r))}ngOnDestroy(){this._resolvers=[],this._svgIconConfigs.clear(),this._iconSetConfigs.clear(),this._cachedIconsByUrl.clear()}_getSvgFromConfig(t){return t.svgText?Ve($g(this._svgElementFromConfig(t))):this._loadSvgIconFromConfig(t).pipe(tt(i=>$g(i)))}_getSvgFromIconSetConfigs(t,i){const r=this._extractIconWithNameFromAnySet(t,i);return r?Ve(r):function Qk(...n){const e=pC(n),{args:t,keys:i}=tI(n),r=new Mn(s=>{const{length:o}=t;if(!o)return void s.complete();const a=new Array(o);let c=o,l=o;for(let u=0;u<o;u++){let h=!1;pr(t[u]).subscribe(Cn(s,d=>{h||(h=!0,l--),a[u]=d},()=>c--,void 0,()=>{(!c||!h)&&(l||s.next(i?iI(i,a):a),s.complete())}))}});return e?r.pipe(nI(e)):r}(i.filter(o=>!o.svgText).map(o=>this._loadSvgIconSetFromConfig(o).pipe(Xs(a=>{const l=`Loading icon set URL: ${this._sanitizer.sanitize(Lt.RESOURCE_URL,o.url)} failed: ${a.message}`;return this._errorHandler.handleError(new Error(l)),Ve(null)})))).pipe(tt(()=>{const o=this._extractIconWithNameFromAnySet(t,i);if(!o)throw BN(t);return o}))}_extractIconWithNameFromAnySet(t,i){for(let r=i.length-1;r>=0;r--){const s=i[r];if(s.svgText&&s.svgText.toString().indexOf(t)>-1){const o=this._svgElementFromConfig(s),a=this._extractSvgIconFromSet(o,t,s.options);if(a)return a}}return null}_loadSvgIconFromConfig(t){return this._fetchIcon(t).pipe(Gn(i=>t.svgText=i),tt(()=>this._svgElementFromConfig(t)))}_loadSvgIconSetFromConfig(t){return t.svgText?Ve(null):this._fetchIcon(t).pipe(Gn(i=>t.svgText=i))}_extractSvgIconFromSet(t,i,r){const s=t.querySelector(`[id="${i}"]`);if(!s)return null;const o=s.cloneNode(!0);if(o.removeAttribute("id"),"svg"===o.nodeName.toLowerCase())return this._setSvgAttributes(o,r);if("symbol"===o.nodeName.toLowerCase())return this._setSvgAttributes(this._toSvgElement(o),r);const a=this._svgElementFromString(Hd("<svg></svg>"));return a.appendChild(o),this._setSvgAttributes(a,r)}_svgElementFromString(t){const i=this._document.createElement("DIV");i.innerHTML=t;const r=i.querySelector("svg");if(!r)throw Error("<svg> tag not found");return r}_toSvgElement(t){const i=this._svgElementFromString(Hd("<svg></svg>")),r=t.attributes;for(let s=0;s<r.length;s++){const{name:o,value:a}=r[s];"id"!==o&&i.setAttribute(o,a)}for(let s=0;s<t.childNodes.length;s++)t.childNodes[s].nodeType===this._document.ELEMENT_NODE&&i.appendChild(t.childNodes[s].cloneNode(!0));return i}_setSvgAttributes(t,i){return t.setAttribute("fit",""),t.setAttribute("height","100%"),t.setAttribute("width","100%"),t.setAttribute("preserveAspectRatio","xMidYMid meet"),t.setAttribute("focusable","false"),i&&i.viewBox&&t.setAttribute("viewBox",i.viewBox),t}_fetchIcon(t){const{url:i,options:r}=t,s=r?.withCredentials??!1;if(!this._httpClient)throw function ine(){return Error("Could not find HttpClient provider for use with Angular Material icons. Please include the HttpClientModule from @angular/common/http in your app imports.")}();if(null==i)throw Error(`Cannot fetch icon from URL "${i}".`);const o=this._sanitizer.sanitize(Lt.RESOURCE_URL,i);if(!o)throw UN(i);const a=this._inProgressUrlFetches.get(o);if(a)return a;const c=this._httpClient.get(o,{responseType:"text",withCredentials:s}).pipe(tt(l=>Hd(l)),Op(()=>this._inProgressUrlFetches.delete(o)),yC());return this._inProgressUrlFetches.set(o,c),c}_addSvgIconConfig(t,i,r){return this._svgIconConfigs.set(HN(t,i),r),this}_addSvgIconSetConfig(t,i){const r=this._iconSetConfigs.get(t);return r?r.push(i):this._iconSetConfigs.set(t,[i]),this}_svgElementFromConfig(t){if(!t.svgElement){const i=this._svgElementFromString(t.svgText);this._setSvgAttributes(i,t.options),t.svgElement=i}return t.svgElement}_getIconConfigFromResolvers(t,i){for(let r=0;r<this._resolvers.length;r++){const s=this._resolvers[r](i,t);if(s)return sne(s)?new pc(s.url,null,s.options):new pc(s,null)}}}return n.\u0275fac=function(t){return new(t||n)(le(pM,8),le(j0),le(hn,8),le(Bs))},n.\u0275prov=Te({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();function $g(n){return n.cloneNode(!0)}function HN(n,e){return n+":"+e}function sne(n){return!(!n.url||!n.options)}const one=vN(class{constructor(n){this._elementRef=n}}),ane=new xe("MAT_ICON_DEFAULT_OPTIONS"),cne=new xe("mat-icon-location",{providedIn:"root",factory:function lne(){const n=Ot(hn),e=n?n.location:null;return{getPathname:()=>e?e.pathname+e.search:""}}}),GN=["clip-path","color-profile","src","cursor","fill","filter","marker","marker-start","marker-mid","marker-end","mask","stroke"],une=GN.map(n=>`[${n}]`).join(", "),hne=/^url\(['"]?#(.*?)['"]?\)$/;let qg=(()=>{class n extends one{constructor(t,i,r,s,o,a){super(t),this._iconRegistry=i,this._location=s,this._errorHandler=o,this._inline=!1,this._previousFontSetClass=[],this._currentIconFetch=Ni.EMPTY,a&&(a.color&&(this.color=this.defaultColor=a.color),a.fontSet&&(this.fontSet=a.fontSet)),r||t.nativeElement.setAttribute("aria-hidden","true")}get inline(){return this._inline}set inline(t){this._inline=fc(t)}get svgIcon(){return this._svgIcon}set svgIcon(t){t!==this._svgIcon&&(t?this._updateSvgIcon(t):this._svgIcon&&this._clearSvgElement(),this._svgIcon=t)}get fontSet(){return this._fontSet}set fontSet(t){const i=this._cleanupFontValue(t);i!==this._fontSet&&(this._fontSet=i,this._updateFontIconClasses())}get fontIcon(){return this._fontIcon}set fontIcon(t){const i=this._cleanupFontValue(t);i!==this._fontIcon&&(this._fontIcon=i,this._updateFontIconClasses())}_splitIconName(t){if(!t)return["",""];const i=t.split(":");switch(i.length){case 1:return["",i[0]];case 2:return i;default:throw Error(`Invalid icon name: "${t}"`)}}ngOnInit(){this._updateFontIconClasses()}ngAfterViewChecked(){const t=this._elementsWithExternalReferences;if(t&&t.size){const i=this._location.getPathname();i!==this._previousPath&&(this._previousPath=i,this._prependPathToReferences(i))}}ngOnDestroy(){this._currentIconFetch.unsubscribe(),this._elementsWithExternalReferences&&this._elementsWithExternalReferences.clear()}_usingFontIcon(){return!this.svgIcon}_setSvgElement(t){this._clearSvgElement();const i=this._location.getPathname();this._previousPath=i,this._cacheChildrenWithExternalReferences(t),this._prependPathToReferences(i),this._elementRef.nativeElement.appendChild(t)}_clearSvgElement(){const t=this._elementRef.nativeElement;let i=t.childNodes.length;for(this._elementsWithExternalReferences&&this._elementsWithExternalReferences.clear();i--;){const r=t.childNodes[i];(1!==r.nodeType||"svg"===r.nodeName.toLowerCase())&&r.remove()}}_updateFontIconClasses(){if(!this._usingFontIcon())return;const t=this._elementRef.nativeElement,i=(this.fontSet?this._iconRegistry.classNameForFontAlias(this.fontSet).split(/ +/):this._iconRegistry.getDefaultFontSetClass()).filter(r=>r.length>0);this._previousFontSetClass.forEach(r=>t.classList.remove(r)),i.forEach(r=>t.classList.add(r)),this._previousFontSetClass=i,this.fontIcon!==this._previousFontIconClass&&!i.includes("mat-ligature-font")&&(this._previousFontIconClass&&t.classList.remove(this._previousFontIconClass),this.fontIcon&&t.classList.add(this.fontIcon),this._previousFontIconClass=this.fontIcon)}_cleanupFontValue(t){return"string"==typeof t?t.trim().split(" ")[0]:t}_prependPathToReferences(t){const i=this._elementsWithExternalReferences;i&&i.forEach((r,s)=>{r.forEach(o=>{s.setAttribute(o.name,`url('${t}#${o.value}')`)})})}_cacheChildrenWithExternalReferences(t){const i=t.querySelectorAll(une),r=this._elementsWithExternalReferences=this._elementsWithExternalReferences||new Map;for(let s=0;s<i.length;s++)GN.forEach(o=>{const a=i[s],c=a.getAttribute(o),l=c?c.match(hne):null;if(l){let u=r.get(a);u||(u=[],r.set(a,u)),u.push({name:o,value:l[1]})}})}_updateSvgIcon(t){if(this._svgNamespace=null,this._svgName=null,this._currentIconFetch.unsubscribe(),t){const[i,r]=this._splitIconName(t);i&&(this._svgNamespace=i),r&&(this._svgName=r),this._currentIconFetch=this._iconRegistry.getNamedSvgIcon(r,i).pipe(Da(1)).subscribe(s=>this._setSvgElement(s),s=>{this._errorHandler.handleError(new Error(`Error retrieving icon ${i}:${r}! ${s.message}`))})}}}return n.\u0275fac=function(t){return new(t||n)(j(oi),j(Wg),kc("aria-hidden"),j(cne),j(Bs),j(ane,8))},n.\u0275cmp=ii({type:n,selectors:[["mat-icon"]],hostAttrs:["role","img",1,"mat-icon","notranslate"],hostVars:8,hostBindings:function(t,i){2&t&&(er("data-mat-icon-type",i._usingFontIcon()?"font":"svg")("data-mat-icon-name",i._svgName||i.fontIcon)("data-mat-icon-namespace",i._svgNamespace||i.fontSet)("fontIcon",i._usingFontIcon()?i.fontIcon:null),yn("mat-icon-inline",i.inline)("mat-icon-no-color","primary"!==i.color&&"accent"!==i.color&&"warn"!==i.color))},inputs:{color:"color",inline:"inline",svgIcon:"svgIcon",fontSet:"fontSet",fontIcon:"fontIcon"},exportAs:["matIcon"],features:[Pt],ngContentSelectors:tne,decls:1,vars:0,template:function(t,i){1&t&&(Rv(),Ov(0))},styles:[".mat-icon{-webkit-user-select:none;user-select:none;background-repeat:no-repeat;display:inline-block;fill:currentColor;height:24px;width:24px;overflow:hidden}.mat-icon.mat-icon-inline{font-size:inherit;height:inherit;line-height:inherit;width:inherit}.mat-icon.mat-ligature-font[fontIcon]::before{content:attr(fontIcon)}[dir=rtl] .mat-icon-rtl-mirror{transform:scale(-1, 1)}.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-prefix .mat-icon,.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-suffix .mat-icon{display:block}.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-prefix .mat-icon-button .mat-icon,.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-suffix .mat-icon-button .mat-icon{margin:auto}"],encapsulation:2,changeDetection:0}),n})(),dne=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=bi({type:n}),n.\u0275inj=hi({imports:[wu,wu]}),n})();function fne(n,e){if(1&n){const t=Gs();W(0,"div",14)(1,"div",15)(2,"p",16),Ce(3),Y(),it(4,"div",17),Y(),W(5,"div",18)(6,"mat-checkbox",19),Oe("click",function(){const s=Ur(t).$implicit;return zr(Sn().toggleRootHighlight(s))}),Y()(),W(7,"div",20)(8,"mat-checkbox",19),Oe("click",function(){const s=Ur(t).$implicit;return zr(Sn().toggleHyperplane(s))}),Y()()()}if(2&n){const t=e.$implicit,i=Sn();ge(3),br(t.name),ge(1),ls("background-color",i.getColor(t)),ge(2),Ge("checked",i.rootHighlighted(t)&&i.getCurrentColorMode()==i.RootSystemColorMode.highlight),ge(2),Ge("checked",i.hyperplaneToRootHighlighted(t))}}class Xg{constructor(e,t,i){this.rootSystemService=e,this.rootSystemPainter=t,this.cd=i,this.RootSystemColorMode=Zn,this.rootSystemColors=[],this.Colors=de,this.isExpanded=!0,this.rootListForDisplay=[],this.rootSystemService.repaintEvent.subscribe(()=>{this.rootSystemColors=Ar[e.rootSystem.type],this.roots=this.rootSystemService.getPositiveRoots(),this.cd.detectChanges()}),this.rootSystemColors=Ar[e.rootSystem.type],this.roots=this.rootSystemService.getPositiveRoots()}toggleExpand(){this.isExpanded=!this.isExpanded}ngOnInit(){}switchHighlightMode(e){e==this.getCurrentColorMode()?this.rootSystemPainter.switchColorMode(Zn.highlight):this.rootSystemPainter.switchColorMode(e)}toggleRootHighlight(e){this.rootSystemPainter.switchColorMode(Zn.highlight),this.rootSystemPainter.rootIsHighlighted(e)?this.rootSystemPainter.removeHighlightFromRoot(e):this.rootSystemPainter.highlightRoot(e)}hyperplaneToRootHighlighted(e){return this.rootSystemPainter.hyperplaneToRootHighlighted(e)}rootHighlighted(e){return this.rootSystemPainter.rootIsHighlighted(e)}getPositiveRoots(){return this.rootSystemService.rootSystem.getPositiveRoots()}toggleHyperplane(e){this.rootSystemPainter.hyperplaneToRootHighlighted(e)?this.rootSystemPainter.removeHighlightOfHyperplaneToRoot(e):this.rootSystemPainter.highlightHyperplaneToRoot(e)}allRootsHighlighted(){return this.rootSystemPainter.allRootsHighlighted()}allHyperplanesHighlighted(){return this.rootSystemPainter.allHyperplanesHighlighted()}toggleAllRootsHighlighted(){this.allRootsHighlighted()?this.rootSystemPainter.clearRootHighlight():(this.rootSystemPainter.highlightAllRoots(),this.rootSystemPainter.switchColorMode(Zn.highlight))}toggleAllRootsHyperplanes(){this.allHyperplanesHighlighted()?this.rootSystemPainter.clearHyperplaneHighlight():this.rootSystemPainter.highlightAllHyperplanes()}getColor(e){return this.rootSystemColors[this.roots.findIndex(t=>t.equal(e))]}getCurrentColorMode(){return this.rootSystemPainter.colorMode}getDividedRootListForDisplay(){let e=[],t=0,i=-1;for(;t<=this.roots.length-1;)t%10==0&&t!=this.roots.length-1&&(i+=1,e.push([])),e[i].push(this.roots[t]),t+=1;return e}static#e=this.\u0275fac=function(t){return new(t||Xg)(j(Ss),j(yu),j(Mo))};static#t=this.\u0275cmp=ii({type:Xg,selectors:[["app-object-selector2-d"]],decls:40,vars:8,consts:[["id","object-selector-panel"],["id","expand-button"],[3,"fontIcon","click"],["id","heading"],["id","inner-content"],["id","type-selection-container"],[1,"switch-mode-item"],[3,"checked","change"],[1,"switch-mode-text"],[1,"divider"],[1,"subsection-heading"],["id","highlight-table"],[1,"highlight-table-column"],[1,"highlight-table-header"],[1,"object-highlight-item"],[1,"root-vector"],[1,"root-vector-text"],[1,"root-vector-background"],[1,"highlight-toggle"],[3,"checked","click"],[1,"hyperplane-toggle"],["class","object-highlight-item",4,"ngFor","ngForOf"]],template:function(t,i){1&t&&(W(0,"div",0)(1,"button",1)(2,"mat-icon",2),Oe("click",function(){return i.toggleExpand()}),Y()(),W(3,"h3",3),Ce(4,"Highlight"),Y(),W(5,"div",4)(6,"div",5)(7,"div",6)(8,"mat-checkbox",7),Oe("change",function(){return i.switchHighlightMode(i.RootSystemColorMode.base)}),Y(),W(9,"p",8),Ce(10,"Base"),Y()(),W(11,"div",6)(12,"mat-checkbox",7),Oe("change",function(){return i.switchHighlightMode(i.RootSystemColorMode.positiveRoots)}),Y(),W(13,"p",8),Ce(14,"Positive roots"),Y()(),W(15,"div",6)(16,"mat-checkbox",7),Oe("change",function(){return i.switchHighlightMode(i.RootSystemColorMode.highlight)}),Y(),W(17,"p",8),Ce(18,"Custom Highlight"),Y()()(),it(19,"div",9),W(20,"h4",10),Ce(21,"Highlight specific object"),Y(),W(22,"div",11)(23,"div",12)(24,"div",13),it(25,"p"),W(26,"p"),Ce(27,"Root (+,-)"),Y(),W(28,"p"),Ce(29,"Hyperplanes"),Y()(),W(30,"div",14)(31,"div",15)(32,"p",16),Ce(33,"All"),Y(),it(34,"div",17),Y(),W(35,"div",18)(36,"mat-checkbox",19),Oe("click",function(){return i.toggleAllRootsHighlighted()}),Y()(),W(37,"div",20)(38,"mat-checkbox",19),Oe("click",function(){return i.toggleAllRootsHyperplanes()}),Y()()(),Si(39,fne,9,5,"div",21),Y()()()()),2&t&&(ge(2),Ge("fontIcon",i.isExpanded?"expand_more":"expand_less"),ge(3),Ge("@expanded",i.isExpanded),ge(3),Ge("checked",i.getCurrentColorMode()==i.RootSystemColorMode.base),ge(4),Ge("checked",i.getCurrentColorMode()==i.RootSystemColorMode.positiveRoots),ge(4),Ge("checked",i.getCurrentColorMode()==i.RootSystemColorMode.highlight),ge(20),Ge("checked",i.allRootsHighlighted()),ge(2),Ge("checked",i.allHyperplanesHighlighted()),ge(1),Ge("ngForOf",i.roots))},dependencies:[Eh,Ud,qg],styles:["#object-selector-panel[_ngcontent-%COMP%]{position:absolute;left:16px;bottom:16px;height:max-content;width:max-content;padding:16px;box-sizing:border-box;background-color:#fff;border-radius:8px;shadow:var(--light-shadow);display:grid;align-content:flex-start;justify-content:stretch;align-items:flex-start}#object-selector-panel[_ngcontent-%COMP%]   #inner-content[_ngcontent-%COMP%]{overflow:hidden}#object-selector-panel[_ngcontent-%COMP%]   #expand-button[_ngcontent-%COMP%]{position:absolute;top:8px;right:12px;color:var(--text-medium);background-color:#fff;border:none;border-radius:50%;transition:all .15s;height:36px;display:grid;justify-content:center;align-content:center;cursor:pointer;width:36px}#object-selector-panel[_ngcontent-%COMP%]   #expand-button[_ngcontent-%COMP%]:hover{background-color:var(--purple-light)}#object-selector-panel[_ngcontent-%COMP%]   #heading[_ngcontent-%COMP%]{font-size:16px;font-weight:700;margin:0 0 4px;padding:0;color:var(--text-dark)}#object-selector-panel[_ngcontent-%COMP%]   .subheading[_ngcontent-%COMP%]{font-size:13px;font-weight:600;margin:0;padding:0;color:var(--text-light)}#object-selector-panel[_ngcontent-%COMP%]   .subsection-heading[_ngcontent-%COMP%]{font-size:14px;font-weight:600;margin:0;padding:0;color:var(--text-medium)}#object-selector-panel[_ngcontent-%COMP%]   #type-selection-container[_ngcontent-%COMP%]{padding:8px 0;display:grid;grid-template-rows:max-content}#object-selector-panel[_ngcontent-%COMP%]   #type-selection-container[_ngcontent-%COMP%]   .switch-mode-item[_ngcontent-%COMP%]{display:grid;grid-template-columns:max-content 1fr;align-items:center}#object-selector-panel[_ngcontent-%COMP%]   #type-selection-container[_ngcontent-%COMP%]   .switch-mode-item[_ngcontent-%COMP%]   .switch-mode-text[_ngcontent-%COMP%]{font-size:13px;color:var(--text-medium);font-weight:600;margin:0;padding:0}#object-selector-panel[_ngcontent-%COMP%]   .divider[_ngcontent-%COMP%]{height:1px;margin:4px 0 12px;width:100%;background-color:var(--purple-light)}#object-selector-panel[_ngcontent-%COMP%]   #highlight-table[_ngcontent-%COMP%]{display:grid;grid-auto-flow:column}#object-selector-panel[_ngcontent-%COMP%]   .highlight-table-column[_ngcontent-%COMP%]{grid-template-rows:repeat(8,max-content);row-gap:4px;grid-auto-flow:column;padding-left:16px}#object-selector-panel[_ngcontent-%COMP%]   .highlight-table-column[_ngcontent-%COMP%]:not(#object-selector-panel   .highlight-table-column[_ngcontent-%COMP%]:first-of-type){border-left:var(--border-thin)}#object-selector-panel[_ngcontent-%COMP%]   .highlight-table-header[_ngcontent-%COMP%]{margin-top:8px;display:grid;grid-template-columns:70px 64px 128px;justify-items:center}#object-selector-panel[_ngcontent-%COMP%]   .highlight-table-header[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:var(--text-light);padding:0;margin:0;font-size:13px;font-weight:600}#object-selector-panel[_ngcontent-%COMP%]   .object-highlight-item[_ngcontent-%COMP%]{display:grid;grid-template-columns:70px 64px 128px;align-items:center}#object-selector-panel[_ngcontent-%COMP%]   .object-highlight-item[_ngcontent-%COMP%]   .root-vector[_ngcontent-%COMP%]{position:relative;height:max-content;width:64px;display:grid;justify-content:center}#object-selector-panel[_ngcontent-%COMP%]   .object-highlight-item[_ngcontent-%COMP%]   .root-vector[_ngcontent-%COMP%]   .root-vector-text[_ngcontent-%COMP%]{display:block;position:relative;z-index:1;font-size:14px;padding:4px;margin:0;cursor:pointer;font-weight:500}#object-selector-panel[_ngcontent-%COMP%]   .object-highlight-item[_ngcontent-%COMP%]   .root-vector[_ngcontent-%COMP%]   .root-vector-background[_ngcontent-%COMP%]{opacity:.6;position:absolute;top:0;left:0;height:100%;width:100%;border-radius:4px}#object-selector-panel[_ngcontent-%COMP%]   .object-highlight-item[_ngcontent-%COMP%]   .highlight-toggle[_ngcontent-%COMP%], #object-selector-panel[_ngcontent-%COMP%]   .object-highlight-item[_ngcontent-%COMP%]   .hyperplane-toggle[_ngcontent-%COMP%]{justify-self:center}"],data:{animation:[Dg("expanded",[Es("true",Ir({height:"*"})),Es("false",Ir({height:"0"})),Ag("* => *",[Tg("125ms ease-in-out")])])]},changeDetection:0})}function pne(n,e){if(1&n&&(W(0,"p"),Ce(1),Y()),2&n){const t=e.$implicit;ge(1),br(t)}}function mne(n,e){if(1&n){const t=Gs();W(0,"div",32),Oe("click",function(){const s=Ur(t).$implicit;return zr(Sn().mirrorWithRoot(s))}),W(1,"div",33)(2,"p",34),Ce(3),Y(),it(4,"div",35),Y()()}if(2&n){const t=e.$implicit,i=Sn();ge(3),br(t.name),ge(1),ls("background-color",i.getColor(t))}}function gne(n,e){if(1&n){const t=Gs();W(0,"div",32),Oe("click",function(){const s=Ur(t).$implicit;return zr(Sn().mirrorWithRoot(s))}),W(1,"div",33)(2,"p",34),Ce(3),Y(),it(4,"div",35),Y()()}if(2&n){const t=e.$implicit,i=Sn();ge(3),br(t.name),ge(1),ls("background-color",i.getColor(t))}}function _ne(n,e){1&n&&(W(0,"p",36),Ce(1," (None applied) "),Y())}function yne(n,e){if(1&n){const t=Gs();W(0,"div",32),Oe("click",function(){const s=Ur(t).$implicit;return zr(Sn().mirrorWithRoot(s))}),W(1,"div",33)(2,"p",34),Ce(3),Y(),it(4,"div",35),Y()()}if(2&n){const t=e.$implicit,i=Sn();ge(3),br(t.name),ge(1),ls("background-color",i.getColor(t))}}function vne(n,e){if(1&n&&(W(0,"p",37),Ce(1),Y()),2&n){const t=Sn();ge(1),dh(" (Length: ",t.getLength(),") ")}}const bne=function(n,e,t){return{matrix3:n,matrix2:e,matrix1:t}};class Yg{constructor(e,t,i){this.rootSystemService=e,this.cd=t,this.transformService=i,this.rootSystemColors=[],this.rootsToAppliedMirrorings=[],this.isExpanded=!0,this.moreInformationShown=!1,this.rootSystemService.repaintEvent.subscribe(()=>{this.resetTransformations(),this.rootSystemColors=Ar[e.rootSystem.type],this.roots=this.getRoots(),t.detectChanges()}),this.transformService.transformationChanged.subscribe(()=>{this.getAppliedMirrorings(),this.cd.detectChanges()}),this.roots=this.getRoots(),this.rootSystemColors=Ar[e.rootSystem.type]}toggleExpand(){this.isExpanded=!this.isExpanded}toggleMoreInformation(){this.moreInformationShown=!this.moreInformationShown}toggleObjectActedOn(e){this.transformService.transformationAppliedTo(e)?this.transformService.removeTransformedObjectType(e):this.transformService.addTransformedObjectType(e),this.cd.detectChanges()}transformationAppliedTo(e){return this.transformService.transformationAppliedTo(e)}getRoots(){return this.rootSystemService.rootSystem.getPositiveRoots()}getPositiveRootsWithoutBase(){return this.getRoots().filter(e=>!e.isSimple)}getCoxeterMatrix(){return this.rootSystemService.rootSystem.getCoxeterMatrix()}getBase(){return this.rootSystemService.getBase()}getColor(e){return this.rootSystemColors[this.roots.findIndex(t=>t.equal(e))]}getLength(){return this.rootSystemService.rootSystem.getLengthOfTransformation(this.transformService.currentTranformation)}mirrorWithRoot(e){this.transformService.mirrorOnPlaneOfRoot(e)}getAppliedMirrorings(){this.rootsToAppliedMirrorings=[...this.transformService.appliedMirrorings].reverse()}resetTransformations(){this.transformService.resetTransformation()}static#e=this.\u0275fac=function(t){return new(t||Yg)(j(Ss),j(Mo),j(Xo))};static#t=this.\u0275cmp=ii({type:Yg,selectors:[["app-object-transformer-panel2-d"]],decls:60,vars:18,consts:[["id","object-selector-panel"],["id","heading"],["id","expand-button"],[3,"fontIcon","click"],["id","inner-content"],["id","more-information",3,"click"],["id","more-information-header"],["id","more-information-text"],["id","more-information-toggle-button"],[3,"fontIcon"],["id","content-wrapper"],["id","information-container"],[1,"information-item"],[1,"information-item-text"],[3,"ngClass"],[1,"matrix-bracket-left"],[4,"ngFor","ngForOf"],[1,"matrix-bracket-right"],[1,"divider"],[1,"description-text"],["id","action-on-table"],[1,"action-object"],[3,"checked","click"],[1,"action-object-text"],[1,"sub-description-text"],[1,"mirror-root-container"],["class","mirror-root-item",3,"click",4,"ngFor","ngForOf"],["id","applied-mirrorings-container"],["id","reflection-placeholder-text",4,"ngIf"],["id","mirrorings"],["id","length-text",4,"ngIf"],["id","reset-button",3,"click"],[1,"mirror-root-item",3,"click"],[1,"root-vector"],[1,"root-vector-text"],[1,"root-vector-background"],["id","reflection-placeholder-text"],["id","length-text"]],template:function(t,i){1&t&&(W(0,"div",0)(1,"h3",1),Ce(2,"Transform"),Y(),W(3,"button",2)(4,"mat-icon",3),Oe("click",function(){return i.toggleExpand()}),Y()(),W(5,"div",4)(6,"div",5),Oe("click",function(){return i.toggleMoreInformation()}),W(7,"div",6)(8,"h5",7),Ce(9,"More Information"),Y(),W(10,"button",8),it(11,"mat-icon",9),Y()(),W(12,"div",10)(13,"div",11)(14,"div",12)(15,"p",13),Ce(16,"Coxeter Matrix"),Y(),W(17,"div",14)(18,"div",15),Ce(19,"["),Y(),Si(20,pne,2,1,"p",16),W(21,"div",17),Ce(22,"]"),Y()()()()()(),it(23,"div",18),W(24,"p",19),Ce(25,"Have Weyl Group act on:"),Y(),W(26,"div",20)(27,"div",21)(28,"mat-checkbox",22),Oe("click",function(){return i.toggleObjectActedOn("ROOTS")}),Y(),W(29,"p",23),Ce(30,"Roots"),Y()(),W(31,"div",21)(32,"mat-checkbox",22),Oe("click",function(){return i.toggleObjectActedOn("WEYL_CHAMBERS")}),Y(),W(33,"p",23),Ce(34,"Weyl Chambers"),Y()(),W(35,"div",21)(36,"mat-checkbox",22),Oe("click",function(){return i.toggleObjectActedOn("HYPERPLANES")}),Y(),W(37,"p",23),Ce(38,"Hyperplanes"),Y()()(),it(39,"div",18),W(40,"p",19),Ce(41,"Mirror at hyperplane orthogonal to root:"),Y(),W(42,"p",24),Ce(43,"Base:"),Y(),W(44,"div",25),Si(45,mne,5,3,"div",26),Y(),W(46,"p",24),Ce(47,"Other positive roots:"),Y(),W(48,"div",25),Si(49,gne,5,3,"div",26),Y(),it(50,"div",18),W(51,"p",19),Ce(52,"Applied relections:"),Y(),W(53,"div",27),Si(54,_ne,2,0,"p",28),W(55,"div",29),Si(56,yne,5,3,"div",26),Y(),Si(57,vne,2,1,"p",30),W(58,"div",31),Oe("click",function(){return i.resetTransformations()}),Ce(59,"Reset"),Y()()()()),2&t&&(ge(4),Ge("fontIcon",i.isExpanded?"expand_more":"expand_less"),ge(1),Ge("@expanded",i.isExpanded),ge(6),Ge("fontIcon",i.moreInformationShown?"expand_less":"expand_more"),ge(2),Ge("@expanded",i.moreInformationShown),ge(4),Ge("ngClass",eT(14,bne,9==i.getCoxeterMatrix().length,4==i.getCoxeterMatrix().length,1==i.getCoxeterMatrix().length)),ge(3),Ge("ngForOf",i.getCoxeterMatrix()),ge(8),Ge("checked",i.transformationAppliedTo("ROOTS")),ge(4),Ge("checked",i.transformationAppliedTo("WEYL_CHAMBERS")),ge(4),Ge("checked",i.transformationAppliedTo("HYPERPLANES")),ge(9),Ge("ngForOf",i.getBase()),ge(4),Ge("ngForOf",i.getPositiveRootsWithoutBase()),ge(5),Ge("ngIf",0==i.rootsToAppliedMirrorings.length),ge(2),Ge("ngForOf",i.rootsToAppliedMirrorings),ge(1),Ge("ngIf",0!=i.rootsToAppliedMirrorings.length))},dependencies:[xA,Eh,P0,Ud,qg],styles:["#object-selector-panel[_ngcontent-%COMP%]{position:absolute;right:16px;bottom:16px;height:max-content;width:400px;padding:16px;box-sizing:border-box;background-color:#fff;border-radius:8px;shadow:var(--light-shadow);display:grid;align-content:flex-start;justify-content:stretch;align-items:flex-start}#object-selector-panel[_ngcontent-%COMP%]   #inner-content[_ngcontent-%COMP%]{overflow:hidden}#object-selector-panel[_ngcontent-%COMP%]   #expand-button[_ngcontent-%COMP%]{position:absolute;top:8px;right:12px;color:var(--text-medium);background-color:#fff;border:none;border-radius:50%;transition:all .15s;height:36px;display:grid;justify-content:center;align-content:center;cursor:pointer;width:36px}#object-selector-panel[_ngcontent-%COMP%]   #expand-button[_ngcontent-%COMP%]:hover{background-color:var(--purple-light)}#object-selector-panel[_ngcontent-%COMP%]   #heading[_ngcontent-%COMP%]{font-size:16px;font-weight:700;margin:0 0 4px;padding:0;color:var(--text-dark)}#object-selector-panel[_ngcontent-%COMP%]   .subheading[_ngcontent-%COMP%]{font-size:13px;font-weight:600;margin:0;padding:0;color:var(--text-light)}#object-selector-panel[_ngcontent-%COMP%]   .subsection-heading[_ngcontent-%COMP%]{font-size:14px;font-weight:600;margin:0;padding:0;color:var(--text-medium)}#object-selector-panel[_ngcontent-%COMP%]   .description-text[_ngcontent-%COMP%]{font-size:14px;font-weight:600;margin:8px 0 0;padding:0;color:var(--text-dark)}#object-selector-panel[_ngcontent-%COMP%]   #length-text[_ngcontent-%COMP%]{font-size:14px;font-style:italic;font-weight:500;color:var(--text-light);display:block;width:100%;box-sizing:border-box;text-align:right;padding-right:8px}#object-selector-panel[_ngcontent-%COMP%]   #reflection-placeholder-text[_ngcontent-%COMP%]{font-size:14px;font-weight:400;color:var(--text-light);padding:0;margin:0}#object-selector-panel[_ngcontent-%COMP%]   .sub-description-text[_ngcontent-%COMP%]{color:var(--text-light);margin:0;font-size:13px;font-weight:600;padding:0}#object-selector-panel[_ngcontent-%COMP%]   #more-information[_ngcontent-%COMP%]{background-color:var(--purple-light);padding:8px;margin-top:8px;border-radius:4px}#object-selector-panel[_ngcontent-%COMP%]   #more-information[_ngcontent-%COMP%]   #more-information-header[_ngcontent-%COMP%]{position:relative;display:grid;align-content:center;align-items:center;height:24px;border:1px solid var(--purple-light);cursor:pointer}#object-selector-panel[_ngcontent-%COMP%]   #more-information[_ngcontent-%COMP%]   #more-information-header[_ngcontent-%COMP%]   #more-information-text[_ngcontent-%COMP%]{font-size:13px;color:var(--text-medium);font-weight:700;margin:0;padding:0}#object-selector-panel[_ngcontent-%COMP%]   #more-information[_ngcontent-%COMP%]   #more-information-header[_ngcontent-%COMP%]   #more-information-toggle-button[_ngcontent-%COMP%]{right:12px;position:absolute;top:0;border:none;background-color:transparent;border-radius:50%;height:16px;width:16px;color:var(--text-medium);cursor:pointer}#object-selector-panel[_ngcontent-%COMP%]   #more-information[_ngcontent-%COMP%]   #content-wrapper[_ngcontent-%COMP%]{overflow:hidden}#object-selector-panel[_ngcontent-%COMP%]   #more-information[_ngcontent-%COMP%]   #content-wrapper[_ngcontent-%COMP%]   #information-container[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(3,1fr)}#object-selector-panel[_ngcontent-%COMP%]   #more-information[_ngcontent-%COMP%]   #content-wrapper[_ngcontent-%COMP%]   #information-container[_ngcontent-%COMP%]   .information-item[_ngcontent-%COMP%]{display:grid;justify-items:center;padding-bottom:16px}#object-selector-panel[_ngcontent-%COMP%]   #more-information[_ngcontent-%COMP%]   #content-wrapper[_ngcontent-%COMP%]   #information-container[_ngcontent-%COMP%]   .information-item[_ngcontent-%COMP%]   .information-item-text[_ngcontent-%COMP%]{font-size:13px;color:var(--text-dark);font-weight:700}#object-selector-panel[_ngcontent-%COMP%]   #more-information[_ngcontent-%COMP%]   #content-wrapper[_ngcontent-%COMP%]   #information-container[_ngcontent-%COMP%]   .information-item[_ngcontent-%COMP%]   .matrix3[_ngcontent-%COMP%], #object-selector-panel[_ngcontent-%COMP%]   #more-information[_ngcontent-%COMP%]   #content-wrapper[_ngcontent-%COMP%]   #information-container[_ngcontent-%COMP%]   .information-item[_ngcontent-%COMP%]   .matrix2[_ngcontent-%COMP%], #object-selector-panel[_ngcontent-%COMP%]   #more-information[_ngcontent-%COMP%]   #content-wrapper[_ngcontent-%COMP%]   #information-container[_ngcontent-%COMP%]   .information-item[_ngcontent-%COMP%]   .matrix1[_ngcontent-%COMP%]{display:grid;grid-template-columns:16px 16px 16px;column-gap:6px;position:relative;margin-left:4px;box-sizing:border-box;width:max-content}#object-selector-panel[_ngcontent-%COMP%]   #more-information[_ngcontent-%COMP%]   #content-wrapper[_ngcontent-%COMP%]   #information-container[_ngcontent-%COMP%]   .information-item[_ngcontent-%COMP%]   .matrix3.matrix2[_ngcontent-%COMP%], #object-selector-panel[_ngcontent-%COMP%]   #more-information[_ngcontent-%COMP%]   #content-wrapper[_ngcontent-%COMP%]   #information-container[_ngcontent-%COMP%]   .information-item[_ngcontent-%COMP%]   .matrix2.matrix2[_ngcontent-%COMP%], #object-selector-panel[_ngcontent-%COMP%]   #more-information[_ngcontent-%COMP%]   #content-wrapper[_ngcontent-%COMP%]   #information-container[_ngcontent-%COMP%]   .information-item[_ngcontent-%COMP%]   .matrix1.matrix2[_ngcontent-%COMP%]{grid-template-columns:16px 16px}#object-selector-panel[_ngcontent-%COMP%]   #more-information[_ngcontent-%COMP%]   #content-wrapper[_ngcontent-%COMP%]   #information-container[_ngcontent-%COMP%]   .information-item[_ngcontent-%COMP%]   .matrix3.matrix2[_ngcontent-%COMP%]   .matrix-bracket-left[_ngcontent-%COMP%], #object-selector-panel[_ngcontent-%COMP%]   #more-information[_ngcontent-%COMP%]   #content-wrapper[_ngcontent-%COMP%]   #information-container[_ngcontent-%COMP%]   .information-item[_ngcontent-%COMP%]   .matrix3.matrix2[_ngcontent-%COMP%]   .matrix-bracket-right[_ngcontent-%COMP%], #object-selector-panel[_ngcontent-%COMP%]   #more-information[_ngcontent-%COMP%]   #content-wrapper[_ngcontent-%COMP%]   #information-container[_ngcontent-%COMP%]   .information-item[_ngcontent-%COMP%]   .matrix2.matrix2[_ngcontent-%COMP%]   .matrix-bracket-left[_ngcontent-%COMP%], #object-selector-panel[_ngcontent-%COMP%]   #more-information[_ngcontent-%COMP%]   #content-wrapper[_ngcontent-%COMP%]   #information-container[_ngcontent-%COMP%]   .information-item[_ngcontent-%COMP%]   .matrix2.matrix2[_ngcontent-%COMP%]   .matrix-bracket-right[_ngcontent-%COMP%], #object-selector-panel[_ngcontent-%COMP%]   #more-information[_ngcontent-%COMP%]   #content-wrapper[_ngcontent-%COMP%]   #information-container[_ngcontent-%COMP%]   .information-item[_ngcontent-%COMP%]   .matrix1.matrix2[_ngcontent-%COMP%]   .matrix-bracket-left[_ngcontent-%COMP%], #object-selector-panel[_ngcontent-%COMP%]   #more-information[_ngcontent-%COMP%]   #content-wrapper[_ngcontent-%COMP%]   #information-container[_ngcontent-%COMP%]   .information-item[_ngcontent-%COMP%]   .matrix1.matrix2[_ngcontent-%COMP%]   .matrix-bracket-right[_ngcontent-%COMP%]{font-size:42px;top:-12px}#object-selector-panel[_ngcontent-%COMP%]   #more-information[_ngcontent-%COMP%]   #content-wrapper[_ngcontent-%COMP%]   #information-container[_ngcontent-%COMP%]   .information-item[_ngcontent-%COMP%]   .matrix3.matrix1[_ngcontent-%COMP%], #object-selector-panel[_ngcontent-%COMP%]   #more-information[_ngcontent-%COMP%]   #content-wrapper[_ngcontent-%COMP%]   #information-container[_ngcontent-%COMP%]   .information-item[_ngcontent-%COMP%]   .matrix2.matrix1[_ngcontent-%COMP%], #object-selector-panel[_ngcontent-%COMP%]   #more-information[_ngcontent-%COMP%]   #content-wrapper[_ngcontent-%COMP%]   #information-container[_ngcontent-%COMP%]   .information-item[_ngcontent-%COMP%]   .matrix1.matrix1[_ngcontent-%COMP%]{grid-template-columns:16px}#object-selector-panel[_ngcontent-%COMP%]   #more-information[_ngcontent-%COMP%]   #content-wrapper[_ngcontent-%COMP%]   #information-container[_ngcontent-%COMP%]   .information-item[_ngcontent-%COMP%]   .matrix3.matrix1[_ngcontent-%COMP%]   .matrix-bracket-left[_ngcontent-%COMP%], #object-selector-panel[_ngcontent-%COMP%]   #more-information[_ngcontent-%COMP%]   #content-wrapper[_ngcontent-%COMP%]   #information-container[_ngcontent-%COMP%]   .information-item[_ngcontent-%COMP%]   .matrix3.matrix1[_ngcontent-%COMP%]   .matrix-bracket-right[_ngcontent-%COMP%], #object-selector-panel[_ngcontent-%COMP%]   #more-information[_ngcontent-%COMP%]   #content-wrapper[_ngcontent-%COMP%]   #information-container[_ngcontent-%COMP%]   .information-item[_ngcontent-%COMP%]   .matrix2.matrix1[_ngcontent-%COMP%]   .matrix-bracket-left[_ngcontent-%COMP%], #object-selector-panel[_ngcontent-%COMP%]   #more-information[_ngcontent-%COMP%]   #content-wrapper[_ngcontent-%COMP%]   #information-container[_ngcontent-%COMP%]   .information-item[_ngcontent-%COMP%]   .matrix2.matrix1[_ngcontent-%COMP%]   .matrix-bracket-right[_ngcontent-%COMP%], #object-selector-panel[_ngcontent-%COMP%]   #more-information[_ngcontent-%COMP%]   #content-wrapper[_ngcontent-%COMP%]   #information-container[_ngcontent-%COMP%]   .information-item[_ngcontent-%COMP%]   .matrix1.matrix1[_ngcontent-%COMP%]   .matrix-bracket-left[_ngcontent-%COMP%], #object-selector-panel[_ngcontent-%COMP%]   #more-information[_ngcontent-%COMP%]   #content-wrapper[_ngcontent-%COMP%]   #information-container[_ngcontent-%COMP%]   .information-item[_ngcontent-%COMP%]   .matrix1.matrix1[_ngcontent-%COMP%]   .matrix-bracket-right[_ngcontent-%COMP%]{font-size:24px;top:-8px}#object-selector-panel[_ngcontent-%COMP%]   #more-information[_ngcontent-%COMP%]   #content-wrapper[_ngcontent-%COMP%]   #information-container[_ngcontent-%COMP%]   .information-item[_ngcontent-%COMP%]   .matrix3[_ngcontent-%COMP%]   .matrix-bracket-left[_ngcontent-%COMP%], #object-selector-panel[_ngcontent-%COMP%]   #more-information[_ngcontent-%COMP%]   #content-wrapper[_ngcontent-%COMP%]   #information-container[_ngcontent-%COMP%]   .information-item[_ngcontent-%COMP%]   .matrix2[_ngcontent-%COMP%]   .matrix-bracket-left[_ngcontent-%COMP%], #object-selector-panel[_ngcontent-%COMP%]   #more-information[_ngcontent-%COMP%]   #content-wrapper[_ngcontent-%COMP%]   #information-container[_ngcontent-%COMP%]   .information-item[_ngcontent-%COMP%]   .matrix1[_ngcontent-%COMP%]   .matrix-bracket-left[_ngcontent-%COMP%]{position:absolute;font-size:62px;left:-16px;margin:0;padding:0;top:-18px;color:var(--text-light)}#object-selector-panel[_ngcontent-%COMP%]   #more-information[_ngcontent-%COMP%]   #content-wrapper[_ngcontent-%COMP%]   #information-container[_ngcontent-%COMP%]   .information-item[_ngcontent-%COMP%]   .matrix3[_ngcontent-%COMP%]   .matrix-bracket-right[_ngcontent-%COMP%], #object-selector-panel[_ngcontent-%COMP%]   #more-information[_ngcontent-%COMP%]   #content-wrapper[_ngcontent-%COMP%]   #information-container[_ngcontent-%COMP%]   .information-item[_ngcontent-%COMP%]   .matrix2[_ngcontent-%COMP%]   .matrix-bracket-right[_ngcontent-%COMP%], #object-selector-panel[_ngcontent-%COMP%]   #more-information[_ngcontent-%COMP%]   #content-wrapper[_ngcontent-%COMP%]   #information-container[_ngcontent-%COMP%]   .information-item[_ngcontent-%COMP%]   .matrix1[_ngcontent-%COMP%]   .matrix-bracket-right[_ngcontent-%COMP%]{position:absolute;font-size:62px;right:-16px;margin:0;padding:0;top:-18px;color:var(--text-light)}#object-selector-panel[_ngcontent-%COMP%]   #more-information[_ngcontent-%COMP%]   #content-wrapper[_ngcontent-%COMP%]   #information-container[_ngcontent-%COMP%]   .information-item[_ngcontent-%COMP%]   .matrix3[_ngcontent-%COMP%]   p[_ngcontent-%COMP%], #object-selector-panel[_ngcontent-%COMP%]   #more-information[_ngcontent-%COMP%]   #content-wrapper[_ngcontent-%COMP%]   #information-container[_ngcontent-%COMP%]   .information-item[_ngcontent-%COMP%]   .matrix2[_ngcontent-%COMP%]   p[_ngcontent-%COMP%], #object-selector-panel[_ngcontent-%COMP%]   #more-information[_ngcontent-%COMP%]   #content-wrapper[_ngcontent-%COMP%]   #information-container[_ngcontent-%COMP%]   .information-item[_ngcontent-%COMP%]   .matrix1[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;padding:0;display:block;font-size:13px;color:var(--text-dark);font-weight:700;text-align:center}#object-selector-panel[_ngcontent-%COMP%]   #action-on-table[_ngcontent-%COMP%]{padding:0;display:grid;grid-template-rows:max-content}#object-selector-panel[_ngcontent-%COMP%]   #action-on-table[_ngcontent-%COMP%]   .action-object[_ngcontent-%COMP%]{display:grid;grid-template-columns:max-content 1fr;align-items:center}#object-selector-panel[_ngcontent-%COMP%]   #action-on-table[_ngcontent-%COMP%]   .action-object[_ngcontent-%COMP%]   .action-object-text[_ngcontent-%COMP%]{font-size:13px;color:var(--text-medium);font-weight:600;margin:0;padding:0}#object-selector-panel[_ngcontent-%COMP%]   #option-container[_ngcontent-%COMP%]{padding:8px 0;display:grid;grid-template-rows:max-content}#object-selector-panel[_ngcontent-%COMP%]   #option-container[_ngcontent-%COMP%]   .option-item[_ngcontent-%COMP%]{display:grid;grid-template-columns:max-content 1fr;align-items:center}#object-selector-panel[_ngcontent-%COMP%]   #option-container[_ngcontent-%COMP%]   .option-item[_ngcontent-%COMP%]   .option-text[_ngcontent-%COMP%]{font-size:13px;color:var(--text-medium);font-weight:500;margin:0;padding:0}#object-selector-panel[_ngcontent-%COMP%]   .divider[_ngcontent-%COMP%]{height:1px;margin:8px 0 12px;width:100%;background-color:var(--purple-light)}#object-selector-panel[_ngcontent-%COMP%]   .mirror-root-container[_ngcontent-%COMP%]{padding:4px 0;margin-bottom:4px;display:grid;grid-template-columns:repeat(5,max-content);grid-gap:8px}#object-selector-panel[_ngcontent-%COMP%]   .mirror-root-item[_ngcontent-%COMP%]   .root-vector[_ngcontent-%COMP%]{position:relative;height:max-content;width:64px;display:grid;justify-content:center}#object-selector-panel[_ngcontent-%COMP%]   .mirror-root-item[_ngcontent-%COMP%]   .root-vector[_ngcontent-%COMP%]   .root-vector-text[_ngcontent-%COMP%]{display:block;position:relative;z-index:1;font-size:14px;padding:4px;margin:0;cursor:pointer;font-weight:500}#object-selector-panel[_ngcontent-%COMP%]   .mirror-root-item[_ngcontent-%COMP%]   .root-vector[_ngcontent-%COMP%]   .root-vector-background[_ngcontent-%COMP%]{opacity:.6;position:absolute;top:0;left:0;height:100%;width:100%;border-radius:4px}#object-selector-panel[_ngcontent-%COMP%]   #applied-mirrorings-container[_ngcontent-%COMP%]{padding-top:4px}#object-selector-panel[_ngcontent-%COMP%]   #applied-mirrorings-container[_ngcontent-%COMP%]   #mirrorings[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(5,max-content);grid-gap:8px}#object-selector-panel[_ngcontent-%COMP%]   #applied-mirrorings-container[_ngcontent-%COMP%]   #reset-button[_ngcontent-%COMP%]{background-color:var(--background-color);color:#fff;padding:8px 16px;font-weight:600;font-size:12px;border:none;border-radius:4px;cursor:pointer;width:max-content;margin-top:12px}"],data:{animation:[Dg("expanded",[Es("void",Ir({height:"0"})),Es("true",Ir({height:"*"})),Es("false",Ir({height:"0"})),Ag("true <=> false",[Tg("125ms ease-in-out")])])]},changeDetection:0})}const xne=["paintContainer"],wne=["paintContainerLayer0"],Mne=["paintContainerLayer1"],Cne=["paintContainerLayer2"],Sne=["paintContainerLayer3"],Ene=["paintContainerLayer4"];class Gd{constructor(e,t,i,r,s,o){this.canvas=e,this.gridPainter=t,this.rootSystemPainter=i,this.weylChamberPainter=r,this.rootSystemService=s,this.transformService=o,s.repaintEvent.subscribe(()=>{this.repaintObjects()}),i.repaintEvent.subscribe(()=>{this.repaintObjects()}),this.transformService.transformationChanged.subscribe(()=>{this.repaintObjects()})}ngOnInit(){}ngAfterViewInit(){this.initializeCanvas(),this.paintObjects()}repaintObjects(){this.clearCanvas(),this.initializeCanvas(),this.paintObjects()}paintObjects(){this.gridPainter.paint(Ut.layer0),this.weylChamberPainter.paint(Ut.layer1),this.rootSystemPainter.paint(Ut.layer4)}clearCanvas(){this.paintSvgContainer.remove()}initializeCanvas(){const e=document.body.clientHeight-4,t=document.body.clientWidth-1;this.paintSvgContainer=c7().addTo(this.paintContainer.nativeElement).size(t,e);const i=[this.paintSvgContainer.nested().size(t,e),this.paintSvgContainer.nested().size(t,e),this.paintSvgContainer.nested().size(t,e),this.paintSvgContainer.nested().size(t,e),this.paintSvgContainer.nested().size(t,e)],r=new l7({height:e,width:t,pixelsInOneUnit:130});this.canvas.initializeCanvas(r),this.canvas.initializePaintLayers(i)}static#e=this.\u0275fac=function(t){return new(t||Gd)(j(Ks),j(td),j(yu),j(Pd),j(Ss),j(Xo))};static#t=this.\u0275cmp=ii({type:Gd,selectors:[["app-root-systems2-d"]],viewQuery:function(t,i){if(1&t&&(xr(xne,5),xr(wne,5),xr(Mne,5),xr(Cne,5),xr(Sne,5),xr(Ene,5)),2&t){let r;tr(r=nr())&&(i.paintContainer=r.first),tr(r=nr())&&(i.layer0=r.first),tr(r=nr())&&(i.layer1=r.first),tr(r=nr())&&(i.layer2=r.first),tr(r=nr())&&(i.layer3=r.first),tr(r=nr())&&(i.layer4=r.first)}},decls:6,vars:0,consts:[["id","root-system-2d"],["id","paint-container"],["paintContainer",""]],template:function(t,i){1&t&&(W(0,"section",0),it(1,"div",1,2)(3,"app-switch-root-system-panel")(4,"app-object-selector2-d")(5,"app-object-transformer-panel2-d"),Y())},dependencies:[Eg,Xg,Yg],styles:["#root-system-2d[_ngcontent-%COMP%]{background-color:var(--background-color);overflow:hidden;height:100%;width:100%}#root-system-2d[_ngcontent-%COMP%]   .paint-layer[_ngcontent-%COMP%]{background-color:transparent;fill:transparent}"]})}const jN={type:"change"},gM={type:"start"},WN={type:"end"};class $N extends $a{constructor(e,t){super(),this.object=e,this.domElement=t,this.domElement.style.touchAction="none",this.enabled=!0,this.target=new S,this.minDistance=0,this.maxDistance=1/0,this.minZoom=0,this.maxZoom=1/0,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.minAzimuthAngle=-1/0,this.maxAzimuthAngle=1/0,this.enableDamping=!1,this.dampingFactor=.05,this.enableZoom=!0,this.zoomSpeed=1,this.enableRotate=!0,this.rotateSpeed=1,this.enablePan=!0,this.panSpeed=1,this.screenSpacePanning=!0,this.keyPanSpeed=7,this.autoRotate=!1,this.autoRotateSpeed=2,this.keys={LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",BOTTOM:"ArrowDown"},this.mouseButtons={LEFT:0,MIDDLE:1,RIGHT:2},this.touches={ONE:0,TWO:2},this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this._domElementKeyEvents=null,this.getPolarAngle=function(){return a.phi},this.getAzimuthalAngle=function(){return a.theta},this.getDistance=function(){return this.object.position.distanceTo(this.target)},this.listenToKeyEvents=function(P){P.addEventListener("keydown",zt),this._domElementKeyEvents=P},this.saveState=function(){i.target0.copy(i.target),i.position0.copy(i.object.position),i.zoom0=i.object.zoom},this.reset=function(){i.target.copy(i.target0),i.object.position.copy(i.position0),i.object.zoom=i.zoom0,i.object.updateProjectionMatrix(),i.dispatchEvent(jN),i.update(),s=r.NONE},this.update=function(){const P=new S,B=(new Ii).setFromUnitVectors(e.up,new S(0,1,0)),Ee=B.clone().invert(),Pe=new S,De=new Ii,ze=2*Math.PI;return function(){const Dt=i.object.position;P.copy(Dt).sub(i.target),P.applyQuaternion(B),a.setFromVector3(P),i.autoRotate&&s===r.NONE&&E(function I(){return 2*Math.PI/60/60*i.autoRotateSpeed}()),i.enableDamping?(a.theta+=c.theta*i.dampingFactor,a.phi+=c.phi*i.dampingFactor):(a.theta+=c.theta,a.phi+=c.phi);let It=i.minAzimuthAngle,Yt=i.maxAzimuthAngle;return isFinite(It)&&isFinite(Yt)&&(It<-Math.PI?It+=ze:It>Math.PI&&(It-=ze),Yt<-Math.PI?Yt+=ze:Yt>Math.PI&&(Yt-=ze),a.theta=It<=Yt?Math.max(It,Math.min(Yt,a.theta)):a.theta>(It+Yt)/2?Math.max(It,a.theta):Math.min(Yt,a.theta)),a.phi=Math.max(i.minPolarAngle,Math.min(i.maxPolarAngle,a.phi)),a.makeSafe(),a.radius*=l,a.radius=Math.max(i.minDistance,Math.min(i.maxDistance,a.radius)),!0===i.enableDamping?i.target.addScaledVector(u,i.dampingFactor):i.target.add(u),P.setFromSpherical(a),P.applyQuaternion(Ee),Dt.copy(i.target).add(P),i.object.lookAt(i.target),!0===i.enableDamping?(c.theta*=1-i.dampingFactor,c.phi*=1-i.dampingFactor,u.multiplyScalar(1-i.dampingFactor)):(c.set(0,0,0),u.set(0,0,0)),l=1,!!(h||Pe.distanceToSquared(i.object.position)>o||8*(1-De.dot(i.object.quaternion))>o)&&(i.dispatchEvent(jN),Pe.copy(i.object.position),De.copy(i.object.quaternion),h=!1,!0)}}(),this.dispose=function(){i.domElement.removeEventListener("contextmenu",q),i.domElement.removeEventListener("pointerdown",_e),i.domElement.removeEventListener("pointercancel",lt),i.domElement.removeEventListener("wheel",Xt),i.domElement.removeEventListener("pointermove",ke),i.domElement.removeEventListener("pointerup",be),null!==i._domElementKeyEvents&&i._domElementKeyEvents.removeEventListener("keydown",zt)};const i=this,r={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_PAN:4,TOUCH_DOLLY_PAN:5,TOUCH_DOLLY_ROTATE:6};let s=r.NONE;const o=1e-6,a=new Bk,c=new Bk;let l=1;const u=new S;let h=!1;const d=new ee,f=new ee,p=new ee,m=new ee,g=new ee,_=new ee,b=new ee,y=new ee,v=new ee,w=[],M={};function x(){return Math.pow(.95,i.zoomSpeed)}function E(P){c.theta-=P}function R(P){c.phi-=P}const $=function(){const P=new S;return function(Ee,Pe){P.setFromMatrixColumn(Pe,0),P.multiplyScalar(-Ee),u.add(P)}}(),se=function(){const P=new S;return function(Ee,Pe){!0===i.screenSpacePanning?P.setFromMatrixColumn(Pe,1):(P.setFromMatrixColumn(Pe,0),P.crossVectors(i.object.up,P)),P.multiplyScalar(Ee),u.add(P)}}(),H=function(){const P=new S;return function(Ee,Pe){const De=i.domElement;if(i.object.isPerspectiveCamera){P.copy(i.object.position).sub(i.target);let Ue=P.length();Ue*=Math.tan(i.object.fov/2*Math.PI/180),$(2*Ee*Ue/De.clientHeight,i.object.matrix),se(2*Pe*Ue/De.clientHeight,i.object.matrix)}else i.object.isOrthographicCamera?($(Ee*(i.object.right-i.object.left)/i.object.zoom/De.clientWidth,i.object.matrix),se(Pe*(i.object.top-i.object.bottom)/i.object.zoom/De.clientHeight,i.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),i.enablePan=!1)}}();function N(P){i.object.isPerspectiveCamera?l/=P:i.object.isOrthographicCamera?(i.object.zoom=Math.max(i.minZoom,Math.min(i.maxZoom,i.object.zoom*P)),i.object.updateProjectionMatrix(),h=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),i.enableZoom=!1)}function X(P){i.object.isPerspectiveCamera?l*=P:i.object.isOrthographicCamera?(i.object.zoom=Math.max(i.minZoom,Math.min(i.maxZoom,i.object.zoom/P)),i.object.updateProjectionMatrix(),h=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),i.enableZoom=!1)}function L(P){d.set(P.clientX,P.clientY)}function F(P){m.set(P.clientX,P.clientY)}function pe(){1===w.length?d.set(w[0].pageX,w[0].pageY):d.set(.5*(w[0].pageX+w[1].pageX),.5*(w[0].pageY+w[1].pageY))}function We(){1===w.length?m.set(w[0].pageX,w[0].pageY):m.set(.5*(w[0].pageX+w[1].pageX),.5*(w[0].pageY+w[1].pageY))}function te(){const P=w[0].pageX-w[1].pageX,B=w[0].pageY-w[1].pageY,Ee=Math.sqrt(P*P+B*B);b.set(0,Ee)}function Le(P){if(1==w.length)f.set(P.pageX,P.pageY);else{const Ee=et(P);f.set(.5*(P.pageX+Ee.x),.5*(P.pageY+Ee.y))}p.subVectors(f,d).multiplyScalar(i.rotateSpeed);const B=i.domElement;E(2*Math.PI*p.x/B.clientHeight),R(2*Math.PI*p.y/B.clientHeight),d.copy(f)}function ye(P){if(1===w.length)g.set(P.pageX,P.pageY);else{const B=et(P);g.set(.5*(P.pageX+B.x),.5*(P.pageY+B.y))}_.subVectors(g,m).multiplyScalar(i.panSpeed),H(_.x,_.y),m.copy(g)}function ut(P){const B=et(P),Ee=P.pageX-B.x,Pe=P.pageY-B.y,De=Math.sqrt(Ee*Ee+Pe*Pe);y.set(0,De),v.set(0,Math.pow(y.y/b.y,i.zoomSpeed)),N(v.y),b.copy(y)}function _e(P){!1!==i.enabled&&(0===w.length&&(i.domElement.setPointerCapture(P.pointerId),i.domElement.addEventListener("pointermove",ke),i.domElement.addEventListener("pointerup",be)),function ue(P){w.push(P)}(P),"touch"===P.pointerType?function T(P){switch(Me(P),w.length){case 1:switch(i.touches.ONE){case 0:if(!1===i.enableRotate)return;pe(),s=r.TOUCH_ROTATE;break;case 1:if(!1===i.enablePan)return;We(),s=r.TOUCH_PAN;break;default:s=r.NONE}break;case 2:switch(i.touches.TWO){case 2:if(!1===i.enableZoom&&!1===i.enablePan)return;(function Be(){i.enableZoom&&te(),i.enablePan&&We()})(),s=r.TOUCH_DOLLY_PAN;break;case 3:if(!1===i.enableZoom&&!1===i.enableRotate)return;(function Fe(){i.enableZoom&&te(),i.enableRotate&&pe()})(),s=r.TOUCH_DOLLY_ROTATE;break;default:s=r.NONE}break;default:s=r.NONE}s!==r.NONE&&i.dispatchEvent(gM)}(P):function Qe(P){let B;switch(P.button){case 0:B=i.mouseButtons.LEFT;break;case 1:B=i.mouseButtons.MIDDLE;break;case 2:B=i.mouseButtons.RIGHT;break;default:B=-1}switch(B){case 1:if(!1===i.enableZoom)return;(function G(P){b.set(P.clientX,P.clientY)})(P),s=r.DOLLY;break;case 0:if(P.ctrlKey||P.metaKey||P.shiftKey){if(!1===i.enablePan)return;F(P),s=r.PAN}else{if(!1===i.enableRotate)return;L(P),s=r.ROTATE}break;case 2:if(P.ctrlKey||P.metaKey||P.shiftKey){if(!1===i.enableRotate)return;L(P),s=r.ROTATE}else{if(!1===i.enablePan)return;F(P),s=r.PAN}break;default:s=r.NONE}s!==r.NONE&&i.dispatchEvent(gM)}(P))}function ke(P){!1!==i.enabled&&("touch"===P.pointerType?function C(P){switch(Me(P),s){case r.TOUCH_ROTATE:if(!1===i.enableRotate)return;Le(P),i.update();break;case r.TOUCH_PAN:if(!1===i.enablePan)return;ye(P),i.update();break;case r.TOUCH_DOLLY_PAN:if(!1===i.enableZoom&&!1===i.enablePan)return;(function oe(P){i.enableZoom&&ut(P),i.enablePan&&ye(P)})(P),i.update();break;case r.TOUCH_DOLLY_ROTATE:if(!1===i.enableZoom&&!1===i.enableRotate)return;(function ne(P){i.enableZoom&&ut(P),i.enableRotate&&Le(P)})(P),i.update();break;default:s=r.NONE}}(P):function $e(P){switch(s){case r.ROTATE:if(!1===i.enableRotate)return;!function O(P){f.set(P.clientX,P.clientY),p.subVectors(f,d).multiplyScalar(i.rotateSpeed);const B=i.domElement;E(2*Math.PI*p.x/B.clientHeight),R(2*Math.PI*p.y/B.clientHeight),d.copy(f),i.update()}(P);break;case r.DOLLY:if(!1===i.enableZoom)return;!function V(P){y.set(P.clientX,P.clientY),v.subVectors(y,b),v.y>0?N(x()):v.y<0&&X(x()),b.copy(y),i.update()}(P);break;case r.PAN:if(!1===i.enablePan)return;!function ce(P){g.set(P.clientX,P.clientY),_.subVectors(g,m).multiplyScalar(i.panSpeed),H(_.x,_.y),m.copy(g),i.update()}(P)}}(P))}function be(P){me(P),0===w.length&&(i.domElement.releasePointerCapture(P.pointerId),i.domElement.removeEventListener("pointermove",ke),i.domElement.removeEventListener("pointerup",be)),i.dispatchEvent(WN),s=r.NONE}function lt(P){me(P)}function Xt(P){!1===i.enabled||!1===i.enableZoom||s!==r.NONE||(P.preventDefault(),i.dispatchEvent(gM),function re(P){P.deltaY<0?X(x()):P.deltaY>0&&N(x()),i.update()}(P),i.dispatchEvent(WN))}function zt(P){!1===i.enabled||!1===i.enablePan||function fe(P){let B=!1;switch(P.code){case i.keys.UP:H(0,i.keyPanSpeed),B=!0;break;case i.keys.BOTTOM:H(0,-i.keyPanSpeed),B=!0;break;case i.keys.LEFT:H(i.keyPanSpeed,0),B=!0;break;case i.keys.RIGHT:H(-i.keyPanSpeed,0),B=!0}B&&(P.preventDefault(),i.update())}(P)}function q(P){!1!==i.enabled&&P.preventDefault()}function me(P){delete M[P.pointerId];for(let B=0;B<w.length;B++)if(w[B].pointerId==P.pointerId)return void w.splice(B,1)}function Me(P){let B=M[P.pointerId];void 0===B&&(B=new ee,M[P.pointerId]=B),B.set(P.pageX,P.pageY)}function et(P){return M[(P.pointerId===w[0].pointerId?w[1]:w[0]).pointerId]}i.domElement.addEventListener("contextmenu",q),i.domElement.addEventListener("pointerdown",_e),i.domElement.addEventListener("pointercancel",lt),i.domElement.addEventListener("wheel",Xt,{passive:!1}),this.update()}}const qN={uniforms:{tDiffuse:{value:null},opacity:{value:1}},vertexShader:"\n\n\t\tvarying vec2 vUv;\n\n\t\tvoid main() {\n\n\t\t\tvUv = uv;\n\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\n\t\t}",fragmentShader:"\n\n\t\tuniform float opacity;\n\n\t\tuniform sampler2D tDiffuse;\n\n\t\tvarying vec2 vUv;\n\n\t\tvoid main() {\n\n\t\t\tgl_FragColor = texture2D( tDiffuse, vUv );\n\t\t\tgl_FragColor.a *= opacity;\n\n\n\t\t}"};class Zg{constructor(){this.enabled=!0,this.needsSwap=!0,this.clear=!1,this.renderToScreen=!1}setSize(){}render(){console.error("THREE.Pass: .render() must be implemented in derived pass.")}dispose(){}}const Dne=new fd(-1,1,1,-1,0,1),_M=new gt;_M.setAttribute("position",new Re([-1,3,0,-1,-1,0,3,-1,0],3)),_M.setAttribute("uv",new Re([0,2,0,0,2,0],2));class Tne{constructor(e){this._mesh=new Qn(_M,e)}dispose(){this._mesh.geometry.dispose()}render(e){e.render(this._mesh,Dne)}get material(){return this._mesh.material}set material(e){this._mesh.material=e}}class XN extends Zg{constructor(e,t){super(),this.textureID=void 0!==t?t:"tDiffuse",e instanceof xs?(this.uniforms=e.uniforms,this.material=e):e&&(this.uniforms=sO.clone(e.uniforms),this.material=new xs({defines:Object.assign({},e.defines),uniforms:this.uniforms,vertexShader:e.vertexShader,fragmentShader:e.fragmentShader})),this.fsQuad=new Tne(this.material)}render(e,t,i){this.uniforms[this.textureID]&&(this.uniforms[this.textureID].value=i.texture),this.fsQuad.material=this.material,this.renderToScreen?(e.setRenderTarget(null),this.fsQuad.render(e)):(e.setRenderTarget(t),this.clear&&e.clear(e.autoClearColor,e.autoClearDepth,e.autoClearStencil),this.fsQuad.render(e))}dispose(){this.material.dispose(),this.fsQuad.dispose()}}class YN extends Zg{constructor(e,t){super(),this.scene=e,this.camera=t,this.clear=!0,this.needsSwap=!1,this.inverse=!1}render(e,t,i){const r=e.getContext(),s=e.state;let o,a;s.buffers.color.setMask(!1),s.buffers.depth.setMask(!1),s.buffers.color.setLocked(!0),s.buffers.depth.setLocked(!0),this.inverse?(o=0,a=1):(o=1,a=0),s.buffers.stencil.setTest(!0),s.buffers.stencil.setOp(r.REPLACE,r.REPLACE,r.REPLACE),s.buffers.stencil.setFunc(r.ALWAYS,o,4294967295),s.buffers.stencil.setClear(a),s.buffers.stencil.setLocked(!0),e.setRenderTarget(i),this.clear&&e.clear(),e.render(this.scene,this.camera),e.setRenderTarget(t),this.clear&&e.clear(),e.render(this.scene,this.camera),s.buffers.color.setLocked(!1),s.buffers.depth.setLocked(!1),s.buffers.stencil.setLocked(!1),s.buffers.stencil.setFunc(r.EQUAL,1,4294967295),s.buffers.stencil.setOp(r.KEEP,r.KEEP,r.KEEP),s.buffers.stencil.setLocked(!0)}}class Ane extends Zg{constructor(){super(),this.needsSwap=!1}render(e){e.state.buffers.stencil.setLocked(!1),e.state.buffers.stencil.setTest(!1)}}class Ine{constructor(e,t){if(this.renderer=e,void 0===t){const i=e.getSize(new ee);this._pixelRatio=e.getPixelRatio(),this._width=i.width,this._height=i.height,(t=new Fo(this._width*this._pixelRatio,this._height*this._pixelRatio)).texture.name="EffectComposer.rt1"}else this._pixelRatio=1,this._width=t.width,this._height=t.height;this.renderTarget1=t,this.renderTarget2=t.clone(),this.renderTarget2.texture.name="EffectComposer.rt2",this.writeBuffer=this.renderTarget1,this.readBuffer=this.renderTarget2,this.renderToScreen=!0,this.passes=[],void 0===qN&&console.error("THREE.EffectComposer relies on CopyShader"),void 0===XN&&console.error("THREE.EffectComposer relies on ShaderPass"),this.copyPass=new XN(qN),this.clock=new Ok}swapBuffers(){const e=this.readBuffer;this.readBuffer=this.writeBuffer,this.writeBuffer=e}addPass(e){this.passes.push(e),e.setSize(this._width*this._pixelRatio,this._height*this._pixelRatio)}insertPass(e,t){this.passes.splice(t,0,e),e.setSize(this._width*this._pixelRatio,this._height*this._pixelRatio)}removePass(e){const t=this.passes.indexOf(e);-1!==t&&this.passes.splice(t,1)}isLastEnabledPass(e){for(let t=e+1;t<this.passes.length;t++)if(this.passes[t].enabled)return!1;return!0}render(e){void 0===e&&(e=this.clock.getDelta());const t=this.renderer.getRenderTarget();let i=!1;for(let r=0,s=this.passes.length;r<s;r++){const o=this.passes[r];if(!1!==o.enabled){if(o.renderToScreen=this.renderToScreen&&this.isLastEnabledPass(r),o.render(this.renderer,this.writeBuffer,this.readBuffer,e,i),o.needsSwap){if(i){const a=this.renderer.getContext(),c=this.renderer.state.buffers.stencil;c.setFunc(a.NOTEQUAL,1,4294967295),this.copyPass.render(this.renderer,this.writeBuffer,this.readBuffer,e),c.setFunc(a.EQUAL,1,4294967295)}this.swapBuffers()}void 0!==YN&&(o instanceof YN?i=!0:o instanceof Ane&&(i=!1))}}this.renderer.setRenderTarget(t)}reset(e){if(void 0===e){const t=this.renderer.getSize(new ee);this._pixelRatio=this.renderer.getPixelRatio(),this._width=t.width,this._height=t.height,(e=this.renderTarget1.clone()).setSize(this._width*this._pixelRatio,this._height*this._pixelRatio)}this.renderTarget1.dispose(),this.renderTarget2.dispose(),this.renderTarget1=e,this.renderTarget2=e.clone(),this.writeBuffer=this.renderTarget1,this.readBuffer=this.renderTarget2}setSize(e,t){this._width=e,this._height=t;const i=this._width*this._pixelRatio,r=this._height*this._pixelRatio;this.renderTarget1.setSize(i,r),this.renderTarget2.setSize(i,r);for(let s=0;s<this.passes.length;s++)this.passes[s].setSize(i,r)}setPixelRatio(e){this._pixelRatio=e,this.setSize(this._width,this._height)}dispose(){this.renderTarget1.dispose(),this.renderTarget2.dispose(),this.copyPass.dispose()}}new fd(-1,1,1,-1,0,1);const yM=new gt;yM.setAttribute("position",new Re([-1,3,0,-1,-1,0,3,-1,0],3)),yM.setAttribute("uv",new Re([0,2,0,0,2,0],2));class Rne extends Zg{constructor(e,t,i,r,s){super(),this.scene=e,this.camera=t,this.overrideMaterial=i,this.clearColor=r,this.clearAlpha=void 0!==s?s:0,this.clear=!0,this.clearDepth=!1,this.needsSwap=!1,this._oldClearColor=new Ie}render(e,t,i){const r=e.autoClear;let s,o;e.autoClear=!1,void 0!==this.overrideMaterial&&(o=this.scene.overrideMaterial,this.scene.overrideMaterial=this.overrideMaterial),this.clearColor&&(e.getClearColor(this._oldClearColor),s=e.getClearAlpha(),e.setClearColor(this.clearColor,this.clearAlpha)),this.clearDepth&&e.clearDepth(),e.setRenderTarget(this.renderToScreen?null:i),this.clear&&e.clear(e.autoClearColor,e.autoClearDepth,e.autoClearStencil),e.render(this.scene,this.camera),this.clearColor&&e.setClearColor(this._oldClearColor,s),void 0!==this.overrideMaterial&&(this.scene.overrideMaterial=o),e.autoClear=r}}class ho{constructor(){this.rootGroup=new lr,this.hyperplaneGroup=new lr,this.weylChamberGroup=new lr,this.reinitializedScene=new ui,this.miniViewRootSystemGroup=new lr}initializeScene(e){this.canvasReference=e,this.scene=new Yx,this.camera=new ei(75,e.clientWidth/e.clientHeight,.1,1e3),this.renderer=new $x({antialias:!0}),this.renderer.setSize(e.clientWidth,e.clientHeight),this.rendererDom=this.renderer.domElement,e.appendChild(this.rendererDom),this.camera.position.set(-20,5,0),this.addComposer(),this.displayScene(),this.addOrbitControls(),this.scene.add(this.rootGroup),this.scene.add(this.weylChamberGroup),this.scene.add(this.hyperplaneGroup),this.reactToMainSceneOrbitChange()}initializeMiniView(e){this.canvasReferenceMiniView=e,this.sceneMiniView=new Yx,this.cameraMiniView=new ei(60,e.clientWidth/e.clientHeight,.1,70),this.rendererMiniView=new $x,this.rendererMiniView.setSize(e.clientWidth,e.clientHeight),this.rendererDomMiniView=this.rendererMiniView.domElement,e.appendChild(this.rendererDomMiniView),this.cameraMiniView.position.set(-20,5,0),this.displayMiniView(),this.startMiniViewDisplay(),this.sceneMiniView.add(this.miniViewRootSystemGroup),this.addOrbitControlsToMiniView(),this.reactToMainSceneOrbitChange()}addOrbitControlsToMiniView(){this.miniViewOrbitControls=new $N(this.cameraMiniView,this.rendererMiniView.domElement),this.miniViewOrbitControls.enabled=!1}rerender(){this.renderer.render(this.scene,this.camera),this.composer.render()}addToRootGroup(e){this.rootGroup.add(e),this.miniViewRootSystemGroup.add(e.clone())}addToWeylChamberGroup(e){this.weylChamberGroup.add(e),this.miniViewRootSystemGroup.add(e.clone())}addToHyperplaneGroup(e){this.hyperplaneGroup.add(e),this.miniViewRootSystemGroup.add(e.clone())}removeTransformations(){this.rootGroup.position.set(0,0,0),this.rootGroup.rotation.set(0,0,0),this.rootGroup.scale.set(1,1,1),this.rootGroup.updateMatrix(),this.hyperplaneGroup.position.set(0,0,0),this.hyperplaneGroup.rotation.set(0,0,0),this.hyperplaneGroup.scale.set(1,1,1),this.hyperplaneGroup.updateMatrix(),this.weylChamberGroup.position.set(0,0,0),this.weylChamberGroup.rotation.set(0,0,0),this.weylChamberGroup.scale.set(1,1,1),this.weylChamberGroup.updateMatrix()}setTransformations(e,t){this.removeTransformations(),t.includes("ROOTS")&&this.rootGroup.applyMatrix4(e),t.includes("HYPERPLANES")&&this.hyperplaneGroup.applyMatrix4(e),t.includes("WEYL_CHAMBERS")&&this.weylChamberGroup.applyMatrix4(e)}reinitializeScene(){function e(t){for(;t.children.length>0;)e(t.children[0]),t.remove(t.children[0]);t.geometry&&t.geometry.dispose(),t.material&&(Object.keys(t.material).forEach(i=>{!t.material[i]||null!==t.material[i]&&"function"==typeof t.material[i].dispose&&t.material[i].dispose()}),t.material.dispose())}this.scene&&(e(this.scene),e(this.sceneMiniView),this.rootGroup=new lr,this.hyperplaneGroup=new lr,this.weylChamberGroup=new lr,this.miniViewRootSystemGroup=new lr,this.scene.add(this.rootGroup),this.scene.add(this.hyperplaneGroup),this.scene.add(this.weylChamberGroup),this.sceneMiniView.add(this.miniViewRootSystemGroup),this.startMiniViewDisplay(),this.startDisplay(),this.reinitializedScene.next())}startDisplay(){this.adjustBackgroundColor(de.purple800),this.addLight()}startMiniViewDisplay(){this.rendererMiniView.setClearColor(de.purple800);const e=new Aw(16777215,.8),t=new Tw(16777215,.8);t.position.set(0,30,0),this.sceneMiniView.add(e),this.sceneMiniView.add(t)}displayMiniView(){requestAnimationFrame(()=>this.displayMiniView()),this.rendererMiniView.render(this.sceneMiniView,this.cameraMiniView)}displayScene(){requestAnimationFrame(()=>this.displayScene()),this.composer.render()}adjustBackgroundColor(e){this.renderer.setClearColor(e)}addOrbitControls(){new $N(this.camera,this.renderer.domElement).addEventListener("change",t=>{this.reactToMainSceneOrbitChange()})}reactToMainSceneOrbitChange(){if(null!=this.camera){var e=new S;this.camera.getWorldPosition(e),e.setLength(21.5),this.cameraMiniView.position.set(e.x,e.y,e.z),this.cameraMiniView.lookAt(new S(0,0,0))}}addComposer(){const e=new Rne(this.scene,this.camera);this.composer=new Ine(this.renderer),this.composer.addPass(e)}addLight(){const e=new Aw(16777215,.8),t=new Tw(16777215,.8);t.position.set(0,30,0),this.scene.add(e),this.scene.add(t)}static#e=this.\u0275fac=function(t){return new(t||ho)};static#t=this.\u0275prov=Te({token:ho,factory:ho.\u0275fac,providedIn:"root"})}class Ne{constructor(e,t,i){this.x=e,this.y=t,this.z=i}getNegative(){return new Ne(-this.x,-this.y,-this.z)}equal(e){return Math.abs(this.x-e.x)<.01&&Math.abs(this.y-e.y)<.01&&Math.abs(this.z-e.z)<.01}static getZero(){return new Ne(0,0,0)}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}normalized(){return new Ne(this.x/this.length(),this.y/this.length(),this.z/this.length())}stretchedBy(e){return new Ne(this.x*e,this.y*e,this.z*e)}dotProduct(e){return e.x*this.x+e.y*this.y+e.z*this.z}}class ZN{constructor(e,t=Ne.getZero(),i=de.white){this.normalVector=e,this.point=t,this.color=i}getNormalVectorAsThreeVector(){return new S(this.normalVector.x,this.normalVector.y,this.normalVector.z)}}class One{constructor(e){this.centerPoint=Ne.getZero(),this.edgePoints=[],this.size=1e4,this.size=null!=e.size?e.size:this.size,this.edgePoints=e.edgePoints.map(t=>t.normalized())}}class Et{constructor(e){this.isSimple=!1,this.isPositive=!0,this.direction=e.vector.normalized(),this.length=e.vector.length(),this.isSimple=e.isSimple,this.name=`(${this.getVector().x} ${this.getVector().y} ${this.getVector().z})`,this.isPositive=null==e.isPositive||e.isPositive}getNegative(){return new Et({vector:this.direction.getNegative().stretchedBy(this.length),isSimple:!1,isPositive:!this.isPositive})}plus(e){const t=new Ne(this.direction.x*this.length+e.direction.x*e.length,this.direction.y*this.length+e.direction.y*e.length,this.direction.z*this.length+e.direction.z*e.length);return new Et({vector:t,isSimple:!1})}times(e){return new Et({vector:this.direction.normalized().stretchedBy(this.length*e),isSimple:!1})}equal(e){return e.direction.equal(this.direction)&&Math.abs(e.length-this.length)<.01}getVector(){return new Ne(this.direction.x*this.length,this.direction.y*this.length,this.direction.z*this.length)}getHyperplane(){return new ZN(this.direction,Ne.getZero())}}class Kg{constructor(e,t,i){this._simpleRoots=[],this._positiveRoots=[],this.coxeterMatrix=[],this.type=e,this.coxeterMatrix=t,this._positiveRoots=i,this._simpleRoots=this._positiveRoots.filter(r=>r.isSimple)}getBase(){return this._simpleRoots}getRoots(){let e=[...this._positiveRoots];return this._positiveRoots.forEach(t=>{e.push(t.getNegative())}),e}getPositiveRoots(){return this._positiveRoots}getNegativeRoots(){let e=[...this._positiveRoots];return this._positiveRoots.forEach(t=>{e.push(t.getNegative())}),e}getHyperplanesToSimpleRoots(){const e=[];for(let t of this._simpleRoots)t.direction.x>=0&&e.push(this.getHyperplaneToRoot(t));return e}getAllHyperplanes(){let e=this.getRoots();const t=[];for(let i of e)i.direction.x>=0&&t.push(this.getHyperplaneToRoot(i));return t}getHyperplaneToRoot(e){return new ZN(e.direction,Ne.getZero())}getFundamentalWeylChamber(){function e(a,c){var l=(new S).crossVectors(a.normal,c.normal);if(0===l.distanceTo(new S(0,0,0)))return null;var h=Math.abs(l.x),d=Math.abs(l.y),f=Math.abs(l.z);return[f>=h&&f>=d?t("z","x","y",a,c):d>=f&&d>=h?t("y","z","x",a,c):t("x","y","z",a,c),l]}function t(a,c,l,u,h){var d=u.normal[c],f=u.normal[l],p=u.constant,m=h.normal[c],g=h.normal[l],_=h.constant,b=(g*p-f*_)/(d*g-m*f),y=(d*_-m*p)/(d*g-m*f),v=new S;return v[a]=0,v[c]=b,v[l]=y,v}const i=[];for(let a of this._simpleRoots){const c=this.getHyperplaneToRoot(a);i.push(new oo(c.getNormalVectorAsThreeVector(),1e3))}let r=[],s=[];for(let a of i)for(let c of i)if(a!=c){let l=e(a,c);console.log("Intersection: ",l);let u=l[1],h=new Ne(u.x,u.y,u.z);r.push(h)}for(let a of r)for(let c of this._simpleRoots)c.direction.dotProduct(a)>=.01&&s.push(a);return new One({edgePoints:s})}getLengthOfTransformation(e){let t=(new Wn).identity();for(let o of e){const{x:a,y:c,z:l}=o.getVector().normalized();t=(new Wn).fromArray([1-2*a*a,-2*a*c,-2*a*l,-2*a*c,1-2*c*c,-2*c*l,-2*a*l,-2*c*l,1-2*l*l]).multiply(t)}const i=this.getPositiveRoots();return i.map(o=>{const a=o.getVector(),c=new S(a.x,a.y,a.z).applyMatrix3(t);return new Et({vector:new Ne(c.x,c.y,c.z),isSimple:!1})}).filter(o=>i.every(a=>!a.equal(o))).length}}var ea=(()=>{return(n=ea||(ea={})).A3="A3",n.B3="B3",n.C3="C3",n.D3="D3",ea;var n})();const kne=new Kg(ea.A3,[1,3,2,3,1,3,2,3,1],[new Et({vector:new Ne(0,1,-1),isSimple:!0}),new Et({vector:new Ne(1,-1,0),isSimple:!0}),new Et({vector:new Ne(0,1,1),isSimple:!0}),new Et({vector:new Ne(1,0,-1),isSimple:!1}),new Et({vector:new Ne(1,1,0),isSimple:!1}),new Et({vector:new Ne(1,0,1),isSimple:!1})]),Lne=new Kg(ea.D3,[1,3,2,3,1,3,2,3,1],[new Et({vector:new Ne(0,1,-1),isSimple:!0}),new Et({vector:new Ne(1,-1,0),isSimple:!0}),new Et({vector:new Ne(0,1,1),isSimple:!0}),new Et({vector:new Ne(1,0,-1),isSimple:!1}),new Et({vector:new Ne(1,1,0),isSimple:!1}),new Et({vector:new Ne(1,0,1),isSimple:!1})]),jd={A3:kne,B3:new Kg(ea.B3,[1,4,2,4,1,3,2,3,1],[new Et({vector:new Ne(0,0,1),isSimple:!0}),new Et({vector:new Ne(0,1,-1),isSimple:!0}),new Et({vector:new Ne(1,-1,0),isSimple:!0}),new Et({vector:new Ne(1,0,0),isSimple:!1}),new Et({vector:new Ne(0,1,0),isSimple:!1}),new Et({vector:new Ne(1,1,0),isSimple:!1}),new Et({vector:new Ne(0,1,1),isSimple:!1}),new Et({vector:new Ne(1,0,1),isSimple:!1}),new Et({vector:new Ne(1,0,-1),isSimple:!1})]),C3:new Kg(ea.C3,[1,4,2,4,1,3,2,3,1],[new Et({vector:new Ne(1,-1,0),isSimple:!0}),new Et({vector:new Ne(0,1,-1),isSimple:!0}),new Et({vector:new Ne(0,0,2),isSimple:!0}),new Et({vector:new Ne(1,1,0),isSimple:!1}),new Et({vector:new Ne(0,1,1),isSimple:!1}),new Et({vector:new Ne(1,0,1),isSimple:!1}),new Et({vector:new Ne(1,0,-1),isSimple:!1}),new Et({vector:new Ne(2,0,0),isSimple:!1}),new Et({vector:new Ne(0,2,0),isSimple:!1})]),D3:Lne};class Ds{constructor(e){this.dashed=!1,this.dashString="",this.start=e.start,this.end=e.end,this.color=e.color,this.width=e.width,this.dashed=null!=e.dashed&&e.dashed,this.dashString=null!=e.dashString?e.dashString:""}}class Su{constructor(e){this.center=e.center,this.radius=e.radius,this.color=e.color}get colorNumber(){return function u7(n){return parseInt(n.replace("#","0x"),16)}(this.color)}}class Wd{constructor(e){this.sceneManager=e,this.scaleFactor=5}drawSphere(e){const t=new Ed(e.radius*this.scaleFactor,32,16),i=new ww({color:e.colorNumber}),r=new Qn(t,i);r.position.set(e.center.x*this.scaleFactor,e.center.y*this.scaleFactor,e.center.z*this.scaleFactor),this.sceneManager.addToRootGroup(r)}drawLine(e,t="ROOT"){const i=new S(e.end.x-e.start.x,e.end.y-e.start.y,e.end.z-e.start.z),r=new du(2*e.width,2*e.width,i.length()*this.scaleFactor,32),s=new yk({color:e.color}),o=new Qn(r,s);var a=new S(0,1,0);o.quaternion.setFromUnitVectors(a,i.clone().normalize()),o.position.copy(i.clone().multiplyScalar(.5*this.scaleFactor)),"HYPERPLANE"==t?this.sceneManager.addToHyperplaneGroup(o):"WEYL_CHAMBER"==t?this.sceneManager.addToWeylChamberGroup(o):this.sceneManager.addToRootGroup(o)}drawPlane(e,t="HYPERPLANE"){var i=new S(e.normalVector.x,e.normalVector.y,e.normalVector.z),r=new S(e.point.x,e.point.y,e.point.z),s=new oo;s.setFromNormalAndCoplanarPoint(i,r).normalize();var o=new dd(9,9),a=new S;s.coplanarPoint(a);var c=(new S).copy(a).add(s.normal);o.lookAt(c),o.translate(a.x,a.y,a.z);var l=new ww({color:e.color,side:2,opacity:.65,transparent:!0}),u=new Qn(o,l);"HYPERPLANE"==t?this.sceneManager.addToHyperplaneGroup(u):"WEYL_CHAMBER"==t?this.sceneManager.addToWeylChamberGroup(u):this.sceneManager.addToRootGroup(u)}drawWeylChamber(e){const t=a=>[a.x,a.y,a.z],i=a=>{const c=new gt;c.setAttribute("position",new qn(a,3));const l=new Ho({color:de.purple300,side:2,transparent:!0,opacity:.2}),u=new Qn(c,l);l.polygonOffset=!0,l.polygonOffsetFactor=-.1,this.sceneManager.addToWeylChamberGroup(u)};let r=-1;const s=e.edgePoints,o=e.size;for(;r<e.edgePoints.length-1;)r+=1,this.drawLine(new Ds({start:e.centerPoint,end:s[r].stretchedBy(100),color:de.purple300,width:.05}),"WEYL_CHAMBER"),i(r==s.length-1?new Float32Array([...t(e.centerPoint),...t(s[r].stretchedBy(o)),...t(s[0].stretchedBy(o))]):new Float32Array([...t(e.centerPoint),...t(s[r].stretchedBy(o)),...t(s[r+1].stretchedBy(o))]))}static#e=this.\u0275fac=function(t){return new(t||Wd)(le(ho))};static#t=this.\u0275prov=Te({token:Wd,factory:Wd.\u0275fac,providedIn:"root"})}class ta{constructor(){this.rootSystem=jd.A3,this.rootSystemChangeEvent=new ui}setInitialRootSystem(e){this.rootSystem=e,this.rootSystemChangeEvent.next()}switchRootSystem(e){this.rootSystem=e,this.rootSystemChangeEvent.next()}static#e=this.\u0275fac=function(t){return new(t||ta)};static#t=this.\u0275prov=Te({token:ta,factory:ta.\u0275fac,providedIn:"root"})}class Eu{constructor(e){this.sceneManager=e,this.currentTranformation=(new ct).identity(),this.appliedMirrorings=[],this.transformationChanged=new ui,this.objectsTransformationActsOn=["ROOTS","WEYL_CHAMBERS"],e.reinitializedScene.subscribe(()=>{this.applyTransformation()})}transformationAppliedTo(e){return this.objectsTransformationActsOn.includes(e)}getCurrentTransformedObjects(){return this.objectsTransformationActsOn}addTransformedObjectType(e){this.objectsTransformationActsOn.push(e),this.transformationChanged.next(),this.applyTransformation()}removeTransformedObjectType(e){this.objectsTransformationActsOn=this.objectsTransformationActsOn.filter(t=>t!=e),this.transformationChanged.next(),this.applyTransformation()}resetTransformation(){this.appliedMirrorings=[],this.currentTranformation=(new ct).identity(),this.clearTranformation(),this.transformationChanged.next()}clearTranformation(){this.sceneManager.removeTransformations()}applyTransformation(){this.sceneManager.setTransformations(this.currentTranformation,this.objectsTransformationActsOn),this.transformationChanged.next()}mirrorOnPlaneOfRoot(e){this.appliedMirrorings.push(e);const i=e.getHyperplane().normalVector.normalized(),r=(new Wn).fromArray([1-2*i.x*i.x,-2*i.x*i.y,-2*i.x*i.z,-2*i.x*i.y,1-2*i.y*i.y,-2*i.y*i.z,-2*i.x*i.z,-2*i.y*i.z,1-2*i.z*i.z]);this.currentTranformation=(new ct).setFromMatrix3(r).multiply(this.currentTranformation),this.applyTransformation()}static#e=this.\u0275fac=function(t){return new(t||Eu)(le(ho))};static#t=this.\u0275prov=Te({token:Eu,factory:Eu.\u0275fac,providedIn:"root"})}class Du{constructor(e,t,i,r){this.painter=e,this.rootSystemService=t,this.sceneManager=i,this.transformServiece=r,this.colorMode=Zn.base,this.highlightedRoots=[],this.rootWithVisibleHyperplanes=[],this.rootSystem=jd.A3,this.rootSystem=t.rootSystem,this.rootSystemService.rootSystemChangeEvent.subscribe(()=>{this.rootSystemService.rootSystem.type!=this.rootSystem.type&&(this.clearRootHighlight(),this.clearHyperplaneVisibility()),this.repaint()})}repaint(){this.sceneManager.reinitializeScene(),this.rootSystem=this.rootSystemService.rootSystem,this.paint()}paint(){this.paintCenter(),this.paintRoots(),this.paintHyperplanes(),this.paintWeylChambers()}switchColorMode(e){this.colorMode=e,this.repaint()}highlightRoot(e){this.highlightedRoots.push(e),this.repaint()}removeHighlightFromRoot(e){this.highlightedRoots=this.highlightedRoots.filter(t=>!t.equal(e)),this.repaint()}showHyperplaneToRoot(e){this.rootWithVisibleHyperplanes.push(e),this.repaint()}hideHyperplaneToRoot(e){this.rootWithVisibleHyperplanes=this.rootWithVisibleHyperplanes.filter(t=>!t.equal(e)),this.repaint()}highlightAllRoots(){this.highlightedRoots=this.rootSystem.getPositiveRoots(),this.repaint()}clearRootHighlight(){this.highlightedRoots=[],this.repaint()}showAllHyperplanes(){this.rootWithVisibleHyperplanes=this.rootSystem.getPositiveRoots(),this.repaint()}allRootsHighlighted(){return this.highlightedRoots.length==this.rootSystem.getPositiveRoots().length}allHyperplanesVisible(){return this.rootWithVisibleHyperplanes.length==this.rootSystem.getPositiveRoots().length}clearHyperplaneVisibility(){this.rootWithVisibleHyperplanes=[],this.repaint()}rootIsHighlighted(e){return this.highlightedRoots.some(t=>t.equal(e))}hyperplaneToRootIsVisible(e){return this.rootWithVisibleHyperplanes.some(t=>t.equal(e))}paintCenter(){this.painter.drawSphere(new Su({center:new Ne(0,0,0),radius:.1,color:de.white}))}paintAxis(){this.painter.drawLine(new Ds({start:new Ne(100,0,0),end:new Ne(-100,0,0),color:de.purple500,width:.03})),this.painter.drawLine(new Ds({start:new Ne(-100,0,0),end:new Ne(100,0,0),color:de.purple500,width:.03})),this.painter.drawLine(new Ds({start:new Ne(0,-100,0),end:new Ne(0,0,0),color:de.purple500,width:.03})),this.painter.drawLine(new Ds({start:new Ne(0,100,0),end:new Ne(0,0,0),color:de.purple500,width:.03})),this.painter.drawLine(new Ds({start:new Ne(0,0,100),end:new Ne(0,0,-100),color:de.purple500,width:.03})),this.painter.drawLine(new Ds({start:new Ne(0,0,-100),end:new Ne(0,0,100),color:de.purple500,width:.03}))}paintHyperplanes(){let e=0;const t=Ar[this.rootSystem.type];for(let i of this.rootSystem.getPositiveRoots()){let r=i.getHyperplane();this.colorMode==Zn.highlight?(this.rootIsHighlighted(i)&&(r.color=t[e]),this.hyperplaneToRootIsVisible(i)&&this.painter.drawPlane(r)):this.hyperplaneToRootIsVisible(i)&&this.painter.drawPlane(r),e+=1}}paintRoots(){let e=0;for(let t of this.rootSystem.getPositiveRoots())this.paintRoot(t,e),this.paintRoot(t.getNegative(),e),e+=1}paintRoot(e,t){this.colorMode==Zn.base?this.paintRootWithBaseMarked(e):this.colorMode==Zn.positiveRoots?this.paintRootWithPositiveMarked(e):this.colorMode==Zn.highlight&&this.paintRootWithHighlight(e,t)}paintRootWithHighlight(e,t){const i=Ar[this.rootSystem.type];let r=de.white;(this.rootIsHighlighted(e)||this.rootIsHighlighted(e.getNegative()))&&(r=i[t]),this.painter.drawSphere(new Su({center:e.getVector(),radius:.1,color:r})),this.painter.drawLine(new Ds({start:Ne.getZero(),end:e.getVector(),width:.04,color:de.white}))}paintRootWithPositiveMarked(e){this.painter.drawSphere(new Su(e.isPositive?{center:e.getVector(),radius:.1,color:de.brightRed}:{center:e.getVector(),radius:.1,color:de.brightGreen})),this.painter.drawLine(new Ds({start:Ne.getZero(),end:e.getVector(),width:.04,color:de.white}))}paintRootWithBaseMarked(e){this.painter.drawSphere(new Su(e.isSimple?{center:e.getVector(),radius:.1,color:de.brightRed}:{center:e.getVector(),radius:.1,color:de.brightGreen})),this.painter.drawLine(new Ds({start:Ne.getZero(),end:e.getVector(),width:.04,color:de.white}))}paintWeylChambers(){const e=this.rootSystem.getFundamentalWeylChamber();this.painter.drawWeylChamber(e)}static#e=this.\u0275fac=function(t){return new(t||Du)(le(Wd),le(ta),le(ho),le(Eu))};static#t=this.\u0275prov=Te({token:Du,factory:Du.\u0275fac,providedIn:"root"})}class Jg{constructor(e,t,i){this.rootSystemService=e,this.activatedRoute=t,this.router=i,this.RootSystems=ea,this.activatedRoute.params.subscribe(r=>{console.log("Change!");let s=decodeURI(r.root_system||"");null!=jd[s]&&this.rootSystemService.setInitialRootSystem(jd[s])})}ngOnInit(){}switchToRootSystem(e){this.rootSystemService.switchRootSystem(jd[e]),this.router.navigate(["/3D",{root_system:e}])}getSelectedRootSystem(){return this.rootSystemService.rootSystem.type}static#e=this.\u0275fac=function(t){return new(t||Jg)(j(ta),j(_s),j(Ln))};static#t=this.\u0275cmp=ii({type:Jg,selectors:[["app-switch-root-system3-d"]],decls:19,vars:8,consts:[["id","switch-panel-container"],["id","switch-panel"],["id","root-systems-container"],[1,"root-system-item",3,"click"],["src","assets/A3.svg",1,"root-system-image"],[1,"root-system-title"],["src","assets/B3.svg",1,"root-system-image"],["src","assets/C3.svg",1,"root-system-image"],["src","assets/D3.svg",1,"root-system-image"]],template:function(t,i){1&t&&(W(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3),Oe("click",function(){return i.switchToRootSystem(i.RootSystems.A3)}),it(4,"img",4),W(5,"small",5),Ce(6,"A3"),Y()(),W(7,"div",3),Oe("click",function(){return i.switchToRootSystem(i.RootSystems.B3)}),it(8,"img",6),W(9,"small",5),Ce(10,"B3"),Y()(),W(11,"div",3),Oe("click",function(){return i.switchToRootSystem(i.RootSystems.C3)}),it(12,"img",7),W(13,"small",5),Ce(14,"C3"),Y()(),W(15,"div",3),Oe("click",function(){return i.switchToRootSystem(i.RootSystems.D3)}),it(16,"img",8),W(17,"small",5),Ce(18,"D3"),Y()()()()()),2&t&&(ge(3),yn("selected","A3"==i.getSelectedRootSystem()),ge(4),yn("selected","B3"==i.getSelectedRootSystem()),ge(4),yn("selected","C3"==i.getSelectedRootSystem()),ge(4),yn("selected","D3"==i.getSelectedRootSystem()))},styles:["#switch-panel-container[_ngcontent-%COMP%]{left:0;top:0;width:100%;display:grid;justify-content:flex-start;padding-left:150px;padding-top:8px;position:absolute;box-sizing:border-box}#switch-panel-container[_ngcontent-%COMP%]   #switch-panel[_ngcontent-%COMP%]{padding:12px;box-sizing:border-box;height:max-content;background-color:#fff;border-radius:8px;shadow:var(--light-shadow);display:grid;align-content:flex-start;justify-content:center}#switch-panel-container[_ngcontent-%COMP%]   #switch-panel[_ngcontent-%COMP%]   #root-systems-container[_ngcontent-%COMP%]{display:grid;grid-template-rows:1fr;grid-auto-flow:column;grid-gap:8px}#switch-panel-container[_ngcontent-%COMP%]   #switch-panel[_ngcontent-%COMP%]   #root-systems-container[_ngcontent-%COMP%]   .root-system-item[_ngcontent-%COMP%]{padding:15px;border:var(--border-thin);border-radius:4px;display:grid;justify-content:center;align-content:center;align-items:center;transition:.15s all ease-in-out;cursor:pointer;position:relative}#switch-panel-container[_ngcontent-%COMP%]   #switch-panel[_ngcontent-%COMP%]   #root-systems-container[_ngcontent-%COMP%]   .root-system-item.selected[_ngcontent-%COMP%], #switch-panel-container[_ngcontent-%COMP%]   #switch-panel[_ngcontent-%COMP%]   #root-systems-container[_ngcontent-%COMP%]   .root-system-item[_ngcontent-%COMP%]:hover{background-color:var(--purple-light)}#switch-panel-container[_ngcontent-%COMP%]   #switch-panel[_ngcontent-%COMP%]   #root-systems-container[_ngcontent-%COMP%]   .root-system-item[_ngcontent-%COMP%]   .root-system-image[_ngcontent-%COMP%]{position:relative;top:-6px;width:40px}#switch-panel-container[_ngcontent-%COMP%]   #switch-panel[_ngcontent-%COMP%]   #root-systems-container[_ngcontent-%COMP%]   .root-system-item[_ngcontent-%COMP%]   .root-system-title[_ngcontent-%COMP%]{font-size:11px;font-weight:600;position:absolute;bottom:4px;color:var(--text-light);text-align:center;width:100%}"]})}function Vne(n,e){if(1&n){const t=Gs();W(0,"div",14)(1,"div",15)(2,"p",16),Ce(3),Y(),it(4,"div",17),Y(),W(5,"div",18)(6,"mat-checkbox",19),Oe("click",function(){const s=Ur(t).$implicit;return zr(Sn().toggleRootHighlight(s))}),Y()(),W(7,"div",20)(8,"mat-checkbox",19),Oe("click",function(){const s=Ur(t).$implicit;return zr(Sn().toggleHyperplane(s))}),Y()()()}if(2&n){const t=e.$implicit,i=Sn();ge(3),br(t.name),ge(1),ls("background-color",i.getColor(t)),ge(2),Ge("checked",i.rootHighlighted(t)&&i.getCurrentColorMode()==i.RootSystemColorMode.highlight),ge(2),Ge("checked",i.hyperplaneToRootVisible(t))}}class Qg{constructor(e,t){this.rootSystemService=e,this.rootSystemPainter=t,this.RootSystemColorMode=Zn,this.rootSystemColors=[],this.Colors=de,this.isExpanded=!0,this.rootListForDisplay=[],this.rootSystemColors=Ar[e.rootSystem.type],this.rootSystemService.rootSystemChangeEvent.subscribe(()=>{this.rootSystemColors=Ar[e.rootSystem.type],this.roots=this.getRoots(),this.rootListForDisplay=this.getDividedRootListForDisplay()}),this.roots=this.getRoots(),this.rootListForDisplay=this.getDividedRootListForDisplay()}toggleExpand(){this.isExpanded=!this.isExpanded}ngOnInit(){}switchHighlightMode(e){e==this.getCurrentColorMode()?this.rootSystemPainter.switchColorMode(Zn.highlight):this.rootSystemPainter.switchColorMode(e)}toggleRootHighlight(e){this.rootSystemPainter.switchColorMode(Zn.highlight),this.rootSystemPainter.rootIsHighlighted(e)?this.rootSystemPainter.removeHighlightFromRoot(e):this.rootSystemPainter.highlightRoot(e)}hyperplaneToRootVisible(e){return this.rootSystemPainter.hyperplaneToRootIsVisible(e)}rootHighlighted(e){return this.rootSystemPainter.rootIsHighlighted(e)}getRoots(){return this.rootSystemService.rootSystem.getPositiveRoots()}toggleHyperplane(e){this.rootSystemPainter.hyperplaneToRootIsVisible(e)?this.rootSystemPainter.hideHyperplaneToRoot(e):this.rootSystemPainter.showHyperplaneToRoot(e)}allRootsHighlighted(){return this.rootSystemPainter.allRootsHighlighted()}allHyperplanesVisible(){return this.rootSystemPainter.allHyperplanesVisible()}toggleAllRootsHighlighted(){this.allRootsHighlighted()?this.rootSystemPainter.clearRootHighlight():(this.rootSystemPainter.highlightAllRoots(),this.rootSystemPainter.switchColorMode(Zn.highlight))}toggleAllRootsHyperplanes(){this.allHyperplanesVisible()?this.rootSystemPainter.clearHyperplaneVisibility():this.rootSystemPainter.showAllHyperplanes()}getColor(e){return this.rootSystemColors[this.roots.findIndex(t=>t.equal(e))]}getCurrentColorMode(){return this.rootSystemPainter.colorMode}getDividedRootListForDisplay(){let e=[],t=0,i=-1;for(;t<=this.roots.length-1;)t%10==0&&t!=this.roots.length-1&&(i+=1,e.push([])),e[i].push(this.roots[t]),t+=1;return e}static#e=this.\u0275fac=function(t){return new(t||Qg)(j(ta),j(Du))};static#t=this.\u0275cmp=ii({type:Qg,selectors:[["app-object-selector3-d"]],decls:40,vars:8,consts:[["id","object-selector-panel"],["id","expand-button"],[3,"fontIcon","click"],["id","heading"],["id","inner-content"],["id","type-selection-container"],[1,"switch-mode-item"],[3,"checked","change"],[1,"switch-mode-text"],[1,"divider"],[1,"subsection-heading"],["id","highlight-table"],[1,"highlight-table-column"],[1,"highlight-table-header"],[1,"object-highlight-item"],[1,"root-vector"],[1,"root-vector-text"],[1,"root-vector-background"],[1,"highlight-toggle"],[3,"checked","click"],[1,"hyperplane-toggle"],["class","object-highlight-item",4,"ngFor","ngForOf"]],template:function(t,i){1&t&&(W(0,"div",0)(1,"button",1)(2,"mat-icon",2),Oe("click",function(){return i.toggleExpand()}),Y()(),W(3,"h3",3),Ce(4,"Highlight"),Y(),W(5,"div",4)(6,"div",5)(7,"div",6)(8,"mat-checkbox",7),Oe("change",function(){return i.switchHighlightMode(i.RootSystemColorMode.base)}),Y(),W(9,"p",8),Ce(10,"Base"),Y()(),W(11,"div",6)(12,"mat-checkbox",7),Oe("change",function(){return i.switchHighlightMode(i.RootSystemColorMode.positiveRoots)}),Y(),W(13,"p",8),Ce(14,"Positive roots"),Y()(),W(15,"div",6)(16,"mat-checkbox",7),Oe("change",function(){return i.switchHighlightMode(i.RootSystemColorMode.highlight)}),Y(),W(17,"p",8),Ce(18,"Custom Highlight"),Y()()(),it(19,"div",9),W(20,"h4",10),Ce(21,"Highlight specific object"),Y(),W(22,"div",11)(23,"div",12)(24,"div",13),it(25,"p"),W(26,"p"),Ce(27,"Root (+,-)"),Y(),W(28,"p"),Ce(29,"Hyperplanes"),Y()(),W(30,"div",14)(31,"div",15)(32,"p",16),Ce(33,"All"),Y(),it(34,"div",17),Y(),W(35,"div",18)(36,"mat-checkbox",19),Oe("click",function(){return i.toggleAllRootsHighlighted()}),Y()(),W(37,"div",20)(38,"mat-checkbox",19),Oe("click",function(){return i.toggleAllRootsHyperplanes()}),Y()()(),Si(39,Vne,9,5,"div",21),Y()()()()),2&t&&(ge(2),Ge("fontIcon",i.isExpanded?"expand_more":"expand_less"),ge(3),Ge("@expanded",i.isExpanded),ge(3),Ge("checked",i.getCurrentColorMode()==i.RootSystemColorMode.base),ge(4),Ge("checked",i.getCurrentColorMode()==i.RootSystemColorMode.positiveRoots),ge(4),Ge("checked",i.getCurrentColorMode()==i.RootSystemColorMode.highlight),ge(20),Ge("checked",i.allRootsHighlighted()),ge(2),Ge("checked",i.allHyperplanesVisible()),ge(1),Ge("ngForOf",i.roots))},dependencies:[Eh,Ud,qg],styles:["#object-selector-panel[_ngcontent-%COMP%]{position:absolute;left:16px;bottom:16px;height:max-content;width:max-content;padding:16px;box-sizing:border-box;background-color:#fff;border-radius:8px;shadow:var(--light-shadow);display:grid;align-content:flex-start;justify-content:stretch;align-items:flex-start}#object-selector-panel[_ngcontent-%COMP%]   #inner-content[_ngcontent-%COMP%]{overflow:hidden}#object-selector-panel[_ngcontent-%COMP%]   #expand-button[_ngcontent-%COMP%]{position:absolute;top:8px;right:12px;color:var(--text-medium);background-color:#fff;border:none;border-radius:50%;transition:all .15s;height:36px;display:grid;justify-content:center;align-content:center;cursor:pointer;width:36px}#object-selector-panel[_ngcontent-%COMP%]   #expand-button[_ngcontent-%COMP%]:hover{background-color:var(--purple-light)}#object-selector-panel[_ngcontent-%COMP%]   #heading[_ngcontent-%COMP%]{font-size:16px;font-weight:700;margin:0 0 4px;padding:0;color:var(--text-dark)}#object-selector-panel[_ngcontent-%COMP%]   .subheading[_ngcontent-%COMP%]{font-size:13px;font-weight:600;margin:0;padding:0;color:var(--text-light)}#object-selector-panel[_ngcontent-%COMP%]   .subsection-heading[_ngcontent-%COMP%]{font-size:14px;font-weight:600;margin:0;padding:0;color:var(--text-medium)}#object-selector-panel[_ngcontent-%COMP%]   #type-selection-container[_ngcontent-%COMP%]{padding:8px 0;display:grid;grid-template-rows:max-content}#object-selector-panel[_ngcontent-%COMP%]   #type-selection-container[_ngcontent-%COMP%]   .switch-mode-item[_ngcontent-%COMP%]{display:grid;grid-template-columns:max-content 1fr;align-items:center}#object-selector-panel[_ngcontent-%COMP%]   #type-selection-container[_ngcontent-%COMP%]   .switch-mode-item[_ngcontent-%COMP%]   .switch-mode-text[_ngcontent-%COMP%]{font-size:13px;color:var(--text-medium);font-weight:600;margin:0;padding:0}#object-selector-panel[_ngcontent-%COMP%]   .divider[_ngcontent-%COMP%]{height:1px;margin:4px 0 12px;width:100%;background-color:var(--purple-light)}#object-selector-panel[_ngcontent-%COMP%]   #highlight-table[_ngcontent-%COMP%]{display:grid;grid-auto-flow:column}#object-selector-panel[_ngcontent-%COMP%]   .highlight-table-column[_ngcontent-%COMP%]{grid-template-rows:repeat(8,max-content);row-gap:4px;grid-auto-flow:column;padding-left:16px}#object-selector-panel[_ngcontent-%COMP%]   .highlight-table-column[_ngcontent-%COMP%]:not(#object-selector-panel   .highlight-table-column[_ngcontent-%COMP%]:first-of-type){border-left:var(--border-thin)}#object-selector-panel[_ngcontent-%COMP%]   .highlight-table-header[_ngcontent-%COMP%]{margin-top:8px;display:grid;grid-template-columns:70px 64px 128px;justify-items:center}#object-selector-panel[_ngcontent-%COMP%]   .highlight-table-header[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:var(--text-light);padding:0;margin:0;font-size:13px;font-weight:600}#object-selector-panel[_ngcontent-%COMP%]   .object-highlight-item[_ngcontent-%COMP%]{display:grid;grid-template-columns:70px 64px 128px;align-items:center}#object-selector-panel[_ngcontent-%COMP%]   .object-highlight-item[_ngcontent-%COMP%]   .root-vector[_ngcontent-%COMP%]{position:relative;height:max-content;width:64px;display:grid;justify-content:center}#object-selector-panel[_ngcontent-%COMP%]   .object-highlight-item[_ngcontent-%COMP%]   .root-vector[_ngcontent-%COMP%]   .root-vector-text[_ngcontent-%COMP%]{display:block;position:relative;z-index:1;font-size:14px;padding:4px;margin:0;cursor:pointer;font-weight:500}#object-selector-panel[_ngcontent-%COMP%]   .object-highlight-item[_ngcontent-%COMP%]   .root-vector[_ngcontent-%COMP%]   .root-vector-background[_ngcontent-%COMP%]{opacity:.6;position:absolute;top:0;left:0;height:100%;width:100%;border-radius:4px}#object-selector-panel[_ngcontent-%COMP%]   .object-highlight-item[_ngcontent-%COMP%]   .highlight-toggle[_ngcontent-%COMP%], #object-selector-panel[_ngcontent-%COMP%]   .object-highlight-item[_ngcontent-%COMP%]   .hyperplane-toggle[_ngcontent-%COMP%]{justify-self:center}"],data:{animation:[Dg("expanded",[Es("true",Ir({height:"*"})),Es("false",Ir({height:"0"})),Ag("* => *",[Tg("125ms ease-in-out")])])]}})}function Bne(n,e){if(1&n&&(W(0,"p"),Ce(1),Y()),2&n){const t=e.$implicit;ge(1),br(t)}}function Une(n,e){if(1&n){const t=Gs();W(0,"div",32),Oe("click",function(){const s=Ur(t).$implicit;return zr(Sn().mirrorWithRoot(s))}),W(1,"div",33)(2,"p",34),Ce(3),Y(),it(4,"div",35),Y()()}if(2&n){const t=e.$implicit,i=Sn();ge(3),br(t.name),ge(1),ls("background-color",i.getColor(t))}}function zne(n,e){if(1&n){const t=Gs();W(0,"div",32),Oe("click",function(){const s=Ur(t).$implicit;return zr(Sn().mirrorWithRoot(s))}),W(1,"div",33)(2,"p",34),Ce(3),Y(),it(4,"div",35),Y()()}if(2&n){const t=e.$implicit,i=Sn();ge(3),br(t.name),ge(1),ls("background-color",i.getColor(t))}}function Hne(n,e){1&n&&(W(0,"p",36),Ce(1,"(None applied)"),Y())}function Gne(n,e){if(1&n){const t=Gs();W(0,"div",32),Oe("click",function(){const s=Ur(t).$implicit;return zr(Sn().mirrorWithRoot(s))}),W(1,"div",33)(2,"p",34),Ce(3),Y(),it(4,"div",35),Y()()}if(2&n){const t=e.$implicit,i=Sn();ge(3),br(t.name),ge(1),ls("background-color",i.getColor(t))}}function jne(n,e){if(1&n&&(W(0,"p",37),Ce(1),Y()),2&n){const t=Sn();ge(1),dh("(Length: ",t.getLength(),")")}}class e_{constructor(e,t,i){this.rootSystemService=e,this.cd=t,this.transformService=i,this.rootSystemColors=[],this.rootsToAppliedMirrorings=[],this.isExpanded=!0,this.moreInformationShown=!1,this.rootSystemService.rootSystemChangeEvent.subscribe(()=>{this.resetTransformations(),this.rootSystemColors=Ar[e.rootSystem.type],this.roots=this.getRoots(),t.detectChanges()}),this.transformService.transformationChanged.subscribe(()=>{this.getAppliedMirrorings()}),this.roots=this.getRoots(),this.rootSystemColors=Ar[e.rootSystem.type]}toggleMoreInformation(){this.moreInformationShown=!this.moreInformationShown}toggleObjectActedOn(e){this.transformService.transformationAppliedTo(e)?this.transformService.removeTransformedObjectType(e):this.transformService.addTransformedObjectType(e),this.cd.detectChanges()}transformationAppliedTo(e){return this.transformService.transformationAppliedTo(e)}toggleExpand(){this.isExpanded=!this.isExpanded}getRoots(){return this.rootSystemService.rootSystem.getPositiveRoots()}getPositiveRootsWithoutBase(){return this.getRoots().filter(e=>!e.isSimple)}getBase(){return this.rootSystemService.rootSystem.getBase()}getColor(e){return this.rootSystemColors[this.roots.findIndex(t=>t.equal(e))]}getCoxeterMatrix(){return this.rootSystemService.rootSystem.coxeterMatrix}getLength(){return this.rootSystemService.rootSystem.getLengthOfTransformation(this.transformService.appliedMirrorings)}mirrorWithRoot(e){this.transformService.mirrorOnPlaneOfRoot(e)}getAppliedMirrorings(){this.rootsToAppliedMirrorings=[...this.transformService.appliedMirrorings].reverse()}resetTransformations(){this.transformService.resetTransformation()}static#e=this.\u0275fac=function(t){return new(t||e_)(j(ta),j(Mo),j(Eu))};static#t=this.\u0275cmp=ii({type:e_,selectors:[["app-object-transformer-panel"]],decls:60,vars:13,consts:[["id","object-selector-panel"],["id","heading"],["id","expand-button"],[3,"fontIcon","click"],["id","inner-content"],["id","more-information",3,"click"],["id","more-information-header"],["id","more-information-text"],["id","more-information-toggle-button"],[3,"fontIcon"],["id","content-wrapper"],["id","information-container"],[1,"information-item"],[1,"information-item-text"],[1,"matrix3"],[1,"matrix-bracket-left"],[4,"ngFor","ngForOf"],[1,"matrix-bracket-right"],[1,"divider"],["id","action-on-table"],[1,"description-text"],[1,"action-object"],[3,"checked","click"],[1,"action-object-text"],[1,"sub-description-text"],[1,"mirror-root-container"],["class","mirror-root-item",3,"click",4,"ngFor","ngForOf"],["id","applied-mirrorings-container"],["id","reflection-placeholder-text",4,"ngIf"],["id","mirrorings"],["id","length-text",4,"ngIf"],["id","reset-button",3,"click"],[1,"mirror-root-item",3,"click"],[1,"root-vector"],[1,"root-vector-text"],[1,"root-vector-background"],["id","reflection-placeholder-text"],["id","length-text"]],template:function(t,i){1&t&&(W(0,"div",0)(1,"h3",1),Ce(2,"Transform"),Y(),W(3,"button",2)(4,"mat-icon",3),Oe("click",function(){return i.toggleExpand()}),Y()(),W(5,"div",4)(6,"div",5),Oe("click",function(){return i.toggleMoreInformation()}),W(7,"div",6)(8,"h5",7),Ce(9,"More Information"),Y(),W(10,"button",8),it(11,"mat-icon",9),Y()(),W(12,"div",10)(13,"div",11)(14,"div",12)(15,"p",13),Ce(16,"Coxeter Matrix"),Y(),W(17,"div",14)(18,"div",15),Ce(19,"["),Y(),Si(20,Bne,2,1,"p",16),W(21,"div",17),Ce(22,"]"),Y()()()()()(),it(23,"div",18),W(24,"div",19)(25,"p",20),Ce(26,"Apply group action to:"),Y(),W(27,"div",21)(28,"mat-checkbox",22),Oe("click",function(){return i.toggleObjectActedOn("ROOTS")}),Y(),W(29,"p",23),Ce(30,"Roots"),Y()(),W(31,"div",21)(32,"mat-checkbox",22),Oe("click",function(){return i.toggleObjectActedOn("WEYL_CHAMBERS")}),Y(),W(33,"p",23),Ce(34,"Weyl Chambers"),Y()(),W(35,"div",21)(36,"mat-checkbox",22),Oe("click",function(){return i.toggleObjectActedOn("HYPERPLANES")}),Y(),W(37,"p",23),Ce(38,"Hyperplanes"),Y()()(),it(39,"div",18),W(40,"p",20),Ce(41,"Mirror at hyperplane orthogonal to root:"),Y(),W(42,"p",24),Ce(43,"Base:"),Y(),W(44,"div",25),Si(45,Une,5,3,"div",26),Y(),W(46,"p",24),Ce(47,"Other positive roots:"),Y(),W(48,"div",25),Si(49,zne,5,3,"div",26),Y(),it(50,"div",18),W(51,"p",20),Ce(52,"Applied relections:"),Y(),W(53,"div",27),Si(54,Hne,2,0,"p",28),W(55,"div",29),Si(56,Gne,5,3,"div",26),Y(),Si(57,jne,2,1,"p",30),W(58,"div",31),Oe("click",function(){return i.resetTransformations()}),Ce(59,"Reset"),Y()()()()),2&t&&(ge(4),Ge("fontIcon",i.isExpanded?"expand_more":"expand_less"),ge(1),Ge("@expanded",i.isExpanded),ge(6),Ge("fontIcon",i.moreInformationShown?"expand_less":"expand_more"),ge(2),Ge("@expanded",i.moreInformationShown),ge(7),Ge("ngForOf",i.getCoxeterMatrix()),ge(8),Ge("checked",i.transformationAppliedTo("ROOTS")),ge(4),Ge("checked",i.transformationAppliedTo("WEYL_CHAMBERS")),ge(4),Ge("checked",i.transformationAppliedTo("HYPERPLANES")),ge(9),Ge("ngForOf",i.getBase()),ge(4),Ge("ngForOf",i.getPositiveRootsWithoutBase()),ge(5),Ge("ngIf",0==i.rootsToAppliedMirrorings.length),ge(2),Ge("ngForOf",i.rootsToAppliedMirrorings),ge(1),Ge("ngIf",0!=i.rootsToAppliedMirrorings.length))},dependencies:[Eh,P0,Ud,qg],styles:["#object-selector-panel[_ngcontent-%COMP%]{position:absolute;right:16px;bottom:16px;height:max-content;width:400px;padding:16px;box-sizing:border-box;background-color:#fff;border-radius:8px;shadow:var(--light-shadow);display:grid;align-content:flex-start;justify-content:stretch;align-items:flex-start}#object-selector-panel[_ngcontent-%COMP%]   #inner-content[_ngcontent-%COMP%]{overflow:hidden}#object-selector-panel[_ngcontent-%COMP%]   #expand-button[_ngcontent-%COMP%]{position:absolute;top:8px;right:12px;color:var(--text-medium);background-color:#fff;border:none;border-radius:50%;transition:all .15s;height:36px;display:grid;justify-content:center;align-content:center;cursor:pointer;width:36px}#object-selector-panel[_ngcontent-%COMP%]   #expand-button[_ngcontent-%COMP%]:hover{background-color:var(--purple-light)}#object-selector-panel[_ngcontent-%COMP%]   #heading[_ngcontent-%COMP%]{font-size:16px;font-weight:700;margin:0 0 4px;padding:0;color:var(--text-dark)}#object-selector-panel[_ngcontent-%COMP%]   .subheading[_ngcontent-%COMP%]{font-size:13px;font-weight:600;margin:0;padding:0;color:var(--text-light)}#object-selector-panel[_ngcontent-%COMP%]   .subsection-heading[_ngcontent-%COMP%]{font-size:14px;font-weight:600;margin:0;padding:0;color:var(--text-medium)}#object-selector-panel[_ngcontent-%COMP%]   .description-text[_ngcontent-%COMP%]{font-size:14px;font-weight:600;margin:8px 0 0;padding:0;color:var(--text-dark)}#object-selector-panel[_ngcontent-%COMP%]   #length-text[_ngcontent-%COMP%]{font-size:14px;font-style:italic;font-weight:500;color:var(--text-light);display:block;width:100%;box-sizing:border-box;text-align:right;padding-right:8px}#object-selector-panel[_ngcontent-%COMP%]   #reflection-placeholder-text[_ngcontent-%COMP%]{font-size:14px;font-weight:400;color:var(--text-light);padding:0;margin:0}#object-selector-panel[_ngcontent-%COMP%]   .sub-description-text[_ngcontent-%COMP%]{color:var(--text-light);margin:0;font-size:13px;font-weight:600;padding:0}#object-selector-panel[_ngcontent-%COMP%]   #more-information[_ngcontent-%COMP%]{background-color:var(--purple-light);padding:8px;margin-top:8px;border-radius:4px}#object-selector-panel[_ngcontent-%COMP%]   #more-information[_ngcontent-%COMP%]   #more-information-header[_ngcontent-%COMP%]{position:relative;display:grid;align-content:center;align-items:center;height:24px;border:1px solid var(--purple-light);cursor:pointer}#object-selector-panel[_ngcontent-%COMP%]   #more-information[_ngcontent-%COMP%]   #more-information-header[_ngcontent-%COMP%]   #more-information-text[_ngcontent-%COMP%]{font-size:13px;color:var(--text-medium);font-weight:700;margin:0;padding:0}#object-selector-panel[_ngcontent-%COMP%]   #more-information[_ngcontent-%COMP%]   #more-information-header[_ngcontent-%COMP%]   #more-information-toggle-button[_ngcontent-%COMP%]{right:12px;position:absolute;top:0;border:none;background-color:transparent;border-radius:50%;height:16px;width:16px;color:var(--text-medium);cursor:pointer}#object-selector-panel[_ngcontent-%COMP%]   #more-information[_ngcontent-%COMP%]   #content-wrapper[_ngcontent-%COMP%]{overflow:hidden}#object-selector-panel[_ngcontent-%COMP%]   #more-information[_ngcontent-%COMP%]   #content-wrapper[_ngcontent-%COMP%]   #information-container[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(3,1fr)}#object-selector-panel[_ngcontent-%COMP%]   #more-information[_ngcontent-%COMP%]   #content-wrapper[_ngcontent-%COMP%]   #information-container[_ngcontent-%COMP%]   .information-item[_ngcontent-%COMP%]{display:grid;justify-items:center;padding-bottom:16px}#object-selector-panel[_ngcontent-%COMP%]   #more-information[_ngcontent-%COMP%]   #content-wrapper[_ngcontent-%COMP%]   #information-container[_ngcontent-%COMP%]   .information-item[_ngcontent-%COMP%]   .information-item-text[_ngcontent-%COMP%]{font-size:13px;color:var(--text-dark);font-weight:700}#object-selector-panel[_ngcontent-%COMP%]   #more-information[_ngcontent-%COMP%]   #content-wrapper[_ngcontent-%COMP%]   #information-container[_ngcontent-%COMP%]   .information-item[_ngcontent-%COMP%]   .matrix3[_ngcontent-%COMP%]{display:grid;grid-template-columns:16px 16px 16px;column-gap:6px;position:relative;margin-left:4px;box-sizing:border-box;width:max-content}#object-selector-panel[_ngcontent-%COMP%]   #more-information[_ngcontent-%COMP%]   #content-wrapper[_ngcontent-%COMP%]   #information-container[_ngcontent-%COMP%]   .information-item[_ngcontent-%COMP%]   .matrix3[_ngcontent-%COMP%]   .matrix-bracket-left[_ngcontent-%COMP%]{position:absolute;font-size:62px;left:-16px;margin:0;padding:0;top:-18px;color:var(--text-light)}#object-selector-panel[_ngcontent-%COMP%]   #more-information[_ngcontent-%COMP%]   #content-wrapper[_ngcontent-%COMP%]   #information-container[_ngcontent-%COMP%]   .information-item[_ngcontent-%COMP%]   .matrix3[_ngcontent-%COMP%]   .matrix-bracket-right[_ngcontent-%COMP%]{position:absolute;font-size:62px;right:-16px;margin:0;padding:0;top:-18px;color:var(--text-light)}#object-selector-panel[_ngcontent-%COMP%]   #more-information[_ngcontent-%COMP%]   #content-wrapper[_ngcontent-%COMP%]   #information-container[_ngcontent-%COMP%]   .information-item[_ngcontent-%COMP%]   .matrix3[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;padding:0;display:block;font-size:13px;color:var(--text-dark);font-weight:700;text-align:center}#object-selector-panel[_ngcontent-%COMP%]   #action-on-table[_ngcontent-%COMP%]{padding:0 0 4px;display:grid;grid-template-rows:max-content}#object-selector-panel[_ngcontent-%COMP%]   #action-on-table[_ngcontent-%COMP%]   .action-object[_ngcontent-%COMP%]{display:grid;grid-template-columns:max-content 1fr;align-items:center}#object-selector-panel[_ngcontent-%COMP%]   #action-on-table[_ngcontent-%COMP%]   .action-object[_ngcontent-%COMP%]   .action-object-text[_ngcontent-%COMP%]{font-size:13px;color:var(--text-medium);font-weight:600;margin:0;padding:0}#object-selector-panel[_ngcontent-%COMP%]   #option-container[_ngcontent-%COMP%]{padding:8px 0;display:grid;grid-template-rows:max-content}#object-selector-panel[_ngcontent-%COMP%]   #option-container[_ngcontent-%COMP%]   .option-item[_ngcontent-%COMP%]{display:grid;grid-template-columns:max-content 1fr;align-items:center}#object-selector-panel[_ngcontent-%COMP%]   #option-container[_ngcontent-%COMP%]   .option-item[_ngcontent-%COMP%]   .option-text[_ngcontent-%COMP%]{font-size:13px;color:var(--text-medium);font-weight:500;margin:0;padding:0}#object-selector-panel[_ngcontent-%COMP%]   .divider[_ngcontent-%COMP%]{height:1px;margin:8px 0 12px;width:100%;background-color:var(--purple-light)}#object-selector-panel[_ngcontent-%COMP%]   .mirror-root-container[_ngcontent-%COMP%]{padding:4px 0;margin-bottom:4px;display:grid;grid-template-columns:repeat(5,max-content);grid-gap:8px}#object-selector-panel[_ngcontent-%COMP%]   .mirror-root-item[_ngcontent-%COMP%]   .root-vector[_ngcontent-%COMP%]{position:relative;height:max-content;width:64px;display:grid;justify-content:center}#object-selector-panel[_ngcontent-%COMP%]   .mirror-root-item[_ngcontent-%COMP%]   .root-vector[_ngcontent-%COMP%]   .root-vector-text[_ngcontent-%COMP%]{display:block;position:relative;z-index:1;font-size:14px;padding:4px;margin:0;cursor:pointer;font-weight:500}#object-selector-panel[_ngcontent-%COMP%]   .mirror-root-item[_ngcontent-%COMP%]   .root-vector[_ngcontent-%COMP%]   .root-vector-background[_ngcontent-%COMP%]{opacity:.6;position:absolute;top:0;left:0;height:100%;width:100%;border-radius:4px}#object-selector-panel[_ngcontent-%COMP%]   #applied-mirrorings-container[_ngcontent-%COMP%]{padding-top:4px}#object-selector-panel[_ngcontent-%COMP%]   #applied-mirrorings-container[_ngcontent-%COMP%]   #mirrorings[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(5,max-content);grid-gap:8px}#object-selector-panel[_ngcontent-%COMP%]   #applied-mirrorings-container[_ngcontent-%COMP%]   #reset-button[_ngcontent-%COMP%]{background-color:var(--background-color);color:#fff;padding:8px 16px;font-weight:600;font-size:12px;border:none;border-radius:4px;cursor:pointer;width:max-content;margin-top:12px}"],data:{animation:[Dg("expanded",[Es("void",Ir({height:"0"})),Es("true",Ir({height:"*"})),Es("false",Ir({height:"0"})),Ag("true <=> false",[Tg("125ms ease-in-out")])])]},changeDetection:0})}const Wne=["miniView"];class t_{constructor(e){this.sceneManager=e}ngAfterViewInit(){this.initializeThreeJs()}initializeThreeJs(){this.sceneManager.initializeMiniView(this.miniViewCont.nativeElement)}static#e=this.\u0275fac=function(t){return new(t||t_)(j(ho))};static#t=this.\u0275cmp=ii({type:t_,selectors:[["app-mini-view3-d"]],viewQuery:function(t,i){if(1&t&&xr(Wne,5),2&t){let r;tr(r=nr())&&(i.miniViewCont=r.first)}},decls:3,vars:0,consts:[["id","mini-view-container"],["id","mini-view-canvas"],["miniView",""]],template:function(t,i){1&t&&(W(0,"div",0),it(1,"div",1,2),Y())},styles:["#mini-view-container[_ngcontent-%COMP%]{height:160px;width:160px;position:absolute;top:16px;right:24px;border-radius:32px;border:5px solid white;overflow:hidden}#mini-view-container[_ngcontent-%COMP%]   #mini-view-canvas[_ngcontent-%COMP%]{height:100%;width:100%}"]})}const $ne=["canvas"];class n_{constructor(e,t){this.sceneManager=e,this.rootSystemPainter=t}ngOnInit(){}ngAfterViewInit(){this.initializeThreeJs(),this.rootSystemPainter.paint()}initializeThreeJs(){this.sceneManager.initializeScene(this.canvas.nativeElement),this.sceneManager.startDisplay()}static#e=this.\u0275fac=function(t){return new(t||n_)(j(ho),j(Du))};static#t=this.\u0275cmp=ii({type:n_,selectors:[["app-root-systems3-d"]],viewQuery:function(t,i){if(1&t&&xr($ne,5),2&t){let r;tr(r=nr())&&(i.canvas=r.first)}},decls:6,vars:0,consts:[["id","main-canvas"],["canvas",""]],template:function(t,i){1&t&&it(0,"div",0,1)(2,"app-switch-root-system3-d")(3,"app-object-selector3-d")(4,"app-object-transformer-panel")(5,"app-mini-view3-d")},dependencies:[Jg,Qg,e_,t_],styles:["#main-canvas[_ngcontent-%COMP%]{height:100vh;width:100vw}"]})}const qne=[{path:"2D",component:Gd},{path:"3D",component:n_},{path:"**",component:Gd}];class i_{static#e=this.\u0275fac=function(t){return new(t||i_)};static#t=this.\u0275mod=bi({type:i_});static#n=this.\u0275inj=hi({imports:[gP.forRoot(qne),gP]})}class r_{constructor(e,t){this.switchedToDimension=new sn,this.selectedDimension="2D",t.events.subscribe(i=>{if(i instanceof To){console.log(i);const r=i.url;let s=r.substring(r.indexOf("/")+1,r.lastIndexOf(";"));("2D"==s||"3D"==s)&&(this.selectedDimension=s)}})}switchToDimension(e){this.selectedDimension=e,this.switchedToDimension.emit(e)}static#e=this.\u0275fac=function(t){return new(t||r_)(j(_s),j(Ln))};static#t=this.\u0275cmp=ii({type:r_,selectors:[["app-dimension-switch-button"]],outputs:{switchedToDimension:"switchedToDimension"},decls:7,vars:4,consts:[["id","dimension-button"],[1,"dimension-item",3,"click"]],template:function(t,i){1&t&&(W(0,"div",0)(1,"div",1),Oe("click",function(){return i.switchToDimension("2D")}),W(2,"p"),Ce(3,"2D"),Y()(),W(4,"div",1),Oe("click",function(){return i.switchToDimension("3D")}),W(5,"p"),Ce(6,"3D"),Y()()()),2&t&&(ge(1),yn("selected","2D"==i.selectedDimension),ge(3),yn("selected","3D"==i.selectedDimension))},styles:["#dimension-button[_ngcontent-%COMP%]{height:64px;background-color:#fff;border-radius:16px;position:absolute;display:grid;grid-template-columns:1fr 1fr;top:8px;left:8px;z-index:100}#dimension-button[_ngcontent-%COMP%]   .dimension-item[_ngcontent-%COMP%]{width:64px;font-size:16px;font-weight:700;color:var(--text-dark);display:grid;justify-content:center;align-content:center;cursor:pointer}#dimension-button[_ngcontent-%COMP%]   .dimension-item.selected[_ngcontent-%COMP%]{background-color:var(--purple-medium);border-radius:16px}"]})}class s_{constructor(e,t){this.router=e,this.route=t,this.showDimension="2D",this.initializeView()}ngOnInit(){}initializeView(){let e=this.route.snapshot.url.toString().split("/").pop();("2D"==e||"3D"==e)&&(this.showDimension=e,null!=this.route.snapshot.params.root_system&&this.router.navigate(["/"+this.showDimension,{root_system:this.route.snapshot.params.root_system}]))}switchDimension(e){this.router.navigateByUrl("/"+e)}static#e=this.\u0275fac=function(t){return new(t||s_)(j(Ln),j(_s))};static#t=this.\u0275cmp=ii({type:s_,selectors:[["app-homepage"]],decls:3,vars:0,consts:[[3,"switchedToDimension"]],template:function(t,i){1&t&&(W(0,"main")(1,"app-dimension-switch-button",0),Oe("switchedToDimension",function(s){return i.switchDimension(s)}),Y(),it(2,"router-outlet"),Y())},dependencies:[ab,r_],styles:["#main[_ngcontent-%COMP%]{display:block;height:100%;width:100%;overflow:hidden;box-sizing:border-box}"]})}class o_{constructor(){this.title="rootSystems"}static#e=this.\u0275fac=function(t){return new(t||o_)};static#t=this.\u0275cmp=ii({type:o_,selectors:[["app-root"]],decls:1,vars:0,template:function(t,i){1&t&&it(0,"app-homepage")},dependencies:[s_]})}function KN(n){return new K(3e3,!1)}function Tie(){return typeof window<"u"&&typeof window.document<"u"}function vM(){return typeof process<"u"&&"[object process]"==={}.toString.call(process)}function na(n){switch(n.length){case 0:return new Rd;case 1:return n[0];default:return new Jk(n)}}function JN(n,e,t,i,r=new Map,s=new Map){const o=[],a=[];let c=-1,l=null;if(i.forEach(u=>{const h=u.get("offset"),d=h==c,f=d&&l||new Map;u.forEach((p,m)=>{let g=m,_=p;if("offset"!==m)switch(g=e.normalizePropertyName(g,o),_){case"!":_=r.get(m);break;case uo:_=s.get(m);break;default:_=e.normalizeStyleValue(m,g,_,o)}f.set(g,_)}),d||a.push(f),l=f,c=h}),o.length)throw function gie(n){return new K(3502,!1)}();return a}function bM(n,e,t,i){switch(e){case"start":n.onStart(()=>i(t&&xM(t,"start",n)));break;case"done":n.onDone(()=>i(t&&xM(t,"done",n)));break;case"destroy":n.onDestroy(()=>i(t&&xM(t,"destroy",n)))}}function xM(n,e,t){const s=wM(n.element,n.triggerName,n.fromState,n.toState,e||n.phaseName,t.totalTime??n.totalTime,!!t.disabled),o=n._data;return null!=o&&(s._data=o),s}function wM(n,e,t,i,r="",s=0,o){return{element:n,triggerName:e,fromState:t,toState:i,phaseName:r,totalTime:s,disabled:!!o}}function hr(n,e,t){let i=n.get(e);return i||n.set(e,i=t),i}function QN(n){const e=n.indexOf(":");return[n.substring(1,e),n.slice(e+1)]}let MM=(n,e)=>!1,eF=(n,e,t)=>[],tF=null;function CM(n){const e=n.parentNode||n.host;return e===tF?null:e}(vM()||typeof Element<"u")&&(Tie()?(tF=(()=>document.documentElement)(),MM=(n,e)=>{for(;e;){if(e===n)return!0;e=CM(e)}return!1}):MM=(n,e)=>n.contains(e),eF=(n,e,t)=>{if(t)return Array.from(n.querySelectorAll(e));const i=n.querySelector(e);return i?[i]:[]});let mc=null,nF=!1;const iF=MM,rF=eF;let sF=(()=>{class n{validateStyleProperty(t){return function Iie(n){mc||(mc=function Pie(){return typeof document<"u"?document.body:null}()||{},nF=!!mc.style&&"WebkitAppearance"in mc.style);let e=!0;return mc.style&&!function Aie(n){return"ebkit"==n.substring(1,6)}(n)&&(e=n in mc.style,!e&&nF&&(e="Webkit"+n.charAt(0).toUpperCase()+n.slice(1)in mc.style)),e}(t)}matchesElement(t,i){return!1}containsElement(t,i){return iF(t,i)}getParentElement(t){return CM(t)}query(t,i,r){return rF(t,i,r)}computeStyle(t,i,r){return r||""}animate(t,i,r,s,o,a=[],c){return new Rd(r,s)}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=Te({token:n,factory:n.\u0275fac}),n})(),SM=(()=>{class n{}return n.NOOP=new sF,n})();const EM="ng-enter",a_="ng-leave",c_="ng-trigger",l_=".ng-trigger",aF="ng-animating",DM=".ng-animating";function fo(n){if("number"==typeof n)return n;const e=n.match(/^(-?[\.\d]+)(m?s)/);return!e||e.length<2?0:TM(parseFloat(e[1]),e[2])}function TM(n,e){return"s"===e?1e3*n:n}function u_(n,e,t){return n.hasOwnProperty("duration")?n:function kie(n,e,t){let r,s=0,o="";if("string"==typeof n){const a=n.match(/^(-?[\.\d]+)(m?s)(?:\s+(-?[\.\d]+)(m?s))?(?:\s+([-a-z]+(?:\(.+?\))?))?$/i);if(null===a)return e.push(KN()),{duration:0,delay:0,easing:""};r=TM(parseFloat(a[1]),a[2]);const c=a[3];null!=c&&(s=TM(parseFloat(c),a[4]));const l=a[5];l&&(o=l)}else r=n;if(!t){let a=!1,c=e.length;r<0&&(e.push(function Xne(){return new K(3100,!1)}()),a=!0),s<0&&(e.push(function Yne(){return new K(3101,!1)}()),a=!0),a&&e.splice(c,0,KN())}return{duration:r,delay:s,easing:o}}(n,e,t)}function $d(n,e={}){return Object.keys(n).forEach(t=>{e[t]=n[t]}),e}function cF(n){const e=new Map;return Object.keys(n).forEach(t=>{e.set(t,n[t])}),e}function ia(n,e=new Map,t){if(t)for(let[i,r]of t)e.set(i,r);for(let[i,r]of n)e.set(i,r);return e}function uF(n,e,t){return t?e+":"+t+";":""}function hF(n){let e="";for(let t=0;t<n.style.length;t++){const i=n.style.item(t);e+=uF(0,i,n.style.getPropertyValue(i))}for(const t in n.style)n.style.hasOwnProperty(t)&&!t.startsWith("_")&&(e+=uF(0,Vie(t),n.style[t]));n.setAttribute("style",e)}function Ts(n,e,t){n.style&&(e.forEach((i,r)=>{const s=IM(r);t&&!t.has(r)&&t.set(r,n.style[s]),n.style[s]=i}),vM()&&hF(n))}function gc(n,e){n.style&&(e.forEach((t,i)=>{const r=IM(i);n.style[r]=""}),vM()&&hF(n))}function qd(n){return Array.isArray(n)?1==n.length?n[0]:Zk(n):n}const AM=new RegExp("{{\\s*(.+?)\\s*}}","g");function dF(n){let e=[];if("string"==typeof n){let t;for(;t=AM.exec(n);)e.push(t[1]);AM.lastIndex=0}return e}function Xd(n,e,t){const i=n.toString(),r=i.replace(AM,(s,o)=>{let a=e[o];return null==a&&(t.push(function Kne(n){return new K(3003,!1)}()),a=""),a.toString()});return r==i?n:r}function h_(n){const e=[];let t=n.next();for(;!t.done;)e.push(t.value),t=n.next();return e}const Fie=/-+([a-z0-9])/g;function IM(n){return n.replace(Fie,(...e)=>e[1].toUpperCase())}function Vie(n){return n.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()}function dr(n,e,t){switch(e.type){case 7:return n.visitTrigger(e,t);case 0:return n.visitState(e,t);case 1:return n.visitTransition(e,t);case 2:return n.visitSequence(e,t);case 3:return n.visitGroup(e,t);case 4:return n.visitAnimate(e,t);case 5:return n.visitKeyframes(e,t);case 6:return n.visitStyle(e,t);case 8:return n.visitReference(e,t);case 9:return n.visitAnimateChild(e,t);case 10:return n.visitAnimateRef(e,t);case 11:return n.visitQuery(e,t);case 12:return n.visitStagger(e,t);default:throw function Jne(n){return new K(3004,!1)}()}}function fF(n,e){return window.getComputedStyle(n)[e]}function jie(n,e){const t=[];return"string"==typeof n?n.split(/\s*,\s*/).forEach(i=>function Wie(n,e,t){if(":"==n[0]){const c=function $ie(n,e){switch(n){case":enter":return"void => *";case":leave":return"* => void";case":increment":return(t,i)=>parseFloat(i)>parseFloat(t);case":decrement":return(t,i)=>parseFloat(i)<parseFloat(t);default:return e.push(function die(n){return new K(3016,!1)}()),"* => *"}}(n,t);if("function"==typeof c)return void e.push(c);n=c}const i=n.match(/^(\*|[-\w]+)\s*(<?[=-]>)\s*(\*|[-\w]+)$/);if(null==i||i.length<4)return t.push(function hie(n){return new K(3015,!1)}()),e;const r=i[1],s=i[2],o=i[3];e.push(pF(r,o));"<"==s[0]&&!("*"==r&&"*"==o)&&e.push(pF(o,r))}(i,t,e)):t.push(n),t}const m_=new Set(["true","1"]),g_=new Set(["false","0"]);function pF(n,e){const t=m_.has(n)||g_.has(n),i=m_.has(e)||g_.has(e);return(r,s)=>{let o="*"==n||n==r,a="*"==e||e==s;return!o&&t&&"boolean"==typeof r&&(o=r?m_.has(n):g_.has(n)),!a&&i&&"boolean"==typeof s&&(a=s?m_.has(e):g_.has(e)),o&&a}}const qie=new RegExp("s*:selfs*,?","g");function PM(n,e,t,i){return new Xie(n).build(e,t,i)}class Xie{constructor(e){this._driver=e}build(e,t,i){const r=new Kie(t);return this._resetContextStyleTimingState(r),dr(this,qd(e),r)}_resetContextStyleTimingState(e){e.currentQuerySelector="",e.collectedStyles=new Map,e.collectedStyles.set("",new Map),e.currentTime=0}visitTrigger(e,t){let i=t.queryCount=0,r=t.depCount=0;const s=[],o=[];return"@"==e.name.charAt(0)&&t.errors.push(function eie(){return new K(3006,!1)}()),e.definitions.forEach(a=>{if(this._resetContextStyleTimingState(t),0==a.type){const c=a,l=c.name;l.toString().split(/\s*,\s*/).forEach(u=>{c.name=u,s.push(this.visitState(c,t))}),c.name=l}else if(1==a.type){const c=this.visitTransition(a,t);i+=c.queryCount,r+=c.depCount,o.push(c)}else t.errors.push(function tie(){return new K(3007,!1)}())}),{type:7,name:e.name,states:s,transitions:o,queryCount:i,depCount:r,options:null}}visitState(e,t){const i=this.visitStyle(e.styles,t),r=e.options&&e.options.params||null;if(i.containsDynamicStyles){const s=new Set,o=r||{};i.styles.forEach(a=>{a instanceof Map&&a.forEach(c=>{dF(c).forEach(l=>{o.hasOwnProperty(l)||s.add(l)})})}),s.size&&(h_(s.values()),t.errors.push(function nie(n,e){return new K(3008,!1)}()))}return{type:0,name:e.name,style:i,options:r?{params:r}:null}}visitTransition(e,t){t.queryCount=0,t.depCount=0;const i=dr(this,qd(e.animation),t);return{type:1,matchers:jie(e.expr,t.errors),animation:i,queryCount:t.queryCount,depCount:t.depCount,options:_c(e.options)}}visitSequence(e,t){return{type:2,steps:e.steps.map(i=>dr(this,i,t)),options:_c(e.options)}}visitGroup(e,t){const i=t.currentTime;let r=0;const s=e.steps.map(o=>{t.currentTime=i;const a=dr(this,o,t);return r=Math.max(r,t.currentTime),a});return t.currentTime=r,{type:3,steps:s,options:_c(e.options)}}visitAnimate(e,t){const i=function Qie(n,e){if(n.hasOwnProperty("duration"))return n;if("number"==typeof n)return RM(u_(n,e).duration,0,"");const t=n;if(t.split(/\s+/).some(s=>"{"==s.charAt(0)&&"{"==s.charAt(1))){const s=RM(0,0,"");return s.dynamic=!0,s.strValue=t,s}const r=u_(t,e);return RM(r.duration,r.delay,r.easing)}(e.timings,t.errors);t.currentAnimateTimings=i;let r,s=e.styles?e.styles:Ir({});if(5==s.type)r=this.visitKeyframes(s,t);else{let o=e.styles,a=!1;if(!o){a=!0;const l={};i.easing&&(l.easing=i.easing),o=Ir(l)}t.currentTime+=i.duration+i.delay;const c=this.visitStyle(o,t);c.isEmptyStep=a,r=c}return t.currentAnimateTimings=null,{type:4,timings:i,style:r,options:null}}visitStyle(e,t){const i=this._makeStyleAst(e,t);return this._validateStyleAst(i,t),i}_makeStyleAst(e,t){const i=[],r=Array.isArray(e.styles)?e.styles:[e.styles];for(let a of r)"string"==typeof a?a===uo?i.push(a):t.errors.push(new K(3002,!1)):i.push(cF(a));let s=!1,o=null;return i.forEach(a=>{if(a instanceof Map&&(a.has("easing")&&(o=a.get("easing"),a.delete("easing")),!s))for(let c of a.values())if(c.toString().indexOf("{{")>=0){s=!0;break}}),{type:6,styles:i,easing:o,offset:e.offset,containsDynamicStyles:s,options:null}}_validateStyleAst(e,t){const i=t.currentAnimateTimings;let r=t.currentTime,s=t.currentTime;i&&s>0&&(s-=i.duration+i.delay),e.styles.forEach(o=>{"string"!=typeof o&&o.forEach((a,c)=>{const l=t.collectedStyles.get(t.currentQuerySelector),u=l.get(c);let h=!0;u&&(s!=r&&s>=u.startTime&&r<=u.endTime&&(t.errors.push(function rie(n,e,t,i,r){return new K(3010,!1)}()),h=!1),s=u.startTime),h&&l.set(c,{startTime:s,endTime:r}),t.options&&function Nie(n,e,t){const i=e.params||{},r=dF(n);r.length&&r.forEach(s=>{i.hasOwnProperty(s)||t.push(function Zne(n){return new K(3001,!1)}())})}(a,t.options,t.errors)})})}visitKeyframes(e,t){const i={type:5,styles:[],options:null};if(!t.currentAnimateTimings)return t.errors.push(function sie(){return new K(3011,!1)}()),i;let s=0;const o=[];let a=!1,c=!1,l=0;const u=e.steps.map(_=>{const b=this._makeStyleAst(_,t);let y=null!=b.offset?b.offset:function Jie(n){if("string"==typeof n)return null;let e=null;if(Array.isArray(n))n.forEach(t=>{if(t instanceof Map&&t.has("offset")){const i=t;e=parseFloat(i.get("offset")),i.delete("offset")}});else if(n instanceof Map&&n.has("offset")){const t=n;e=parseFloat(t.get("offset")),t.delete("offset")}return e}(b.styles),v=0;return null!=y&&(s++,v=b.offset=y),c=c||v<0||v>1,a=a||v<l,l=v,o.push(v),b});c&&t.errors.push(function oie(){return new K(3012,!1)}()),a&&t.errors.push(function aie(){return new K(3200,!1)}());const h=e.steps.length;let d=0;s>0&&s<h?t.errors.push(function cie(){return new K(3202,!1)}()):0==s&&(d=1/(h-1));const f=h-1,p=t.currentTime,m=t.currentAnimateTimings,g=m.duration;return u.forEach((_,b)=>{const y=d>0?b==f?1:d*b:o[b],v=y*g;t.currentTime=p+m.delay+v,m.duration=v,this._validateStyleAst(_,t),_.offset=y,i.styles.push(_)}),i}visitReference(e,t){return{type:8,animation:dr(this,qd(e.animation),t),options:_c(e.options)}}visitAnimateChild(e,t){return t.depCount++,{type:9,options:_c(e.options)}}visitAnimateRef(e,t){return{type:10,animation:this.visitReference(e.animation,t),options:_c(e.options)}}visitQuery(e,t){const i=t.currentQuerySelector,r=e.options||{};t.queryCount++,t.currentQuery=e;const[s,o]=function Yie(n){const e=!!n.split(/\s*,\s*/).find(t=>":self"==t);return e&&(n=n.replace(qie,"")),n=n.replace(/@\*/g,l_).replace(/@\w+/g,t=>l_+"-"+t.slice(1)).replace(/:animating/g,DM),[n,e]}(e.selector);t.currentQuerySelector=i.length?i+" "+s:s,hr(t.collectedStyles,t.currentQuerySelector,new Map);const a=dr(this,qd(e.animation),t);return t.currentQuery=null,t.currentQuerySelector=i,{type:11,selector:s,limit:r.limit||0,optional:!!r.optional,includeSelf:o,animation:a,originalSelector:e.selector,options:_c(e.options)}}visitStagger(e,t){t.currentQuery||t.errors.push(function lie(){return new K(3013,!1)}());const i="full"===e.timings?{duration:0,delay:0,easing:"full"}:u_(e.timings,t.errors,!0);return{type:12,animation:dr(this,qd(e.animation),t),timings:i,options:null}}}class Kie{constructor(e){this.errors=e,this.queryCount=0,this.depCount=0,this.currentTransition=null,this.currentQuery=null,this.currentQuerySelector=null,this.currentAnimateTimings=null,this.currentTime=0,this.collectedStyles=new Map,this.options=null,this.unsupportedCSSPropertiesFound=new Set}}function _c(n){return n?(n=$d(n)).params&&(n.params=function Zie(n){return n?$d(n):null}(n.params)):n={},n}function RM(n,e,t){return{duration:n,delay:e,easing:t}}function OM(n,e,t,i,r,s,o=null,a=!1){return{type:1,element:n,keyframes:e,preStyleProps:t,postStyleProps:i,duration:r,delay:s,totalTime:r+s,easing:o,subTimeline:a}}class __{constructor(){this._map=new Map}get(e){return this._map.get(e)||[]}append(e,t){let i=this._map.get(e);i||this._map.set(e,i=[]),i.push(...t)}has(e){return this._map.has(e)}clear(){this._map.clear()}}const nre=new RegExp(":enter","g"),rre=new RegExp(":leave","g");function kM(n,e,t,i,r,s=new Map,o=new Map,a,c,l=[]){return(new sre).buildKeyframes(n,e,t,i,r,s,o,a,c,l)}class sre{buildKeyframes(e,t,i,r,s,o,a,c,l,u=[]){l=l||new __;const h=new LM(e,t,l,r,s,u,[]);h.options=c;const d=c.delay?fo(c.delay):0;h.currentTimeline.delayNextStep(d),h.currentTimeline.setStyles([o],null,h.errors,c),dr(this,i,h);const f=h.timelines.filter(p=>p.containsAnimation());if(f.length&&a.size){let p;for(let m=f.length-1;m>=0;m--){const g=f[m];if(g.element===t){p=g;break}}p&&!p.allowOnlyTimelineStyles()&&p.setStyles([a],null,h.errors,c)}return f.length?f.map(p=>p.buildKeyframes()):[OM(t,[],[],[],0,d,"",!1)]}visitTrigger(e,t){}visitState(e,t){}visitTransition(e,t){}visitAnimateChild(e,t){const i=t.subInstructions.get(t.element);if(i){const r=t.createSubContext(e.options),s=t.currentTimeline.currentTime,o=this._visitSubInstructions(i,r,r.options);s!=o&&t.transformIntoNewTimeline(o)}t.previousNode=e}visitAnimateRef(e,t){const i=t.createSubContext(e.options);i.transformIntoNewTimeline(),this._applyAnimationRefDelays([e.options,e.animation.options],t,i),this.visitReference(e.animation,i),t.transformIntoNewTimeline(i.currentTimeline.currentTime),t.previousNode=e}_applyAnimationRefDelays(e,t,i){for(const r of e){const s=r?.delay;if(s){const o="number"==typeof s?s:fo(Xd(s,r?.params??{},t.errors));i.delayNextStep(o)}}}_visitSubInstructions(e,t,i){let s=t.currentTimeline.currentTime;const o=null!=i.duration?fo(i.duration):null,a=null!=i.delay?fo(i.delay):null;return 0!==o&&e.forEach(c=>{const l=t.appendInstructionToTimeline(c,o,a);s=Math.max(s,l.duration+l.delay)}),s}visitReference(e,t){t.updateOptions(e.options,!0),dr(this,e.animation,t),t.previousNode=e}visitSequence(e,t){const i=t.subContextCount;let r=t;const s=e.options;if(s&&(s.params||s.delay)&&(r=t.createSubContext(s),r.transformIntoNewTimeline(),null!=s.delay)){6==r.previousNode.type&&(r.currentTimeline.snapshotCurrentStyles(),r.previousNode=y_);const o=fo(s.delay);r.delayNextStep(o)}e.steps.length&&(e.steps.forEach(o=>dr(this,o,r)),r.currentTimeline.applyStylesToKeyframe(),r.subContextCount>i&&r.transformIntoNewTimeline()),t.previousNode=e}visitGroup(e,t){const i=[];let r=t.currentTimeline.currentTime;const s=e.options&&e.options.delay?fo(e.options.delay):0;e.steps.forEach(o=>{const a=t.createSubContext(e.options);s&&a.delayNextStep(s),dr(this,o,a),r=Math.max(r,a.currentTimeline.currentTime),i.push(a.currentTimeline)}),i.forEach(o=>t.currentTimeline.mergeTimelineCollectedStyles(o)),t.transformIntoNewTimeline(r),t.previousNode=e}_visitTiming(e,t){if(e.dynamic){const i=e.strValue;return u_(t.params?Xd(i,t.params,t.errors):i,t.errors)}return{duration:e.duration,delay:e.delay,easing:e.easing}}visitAnimate(e,t){const i=t.currentAnimateTimings=this._visitTiming(e.timings,t),r=t.currentTimeline;i.delay&&(t.incrementTime(i.delay),r.snapshotCurrentStyles());const s=e.style;5==s.type?this.visitKeyframes(s,t):(t.incrementTime(i.duration),this.visitStyle(s,t),r.applyStylesToKeyframe()),t.currentAnimateTimings=null,t.previousNode=e}visitStyle(e,t){const i=t.currentTimeline,r=t.currentAnimateTimings;!r&&i.hasCurrentStyleProperties()&&i.forwardFrame();const s=r&&r.easing||e.easing;e.isEmptyStep?i.applyEmptyStep(s):i.setStyles(e.styles,s,t.errors,t.options),t.previousNode=e}visitKeyframes(e,t){const i=t.currentAnimateTimings,r=t.currentTimeline.duration,s=i.duration,a=t.createSubContext().currentTimeline;a.easing=i.easing,e.styles.forEach(c=>{a.forwardTime((c.offset||0)*s),a.setStyles(c.styles,c.easing,t.errors,t.options),a.applyStylesToKeyframe()}),t.currentTimeline.mergeTimelineCollectedStyles(a),t.transformIntoNewTimeline(r+s),t.previousNode=e}visitQuery(e,t){const i=t.currentTimeline.currentTime,r=e.options||{},s=r.delay?fo(r.delay):0;s&&(6===t.previousNode.type||0==i&&t.currentTimeline.hasCurrentStyleProperties())&&(t.currentTimeline.snapshotCurrentStyles(),t.previousNode=y_);let o=i;const a=t.invokeQuery(e.selector,e.originalSelector,e.limit,e.includeSelf,!!r.optional,t.errors);t.currentQueryTotal=a.length;let c=null;a.forEach((l,u)=>{t.currentQueryIndex=u;const h=t.createSubContext(e.options,l);s&&h.delayNextStep(s),l===t.element&&(c=h.currentTimeline),dr(this,e.animation,h),h.currentTimeline.applyStylesToKeyframe(),o=Math.max(o,h.currentTimeline.currentTime)}),t.currentQueryIndex=0,t.currentQueryTotal=0,t.transformIntoNewTimeline(o),c&&(t.currentTimeline.mergeTimelineCollectedStyles(c),t.currentTimeline.snapshotCurrentStyles()),t.previousNode=e}visitStagger(e,t){const i=t.parentContext,r=t.currentTimeline,s=e.timings,o=Math.abs(s.duration),a=o*(t.currentQueryTotal-1);let c=o*t.currentQueryIndex;switch(s.duration<0?"reverse":s.easing){case"reverse":c=a-c;break;case"full":c=i.currentStaggerTime}const u=t.currentTimeline;c&&u.delayNextStep(c);const h=u.currentTime;dr(this,e.animation,t),t.previousNode=e,i.currentStaggerTime=r.currentTime-h+(r.startTime-i.currentTimeline.startTime)}}const y_={};class LM{constructor(e,t,i,r,s,o,a,c){this._driver=e,this.element=t,this.subInstructions=i,this._enterClassName=r,this._leaveClassName=s,this.errors=o,this.timelines=a,this.parentContext=null,this.currentAnimateTimings=null,this.previousNode=y_,this.subContextCount=0,this.options={},this.currentQueryIndex=0,this.currentQueryTotal=0,this.currentStaggerTime=0,this.currentTimeline=c||new v_(this._driver,t,0),a.push(this.currentTimeline)}get params(){return this.options.params}updateOptions(e,t){if(!e)return;const i=e;let r=this.options;null!=i.duration&&(r.duration=fo(i.duration)),null!=i.delay&&(r.delay=fo(i.delay));const s=i.params;if(s){let o=r.params;o||(o=this.options.params={}),Object.keys(s).forEach(a=>{(!t||!o.hasOwnProperty(a))&&(o[a]=Xd(s[a],o,this.errors))})}}_copyOptions(){const e={};if(this.options){const t=this.options.params;if(t){const i=e.params={};Object.keys(t).forEach(r=>{i[r]=t[r]})}}return e}createSubContext(e=null,t,i){const r=t||this.element,s=new LM(this._driver,r,this.subInstructions,this._enterClassName,this._leaveClassName,this.errors,this.timelines,this.currentTimeline.fork(r,i||0));return s.previousNode=this.previousNode,s.currentAnimateTimings=this.currentAnimateTimings,s.options=this._copyOptions(),s.updateOptions(e),s.currentQueryIndex=this.currentQueryIndex,s.currentQueryTotal=this.currentQueryTotal,s.parentContext=this,this.subContextCount++,s}transformIntoNewTimeline(e){return this.previousNode=y_,this.currentTimeline=this.currentTimeline.fork(this.element,e),this.timelines.push(this.currentTimeline),this.currentTimeline}appendInstructionToTimeline(e,t,i){const r={duration:t??e.duration,delay:this.currentTimeline.currentTime+(i??0)+e.delay,easing:""},s=new ore(this._driver,e.element,e.keyframes,e.preStyleProps,e.postStyleProps,r,e.stretchStartingKeyframe);return this.timelines.push(s),r}incrementTime(e){this.currentTimeline.forwardTime(this.currentTimeline.duration+e)}delayNextStep(e){e>0&&this.currentTimeline.delayNextStep(e)}invokeQuery(e,t,i,r,s,o){let a=[];if(r&&a.push(this.element),e.length>0){e=(e=e.replace(nre,"."+this._enterClassName)).replace(rre,"."+this._leaveClassName);let l=this._driver.query(this.element,e,1!=i);0!==i&&(l=i<0?l.slice(l.length+i,l.length):l.slice(0,i)),a.push(...l)}return!s&&0==a.length&&o.push(function uie(n){return new K(3014,!1)}()),a}}class v_{constructor(e,t,i,r){this._driver=e,this.element=t,this.startTime=i,this._elementTimelineStylesLookup=r,this.duration=0,this._previousKeyframe=new Map,this._currentKeyframe=new Map,this._keyframes=new Map,this._styleSummary=new Map,this._localTimelineStyles=new Map,this._pendingStyles=new Map,this._backFill=new Map,this._currentEmptyStepKeyframe=null,this._elementTimelineStylesLookup||(this._elementTimelineStylesLookup=new Map),this._globalTimelineStyles=this._elementTimelineStylesLookup.get(t),this._globalTimelineStyles||(this._globalTimelineStyles=this._localTimelineStyles,this._elementTimelineStylesLookup.set(t,this._localTimelineStyles)),this._loadKeyframe()}containsAnimation(){switch(this._keyframes.size){case 0:return!1;case 1:return this.hasCurrentStyleProperties();default:return!0}}hasCurrentStyleProperties(){return this._currentKeyframe.size>0}get currentTime(){return this.startTime+this.duration}delayNextStep(e){const t=1===this._keyframes.size&&this._pendingStyles.size;this.duration||t?(this.forwardTime(this.currentTime+e),t&&this.snapshotCurrentStyles()):this.startTime+=e}fork(e,t){return this.applyStylesToKeyframe(),new v_(this._driver,e,t||this.currentTime,this._elementTimelineStylesLookup)}_loadKeyframe(){this._currentKeyframe&&(this._previousKeyframe=this._currentKeyframe),this._currentKeyframe=this._keyframes.get(this.duration),this._currentKeyframe||(this._currentKeyframe=new Map,this._keyframes.set(this.duration,this._currentKeyframe))}forwardFrame(){this.duration+=1,this._loadKeyframe()}forwardTime(e){this.applyStylesToKeyframe(),this.duration=e,this._loadKeyframe()}_updateStyle(e,t){this._localTimelineStyles.set(e,t),this._globalTimelineStyles.set(e,t),this._styleSummary.set(e,{time:this.currentTime,value:t})}allowOnlyTimelineStyles(){return this._currentEmptyStepKeyframe!==this._currentKeyframe}applyEmptyStep(e){e&&this._previousKeyframe.set("easing",e);for(let[t,i]of this._globalTimelineStyles)this._backFill.set(t,i||uo),this._currentKeyframe.set(t,uo);this._currentEmptyStepKeyframe=this._currentKeyframe}setStyles(e,t,i,r){t&&this._previousKeyframe.set("easing",t);const s=r&&r.params||{},o=function are(n,e){const t=new Map;let i;return n.forEach(r=>{if("*"===r){i=i||e.keys();for(let s of i)t.set(s,uo)}else ia(r,t)}),t}(e,this._globalTimelineStyles);for(let[a,c]of o){const l=Xd(c,s,i);this._pendingStyles.set(a,l),this._localTimelineStyles.has(a)||this._backFill.set(a,this._globalTimelineStyles.get(a)??uo),this._updateStyle(a,l)}}applyStylesToKeyframe(){0!=this._pendingStyles.size&&(this._pendingStyles.forEach((e,t)=>{this._currentKeyframe.set(t,e)}),this._pendingStyles.clear(),this._localTimelineStyles.forEach((e,t)=>{this._currentKeyframe.has(t)||this._currentKeyframe.set(t,e)}))}snapshotCurrentStyles(){for(let[e,t]of this._localTimelineStyles)this._pendingStyles.set(e,t),this._updateStyle(e,t)}getFinalKeyframe(){return this._keyframes.get(this.duration)}get properties(){const e=[];for(let t in this._currentKeyframe)e.push(t);return e}mergeTimelineCollectedStyles(e){e._styleSummary.forEach((t,i)=>{const r=this._styleSummary.get(i);(!r||t.time>r.time)&&this._updateStyle(i,t.value)})}buildKeyframes(){this.applyStylesToKeyframe();const e=new Set,t=new Set,i=1===this._keyframes.size&&0===this.duration;let r=[];this._keyframes.forEach((a,c)=>{const l=ia(a,new Map,this._backFill);l.forEach((u,h)=>{"!"===u?e.add(h):u===uo&&t.add(h)}),i||l.set("offset",c/this.duration),r.push(l)});const s=e.size?h_(e.values()):[],o=t.size?h_(t.values()):[];if(i){const a=r[0],c=new Map(a);a.set("offset",0),c.set("offset",1),r=[a,c]}return OM(this.element,r,s,o,this.duration,this.startTime,this.easing,!1)}}class ore extends v_{constructor(e,t,i,r,s,o,a=!1){super(e,t,o.delay),this.keyframes=i,this.preStyleProps=r,this.postStyleProps=s,this._stretchStartingKeyframe=a,this.timings={duration:o.duration,delay:o.delay,easing:o.easing}}containsAnimation(){return this.keyframes.length>1}buildKeyframes(){let e=this.keyframes,{delay:t,duration:i,easing:r}=this.timings;if(this._stretchStartingKeyframe&&t){const s=[],o=i+t,a=t/o,c=ia(e[0]);c.set("offset",0),s.push(c);const l=ia(e[0]);l.set("offset",_F(a)),s.push(l);const u=e.length-1;for(let h=1;h<=u;h++){let d=ia(e[h]);const f=d.get("offset");d.set("offset",_F((t+f*i)/o)),s.push(d)}i=o,t=0,r="",e=s}return OM(this.element,e,this.preStyleProps,this.postStyleProps,i,t,r,!0)}}function _F(n,e=3){const t=Math.pow(10,e-1);return Math.round(n*t)/t}class NM{}const cre=new Set(["width","height","minWidth","minHeight","maxWidth","maxHeight","left","top","bottom","right","fontSize","outlineWidth","outlineOffset","paddingTop","paddingLeft","paddingBottom","paddingRight","marginTop","marginLeft","marginBottom","marginRight","borderRadius","borderWidth","borderTopWidth","borderLeftWidth","borderRightWidth","borderBottomWidth","textIndent","perspective"]);class lre extends NM{normalizePropertyName(e,t){return IM(e)}normalizeStyleValue(e,t,i,r){let s="";const o=i.toString().trim();if(cre.has(t)&&0!==i&&"0"!==i)if("number"==typeof i)s="px";else{const a=i.match(/^[+-]?[\d\.]+([a-z]*)$/);a&&0==a[1].length&&r.push(function Qne(n,e){return new K(3005,!1)}())}return o+s}}function yF(n,e,t,i,r,s,o,a,c,l,u,h,d){return{type:0,element:n,triggerName:e,isRemovalTransition:r,fromState:t,fromStyles:s,toState:i,toStyles:o,timelines:a,queriedElements:c,preStyleProps:l,postStyleProps:u,totalTime:h,errors:d}}const FM={};class vF{constructor(e,t,i){this._triggerName=e,this.ast=t,this._stateStyles=i}match(e,t,i,r){return function ure(n,e,t,i,r){return n.some(s=>s(e,t,i,r))}(this.ast.matchers,e,t,i,r)}buildStyles(e,t,i){let r=this._stateStyles.get("*");return void 0!==e&&(r=this._stateStyles.get(e?.toString())||r),r?r.buildStyles(t,i):new Map}build(e,t,i,r,s,o,a,c,l,u){const h=[],d=this.ast.options&&this.ast.options.params||FM,p=this.buildStyles(i,a&&a.params||FM,h),m=c&&c.params||FM,g=this.buildStyles(r,m,h),_=new Set,b=new Map,y=new Map,v="void"===r,w={params:hre(m,d),delay:this.ast.options?.delay},M=u?[]:kM(e,t,this.ast.animation,s,o,p,g,w,l,h);let I=0;if(M.forEach(E=>{I=Math.max(E.duration+E.delay,I)}),h.length)return yF(t,this._triggerName,i,r,v,p,g,[],[],b,y,I,h);M.forEach(E=>{const R=E.element,$=hr(b,R,new Set);E.preStyleProps.forEach(H=>$.add(H));const se=hr(y,R,new Set);E.postStyleProps.forEach(H=>se.add(H)),R!==t&&_.add(R)});const x=h_(_.values());return yF(t,this._triggerName,i,r,v,p,g,M,x,b,y,I)}}function hre(n,e){const t=$d(e);for(const i in n)n.hasOwnProperty(i)&&null!=n[i]&&(t[i]=n[i]);return t}class dre{constructor(e,t,i){this.styles=e,this.defaultParams=t,this.normalizer=i}buildStyles(e,t){const i=new Map,r=$d(this.defaultParams);return Object.keys(e).forEach(s=>{const o=e[s];null!==o&&(r[s]=o)}),this.styles.styles.forEach(s=>{"string"!=typeof s&&s.forEach((o,a)=>{o&&(o=Xd(o,r,t));const c=this.normalizer.normalizePropertyName(a,t);o=this.normalizer.normalizeStyleValue(a,c,o,t),i.set(c,o)})}),i}}class pre{constructor(e,t,i){this.name=e,this.ast=t,this._normalizer=i,this.transitionFactories=[],this.states=new Map,t.states.forEach(r=>{this.states.set(r.name,new dre(r.style,r.options&&r.options.params||{},i))}),bF(this.states,"true","1"),bF(this.states,"false","0"),t.transitions.forEach(r=>{this.transitionFactories.push(new vF(e,r,this.states))}),this.fallbackTransition=function mre(n,e,t){return new vF(n,{type:1,animation:{type:2,steps:[],options:null},matchers:[(o,a)=>!0],options:null,queryCount:0,depCount:0},e)}(e,this.states)}get containsQueries(){return this.ast.queryCount>0}matchTransition(e,t,i,r){return this.transitionFactories.find(o=>o.match(e,t,i,r))||null}matchStyles(e,t,i){return this.fallbackTransition.buildStyles(e,t,i)}}function bF(n,e,t){n.has(e)?n.has(t)||n.set(t,n.get(e)):n.has(t)&&n.set(e,n.get(t))}const gre=new __;class _re{constructor(e,t,i){this.bodyNode=e,this._driver=t,this._normalizer=i,this._animations=new Map,this._playersById=new Map,this.players=[]}register(e,t){const i=[],s=PM(this._driver,t,i,[]);if(i.length)throw function _ie(n){return new K(3503,!1)}();this._animations.set(e,s)}_buildPlayer(e,t,i){const r=e.element,s=JN(0,this._normalizer,0,e.keyframes,t,i);return this._driver.animate(r,s,e.duration,e.delay,e.easing,[],!0)}create(e,t,i={}){const r=[],s=this._animations.get(e);let o;const a=new Map;if(s?(o=kM(this._driver,t,s,EM,a_,new Map,new Map,i,gre,r),o.forEach(u=>{const h=hr(a,u.element,new Map);u.postStyleProps.forEach(d=>h.set(d,null))})):(r.push(function yie(){return new K(3300,!1)}()),o=[]),r.length)throw function vie(n){return new K(3504,!1)}();a.forEach((u,h)=>{u.forEach((d,f)=>{u.set(f,this._driver.computeStyle(h,f,uo))})});const l=na(o.map(u=>{const h=a.get(u.element);return this._buildPlayer(u,new Map,h)}));return this._playersById.set(e,l),l.onDestroy(()=>this.destroy(e)),this.players.push(l),l}destroy(e){const t=this._getPlayer(e);t.destroy(),this._playersById.delete(e);const i=this.players.indexOf(t);i>=0&&this.players.splice(i,1)}_getPlayer(e){const t=this._playersById.get(e);if(!t)throw function bie(n){return new K(3301,!1)}();return t}listen(e,t,i,r){const s=wM(t,"","","");return bM(this._getPlayer(e),i,s,r),()=>{}}command(e,t,i,r){if("register"==i)return void this.register(e,r[0]);if("create"==i)return void this.create(e,t,r[0]||{});const s=this._getPlayer(e);switch(i){case"play":s.play();break;case"pause":s.pause();break;case"reset":s.reset();break;case"restart":s.restart();break;case"finish":s.finish();break;case"init":s.init();break;case"setPosition":s.setPosition(parseFloat(r[0]));break;case"destroy":this.destroy(e)}}}const xF="ng-animate-queued",VM="ng-animate-disabled",wre=[],wF={namespaceId:"",setForRemoval:!1,setForMove:!1,hasAnimation:!1,removedBeforeQueried:!1},Mre={namespaceId:"",setForMove:!1,setForRemoval:!1,hasAnimation:!1,removedBeforeQueried:!0},Pr="__ng_removed";class BM{constructor(e,t=""){this.namespaceId=t;const i=e&&e.hasOwnProperty("value");if(this.value=function Dre(n){return n??null}(i?e.value:e),i){const s=$d(e);delete s.value,this.options=s}else this.options={};this.options.params||(this.options.params={})}get params(){return this.options.params}absorbOptions(e){const t=e.params;if(t){const i=this.options.params;Object.keys(t).forEach(r=>{null==i[r]&&(i[r]=t[r])})}}}const Yd="void",UM=new BM(Yd);class Cre{constructor(e,t,i){this.id=e,this.hostElement=t,this._engine=i,this.players=[],this._triggers=new Map,this._queue=[],this._elementListeners=new Map,this._hostClassName="ng-tns-"+e,Rr(t,this._hostClassName)}listen(e,t,i,r){if(!this._triggers.has(t))throw function xie(n,e){return new K(3302,!1)}();if(null==i||0==i.length)throw function wie(n){return new K(3303,!1)}();if(!function Tre(n){return"start"==n||"done"==n}(i))throw function Mie(n,e){return new K(3400,!1)}();const s=hr(this._elementListeners,e,[]),o={name:t,phase:i,callback:r};s.push(o);const a=hr(this._engine.statesByElement,e,new Map);return a.has(t)||(Rr(e,c_),Rr(e,c_+"-"+t),a.set(t,UM)),()=>{this._engine.afterFlush(()=>{const c=s.indexOf(o);c>=0&&s.splice(c,1),this._triggers.has(t)||a.delete(t)})}}register(e,t){return!this._triggers.has(e)&&(this._triggers.set(e,t),!0)}_getTrigger(e){const t=this._triggers.get(e);if(!t)throw function Cie(n){return new K(3401,!1)}();return t}trigger(e,t,i,r=!0){const s=this._getTrigger(t),o=new zM(this.id,t,e);let a=this._engine.statesByElement.get(e);a||(Rr(e,c_),Rr(e,c_+"-"+t),this._engine.statesByElement.set(e,a=new Map));let c=a.get(t);const l=new BM(i,this.id);if(!(i&&i.hasOwnProperty("value"))&&c&&l.absorbOptions(c.options),a.set(t,l),c||(c=UM),l.value!==Yd&&c.value===l.value){if(!function Pre(n,e){const t=Object.keys(n),i=Object.keys(e);if(t.length!=i.length)return!1;for(let r=0;r<t.length;r++){const s=t[r];if(!e.hasOwnProperty(s)||n[s]!==e[s])return!1}return!0}(c.params,l.params)){const m=[],g=s.matchStyles(c.value,c.params,m),_=s.matchStyles(l.value,l.params,m);m.length?this._engine.reportError(m):this._engine.afterFlush(()=>{gc(e,g),Ts(e,_)})}return}const d=hr(this._engine.playersByElement,e,[]);d.forEach(m=>{m.namespaceId==this.id&&m.triggerName==t&&m.queued&&m.destroy()});let f=s.matchTransition(c.value,l.value,e,l.params),p=!1;if(!f){if(!r)return;f=s.fallbackTransition,p=!0}return this._engine.totalQueuedPlayers++,this._queue.push({element:e,triggerName:t,transition:f,fromState:c,toState:l,player:o,isFallbackTransition:p}),p||(Rr(e,xF),o.onStart(()=>{Tu(e,xF)})),o.onDone(()=>{let m=this.players.indexOf(o);m>=0&&this.players.splice(m,1);const g=this._engine.playersByElement.get(e);if(g){let _=g.indexOf(o);_>=0&&g.splice(_,1)}}),this.players.push(o),d.push(o),o}deregister(e){this._triggers.delete(e),this._engine.statesByElement.forEach(t=>t.delete(e)),this._elementListeners.forEach((t,i)=>{this._elementListeners.set(i,t.filter(r=>r.name!=e))})}clearElementCache(e){this._engine.statesByElement.delete(e),this._elementListeners.delete(e);const t=this._engine.playersByElement.get(e);t&&(t.forEach(i=>i.destroy()),this._engine.playersByElement.delete(e))}_signalRemovalForInnerTriggers(e,t){const i=this._engine.driver.query(e,l_,!0);i.forEach(r=>{if(r[Pr])return;const s=this._engine.fetchNamespacesByElement(r);s.size?s.forEach(o=>o.triggerLeaveAnimation(r,t,!1,!0)):this.clearElementCache(r)}),this._engine.afterFlushAnimationsDone(()=>i.forEach(r=>this.clearElementCache(r)))}triggerLeaveAnimation(e,t,i,r){const s=this._engine.statesByElement.get(e),o=new Map;if(s){const a=[];if(s.forEach((c,l)=>{if(o.set(l,c.value),this._triggers.has(l)){const u=this.trigger(e,l,Yd,r);u&&a.push(u)}}),a.length)return this._engine.markElementAsRemoved(this.id,e,!0,t,o),i&&na(a).onDone(()=>this._engine.processLeaveNode(e)),!0}return!1}prepareLeaveAnimationListeners(e){const t=this._elementListeners.get(e),i=this._engine.statesByElement.get(e);if(t&&i){const r=new Set;t.forEach(s=>{const o=s.name;if(r.has(o))return;r.add(o);const c=this._triggers.get(o).fallbackTransition,l=i.get(o)||UM,u=new BM(Yd),h=new zM(this.id,o,e);this._engine.totalQueuedPlayers++,this._queue.push({element:e,triggerName:o,transition:c,fromState:l,toState:u,player:h,isFallbackTransition:!0})})}}removeNode(e,t){const i=this._engine;if(e.childElementCount&&this._signalRemovalForInnerTriggers(e,t),this.triggerLeaveAnimation(e,t,!0))return;let r=!1;if(i.totalAnimations){const s=i.players.length?i.playersByQueriedElement.get(e):[];if(s&&s.length)r=!0;else{let o=e;for(;o=o.parentNode;)if(i.statesByElement.get(o)){r=!0;break}}}if(this.prepareLeaveAnimationListeners(e),r)i.markElementAsRemoved(this.id,e,!1,t);else{const s=e[Pr];(!s||s===wF)&&(i.afterFlush(()=>this.clearElementCache(e)),i.destroyInnerAnimations(e),i._onRemovalComplete(e,t))}}insertNode(e,t){Rr(e,this._hostClassName)}drainQueuedTransitions(e){const t=[];return this._queue.forEach(i=>{const r=i.player;if(r.destroyed)return;const s=i.element,o=this._elementListeners.get(s);o&&o.forEach(a=>{if(a.name==i.triggerName){const c=wM(s,i.triggerName,i.fromState.value,i.toState.value);c._data=e,bM(i.player,a.phase,c,a.callback)}}),r.markedForDestroy?this._engine.afterFlush(()=>{r.destroy()}):t.push(i)}),this._queue=[],t.sort((i,r)=>{const s=i.transition.ast.depCount,o=r.transition.ast.depCount;return 0==s||0==o?s-o:this._engine.driver.containsElement(i.element,r.element)?1:-1})}destroy(e){this.players.forEach(t=>t.destroy()),this._signalRemovalForInnerTriggers(this.hostElement,e)}elementContainsData(e){let t=!1;return this._elementListeners.has(e)&&(t=!0),t=!!this._queue.find(i=>i.element===e)||t,t}}class Sre{constructor(e,t,i){this.bodyNode=e,this.driver=t,this._normalizer=i,this.players=[],this.newHostElements=new Map,this.playersByElement=new Map,this.playersByQueriedElement=new Map,this.statesByElement=new Map,this.disabledNodes=new Set,this.totalAnimations=0,this.totalQueuedPlayers=0,this._namespaceLookup={},this._namespaceList=[],this._flushFns=[],this._whenQuietFns=[],this.namespacesByHostElement=new Map,this.collectedEnterElements=[],this.collectedLeaveElements=[],this.onRemovalComplete=(r,s)=>{}}_onRemovalComplete(e,t){this.onRemovalComplete(e,t)}get queuedPlayers(){const e=[];return this._namespaceList.forEach(t=>{t.players.forEach(i=>{i.queued&&e.push(i)})}),e}createNamespace(e,t){const i=new Cre(e,t,this);return this.bodyNode&&this.driver.containsElement(this.bodyNode,t)?this._balanceNamespaceList(i,t):(this.newHostElements.set(t,i),this.collectEnterElement(t)),this._namespaceLookup[e]=i}_balanceNamespaceList(e,t){const i=this._namespaceList,r=this.namespacesByHostElement;if(i.length-1>=0){let o=!1,a=this.driver.getParentElement(t);for(;a;){const c=r.get(a);if(c){const l=i.indexOf(c);i.splice(l+1,0,e),o=!0;break}a=this.driver.getParentElement(a)}o||i.unshift(e)}else i.push(e);return r.set(t,e),e}register(e,t){let i=this._namespaceLookup[e];return i||(i=this.createNamespace(e,t)),i}registerTrigger(e,t,i){let r=this._namespaceLookup[e];r&&r.register(t,i)&&this.totalAnimations++}destroy(e,t){if(!e)return;const i=this._fetchNamespace(e);this.afterFlush(()=>{this.namespacesByHostElement.delete(i.hostElement),delete this._namespaceLookup[e];const r=this._namespaceList.indexOf(i);r>=0&&this._namespaceList.splice(r,1)}),this.afterFlushAnimationsDone(()=>i.destroy(t))}_fetchNamespace(e){return this._namespaceLookup[e]}fetchNamespacesByElement(e){const t=new Set,i=this.statesByElement.get(e);if(i)for(let r of i.values())if(r.namespaceId){const s=this._fetchNamespace(r.namespaceId);s&&t.add(s)}return t}trigger(e,t,i,r){if(b_(t)){const s=this._fetchNamespace(e);if(s)return s.trigger(t,i,r),!0}return!1}insertNode(e,t,i,r){if(!b_(t))return;const s=t[Pr];if(s&&s.setForRemoval){s.setForRemoval=!1,s.setForMove=!0;const o=this.collectedLeaveElements.indexOf(t);o>=0&&this.collectedLeaveElements.splice(o,1)}if(e){const o=this._fetchNamespace(e);o&&o.insertNode(t,i)}r&&this.collectEnterElement(t)}collectEnterElement(e){this.collectedEnterElements.push(e)}markElementAsDisabled(e,t){t?this.disabledNodes.has(e)||(this.disabledNodes.add(e),Rr(e,VM)):this.disabledNodes.has(e)&&(this.disabledNodes.delete(e),Tu(e,VM))}removeNode(e,t,i,r){if(b_(t)){const s=e?this._fetchNamespace(e):null;if(s?s.removeNode(t,r):this.markElementAsRemoved(e,t,!1,r),i){const o=this.namespacesByHostElement.get(t);o&&o.id!==e&&o.removeNode(t,r)}}else this._onRemovalComplete(t,r)}markElementAsRemoved(e,t,i,r,s){this.collectedLeaveElements.push(t),t[Pr]={namespaceId:e,setForRemoval:r,hasAnimation:i,removedBeforeQueried:!1,previousTriggersValues:s}}listen(e,t,i,r,s){return b_(t)?this._fetchNamespace(e).listen(t,i,r,s):()=>{}}_buildInstruction(e,t,i,r,s){return e.transition.build(this.driver,e.element,e.fromState.value,e.toState.value,i,r,e.fromState.options,e.toState.options,t,s)}destroyInnerAnimations(e){let t=this.driver.query(e,l_,!0);t.forEach(i=>this.destroyActiveAnimationsForElement(i)),0!=this.playersByQueriedElement.size&&(t=this.driver.query(e,DM,!0),t.forEach(i=>this.finishActiveQueriedAnimationOnElement(i)))}destroyActiveAnimationsForElement(e){const t=this.playersByElement.get(e);t&&t.forEach(i=>{i.queued?i.markedForDestroy=!0:i.destroy()})}finishActiveQueriedAnimationOnElement(e){const t=this.playersByQueriedElement.get(e);t&&t.forEach(i=>i.finish())}whenRenderingDone(){return new Promise(e=>{if(this.players.length)return na(this.players).onDone(()=>e());e()})}processLeaveNode(e){const t=e[Pr];if(t&&t.setForRemoval){if(e[Pr]=wF,t.namespaceId){this.destroyInnerAnimations(e);const i=this._fetchNamespace(t.namespaceId);i&&i.clearElementCache(e)}this._onRemovalComplete(e,t.setForRemoval)}e.classList?.contains(VM)&&this.markElementAsDisabled(e,!1),this.driver.query(e,".ng-animate-disabled",!0).forEach(i=>{this.markElementAsDisabled(i,!1)})}flush(e=-1){let t=[];if(this.newHostElements.size&&(this.newHostElements.forEach((i,r)=>this._balanceNamespaceList(i,r)),this.newHostElements.clear()),this.totalAnimations&&this.collectedEnterElements.length)for(let i=0;i<this.collectedEnterElements.length;i++)Rr(this.collectedEnterElements[i],"ng-star-inserted");if(this._namespaceList.length&&(this.totalQueuedPlayers||this.collectedLeaveElements.length)){const i=[];try{t=this._flushAnimations(i,e)}finally{for(let r=0;r<i.length;r++)i[r]()}}else for(let i=0;i<this.collectedLeaveElements.length;i++)this.processLeaveNode(this.collectedLeaveElements[i]);if(this.totalQueuedPlayers=0,this.collectedEnterElements.length=0,this.collectedLeaveElements.length=0,this._flushFns.forEach(i=>i()),this._flushFns=[],this._whenQuietFns.length){const i=this._whenQuietFns;this._whenQuietFns=[],t.length?na(t).onDone(()=>{i.forEach(r=>r())}):i.forEach(r=>r())}}reportError(e){throw function Sie(n){return new K(3402,!1)}()}_flushAnimations(e,t){const i=new __,r=[],s=new Map,o=[],a=new Map,c=new Map,l=new Map,u=new Set;this.disabledNodes.forEach(L=>{u.add(L);const G=this.driver.query(L,".ng-animate-queued",!0);for(let F=0;F<G.length;F++)u.add(G[F])});const h=this.bodyNode,d=Array.from(this.statesByElement.keys()),f=SF(d,this.collectedEnterElements),p=new Map;let m=0;f.forEach((L,G)=>{const F=EM+m++;p.set(G,F),L.forEach(O=>Rr(O,F))});const g=[],_=new Set,b=new Set;for(let L=0;L<this.collectedLeaveElements.length;L++){const G=this.collectedLeaveElements[L],F=G[Pr];F&&F.setForRemoval&&(g.push(G),_.add(G),F.hasAnimation?this.driver.query(G,".ng-star-inserted",!0).forEach(O=>_.add(O)):b.add(G))}const y=new Map,v=SF(d,Array.from(_));v.forEach((L,G)=>{const F=a_+m++;y.set(G,F),L.forEach(O=>Rr(O,F))}),e.push(()=>{f.forEach((L,G)=>{const F=p.get(G);L.forEach(O=>Tu(O,F))}),v.forEach((L,G)=>{const F=y.get(G);L.forEach(O=>Tu(O,F))}),g.forEach(L=>{this.processLeaveNode(L)})});const w=[],M=[];for(let L=this._namespaceList.length-1;L>=0;L--)this._namespaceList[L].drainQueuedTransitions(t).forEach(F=>{const O=F.player,V=F.element;if(w.push(O),this.collectedEnterElements.length){const Be=V[Pr];if(Be&&Be.setForMove){if(Be.previousTriggersValues&&Be.previousTriggersValues.has(F.triggerName)){const Fe=Be.previousTriggersValues.get(F.triggerName),Le=this.statesByElement.get(F.element);if(Le&&Le.has(F.triggerName)){const ye=Le.get(F.triggerName);ye.value=Fe,Le.set(F.triggerName,ye)}}return void O.destroy()}}const ce=!h||!this.driver.containsElement(h,V),re=y.get(V),fe=p.get(V),pe=this._buildInstruction(F,i,fe,re,ce);if(pe.errors&&pe.errors.length)return void M.push(pe);if(ce)return O.onStart(()=>gc(V,pe.fromStyles)),O.onDestroy(()=>Ts(V,pe.toStyles)),void r.push(O);if(F.isFallbackTransition)return O.onStart(()=>gc(V,pe.fromStyles)),O.onDestroy(()=>Ts(V,pe.toStyles)),void r.push(O);const We=[];pe.timelines.forEach(Be=>{Be.stretchStartingKeyframe=!0,this.disabledNodes.has(Be.element)||We.push(Be)}),pe.timelines=We,i.append(V,pe.timelines),o.push({instruction:pe,player:O,element:V}),pe.queriedElements.forEach(Be=>hr(a,Be,[]).push(O)),pe.preStyleProps.forEach((Be,Fe)=>{if(Be.size){let Le=c.get(Fe);Le||c.set(Fe,Le=new Set),Be.forEach((ye,ut)=>Le.add(ut))}}),pe.postStyleProps.forEach((Be,Fe)=>{let Le=l.get(Fe);Le||l.set(Fe,Le=new Set),Be.forEach((ye,ut)=>Le.add(ut))})});if(M.length){const L=[];M.forEach(G=>{L.push(function Eie(n,e){return new K(3505,!1)}())}),w.forEach(G=>G.destroy()),this.reportError(L)}const I=new Map,x=new Map;o.forEach(L=>{const G=L.element;i.has(G)&&(x.set(G,G),this._beforeAnimationBuild(L.player.namespaceId,L.instruction,I))}),r.forEach(L=>{const G=L.element;this._getPreviousPlayers(G,!1,L.namespaceId,L.triggerName,null).forEach(O=>{hr(I,G,[]).push(O),O.destroy()})});const E=g.filter(L=>DF(L,c,l)),R=new Map;CF(R,this.driver,b,l,uo).forEach(L=>{DF(L,c,l)&&E.push(L)});const se=new Map;f.forEach((L,G)=>{CF(se,this.driver,new Set(L),c,"!")}),E.forEach(L=>{const G=R.get(L),F=se.get(L);R.set(L,new Map([...Array.from(G?.entries()??[]),...Array.from(F?.entries()??[])]))});const H=[],N=[],X={};o.forEach(L=>{const{element:G,player:F,instruction:O}=L;if(i.has(G)){if(u.has(G))return F.onDestroy(()=>Ts(G,O.toStyles)),F.disabled=!0,F.overrideTotalTime(O.totalTime),void r.push(F);let V=X;if(x.size>1){let re=G;const fe=[];for(;re=re.parentNode;){const pe=x.get(re);if(pe){V=pe;break}fe.push(re)}fe.forEach(pe=>x.set(pe,V))}const ce=this._buildAnimation(F.namespaceId,O,I,s,se,R);if(F.setRealPlayer(ce),V===X)H.push(F);else{const re=this.playersByElement.get(V);re&&re.length&&(F.parentPlayer=na(re)),r.push(F)}}else gc(G,O.fromStyles),F.onDestroy(()=>Ts(G,O.toStyles)),N.push(F),u.has(G)&&r.push(F)}),N.forEach(L=>{const G=s.get(L.element);if(G&&G.length){const F=na(G);L.setRealPlayer(F)}}),r.forEach(L=>{L.parentPlayer?L.syncPlayerEvents(L.parentPlayer):L.destroy()});for(let L=0;L<g.length;L++){const G=g[L],F=G[Pr];if(Tu(G,a_),F&&F.hasAnimation)continue;let O=[];if(a.size){let ce=a.get(G);ce&&ce.length&&O.push(...ce);let re=this.driver.query(G,DM,!0);for(let fe=0;fe<re.length;fe++){let pe=a.get(re[fe]);pe&&pe.length&&O.push(...pe)}}const V=O.filter(ce=>!ce.destroyed);V.length?Are(this,G,V):this.processLeaveNode(G)}return g.length=0,H.forEach(L=>{this.players.push(L),L.onDone(()=>{L.destroy();const G=this.players.indexOf(L);this.players.splice(G,1)}),L.play()}),H}elementContainsData(e,t){let i=!1;const r=t[Pr];return r&&r.setForRemoval&&(i=!0),this.playersByElement.has(t)&&(i=!0),this.playersByQueriedElement.has(t)&&(i=!0),this.statesByElement.has(t)&&(i=!0),this._fetchNamespace(e).elementContainsData(t)||i}afterFlush(e){this._flushFns.push(e)}afterFlushAnimationsDone(e){this._whenQuietFns.push(e)}_getPreviousPlayers(e,t,i,r,s){let o=[];if(t){const a=this.playersByQueriedElement.get(e);a&&(o=a)}else{const a=this.playersByElement.get(e);if(a){const c=!s||s==Yd;a.forEach(l=>{l.queued||!c&&l.triggerName!=r||o.push(l)})}}return(i||r)&&(o=o.filter(a=>!(i&&i!=a.namespaceId||r&&r!=a.triggerName))),o}_beforeAnimationBuild(e,t,i){const s=t.element,o=t.isRemovalTransition?void 0:e,a=t.isRemovalTransition?void 0:t.triggerName;for(const c of t.timelines){const l=c.element,u=l!==s,h=hr(i,l,[]);this._getPreviousPlayers(l,u,o,a,t.toState).forEach(f=>{const p=f.getRealPlayer();p.beforeDestroy&&p.beforeDestroy(),f.destroy(),h.push(f)})}gc(s,t.fromStyles)}_buildAnimation(e,t,i,r,s,o){const a=t.triggerName,c=t.element,l=[],u=new Set,h=new Set,d=t.timelines.map(p=>{const m=p.element;u.add(m);const g=m[Pr];if(g&&g.removedBeforeQueried)return new Rd(p.duration,p.delay);const _=m!==c,b=function Ire(n){const e=[];return EF(n,e),e}((i.get(m)||wre).map(I=>I.getRealPlayer())).filter(I=>!!I.element&&I.element===m),y=s.get(m),v=o.get(m),w=JN(0,this._normalizer,0,p.keyframes,y,v),M=this._buildPlayer(p,w,b);if(p.subTimeline&&r&&h.add(m),_){const I=new zM(e,a,m);I.setRealPlayer(M),l.push(I)}return M});l.forEach(p=>{hr(this.playersByQueriedElement,p.element,[]).push(p),p.onDone(()=>function Ere(n,e,t){let i=n.get(e);if(i){if(i.length){const r=i.indexOf(t);i.splice(r,1)}0==i.length&&n.delete(e)}return i}(this.playersByQueriedElement,p.element,p))}),u.forEach(p=>Rr(p,aF));const f=na(d);return f.onDestroy(()=>{u.forEach(p=>Tu(p,aF)),Ts(c,t.toStyles)}),h.forEach(p=>{hr(r,p,[]).push(f)}),f}_buildPlayer(e,t,i){return t.length>0?this.driver.animate(e.element,t,e.duration,e.delay,e.easing,i):new Rd(e.duration,e.delay)}}class zM{constructor(e,t,i){this.namespaceId=e,this.triggerName=t,this.element=i,this._player=new Rd,this._containsRealPlayer=!1,this._queuedCallbacks=new Map,this.destroyed=!1,this.markedForDestroy=!1,this.disabled=!1,this.queued=!0,this.totalTime=0}setRealPlayer(e){this._containsRealPlayer||(this._player=e,this._queuedCallbacks.forEach((t,i)=>{t.forEach(r=>bM(e,i,void 0,r))}),this._queuedCallbacks.clear(),this._containsRealPlayer=!0,this.overrideTotalTime(e.totalTime),this.queued=!1)}getRealPlayer(){return this._player}overrideTotalTime(e){this.totalTime=e}syncPlayerEvents(e){const t=this._player;t.triggerCallback&&e.onStart(()=>t.triggerCallback("start")),e.onDone(()=>this.finish()),e.onDestroy(()=>this.destroy())}_queueEvent(e,t){hr(this._queuedCallbacks,e,[]).push(t)}onDone(e){this.queued&&this._queueEvent("done",e),this._player.onDone(e)}onStart(e){this.queued&&this._queueEvent("start",e),this._player.onStart(e)}onDestroy(e){this.queued&&this._queueEvent("destroy",e),this._player.onDestroy(e)}init(){this._player.init()}hasStarted(){return!this.queued&&this._player.hasStarted()}play(){!this.queued&&this._player.play()}pause(){!this.queued&&this._player.pause()}restart(){!this.queued&&this._player.restart()}finish(){this._player.finish()}destroy(){this.destroyed=!0,this._player.destroy()}reset(){!this.queued&&this._player.reset()}setPosition(e){this.queued||this._player.setPosition(e)}getPosition(){return this.queued?0:this._player.getPosition()}triggerCallback(e){const t=this._player;t.triggerCallback&&t.triggerCallback(e)}}function b_(n){return n&&1===n.nodeType}function MF(n,e){const t=n.style.display;return n.style.display=e??"none",t}function CF(n,e,t,i,r){const s=[];t.forEach(c=>s.push(MF(c)));const o=[];i.forEach((c,l)=>{const u=new Map;c.forEach(h=>{const d=e.computeStyle(l,h,r);u.set(h,d),(!d||0==d.length)&&(l[Pr]=Mre,o.push(l))}),n.set(l,u)});let a=0;return t.forEach(c=>MF(c,s[a++])),o}function SF(n,e){const t=new Map;if(n.forEach(a=>t.set(a,[])),0==e.length)return t;const r=new Set(e),s=new Map;function o(a){if(!a)return 1;let c=s.get(a);if(c)return c;const l=a.parentNode;return c=t.has(l)?l:r.has(l)?1:o(l),s.set(a,c),c}return e.forEach(a=>{const c=o(a);1!==c&&t.get(c).push(a)}),t}function Rr(n,e){n.classList?.add(e)}function Tu(n,e){n.classList?.remove(e)}function Are(n,e,t){na(t).onDone(()=>n.processLeaveNode(e))}function EF(n,e){for(let t=0;t<n.length;t++){const i=n[t];i instanceof Jk?EF(i.players,e):e.push(i)}}function DF(n,e,t){const i=t.get(n);if(!i)return!1;let r=e.get(n);return r?i.forEach(s=>r.add(s)):e.set(n,i),t.delete(n),!0}class x_{constructor(e,t,i){this.bodyNode=e,this._driver=t,this._normalizer=i,this._triggerCache={},this.onRemovalComplete=(r,s)=>{},this._transitionEngine=new Sre(e,t,i),this._timelineEngine=new _re(e,t,i),this._transitionEngine.onRemovalComplete=(r,s)=>this.onRemovalComplete(r,s)}registerTrigger(e,t,i,r,s){const o=e+"-"+r;let a=this._triggerCache[o];if(!a){const c=[],u=PM(this._driver,s,c,[]);if(c.length)throw function mie(n,e){return new K(3404,!1)}();a=function fre(n,e,t){return new pre(n,e,t)}(r,u,this._normalizer),this._triggerCache[o]=a}this._transitionEngine.registerTrigger(t,r,a)}register(e,t){this._transitionEngine.register(e,t)}destroy(e,t){this._transitionEngine.destroy(e,t)}onInsert(e,t,i,r){this._transitionEngine.insertNode(e,t,i,r)}onRemove(e,t,i,r){this._transitionEngine.removeNode(e,t,r||!1,i)}disableAnimations(e,t){this._transitionEngine.markElementAsDisabled(e,t)}process(e,t,i,r){if("@"==i.charAt(0)){const[s,o]=QN(i);this._timelineEngine.command(s,t,o,r)}else this._transitionEngine.trigger(e,t,i,r)}listen(e,t,i,r,s){if("@"==i.charAt(0)){const[o,a]=QN(i);return this._timelineEngine.listen(o,t,a,s)}return this._transitionEngine.listen(e,t,i,r,s)}flush(e=-1){this._transitionEngine.flush(e)}get players(){return this._transitionEngine.players.concat(this._timelineEngine.players)}whenRenderingDone(){return this._transitionEngine.whenRenderingDone()}}let Ore=(()=>{class n{constructor(t,i,r){this._element=t,this._startStyles=i,this._endStyles=r,this._state=0;let s=n.initialStylesByElement.get(t);s||n.initialStylesByElement.set(t,s=new Map),this._initialStyles=s}start(){this._state<1&&(this._startStyles&&Ts(this._element,this._startStyles,this._initialStyles),this._state=1)}finish(){this.start(),this._state<2&&(Ts(this._element,this._initialStyles),this._endStyles&&(Ts(this._element,this._endStyles),this._endStyles=null),this._state=1)}destroy(){this.finish(),this._state<3&&(n.initialStylesByElement.delete(this._element),this._startStyles&&(gc(this._element,this._startStyles),this._endStyles=null),this._endStyles&&(gc(this._element,this._endStyles),this._endStyles=null),Ts(this._element,this._initialStyles),this._state=3)}}return n.initialStylesByElement=new WeakMap,n})();function HM(n){let e=null;return n.forEach((t,i)=>{(function kre(n){return"display"===n||"position"===n})(i)&&(e=e||new Map,e.set(i,t))}),e}class TF{constructor(e,t,i,r){this.element=e,this.keyframes=t,this.options=i,this._specialStyles=r,this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._initialized=!1,this._finished=!1,this._started=!1,this._destroyed=!1,this._originalOnDoneFns=[],this._originalOnStartFns=[],this.time=0,this.parentPlayer=null,this.currentSnapshot=new Map,this._duration=i.duration,this._delay=i.delay||0,this.time=this._duration+this._delay}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(e=>e()),this._onDoneFns=[])}init(){this._buildPlayer(),this._preparePlayerBeforeStart()}_buildPlayer(){if(this._initialized)return;this._initialized=!0;const e=this.keyframes;this.domPlayer=this._triggerWebAnimation(this.element,e,this.options),this._finalKeyframe=e.length?e[e.length-1]:new Map,this.domPlayer.addEventListener("finish",()=>this._onFinish())}_preparePlayerBeforeStart(){this._delay?this._resetDomPlayerState():this.domPlayer.pause()}_convertKeyframesToObject(e){const t=[];return e.forEach(i=>{t.push(Object.fromEntries(i))}),t}_triggerWebAnimation(e,t,i){return e.animate(this._convertKeyframesToObject(t),i)}onStart(e){this._originalOnStartFns.push(e),this._onStartFns.push(e)}onDone(e){this._originalOnDoneFns.push(e),this._onDoneFns.push(e)}onDestroy(e){this._onDestroyFns.push(e)}play(){this._buildPlayer(),this.hasStarted()||(this._onStartFns.forEach(e=>e()),this._onStartFns=[],this._started=!0,this._specialStyles&&this._specialStyles.start()),this.domPlayer.play()}pause(){this.init(),this.domPlayer.pause()}finish(){this.init(),this._specialStyles&&this._specialStyles.finish(),this._onFinish(),this.domPlayer.finish()}reset(){this._resetDomPlayerState(),this._destroyed=!1,this._finished=!1,this._started=!1,this._onStartFns=this._originalOnStartFns,this._onDoneFns=this._originalOnDoneFns}_resetDomPlayerState(){this.domPlayer&&this.domPlayer.cancel()}restart(){this.reset(),this.play()}hasStarted(){return this._started}destroy(){this._destroyed||(this._destroyed=!0,this._resetDomPlayerState(),this._onFinish(),this._specialStyles&&this._specialStyles.destroy(),this._onDestroyFns.forEach(e=>e()),this._onDestroyFns=[])}setPosition(e){void 0===this.domPlayer&&this.init(),this.domPlayer.currentTime=e*this.time}getPosition(){return this.domPlayer.currentTime/this.time}get totalTime(){return this._delay+this._duration}beforeDestroy(){const e=new Map;this.hasStarted()&&this._finalKeyframe.forEach((i,r)=>{"offset"!==r&&e.set(r,this._finished?i:fF(this.element,r))}),this.currentSnapshot=e}triggerCallback(e){const t="start"===e?this._onStartFns:this._onDoneFns;t.forEach(i=>i()),t.length=0}}class Lre{validateStyleProperty(e){return!0}validateAnimatableStyleProperty(e){return!0}matchesElement(e,t){return!1}containsElement(e,t){return iF(e,t)}getParentElement(e){return CM(e)}query(e,t,i){return rF(e,t,i)}computeStyle(e,t,i){return window.getComputedStyle(e)[t]}animate(e,t,i,r,s,o=[]){const c={duration:i,delay:r,fill:0==r?"both":"forwards"};s&&(c.easing=s);const l=new Map,u=o.filter(f=>f instanceof TF);(function Bie(n,e){return 0===n||0===e})(i,r)&&u.forEach(f=>{f.currentSnapshot.forEach((p,m)=>l.set(m,p))});let h=function Lie(n){return n.length?n[0]instanceof Map?n:n.map(e=>cF(e)):[]}(t).map(f=>ia(f));h=function Uie(n,e,t){if(t.size&&e.length){let i=e[0],r=[];if(t.forEach((s,o)=>{i.has(o)||r.push(o),i.set(o,s)}),r.length)for(let s=1;s<e.length;s++){let o=e[s];r.forEach(a=>o.set(a,fF(n,a)))}}return e}(e,h,l);const d=function Rre(n,e){let t=null,i=null;return Array.isArray(e)&&e.length?(t=HM(e[0]),e.length>1&&(i=HM(e[e.length-1]))):e instanceof Map&&(t=HM(e)),t||i?new Ore(n,t,i):null}(e,h);return new TF(e,h,c,d)}}let Nre=(()=>{class n extends Yk{constructor(t,i){super(),this._nextAnimationId=0,this._renderer=t.createRenderer(i.body,{id:"0",encapsulation:Nr.None,styles:[],data:{animation:[]}})}build(t){const i=this._nextAnimationId.toString();this._nextAnimationId++;const r=Array.isArray(t)?Zk(t):t;return AF(this._renderer,null,i,"register",[r]),new Fre(i,this._renderer)}}return n.\u0275fac=function(t){return new(t||n)(le(rh),le(hn))},n.\u0275prov=Te({token:n,factory:n.\u0275fac}),n})();class Fre extends IQ{constructor(e,t){super(),this._id=e,this._renderer=t}create(e,t){return new Vre(this._id,e,t||{},this._renderer)}}class Vre{constructor(e,t,i,r){this.id=e,this.element=t,this._renderer=r,this.parentPlayer=null,this._started=!1,this.totalTime=0,this._command("create",i)}_listen(e,t){return this._renderer.listen(this.element,`@@${this.id}:${e}`,t)}_command(e,...t){return AF(this._renderer,this.element,this.id,e,t)}onDone(e){this._listen("done",e)}onStart(e){this._listen("start",e)}onDestroy(e){this._listen("destroy",e)}init(){this._command("init")}hasStarted(){return this._started}play(){this._command("play"),this._started=!0}pause(){this._command("pause")}restart(){this._command("restart")}finish(){this._command("finish")}destroy(){this._command("destroy")}reset(){this._command("reset"),this._started=!1}setPosition(e){this._command("setPosition",e)}getPosition(){return this._renderer.engine.players[+this.id]?.getPosition()??0}}function AF(n,e,t,i,r){return n.setProperty(e,`@@${t}:${i}`,r)}const IF="@.disabled";let Bre=(()=>{class n{constructor(t,i,r){this.delegate=t,this.engine=i,this._zone=r,this._currentId=0,this._microtaskId=1,this._animationCallbacksBuffer=[],this._rendererCache=new Map,this._cdRecurDepth=0,this.promise=Promise.resolve(0),i.onRemovalComplete=(s,o)=>{const a=o?.parentNode(s);a&&o.removeChild(a,s)}}createRenderer(t,i){const s=this.delegate.createRenderer(t,i);if(!(t&&i&&i.data&&i.data.animation)){let u=this._rendererCache.get(s);return u||(u=new PF("",s,this.engine,()=>this._rendererCache.delete(s)),this._rendererCache.set(s,u)),u}const o=i.id,a=i.id+"-"+this._currentId;this._currentId++,this.engine.register(a,t);const c=u=>{Array.isArray(u)?u.forEach(c):this.engine.registerTrigger(o,a,t,u.name,u)};return i.data.animation.forEach(c),new Ure(this,a,s,this.engine)}begin(){this._cdRecurDepth++,this.delegate.begin&&this.delegate.begin()}_scheduleCountTask(){this.promise.then(()=>{this._microtaskId++})}scheduleListenerCallback(t,i,r){t>=0&&t<this._microtaskId?this._zone.run(()=>i(r)):(0==this._animationCallbacksBuffer.length&&Promise.resolve(null).then(()=>{this._zone.run(()=>{this._animationCallbacksBuffer.forEach(s=>{const[o,a]=s;o(a)}),this._animationCallbacksBuffer=[]})}),this._animationCallbacksBuffer.push([i,r]))}end(){this._cdRecurDepth--,0==this._cdRecurDepth&&this._zone.runOutsideAngular(()=>{this._scheduleCountTask(),this.engine.flush(this._microtaskId)}),this.delegate.end&&this.delegate.end()}whenRenderingDone(){return this.engine.whenRenderingDone()}}return n.\u0275fac=function(t){return new(t||n)(le(rh),le(x_),le(on))},n.\u0275prov=Te({token:n,factory:n.\u0275fac}),n})();class PF{constructor(e,t,i,r){this.namespaceId=e,this.delegate=t,this.engine=i,this._onDestroy=r,this.destroyNode=this.delegate.destroyNode?s=>t.destroyNode(s):null}get data(){return this.delegate.data}destroy(){this.engine.destroy(this.namespaceId,this.delegate),this.delegate.destroy(),this._onDestroy?.()}createElement(e,t){return this.delegate.createElement(e,t)}createComment(e){return this.delegate.createComment(e)}createText(e){return this.delegate.createText(e)}appendChild(e,t){this.delegate.appendChild(e,t),this.engine.onInsert(this.namespaceId,t,e,!1)}insertBefore(e,t,i,r=!0){this.delegate.insertBefore(e,t,i),this.engine.onInsert(this.namespaceId,t,e,r)}removeChild(e,t,i){this.engine.onRemove(this.namespaceId,t,this.delegate,i)}selectRootElement(e,t){return this.delegate.selectRootElement(e,t)}parentNode(e){return this.delegate.parentNode(e)}nextSibling(e){return this.delegate.nextSibling(e)}setAttribute(e,t,i,r){this.delegate.setAttribute(e,t,i,r)}removeAttribute(e,t,i){this.delegate.removeAttribute(e,t,i)}addClass(e,t){this.delegate.addClass(e,t)}removeClass(e,t){this.delegate.removeClass(e,t)}setStyle(e,t,i,r){this.delegate.setStyle(e,t,i,r)}removeStyle(e,t,i){this.delegate.removeStyle(e,t,i)}setProperty(e,t,i){"@"==t.charAt(0)&&t==IF?this.disableAnimations(e,!!i):this.delegate.setProperty(e,t,i)}setValue(e,t){this.delegate.setValue(e,t)}listen(e,t,i){return this.delegate.listen(e,t,i)}disableAnimations(e,t){this.engine.disableAnimations(e,t)}}class Ure extends PF{constructor(e,t,i,r,s){super(t,i,r,s),this.factory=e,this.namespaceId=t}setProperty(e,t,i){"@"==t.charAt(0)?"."==t.charAt(1)&&t==IF?this.disableAnimations(e,i=void 0===i||!!i):this.engine.process(this.namespaceId,e,t.slice(1),i):this.delegate.setProperty(e,t,i)}listen(e,t,i){if("@"==t.charAt(0)){const r=function zre(n){switch(n){case"body":return document.body;case"document":return document;case"window":return window;default:return n}}(e);let s=t.slice(1),o="";return"@"!=s.charAt(0)&&([s,o]=function Hre(n){const e=n.indexOf(".");return[n.substring(0,e),n.slice(e+1)]}(s)),this.engine.listen(this.namespaceId,r,s,o,a=>{this.factory.scheduleListenerCallback(a._data||-1,i,a)})}return this.delegate.listen(e,t,i)}}const RF=[{provide:Yk,useClass:Nre},{provide:NM,useFactory:function jre(){return new lre}},{provide:x_,useClass:(()=>{class n extends x_{constructor(t,i,r,s){super(t.body,i,r)}ngOnDestroy(){this.flush()}}return n.\u0275fac=function(t){return new(t||n)(le(hn),le(SM),le(NM),le(wh))},n.\u0275prov=Te({token:n,factory:n.\u0275fac}),n})()},{provide:rh,useFactory:function Wre(n,e,t){return new Bre(n,e,t)},deps:[Ap,x_,on]}],GM=[{provide:SM,useFactory:()=>new Lre},{provide:cp,useValue:"BrowserAnimations"},...RF],OF=[{provide:SM,useClass:sF},{provide:cp,useValue:"NoopAnimations"},...RF];let $re=(()=>{class n{static withConfig(t){return{ngModule:n,providers:t.disableAnimations?OF:GM}}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=bi({type:n}),n.\u0275inj=hi({providers:GM,imports:[ZA]}),n})();class M_{static#e=this.\u0275fac=function(t){return new(t||M_)};static#t=this.\u0275mod=bi({type:M_,bootstrap:[o_]});static#n=this.\u0275inj=hi({imports:[ZA,i_,$re,kte,dne]})}b6().bootstrapModule(M_).catch(n=>console.error(n))}},Qt=>{Qt(Qt.s=202)}]);